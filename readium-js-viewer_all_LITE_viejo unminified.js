var requirejs, require, define;
if (
    ((function (e) {
        function t(e, t) {
            return b.call(e, t);
        }
        function n(e, t) {
            var n,
                r,
                i,
                o,
                a,
                s,
                l,
                c,
                u,
                d,
                f,
                h,
                p = t && t.split("/"),
                g = m.map,
                v = (g && g["*"]) || {};
            if (e) {
                for (e = e.split("/"), a = e.length - 1, m.nodeIdCompat && _.test(e[a]) && (e[a] = e[a].replace(_, "")), "." === e[0].charAt(0) && p && ((h = p.slice(0, p.length - 1)), (e = h.concat(e))), u = 0; u < e.length; u++)
                    if (((f = e[u]), "." === f)) e.splice(u, 1), (u -= 1);
                    else if (".." === f) {
                        if (0 === u || (1 === u && ".." === e[2]) || ".." === e[u - 1]) continue;
                        u > 0 && (e.splice(u - 1, 2), (u -= 2));
                    }
                e = e.join("/");
            }
            if ((p || v) && g) {
                for (n = e.split("/"), u = n.length; u > 0; u -= 1) {
                    if (((r = n.slice(0, u).join("/")), p))
                        for (d = p.length; d > 0; d -= 1)
                            if (((i = g[p.slice(0, d).join("/")]), i && (i = i[r]))) {
                                (o = i), (s = u);
                                break;
                            }
                    if (o) break;
                    !l && v && v[r] && ((l = v[r]), (c = u));
                }
                !o && l && ((o = l), (s = c)), o && (n.splice(0, s, o), (e = n.join("/")));
            }
            return e;
        }
        function r(t, n) {
            return function () {
                var r = y.call(arguments, 0);
                return "string" != typeof r[0] && 1 === r.length && r.push(null), d.apply(e, r.concat([t, n]));
            };
        }
        function i(e) {
            return function (t) {
                return n(t, e);
            };
        }
        function o(e) {
            return function (t) {
                p[e] = t;
            };
        }
        function a(n) {
            if (t(g, n)) {
                var r = g[n];
                delete g[n], (v[n] = !0), u.apply(e, r);
            }
            if (!t(p, n) && !t(v, n)) throw new Error("No " + n);
            return p[n];
        }
        function s(e) {
            var t,
                n = e ? e.indexOf("!") : -1;
            return n > -1 && ((t = e.substring(0, n)), (e = e.substring(n + 1, e.length))), [t, e];
        }
        function l(e) {
            return e ? s(e) : [];
        }
        function c(e) {
            return function () {
                return (m && m.config && m.config[e]) || {};
            };
        }
        var u,
            d,
            f,
            h,
            p = {},
            g = {},
            m = {},
            v = {},
            b = Object.prototype.hasOwnProperty,
            y = [].slice,
            _ = /\.js$/;
        (f = function (e, t) {
            var r,
                o = s(e),
                l = o[0],
                c = t[1];
            return (
                (e = o[1]), l && ((l = n(l, c)), (r = a(l))), l ? (e = r && r.normalize ? r.normalize(e, i(c)) : n(e, c)) : ((e = n(e, c)), (o = s(e)), (l = o[0]), (e = o[1]), l && (r = a(l))), { f: l ? l + "!" + e : e, n: e, pr: l, p: r }
            );
        }),
            (h = {
                require: function (e) {
                    return r(e);
                },
                exports: function (e) {
                    var t = p[e];
                    return "undefined" != typeof t ? t : (p[e] = {});
                },
                module: function (e) {
                    return { id: e, uri: "", exports: p[e], config: c(e) };
                },
            }),
            (u = function (n, i, s, c) {
                var u,
                    d,
                    m,
                    b,
                    y,
                    _,
                    w,
                    x = [],
                    E = typeof s;
                if (((c = c || n), (_ = l(c)), "undefined" === E || "function" === E)) {
                    for (i = !i.length && s.length ? ["require", "exports", "module"] : i, y = 0; y < i.length; y += 1)
                        if (((b = f(i[y], _)), (d = b.f), "require" === d)) x[y] = h.require(n);
                        else if ("exports" === d) (x[y] = h.exports(n)), (w = !0);
                        else if ("module" === d) u = x[y] = h.module(n);
                        else if (t(p, d) || t(g, d) || t(v, d)) x[y] = a(d);
                        else {
                            if (!b.p) throw new Error(n + " missing " + d);
                            b.p.load(b.n, r(c, !0), o(d), {}), (x[y] = p[d]);
                        }
                    (m = s ? s.apply(p[n], x) : void 0), n && (u && u.exports !== e && u.exports !== p[n] ? (p[n] = u.exports) : (m === e && w) || (p[n] = m));
                } else n && (p[n] = s);
            }),
            (requirejs = require = d = function (t, n, r, i, o) {
                if ("string" == typeof t) return h[t] ? h[t](n) : a(f(t, l(n)).f);
                if (!t.splice) {
                    if (((m = t), m.deps && d(m.deps, m.callback), !n)) return;
                    n.splice ? ((t = n), (n = r), (r = null)) : (t = e);
                }
                return (
                    (n = n || function () {}),
                    "function" == typeof r && ((r = i), (i = o)),
                    i
                        ? u(e, t, n, r)
                        : setTimeout(function () {
                              u(e, t, n, r);
                          }, 4),
                    d
                );
            }),
            (d.config = function (e) {
                return d(e);
            }),
            (requirejs._defined = p),
            (define = function (e, n, r) {
                if ("string" != typeof e) throw new Error("See almond README: incorrect module build, no module name");
                n.splice || ((r = n), (n = [])), t(p, e) || t(g, e) || (g[e] = [e, n, r]);
            }),
            (define.amd = { jQuery: !0 });
    })(),
    define("readium-js-viewer_all_LITE", function () {}),
    (function (e) {
        "use strict";
        function t(e, t) {
            function n() {
                this.constructor = e;
            }
            (n.prototype = t.prototype), (e.prototype = new n());
        }
        function n(e, t, r, i) {
            (this.message = e), (this.expected = t), (this.found = r), (this.location = i), (this.name = "SyntaxError"), "function" == typeof Error.captureStackTrace && Error.captureStackTrace(this, n);
        }
        function r(e, t) {
            function r(e, t) {
                return { type: "literal", text: e, ignoreCase: t };
            }
            function i(e, t, n) {
                return { type: "class", parts: e, inverted: t, ignoreCase: n };
            }
            function o() {
                return { type: "end" };
            }
            function a(e) {
                return { type: "other", description: e };
            }
            function s(t) {
                var n,
                    r = Ye[t];
                if (r) return r;
                for (n = t - 1; !Ye[n]; ) n--;
                for (r = Ye[n], r = { line: r.line, column: r.column }; n < t; ) 10 === e.charCodeAt(n) ? (r.line++, (r.column = 1)) : r.column++, n++;
                return (Ye[t] = r), r;
            }
            function l(e, t) {
                var n = s(e),
                    r = s(t);
                return { start: { offset: e, line: n.line, column: n.column }, end: { offset: t, line: r.line, column: r.column } };
            }
            function c(e) {
                Xe < Ze || (Xe > Ze && ((Ze = Xe), (et = [])), et.push(e));
            }
            function u(e, t, r) {
                return new n(n.buildMessage(e, t), e, t, r);
            }
            function d() {
                var t, n, r, i;
                return (
                    (t = Xe),
                    e.substr(Xe, 8) === U ? ((n = U), (Xe += 8)) : ((n = M), 0 === tt && c(B)),
                    n !== M
                        ? ((r = f()), r === M && (r = h()), r !== M ? (41 === e.charCodeAt(Xe) ? ((i = j), Xe++) : ((i = M), 0 === tt && c(z)), i !== M ? ((Qe = t), (n = V(r)), (t = n)) : ((Xe = t), (t = M))) : ((Xe = t), (t = M)))
                        : ((Xe = t), (t = M)),
                    t
                );
            }
            function f() {
                var t, n, r, i, o, a, s;
                return (
                    (t = Xe),
                    (n = g()),
                    n !== M
                        ? ((r = p()),
                          r !== M
                              ? (44 === e.charCodeAt(Xe) ? ((i = H), Xe++) : ((i = M), 0 === tt && c($)),
                                i !== M
                                    ? ((o = p()),
                                      o !== M
                                          ? (44 === e.charCodeAt(Xe) ? ((a = H), Xe++) : ((a = M), 0 === tt && c($)), a !== M ? ((s = p()), s !== M ? ((Qe = t), (n = W(n, r, o, s)), (t = n)) : ((Xe = t), (t = M))) : ((Xe = t), (t = M)))
                                          : ((Xe = t), (t = M)))
                                    : ((Xe = t), (t = M)))
                              : ((Xe = t), (t = M)))
                        : ((Xe = t), (t = M)),
                    t
                );
            }
            function h() {
                var e, t, n;
                return (e = Xe), (t = g()), t !== M ? ((n = p()), n !== M ? ((Qe = e), (t = q(t, n)), (e = t)) : ((Xe = e), (e = M))) : ((Xe = e), (e = M)), e;
            }
            function p() {
                var e, t, n;
                if (((e = Xe), (t = []), (n = g()), n === M && (n = m()), n !== M)) for (; n !== M; ) t.push(n), (n = g()), n === M && (n = m());
                else t = M;
                return t !== M ? ((n = v()), n === M && (n = null), n !== M ? ((Qe = e), (t = G(t, n)), (e = t)) : ((Xe = e), (e = M))) : ((Xe = e), (e = M)), e;
            }
            function g() {
                var t, n, r, i, o, a, s;
                return (
                    (t = Xe),
                    47 === e.charCodeAt(Xe) ? ((n = J), Xe++) : ((n = M), 0 === tt && c(K)),
                    n !== M
                        ? ((r = T()),
                          r !== M
                              ? ((i = Xe),
                                91 === e.charCodeAt(Xe) ? ((o = X), Xe++) : ((o = M), 0 === tt && c(Q)),
                                o !== M
                                    ? ((a = b()), a !== M ? (93 === e.charCodeAt(Xe) ? ((s = Y), Xe++) : ((s = M), 0 === tt && c(Z)), s !== M ? ((o = [o, a, s]), (i = o)) : ((Xe = i), (i = M))) : ((Xe = i), (i = M)))
                                    : ((Xe = i), (i = M)),
                                i === M && (i = null),
                                i !== M ? ((Qe = t), (n = ee(r, i)), (t = n)) : ((Xe = t), (t = M)))
                              : ((Xe = t), (t = M)))
                        : ((Xe = t), (t = M)),
                    t
                );
            }
            function m() {
                var t, n, r, i, o, a, s;
                return (
                    (t = Xe),
                    e.substr(Xe, 2) === te ? ((n = te), (Xe += 2)) : ((n = M), 0 === tt && c(ne)),
                    n !== M
                        ? ((r = T()),
                          r !== M
                              ? ((i = Xe),
                                91 === e.charCodeAt(Xe) ? ((o = X), Xe++) : ((o = M), 0 === tt && c(Q)),
                                o !== M
                                    ? ((a = b()), a !== M ? (93 === e.charCodeAt(Xe) ? ((s = Y), Xe++) : ((s = M), 0 === tt && c(Z)), s !== M ? ((o = [o, a, s]), (i = o)) : ((Xe = i), (i = M))) : ((Xe = i), (i = M)))
                                    : ((Xe = i), (i = M)),
                                i === M && (i = null),
                                i !== M ? ((Qe = t), (n = re(r, i)), (t = n)) : ((Xe = t), (t = M)))
                              : ((Xe = t), (t = M)))
                        : ((Xe = t), (t = M)),
                    t
                );
            }
            function v() {
                var t, n, r, i, o, a, s;
                return (
                    (t = Xe),
                    58 === e.charCodeAt(Xe) ? ((n = ie), Xe++) : ((n = M), 0 === tt && c(oe)),
                    n !== M
                        ? ((r = T()),
                          r !== M
                              ? ((i = Xe),
                                91 === e.charCodeAt(Xe) ? ((o = X), Xe++) : ((o = M), 0 === tt && c(Q)),
                                o !== M
                                    ? ((a = y()), a !== M ? (93 === e.charCodeAt(Xe) ? ((s = Y), Xe++) : ((s = M), 0 === tt && c(Z)), s !== M ? ((o = [o, a, s]), (i = o)) : ((Xe = i), (i = M))) : ((Xe = i), (i = M)))
                                    : ((Xe = i), (i = M)),
                                i === M && (i = null),
                                i !== M ? ((Qe = t), (n = ae(r, i)), (t = n)) : ((Xe = t), (t = M)))
                              : ((Xe = t), (t = M)))
                        : ((Xe = t), (t = M)),
                    t
                );
            }
            function b() {
                var e, t;
                return (e = Xe), (t = E()), t !== M && ((Qe = e), (t = se(t))), (e = t);
            }
            function y() {
                var e, t, n;
                return (e = Xe), (t = w()), t === M && (t = null), t !== M ? ((n = _()), n === M && (n = null), n !== M ? ((Qe = e), (t = le(t, n)), (e = t)) : ((Xe = e), (e = M))) : ((Xe = e), (e = M)), e;
            }
            function _() {
                var t, n, r, i, o;
                return (
                    (t = Xe),
                    59 === e.charCodeAt(Xe) ? ((n = ce), Xe++) : ((n = M), 0 === tt && c(ue)),
                    n !== M
                        ? ((r = x()),
                          r !== M
                              ? (61 === e.charCodeAt(Xe) ? ((i = de), Xe++) : ((i = M), 0 === tt && c(fe)), i !== M ? ((o = x()), o !== M ? ((Qe = t), (n = he(r, o)), (t = n)) : ((Xe = t), (t = M))) : ((Xe = t), (t = M)))
                              : ((Xe = t), (t = M)))
                        : ((Xe = t), (t = M)),
                    t
                );
            }
            function w() {
                var t, n, r, i;
                return (
                    (t = Xe),
                    (n = E()),
                    n === M && (n = null),
                    n !== M
                        ? (44 === e.charCodeAt(Xe) ? ((r = H), Xe++) : ((r = M), 0 === tt && c($)), r !== M ? ((i = E()), i === M && (i = null), i !== M ? ((Qe = t), (n = pe(n, i)), (t = n)) : ((Xe = t), (t = M))) : ((Xe = t), (t = M)))
                        : ((Xe = t), (t = M)),
                    t
                );
            }
            function x() {
                var e, t, n;
                if (((e = Xe), (t = []), (n = C()), n === M && (n = A()), n !== M)) for (; n !== M; ) t.push(n), (n = C()), n === M && (n = A());
                else t = M;
                return t !== M && ((Qe = e), (t = ge(t))), (e = t);
            }
            function E() {
                var e, t, n;
                if (((e = Xe), (t = []), (n = C()), n === M && ((n = A()), n === M && (n = S())), n !== M)) for (; n !== M; ) t.push(n), (n = C()), n === M && ((n = A()), n === M && (n = S()));
                else t = M;
                return t !== M && ((Qe = e), (t = ge(t))), (e = t);
            }
            function C() {
                var e, t, n, r;
                return (
                    (e = Xe),
                    (t = Xe),
                    (n = R()),
                    n !== M ? ((r = R()), r !== M ? ((n = [n, r]), (t = n)) : ((Xe = t), (t = M))) : ((Xe = t), (t = M)),
                    t === M &&
                        ((t = Xe),
                        (n = R()),
                        n !== M ? ((r = I()), r !== M ? ((n = [n, r]), (t = n)) : ((Xe = t), (t = M))) : ((Xe = t), (t = M)),
                        t === M &&
                            ((t = Xe),
                            (n = R()),
                            n !== M ? ((r = k()), r !== M ? ((n = [n, r]), (t = n)) : ((Xe = t), (t = M))) : ((Xe = t), (t = M)),
                            t === M &&
                                ((t = Xe),
                                (n = R()),
                                n !== M ? ((r = P()), r !== M ? ((n = [n, r]), (t = n)) : ((Xe = t), (t = M))) : ((Xe = t), (t = M)),
                                t === M &&
                                    ((t = Xe),
                                    (n = R()),
                                    n !== M ? ((r = N()), r !== M ? ((n = [n, r]), (t = n)) : ((Xe = t), (t = M))) : ((Xe = t), (t = M)),
                                    t === M && ((t = Xe), (n = R()), n !== M ? ((r = O()), r !== M ? ((n = [n, r]), (t = n)) : ((Xe = t), (t = M))) : ((Xe = t), (t = M))))))),
                    t !== M && ((Qe = e), (t = me(t))),
                    (e = t)
                );
            }
            function T() {
                var t, n, r, i, o;
                if (((t = Xe), 48 === e.charCodeAt(Xe) ? ((n = Ee), Xe++) : ((n = M), 0 === tt && c(Ce)), n === M))
                    if (((n = Xe), ve.test(e.charAt(Xe)) ? ((r = e.charAt(Xe)), Xe++) : ((r = M), 0 === tt && c(be)), r !== M)) {
                        for (i = [], ye.test(e.charAt(Xe)) ? ((o = e.charAt(Xe)), Xe++) : ((o = M), 0 === tt && c(_e)); o !== M; ) i.push(o), ye.test(e.charAt(Xe)) ? ((o = e.charAt(Xe)), Xe++) : ((o = M), 0 === tt && c(_e));
                        i !== M ? ((r = [r, i]), (n = r)) : ((Xe = n), (n = M));
                    } else (Xe = n), (n = M);
                return n !== M && ((Qe = t), (n = Te(n))), (t = n);
            }
            function S() {
                var t, n;
                return (t = Xe), 32 === e.charCodeAt(Xe) ? ((n = Se), Xe++) : ((n = M), 0 === tt && c(Re)), n !== M && ((Qe = t), (n = Ie())), (t = n);
            }
            function R() {
                var t, n;
                return (t = Xe), 94 === e.charCodeAt(Xe) ? ((n = ke), Xe++) : ((n = M), 0 === tt && c(Pe)), n !== M && ((Qe = t), (n = Ne())), (t = n);
            }
            function I() {
                var t, n;
                return (t = Xe), 91 === e.charCodeAt(Xe) ? ((n = X), Xe++) : ((n = M), 0 === tt && c(Q)), n === M && (93 === e.charCodeAt(Xe) ? ((n = Y), Xe++) : ((n = M), 0 === tt && c(Z))), n !== M && ((Qe = t), (n = Oe(n))), (t = n);
            }
            function k() {
                var t, n;
                return (t = Xe), 40 === e.charCodeAt(Xe) ? ((n = Ae), Xe++) : ((n = M), 0 === tt && c(De)), n === M && (41 === e.charCodeAt(Xe) ? ((n = j), Xe++) : ((n = M), 0 === tt && c(z))), n !== M && ((Qe = t), (n = Me(n))), (t = n);
            }
            function P() {
                var t, n;
                return (t = Xe), 44 === e.charCodeAt(Xe) ? ((n = H), Xe++) : ((n = M), 0 === tt && c($)), n !== M && ((Qe = t), (n = Fe())), (t = n);
            }
            function N() {
                var t, n;
                return (t = Xe), 59 === e.charCodeAt(Xe) ? ((n = ce), Xe++) : ((n = M), 0 === tt && c(ue)), n !== M && ((Qe = t), (n = Le())), (t = n);
            }
            function O() {
                var t, n;
                return (t = Xe), 61 === e.charCodeAt(Xe) ? ((n = de), Xe++) : ((n = M), 0 === tt && c(fe)), n !== M && ((Qe = t), (n = Ue())), (t = n);
            }
            function A() {
                var t, n;
                return (
                    (t = Xe),
                    Be.test(e.charAt(Xe)) ? ((n = e.charAt(Xe)), Xe++) : ((n = M), 0 === tt && c(je)),
                    n === M &&
                        (ze.test(e.charAt(Xe)) ? ((n = e.charAt(Xe)), Xe++) : ((n = M), 0 === tt && c(Ve)),
                        n === M &&
                            (ye.test(e.charAt(Xe)) ? ((n = e.charAt(Xe)), Xe++) : ((n = M), 0 === tt && c(_e)),
                            n === M &&
                                (45 === e.charCodeAt(Xe) ? ((n = He), Xe++) : ((n = M), 0 === tt && c($e)),
                                n === M &&
                                    (95 === e.charCodeAt(Xe) ? ((n = We), Xe++) : ((n = M), 0 === tt && c(qe)),
                                    n === M && (46 === e.charCodeAt(Xe) ? ((n = we), Xe++) : ((n = M), 0 === tt && c(xe)), n === M && (37 === e.charCodeAt(Xe) ? ((n = Ge), Xe++) : ((n = M), 0 === tt && c(Je)))))))),
                    n !== M && ((Qe = t), (n = Ke(n))),
                    (t = n)
                );
            }
            t = void 0 !== t ? t : {};
            var D,
                M = {},
                F = { fragment: d },
                L = d,
                U = "epubcfi(",
                B = r("epubcfi(", !1),
                j = ")",
                z = r(")", !1),
                V = function (e) {
                    return { type: "CFIAST", cfiString: e };
                },
                H = ",",
                $ = r(",", !1),
                W = function (e, t, n, r) {
                    return { type: "range", path: e, localPath: t, range1: n, range2: r };
                },
                q = function (e, t) {
                    return { type: "path", path: e, localPath: t };
                },
                G = function (e, t) {
                    return { steps: e, termStep: t ? t : "" };
                },
                J = "/",
                K = r("/", !1),
                X = "[",
                Q = r("[", !1),
                Y = "]",
                Z = r("]", !1),
                ee = function (e, t) {
                    return { type: "indexStep", stepLength: e, idAssertion: t ? t[1] : void 0 };
                },
                te = "!/",
                ne = r("!/", !1),
                re = function (e, t) {
                    return { type: "indirectionStep", stepLength: e, idAssertion: t ? t[1] : void 0 };
                },
                ie = ":",
                oe = r(":", !1),
                ae = function (e, t) {
                    return { type: "textTerminus", offsetValue: e, textAssertion: t ? t[1] : void 0 };
                },
                se = function (e) {
                    return e;
                },
                le = function (e, t) {
                    return { type: "textLocationAssertion", csv: e ? e : "", parameter: t ? t : "" };
                },
                ce = ";",
                ue = r(";", !1),
                de = "=",
                fe = r("=", !1),
                he = function (e, t) {
                    return { type: "parameter", LHSValue: e ? e : "", RHSValue: t ? t : "" };
                },
                pe = function (e, t) {
                    return { type: "csv", preAssertion: e ? e : "", postAssertion: t ? t : "" };
                },
                ge = function (e) {
                    return e.join("");
                },
                me = function (e) {
                    return e[1];
                },
                ve = /^[1-9]/,
                be = i([["1", "9"]], !1, !1),
                ye = /^[0-9]/,
                _e = i([["0", "9"]], !1, !1),
                we = ".",
                xe = r(".", !1),
                Ee = "0",
                Ce = r("0", !1),
                Te = function (e) {
                    return "0" === e ? "0" : e[0].concat(e[1].join(""));
                },
                Se = " ",
                Re = r(" ", !1),
                Ie = function () {
                    return " ";
                },
                ke = "^",
                Pe = r("^", !1),
                Ne = function () {
                    return "^";
                },
                Oe =
                    (r('"', !1),
                    function (e) {
                        return e;
                    }),
                Ae = "(",
                De = r("(", !1),
                Me = function (e) {
                    return e;
                },
                Fe = function () {
                    return ",";
                },
                Le = function () {
                    return ";";
                },
                Ue = function () {
                    return "=";
                },
                Be = /^[a-z]/,
                je = i([["a", "z"]], !1, !1),
                ze = /^[A-Z]/,
                Ve = i([["A", "Z"]], !1, !1),
                He = "-",
                $e = r("-", !1),
                We = "_",
                qe = r("_", !1),
                Ge = "%",
                Je = r("%", !1),
                Ke = function (e) {
                    return e;
                },
                Xe = 0,
                Qe = 0,
                Ye = [{ line: 1, column: 1 }],
                Ze = 0,
                et = [],
                tt = 0;
            if ("startRule" in t) {
                if (!(t.startRule in F)) throw new Error("Can't start parsing from rule \"" + t.startRule + '".');
                L = F[t.startRule];
            }
            if (((D = L()), D !== M && Xe === e.length)) return D;
            throw (D !== M && Xe < e.length && c(o()), u(et, Ze < e.length ? e.charAt(Ze) : null, Ze < e.length ? l(Ze, Ze + 1) : l(Ze, Ze)));
        }
        t(n, Error),
            (n.buildMessage = function (e, t) {
                function n(e) {
                    return e.charCodeAt(0).toString(16).toUpperCase();
                }
                function r(e) {
                    return e
                        .replace(/\\/g, "\\\\")
                        .replace(/"/g, '\\"')
                        .replace(/\0/g, "\\0")
                        .replace(/\t/g, "\\t")
                        .replace(/\n/g, "\\n")
                        .replace(/\r/g, "\\r")
                        .replace(/[\x00-\x0F]/g, function (e) {
                            return "\\x0" + n(e);
                        })
                        .replace(/[\x10-\x1F\x7F-\x9F]/g, function (e) {
                            return "\\x" + n(e);
                        });
                }
                function i(e) {
                    return e
                        .replace(/\\/g, "\\\\")
                        .replace(/\]/g, "\\]")
                        .replace(/\^/g, "\\^")
                        .replace(/-/g, "\\-")
                        .replace(/\0/g, "\\0")
                        .replace(/\t/g, "\\t")
                        .replace(/\n/g, "\\n")
                        .replace(/\r/g, "\\r")
                        .replace(/[\x00-\x0F]/g, function (e) {
                            return "\\x0" + n(e);
                        })
                        .replace(/[\x10-\x1F\x7F-\x9F]/g, function (e) {
                            return "\\x" + n(e);
                        });
                }
                function o(e) {
                    return l[e.type](e);
                }
                function a(e) {
                    var t,
                        n,
                        r = new Array(e.length);
                    for (t = 0; t < e.length; t++) r[t] = o(e[t]);
                    if ((r.sort(), r.length > 0)) {
                        for (t = 1, n = 1; t < r.length; t++) r[t - 1] !== r[t] && ((r[n] = r[t]), n++);
                        r.length = n;
                    }
                    switch (r.length) {
                        case 1:
                            return r[0];
                        case 2:
                            return r[0] + " or " + r[1];
                        default:
                            return r.slice(0, -1).join(", ") + ", or " + r[r.length - 1];
                    }
                }
                function s(e) {
                    return e ? '"' + r(e) + '"' : "end of input";
                }
                var l = {
                    literal: function (e) {
                        return '"' + r(e.text) + '"';
                    },
                    class: function (e) {
                        var t,
                            n = "";
                        for (t = 0; t < e.parts.length; t++) n += e.parts[t] instanceof Array ? i(e.parts[t][0]) + "-" + i(e.parts[t][1]) : i(e.parts[t]);
                        return "[" + (e.inverted ? "^" : "") + n + "]";
                    },
                    any: function (e) {
                        return "any character";
                    },
                    end: function (e) {
                        return "end of input";
                    },
                    other: function (e) {
                        return e.description;
                    },
                };
                return "Expected " + a(e) + " but " + s(t) + " found.";
            }),
            (e.window.EPUBcfiParser = { SyntaxError: n, parse: r });
    })(this),
    define("readium_cfi_js/cfi_parser", (function (e) {
        return function () {
            var t;
            return t || e.EPUBcfiParser;
        };
    })(this)),
    (function (e, t) {
        "object" == typeof module && "object" == typeof module.exports
            ? (module.exports = e.document
                  ? t(e, !0)
                  : function (e) {
                        if (!e.document) throw new Error("jQuery requires a window with a document");
                        return t(e);
                    })
            : t(e);
    })("undefined" != typeof window ? window : this, function (e, t) {
        function n(e) {
            var t = !!e && "length" in e && e.length,
                n = oe.type(e);
            return "function" !== n && !oe.isWindow(e) && ("array" === n || 0 === t || ("number" == typeof t && t > 0 && t - 1 in e));
        }
        function r(e, t, n) {
            if (oe.isFunction(t))
                return oe.grep(e, function (e, r) {
                    return !!t.call(e, r, e) !== n;
                });
            if (t.nodeType)
                return oe.grep(e, function (e) {
                    return (e === t) !== n;
                });
            if ("string" == typeof t) {
                if (ge.test(t)) return oe.filter(t, e, n);
                t = oe.filter(t, e);
            }
            return oe.grep(e, function (e) {
                return Z.call(t, e) > -1 !== n;
            });
        }
        function i(e, t) {
            for (; (e = e[t]) && 1 !== e.nodeType; );
            return e;
        }
        function o(e) {
            var t = {};
            return (
                oe.each(e.match(we) || [], function (e, n) {
                    t[n] = !0;
                }),
                t
            );
        }
        function a() {
            K.removeEventListener("DOMContentLoaded", a), e.removeEventListener("load", a), oe.ready();
        }
        function s() {
            this.expando = oe.expando + s.uid++;
        }
        function l(e, t, n) {
            var r;
            if (void 0 === n && 1 === e.nodeType)
                if (((r = "data-" + t.replace(Ie, "-$&").toLowerCase()), (n = e.getAttribute(r)), "string" == typeof n)) {
                    try {
                        n = "true" === n || ("false" !== n && ("null" === n ? null : +n + "" === n ? +n : Re.test(n) ? oe.parseJSON(n) : n));
                    } catch (e) {}
                    Se.set(e, t, n);
                } else n = void 0;
            return n;
        }
        function c(e, t, n, r) {
            var i,
                o = 1,
                a = 20,
                s = r
                    ? function () {
                          return r.cur();
                      }
                    : function () {
                          return oe.css(e, t, "");
                      },
                l = s(),
                c = (n && n[3]) || (oe.cssNumber[t] ? "" : "px"),
                u = (oe.cssNumber[t] || ("px" !== c && +l)) && Pe.exec(oe.css(e, t));
            if (u && u[3] !== c) {
                (c = c || u[3]), (n = n || []), (u = +l || 1);
                do (o = o || ".5"), (u /= o), oe.style(e, t, u + c);
                while (o !== (o = s() / l) && 1 !== o && --a);
            }
            return n && ((u = +u || +l || 0), (i = n[1] ? u + (n[1] + 1) * n[2] : +n[2]), r && ((r.unit = c), (r.start = u), (r.end = i))), i;
        }
        function u(e, t) {
            var n = "undefined" != typeof e.getElementsByTagName ? e.getElementsByTagName(t || "*") : "undefined" != typeof e.querySelectorAll ? e.querySelectorAll(t || "*") : [];
            return void 0 === t || (t && oe.nodeName(e, t)) ? oe.merge([e], n) : n;
        }
        function d(e, t) {
            for (var n = 0, r = e.length; n < r; n++) Te.set(e[n], "globalEval", !t || Te.get(t[n], "globalEval"));
        }
        function f(e, t, n, r, i) {
            for (var o, a, s, l, c, f, h = t.createDocumentFragment(), p = [], g = 0, m = e.length; g < m; g++)
                if (((o = e[g]), o || 0 === o))
                    if ("object" === oe.type(o)) oe.merge(p, o.nodeType ? [o] : o);
                    else if (Le.test(o)) {
                        for (a = a || h.appendChild(t.createElement("div")), s = (De.exec(o) || ["", ""])[1].toLowerCase(), l = Fe[s] || Fe._default, a.innerHTML = l[1] + oe.htmlPrefilter(o) + l[2], f = l[0]; f--; ) a = a.lastChild;
                        oe.merge(p, a.childNodes), (a = h.firstChild), (a.textContent = "");
                    } else p.push(t.createTextNode(o));
            for (h.textContent = "", g = 0; (o = p[g++]); )
                if (r && oe.inArray(o, r) > -1) i && i.push(o);
                else if (((c = oe.contains(o.ownerDocument, o)), (a = u(h.appendChild(o), "script")), c && d(a), n)) for (f = 0; (o = a[f++]); ) Me.test(o.type || "") && n.push(o);
            return h;
        }
        function h() {
            return !0;
        }
        function p() {
            return !1;
        }
        function g() {
            try {
                return K.activeElement;
            } catch (e) {}
        }
        function m(e, t, n, r, i, o) {
            var a, s;
            if ("object" == typeof t) {
                "string" != typeof n && ((r = r || n), (n = void 0));
                for (s in t) m(e, s, n, r, t[s], o);
                return e;
            }
            if ((null == r && null == i ? ((i = n), (r = n = void 0)) : null == i && ("string" == typeof n ? ((i = r), (r = void 0)) : ((i = r), (r = n), (n = void 0))), i === !1)) i = p;
            else if (!i) return e;
            return (
                1 === o &&
                    ((a = i),
                    (i = function (e) {
                        return oe().off(e), a.apply(this, arguments);
                    }),
                    (i.guid = a.guid || (a.guid = oe.guid++))),
                e.each(function () {
                    oe.event.add(this, t, i, r, n);
                })
            );
        }
        function v(e, t) {
            return oe.nodeName(e, "table") && oe.nodeName(11 !== t.nodeType ? t : t.firstChild, "tr") ? e.getElementsByTagName("tbody")[0] || e.appendChild(e.ownerDocument.createElement("tbody")) : e;
        }
        function b(e) {
            return (e.type = (null !== e.getAttribute("type")) + "/" + e.type), e;
        }
        function y(e) {
            var t = $e.exec(e.type);
            return t ? (e.type = t[1]) : e.removeAttribute("type"), e;
        }
        function _(e, t) {
            var n, r, i, o, a, s, l, c;
            if (1 === t.nodeType) {
                if (Te.hasData(e) && ((o = Te.access(e)), (a = Te.set(t, o)), (c = o.events))) {
                    delete a.handle, (a.events = {});
                    for (i in c) for (n = 0, r = c[i].length; n < r; n++) oe.event.add(t, i, c[i][n]);
                }
                Se.hasData(e) && ((s = Se.access(e)), (l = oe.extend({}, s)), Se.set(t, l));
            }
        }
        function w(e, t) {
            var n = t.nodeName.toLowerCase();
            "input" === n && Ae.test(e.type) ? (t.checked = e.checked) : ("input" !== n && "textarea" !== n) || (t.defaultValue = e.defaultValue);
        }
        function x(e, t, n, r) {
            t = Q.apply([], t);
            var i,
                o,
                a,
                s,
                l,
                c,
                d = 0,
                h = e.length,
                p = h - 1,
                g = t[0],
                m = oe.isFunction(g);
            if (m || (h > 1 && "string" == typeof g && !re.checkClone && He.test(g)))
                return e.each(function (i) {
                    var o = e.eq(i);
                    m && (t[0] = g.call(this, i, o.html())), x(o, t, n, r);
                });
            if (h && ((i = f(t, e[0].ownerDocument, !1, e, r)), (o = i.firstChild), 1 === i.childNodes.length && (i = o), o || r)) {
                for (a = oe.map(u(i, "script"), b), s = a.length; d < h; d++) (l = i), d !== p && ((l = oe.clone(l, !0, !0)), s && oe.merge(a, u(l, "script"))), n.call(e[d], l, d);
                if (s)
                    for (c = a[a.length - 1].ownerDocument, oe.map(a, y), d = 0; d < s; d++)
                        (l = a[d]), Me.test(l.type || "") && !Te.access(l, "globalEval") && oe.contains(c, l) && (l.src ? oe._evalUrl && oe._evalUrl(l.src) : oe.globalEval(l.textContent.replace(We, "")));
            }
            return e;
        }
        function E(e, t, n) {
            for (var r, i = t ? oe.filter(t, e) : e, o = 0; null != (r = i[o]); o++) n || 1 !== r.nodeType || oe.cleanData(u(r)), r.parentNode && (n && oe.contains(r.ownerDocument, r) && d(u(r, "script")), r.parentNode.removeChild(r));
            return e;
        }
        function C(e, t) {
            var n = oe(t.createElement(e)).appendTo(t.body),
                r = oe.css(n[0], "display");
            return n.detach(), r;
        }
        function T(e) {
            var t = K,
                n = Ge[e];
            return (
                n ||
                    ((n = C(e, t)),
                    ("none" !== n && n) || ((qe = (qe || oe("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement)), (t = qe[0].contentDocument), t.write(), t.close(), (n = C(e, t)), qe.detach()),
                    (Ge[e] = n)),
                n
            );
        }
        function S(e, t, n) {
            var r,
                i,
                o,
                a,
                s = e.style;
            return (
                (n = n || Xe(e)),
                (a = n ? n.getPropertyValue(t) || n[t] : void 0),
                ("" !== a && void 0 !== a) || oe.contains(e.ownerDocument, e) || (a = oe.style(e, t)),
                n && !re.pixelMarginRight() && Ke.test(a) && Je.test(t) && ((r = s.width), (i = s.minWidth), (o = s.maxWidth), (s.minWidth = s.maxWidth = s.width = a), (a = n.width), (s.width = r), (s.minWidth = i), (s.maxWidth = o)),
                void 0 !== a ? a + "" : a
            );
        }
        function R(e, t) {
            return {
                get: function () {
                    return e() ? void delete this.get : (this.get = t).apply(this, arguments);
                },
            };
        }
        function I(e) {
            if (e in rt) return e;
            for (var t = e[0].toUpperCase() + e.slice(1), n = nt.length; n--; ) if (((e = nt[n] + t), e in rt)) return e;
        }
        function k(e, t, n) {
            var r = Pe.exec(t);
            return r ? Math.max(0, r[2] - (n || 0)) + (r[3] || "px") : t;
        }
        function P(e, t, n, r, i) {
            for (var o = n === (r ? "border" : "content") ? 4 : "width" === t ? 1 : 0, a = 0; o < 4; o += 2)
                "margin" === n && (a += oe.css(e, n + Ne[o], !0, i)),
                    r
                        ? ("content" === n && (a -= oe.css(e, "padding" + Ne[o], !0, i)), "margin" !== n && (a -= oe.css(e, "border" + Ne[o] + "Width", !0, i)))
                        : ((a += oe.css(e, "padding" + Ne[o], !0, i)), "padding" !== n && (a += oe.css(e, "border" + Ne[o] + "Width", !0, i)));
            return a;
        }
        function N(e, t, n) {
            var r = !0,
                i = "width" === t ? e.offsetWidth : e.offsetHeight,
                o = Xe(e),
                a = "border-box" === oe.css(e, "boxSizing", !1, o);
            if (i <= 0 || null == i) {
                if (((i = S(e, t, o)), (i < 0 || null == i) && (i = e.style[t]), Ke.test(i))) return i;
                (r = a && (re.boxSizingReliable() || i === e.style[t])), (i = parseFloat(i) || 0);
            }
            return i + P(e, t, n || (a ? "border" : "content"), r, o) + "px";
        }
        function O(e, t) {
            for (var n, r, i, o = [], a = 0, s = e.length; a < s; a++)
                (r = e[a]),
                    r.style &&
                        ((o[a] = Te.get(r, "olddisplay")),
                        (n = r.style.display),
                        t
                            ? (o[a] || "none" !== n || (r.style.display = ""), "" === r.style.display && Oe(r) && (o[a] = Te.access(r, "olddisplay", T(r.nodeName))))
                            : ((i = Oe(r)), ("none" === n && i) || Te.set(r, "olddisplay", i ? n : oe.css(r, "display"))));
            for (a = 0; a < s; a++) (r = e[a]), r.style && ((t && "none" !== r.style.display && "" !== r.style.display) || (r.style.display = t ? o[a] || "" : "none"));
            return e;
        }
        function A(e, t, n, r, i) {
            return new A.prototype.init(e, t, n, r, i);
        }
        function D() {
            return (
                e.setTimeout(function () {
                    it = void 0;
                }),
                (it = oe.now())
            );
        }
        function M(e, t) {
            var n,
                r = 0,
                i = { height: e };
            for (t = t ? 1 : 0; r < 4; r += 2 - t) (n = Ne[r]), (i["margin" + n] = i["padding" + n] = e);
            return t && (i.opacity = i.width = e), i;
        }
        function F(e, t, n) {
            for (var r, i = (B.tweeners[t] || []).concat(B.tweeners["*"]), o = 0, a = i.length; o < a; o++) if ((r = i[o].call(n, t, e))) return r;
        }
        function L(e, t, n) {
            var r,
                i,
                o,
                a,
                s,
                l,
                c,
                u,
                d = this,
                f = {},
                h = e.style,
                p = e.nodeType && Oe(e),
                g = Te.get(e, "fxshow");
            n.queue ||
                ((s = oe._queueHooks(e, "fx")),
                null == s.unqueued &&
                    ((s.unqueued = 0),
                    (l = s.empty.fire),
                    (s.empty.fire = function () {
                        s.unqueued || l();
                    })),
                s.unqueued++,
                d.always(function () {
                    d.always(function () {
                        s.unqueued--, oe.queue(e, "fx").length || s.empty.fire();
                    });
                })),
                1 === e.nodeType &&
                    ("height" in t || "width" in t) &&
                    ((n.overflow = [h.overflow, h.overflowX, h.overflowY]),
                    (c = oe.css(e, "display")),
                    (u = "none" === c ? Te.get(e, "olddisplay") || T(e.nodeName) : c),
                    "inline" === u && "none" === oe.css(e, "float") && (h.display = "inline-block")),
                n.overflow &&
                    ((h.overflow = "hidden"),
                    d.always(function () {
                        (h.overflow = n.overflow[0]), (h.overflowX = n.overflow[1]), (h.overflowY = n.overflow[2]);
                    }));
            for (r in t)
                if (((i = t[r]), at.exec(i))) {
                    if ((delete t[r], (o = o || "toggle" === i), i === (p ? "hide" : "show"))) {
                        if ("show" !== i || !g || void 0 === g[r]) continue;
                        p = !0;
                    }
                    f[r] = (g && g[r]) || oe.style(e, r);
                } else c = void 0;
            if (oe.isEmptyObject(f)) "inline" === ("none" === c ? T(e.nodeName) : c) && (h.display = c);
            else {
                g ? "hidden" in g && (p = g.hidden) : (g = Te.access(e, "fxshow", {})),
                    o && (g.hidden = !p),
                    p
                        ? oe(e).show()
                        : d.done(function () {
                              oe(e).hide();
                          }),
                    d.done(function () {
                        var t;
                        Te.remove(e, "fxshow");
                        for (t in f) oe.style(e, t, f[t]);
                    });
                for (r in f) (a = F(p ? g[r] : 0, r, d)), r in g || ((g[r] = a.start), p && ((a.end = a.start), (a.start = "width" === r || "height" === r ? 1 : 0)));
            }
        }
        function U(e, t) {
            var n, r, i, o, a;
            for (n in e)
                if (((r = oe.camelCase(n)), (i = t[r]), (o = e[n]), oe.isArray(o) && ((i = o[1]), (o = e[n] = o[0])), n !== r && ((e[r] = o), delete e[n]), (a = oe.cssHooks[r]), a && "expand" in a)) {
                    (o = a.expand(o)), delete e[r];
                    for (n in o) n in e || ((e[n] = o[n]), (t[n] = i));
                } else t[r] = i;
        }
        function B(e, t, n) {
            var r,
                i,
                o = 0,
                a = B.prefilters.length,
                s = oe.Deferred().always(function () {
                    delete l.elem;
                }),
                l = function () {
                    if (i) return !1;
                    for (var t = it || D(), n = Math.max(0, c.startTime + c.duration - t), r = n / c.duration || 0, o = 1 - r, a = 0, l = c.tweens.length; a < l; a++) c.tweens[a].run(o);
                    return s.notifyWith(e, [c, o, n]), o < 1 && l ? n : (s.resolveWith(e, [c]), !1);
                },
                c = s.promise({
                    elem: e,
                    props: oe.extend({}, t),
                    opts: oe.extend(!0, { specialEasing: {}, easing: oe.easing._default }, n),
                    originalProperties: t,
                    originalOptions: n,
                    startTime: it || D(),
                    duration: n.duration,
                    tweens: [],
                    createTween: function (t, n) {
                        var r = oe.Tween(e, c.opts, t, n, c.opts.specialEasing[t] || c.opts.easing);
                        return c.tweens.push(r), r;
                    },
                    stop: function (t) {
                        var n = 0,
                            r = t ? c.tweens.length : 0;
                        if (i) return this;
                        for (i = !0; n < r; n++) c.tweens[n].run(1);
                        return t ? (s.notifyWith(e, [c, 1, 0]), s.resolveWith(e, [c, t])) : s.rejectWith(e, [c, t]), this;
                    },
                }),
                u = c.props;
            for (U(u, c.opts.specialEasing); o < a; o++) if ((r = B.prefilters[o].call(c, e, u, c.opts))) return oe.isFunction(r.stop) && (oe._queueHooks(c.elem, c.opts.queue).stop = oe.proxy(r.stop, r)), r;
            return (
                oe.map(u, F, c),
                oe.isFunction(c.opts.start) && c.opts.start.call(e, c),
                oe.fx.timer(oe.extend(l, { elem: e, anim: c, queue: c.opts.queue })),
                c.progress(c.opts.progress).done(c.opts.done, c.opts.complete).fail(c.opts.fail).always(c.opts.always)
            );
        }
        function j(e) {
            return (e.getAttribute && e.getAttribute("class")) || "";
        }
        function z(e) {
            return function (t, n) {
                "string" != typeof t && ((n = t), (t = "*"));
                var r,
                    i = 0,
                    o = t.toLowerCase().match(we) || [];
                if (oe.isFunction(n)) for (; (r = o[i++]); ) "+" === r[0] ? ((r = r.slice(1) || "*"), (e[r] = e[r] || []).unshift(n)) : (e[r] = e[r] || []).push(n);
            };
        }
        function V(e, t, n, r) {
            function i(s) {
                var l;
                return (
                    (o[s] = !0),
                    oe.each(e[s] || [], function (e, s) {
                        var c = s(t, n, r);
                        return "string" != typeof c || a || o[c] ? (a ? !(l = c) : void 0) : (t.dataTypes.unshift(c), i(c), !1);
                    }),
                    l
                );
            }
            var o = {},
                a = e === St;
            return i(t.dataTypes[0]) || (!o["*"] && i("*"));
        }
        function H(e, t) {
            var n,
                r,
                i = oe.ajaxSettings.flatOptions || {};
            for (n in t) void 0 !== t[n] && ((i[n] ? e : r || (r = {}))[n] = t[n]);
            return r && oe.extend(!0, e, r), e;
        }
        function $(e, t, n) {
            for (var r, i, o, a, s = e.contents, l = e.dataTypes; "*" === l[0]; ) l.shift(), void 0 === r && (r = e.mimeType || t.getResponseHeader("Content-Type"));
            if (r)
                for (i in s)
                    if (s[i] && s[i].test(r)) {
                        l.unshift(i);
                        break;
                    }
            if (l[0] in n) o = l[0];
            else {
                for (i in n) {
                    if (!l[0] || e.converters[i + " " + l[0]]) {
                        o = i;
                        break;
                    }
                    a || (a = i);
                }
                o = o || a;
            }
            if (o) return o !== l[0] && l.unshift(o), n[o];
        }
        function W(e, t, n, r) {
            var i,
                o,
                a,
                s,
                l,
                c = {},
                u = e.dataTypes.slice();
            if (u[1]) for (a in e.converters) c[a.toLowerCase()] = e.converters[a];
            for (o = u.shift(); o; )
                if ((e.responseFields[o] && (n[e.responseFields[o]] = t), !l && r && e.dataFilter && (t = e.dataFilter(t, e.dataType)), (l = o), (o = u.shift())))
                    if ("*" === o) o = l;
                    else if ("*" !== l && l !== o) {
                        if (((a = c[l + " " + o] || c["* " + o]), !a))
                            for (i in c)
                                if (((s = i.split(" ")), s[1] === o && (a = c[l + " " + s[0]] || c["* " + s[0]]))) {
                                    a === !0 ? (a = c[i]) : c[i] !== !0 && ((o = s[0]), u.unshift(s[1]));
                                    break;
                                }
                        if (a !== !0)
                            if (a && e.throws) t = a(t);
                            else
                                try {
                                    t = a(t);
                                } catch (e) {
                                    return { state: "parsererror", error: a ? e : "No conversion from " + l + " to " + o };
                                }
                    }
            return { state: "success", data: t };
        }
        function q(e, t, n, r) {
            var i;
            if (oe.isArray(t))
                oe.each(t, function (t, i) {
                    n || Pt.test(e) ? r(e, i) : q(e + "[" + ("object" == typeof i && null != i ? t : "") + "]", i, n, r);
                });
            else if (n || "object" !== oe.type(t)) r(e, t);
            else for (i in t) q(e + "[" + i + "]", t[i], n, r);
        }
        function G(e) {
            return oe.isWindow(e) ? e : 9 === e.nodeType && e.defaultView;
        }
        var J = [],
            K = e.document,
            X = J.slice,
            Q = J.concat,
            Y = J.push,
            Z = J.indexOf,
            ee = {},
            te = ee.toString,
            ne = ee.hasOwnProperty,
            re = {},
            ie = "2.2.4",
            oe = function (e, t) {
                return new oe.fn.init(e, t);
            },
            ae = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
            se = /^-ms-/,
            le = /-([\da-z])/gi,
            ce = function (e, t) {
                return t.toUpperCase();
            };
        (oe.fn = oe.prototype = {
            jquery: ie,
            constructor: oe,
            selector: "",
            length: 0,
            toArray: function () {
                return X.call(this);
            },
            get: function (e) {
                return null != e ? (e < 0 ? this[e + this.length] : this[e]) : X.call(this);
            },
            pushStack: function (e) {
                var t = oe.merge(this.constructor(), e);
                return (t.prevObject = this), (t.context = this.context), t;
            },
            each: function (e) {
                return oe.each(this, e);
            },
            map: function (e) {
                return this.pushStack(
                    oe.map(this, function (t, n) {
                        return e.call(t, n, t);
                    })
                );
            },
            slice: function () {
                return this.pushStack(X.apply(this, arguments));
            },
            first: function () {
                return this.eq(0);
            },
            last: function () {
                return this.eq(-1);
            },
            eq: function (e) {
                var t = this.length,
                    n = +e + (e < 0 ? t : 0);
                return this.pushStack(n >= 0 && n < t ? [this[n]] : []);
            },
            end: function () {
                return this.prevObject || this.constructor();
            },
            push: Y,
            sort: J.sort,
            splice: J.splice,
        }),
            (oe.extend = oe.fn.extend = function () {
                var e,
                    t,
                    n,
                    r,
                    i,
                    o,
                    a = arguments[0] || {},
                    s = 1,
                    l = arguments.length,
                    c = !1;
                for ("boolean" == typeof a && ((c = a), (a = arguments[s] || {}), s++), "object" == typeof a || oe.isFunction(a) || (a = {}), s === l && ((a = this), s--); s < l; s++)
                    if (null != (e = arguments[s]))
                        for (t in e)
                            (n = a[t]),
                                (r = e[t]),
                                a !== r &&
                                    (c && r && (oe.isPlainObject(r) || (i = oe.isArray(r)))
                                        ? (i ? ((i = !1), (o = n && oe.isArray(n) ? n : [])) : (o = n && oe.isPlainObject(n) ? n : {}), (a[t] = oe.extend(c, o, r)))
                                        : void 0 !== r && (a[t] = r));
                return a;
            }),
            oe.extend({
                expando: "jQuery" + (ie + Math.random()).replace(/\D/g, ""),
                isReady: !0,
                error: function (e) {
                    throw new Error(e);
                },
                noop: function () {},
                isFunction: function (e) {
                    return "function" === oe.type(e);
                },
                isArray: Array.isArray,
                isWindow: function (e) {
                    return null != e && e === e.window;
                },
                isNumeric: function (e) {
                    var t = e && e.toString();
                    return !oe.isArray(e) && t - parseFloat(t) + 1 >= 0;
                },
                isPlainObject: function (e) {
                    var t;
                    if ("object" !== oe.type(e) || e.nodeType || oe.isWindow(e)) return !1;
                    if (e.constructor && !ne.call(e, "constructor") && !ne.call(e.constructor.prototype || {}, "isPrototypeOf")) return !1;
                    for (t in e);
                    return void 0 === t || ne.call(e, t);
                },
                isEmptyObject: function (e) {
                    var t;
                    for (t in e) return !1;
                    return !0;
                },
                type: function (e) {
                    return null == e ? e + "" : "object" == typeof e || "function" == typeof e ? ee[te.call(e)] || "object" : typeof e;
                },
                globalEval: function (e) {
                    var t,
                        n = eval;
                    (e = oe.trim(e)), e && (1 === e.indexOf("use strict") ? ((t = K.createElement("script")), (t.text = e), K.head.appendChild(t).parentNode.removeChild(t)) : n(e));
                },
                camelCase: function (e) {
                    return e.replace(se, "ms-").replace(le, ce);
                },
                nodeName: function (e, t) {
                    return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase();
                },
                each: function (e, t) {
                    var r,
                        i = 0;
                    if (n(e)) for (r = e.length; i < r && t.call(e[i], i, e[i]) !== !1; i++);
                    else for (i in e) if (t.call(e[i], i, e[i]) === !1) break;
                    return e;
                },
                trim: function (e) {
                    return null == e ? "" : (e + "").replace(ae, "");
                },
                makeArray: function (e, t) {
                    var r = t || [];
                    return null != e && (n(Object(e)) ? oe.merge(r, "string" == typeof e ? [e] : e) : Y.call(r, e)), r;
                },
                inArray: function (e, t, n) {
                    return null == t ? -1 : Z.call(t, e, n);
                },
                merge: function (e, t) {
                    for (var n = +t.length, r = 0, i = e.length; r < n; r++) e[i++] = t[r];
                    return (e.length = i), e;
                },
                grep: function (e, t, n) {
                    for (var r, i = [], o = 0, a = e.length, s = !n; o < a; o++) (r = !t(e[o], o)), r !== s && i.push(e[o]);
                    return i;
                },
                map: function (e, t, r) {
                    var i,
                        o,
                        a = 0,
                        s = [];
                    if (n(e)) for (i = e.length; a < i; a++) (o = t(e[a], a, r)), null != o && s.push(o);
                    else for (a in e) (o = t(e[a], a, r)), null != o && s.push(o);
                    return Q.apply([], s);
                },
                guid: 1,
                proxy: function (e, t) {
                    var n, r, i;
                    if (("string" == typeof t && ((n = e[t]), (t = e), (e = n)), oe.isFunction(e)))
                        return (
                            (r = X.call(arguments, 2)),
                            (i = function () {
                                return e.apply(t || this, r.concat(X.call(arguments)));
                            }),
                            (i.guid = e.guid = e.guid || oe.guid++),
                            i
                        );
                },
                now: Date.now,
                support: re,
            }),
            "function" == typeof Symbol && (oe.fn[Symbol.iterator] = J[Symbol.iterator]),
            oe.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function (e, t) {
                ee["[object " + t + "]"] = t.toLowerCase();
            });
        var ue = (function (e) {
            function t(e, t, n, r) {
                var i,
                    o,
                    a,
                    s,
                    l,
                    c,
                    d,
                    h,
                    p = t && t.ownerDocument,
                    g = t ? t.nodeType : 9;
                if (((n = n || []), "string" != typeof e || !e || (1 !== g && 9 !== g && 11 !== g))) return n;
                if (!r && ((t ? t.ownerDocument || t : j) !== O && N(t), (t = t || O), D)) {
                    if (11 !== g && (c = ve.exec(e)))
                        if ((i = c[1])) {
                            if (9 === g) {
                                if (!(a = t.getElementById(i))) return n;
                                if (a.id === i) return n.push(a), n;
                            } else if (p && (a = p.getElementById(i)) && U(t, a) && a.id === i) return n.push(a), n;
                        } else {
                            if (c[2]) return Y.apply(n, t.getElementsByTagName(e)), n;
                            if ((i = c[3]) && w.getElementsByClassName && t.getElementsByClassName) return Y.apply(n, t.getElementsByClassName(i)), n;
                        }
                    if (w.qsa && !W[e + " "] && (!M || !M.test(e))) {
                        if (1 !== g) (p = t), (h = e);
                        else if ("object" !== t.nodeName.toLowerCase()) {
                            for ((s = t.getAttribute("id")) ? (s = s.replace(ye, "\\$&")) : t.setAttribute("id", (s = B)), d = T(e), o = d.length, l = fe.test(s) ? "#" + s : "[id='" + s + "']"; o--; ) d[o] = l + " " + f(d[o]);
                            (h = d.join(",")), (p = (be.test(e) && u(t.parentNode)) || t);
                        }
                        if (h)
                            try {
                                return Y.apply(n, p.querySelectorAll(h)), n;
                            } catch (e) {
                            } finally {
                                s === B && t.removeAttribute("id");
                            }
                    }
                }
                return R(e.replace(se, "$1"), t, n, r);
            }
            function n() {
                function e(n, r) {
                    return t.push(n + " ") > x.cacheLength && delete e[t.shift()], (e[n + " "] = r);
                }
                var t = [];
                return e;
            }
            function r(e) {
                return (e[B] = !0), e;
            }
            function i(e) {
                var t = O.createElement("div");
                try {
                    return !!e(t);
                } catch (e) {
                    return !1;
                } finally {
                    t.parentNode && t.parentNode.removeChild(t), (t = null);
                }
            }
            function o(e, t) {
                for (var n = e.split("|"), r = n.length; r--; ) x.attrHandle[n[r]] = t;
            }
            function a(e, t) {
                var n = t && e,
                    r = n && 1 === e.nodeType && 1 === t.nodeType && (~t.sourceIndex || G) - (~e.sourceIndex || G);
                if (r) return r;
                if (n) for (; (n = n.nextSibling); ) if (n === t) return -1;
                return e ? 1 : -1;
            }
            function s(e) {
                return function (t) {
                    var n = t.nodeName.toLowerCase();
                    return "input" === n && t.type === e;
                };
            }
            function l(e) {
                return function (t) {
                    var n = t.nodeName.toLowerCase();
                    return ("input" === n || "button" === n) && t.type === e;
                };
            }
            function c(e) {
                return r(function (t) {
                    return (
                        (t = +t),
                        r(function (n, r) {
                            for (var i, o = e([], n.length, t), a = o.length; a--; ) n[(i = o[a])] && (n[i] = !(r[i] = n[i]));
                        })
                    );
                });
            }
            function u(e) {
                return e && "undefined" != typeof e.getElementsByTagName && e;
            }
            function d() {}
            function f(e) {
                for (var t = 0, n = e.length, r = ""; t < n; t++) r += e[t].value;
                return r;
            }
            function h(e, t, n) {
                var r = t.dir,
                    i = n && "parentNode" === r,
                    o = V++;
                return t.first
                    ? function (t, n, o) {
                          for (; (t = t[r]); ) if (1 === t.nodeType || i) return e(t, n, o);
                      }
                    : function (t, n, a) {
                          var s,
                              l,
                              c,
                              u = [z, o];
                          if (a) {
                              for (; (t = t[r]); ) if ((1 === t.nodeType || i) && e(t, n, a)) return !0;
                          } else
                              for (; (t = t[r]); )
                                  if (1 === t.nodeType || i) {
                                      if (((c = t[B] || (t[B] = {})), (l = c[t.uniqueID] || (c[t.uniqueID] = {})), (s = l[r]) && s[0] === z && s[1] === o)) return (u[2] = s[2]);
                                      if (((l[r] = u), (u[2] = e(t, n, a)))) return !0;
                                  }
                      };
            }
            function p(e) {
                return e.length > 1
                    ? function (t, n, r) {
                          for (var i = e.length; i--; ) if (!e[i](t, n, r)) return !1;
                          return !0;
                      }
                    : e[0];
            }
            function g(e, n, r) {
                for (var i = 0, o = n.length; i < o; i++) t(e, n[i], r);
                return r;
            }
            function m(e, t, n, r, i) {
                for (var o, a = [], s = 0, l = e.length, c = null != t; s < l; s++) (o = e[s]) && ((n && !n(o, r, i)) || (a.push(o), c && t.push(s)));
                return a;
            }
            function v(e, t, n, i, o, a) {
                return (
                    i && !i[B] && (i = v(i)),
                    o && !o[B] && (o = v(o, a)),
                    r(function (r, a, s, l) {
                        var c,
                            u,
                            d,
                            f = [],
                            h = [],
                            p = a.length,
                            v = r || g(t || "*", s.nodeType ? [s] : s, []),
                            b = !e || (!r && t) ? v : m(v, f, e, s, l),
                            y = n ? (o || (r ? e : p || i) ? [] : a) : b;
                        if ((n && n(b, y, s, l), i)) for (c = m(y, h), i(c, [], s, l), u = c.length; u--; ) (d = c[u]) && (y[h[u]] = !(b[h[u]] = d));
                        if (r) {
                            if (o || e) {
                                if (o) {
                                    for (c = [], u = y.length; u--; ) (d = y[u]) && c.push((b[u] = d));
                                    o(null, (y = []), c, l);
                                }
                                for (u = y.length; u--; ) (d = y[u]) && (c = o ? ee(r, d) : f[u]) > -1 && (r[c] = !(a[c] = d));
                            }
                        } else (y = m(y === a ? y.splice(p, y.length) : y)), o ? o(null, a, y, l) : Y.apply(a, y);
                    })
                );
            }
            function b(e) {
                for (
                    var t,
                        n,
                        r,
                        i = e.length,
                        o = x.relative[e[0].type],
                        a = o || x.relative[" "],
                        s = o ? 1 : 0,
                        l = h(
                            function (e) {
                                return e === t;
                            },
                            a,
                            !0
                        ),
                        c = h(
                            function (e) {
                                return ee(t, e) > -1;
                            },
                            a,
                            !0
                        ),
                        u = [
                            function (e, n, r) {
                                var i = (!o && (r || n !== I)) || ((t = n).nodeType ? l(e, n, r) : c(e, n, r));
                                return (t = null), i;
                            },
                        ];
                    s < i;
                    s++
                )
                    if ((n = x.relative[e[s].type])) u = [h(p(u), n)];
                    else {
                        if (((n = x.filter[e[s].type].apply(null, e[s].matches)), n[B])) {
                            for (r = ++s; r < i && !x.relative[e[r].type]; r++);
                            return v(s > 1 && p(u), s > 1 && f(e.slice(0, s - 1).concat({ value: " " === e[s - 2].type ? "*" : "" })).replace(se, "$1"), n, s < r && b(e.slice(s, r)), r < i && b((e = e.slice(r))), r < i && f(e));
                        }
                        u.push(n);
                    }
                return p(u);
            }
            function y(e, n) {
                var i = n.length > 0,
                    o = e.length > 0,
                    a = function (r, a, s, l, c) {
                        var u,
                            d,
                            f,
                            h = 0,
                            p = "0",
                            g = r && [],
                            v = [],
                            b = I,
                            y = r || (o && x.find.TAG("*", c)),
                            _ = (z += null == b ? 1 : Math.random() || 0.1),
                            w = y.length;
                        for (c && (I = a === O || a || c); p !== w && null != (u = y[p]); p++) {
                            if (o && u) {
                                for (d = 0, a || u.ownerDocument === O || (N(u), (s = !D)); (f = e[d++]); )
                                    if (f(u, a || O, s)) {
                                        l.push(u);
                                        break;
                                    }
                                c && (z = _);
                            }
                            i && ((u = !f && u) && h--, r && g.push(u));
                        }
                        if (((h += p), i && p !== h)) {
                            for (d = 0; (f = n[d++]); ) f(g, v, a, s);
                            if (r) {
                                if (h > 0) for (; p--; ) g[p] || v[p] || (v[p] = X.call(l));
                                v = m(v);
                            }
                            Y.apply(l, v), c && !r && v.length > 0 && h + n.length > 1 && t.uniqueSort(l);
                        }
                        return c && ((z = _), (I = b)), g;
                    };
                return i ? r(a) : a;
            }
            var _,
                w,
                x,
                E,
                C,
                T,
                S,
                R,
                I,
                k,
                P,
                N,
                O,
                A,
                D,
                M,
                F,
                L,
                U,
                B = "sizzle" + 1 * new Date(),
                j = e.document,
                z = 0,
                V = 0,
                H = n(),
                $ = n(),
                W = n(),
                q = function (e, t) {
                    return e === t && (P = !0), 0;
                },
                G = 1 << 31,
                J = {}.hasOwnProperty,
                K = [],
                X = K.pop,
                Q = K.push,
                Y = K.push,
                Z = K.slice,
                ee = function (e, t) {
                    for (var n = 0, r = e.length; n < r; n++) if (e[n] === t) return n;
                    return -1;
                },
                te = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
                ne = "[\\x20\\t\\r\\n\\f]",
                re = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
                ie = "\\[" + ne + "*(" + re + ")(?:" + ne + "*([*^$|!~]?=)" + ne + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + re + "))|)" + ne + "*\\]",
                oe = ":(" + re + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + ie + ")*)|.*)\\)|)",
                ae = new RegExp(ne + "+", "g"),
                se = new RegExp("^" + ne + "+|((?:^|[^\\\\])(?:\\\\.)*)" + ne + "+$", "g"),
                le = new RegExp("^" + ne + "*," + ne + "*"),
                ce = new RegExp("^" + ne + "*([>+~]|" + ne + ")" + ne + "*"),
                ue = new RegExp("=" + ne + "*([^\\]'\"]*?)" + ne + "*\\]", "g"),
                de = new RegExp(oe),
                fe = new RegExp("^" + re + "$"),
                he = {
                    ID: new RegExp("^#(" + re + ")"),
                    CLASS: new RegExp("^\\.(" + re + ")"),
                    TAG: new RegExp("^(" + re + "|[*])"),
                    ATTR: new RegExp("^" + ie),
                    PSEUDO: new RegExp("^" + oe),
                    CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + ne + "*(even|odd|(([+-]|)(\\d*)n|)" + ne + "*(?:([+-]|)" + ne + "*(\\d+)|))" + ne + "*\\)|)", "i"),
                    bool: new RegExp("^(?:" + te + ")$", "i"),
                    needsContext: new RegExp("^" + ne + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + ne + "*((?:-\\d)?\\d*)" + ne + "*\\)|)(?=[^-]|$)", "i"),
                },
                pe = /^(?:input|select|textarea|button)$/i,
                ge = /^h\d$/i,
                me = /^[^{]+\{\s*\[native \w/,
                ve = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
                be = /[+~]/,
                ye = /'|\\/g,
                _e = new RegExp("\\\\([\\da-f]{1,6}" + ne + "?|(" + ne + ")|.)", "ig"),
                we = function (e, t, n) {
                    var r = "0x" + t - 65536;
                    return r !== r || n ? t : r < 0 ? String.fromCharCode(r + 65536) : String.fromCharCode((r >> 10) | 55296, (1023 & r) | 56320);
                },
                xe = function () {
                    N();
                };
            try {
                Y.apply((K = Z.call(j.childNodes)), j.childNodes), K[j.childNodes.length].nodeType;
            } catch (e) {
                Y = {
                    apply: K.length
                        ? function (e, t) {
                              Q.apply(e, Z.call(t));
                          }
                        : function (e, t) {
                              for (var n = e.length, r = 0; (e[n++] = t[r++]); );
                              e.length = n - 1;
                          },
                };
            }
            (w = t.support = {}),
                (C = t.isXML = function (e) {
                    var t = e && (e.ownerDocument || e).documentElement;
                    return !!t && "HTML" !== t.nodeName;
                }),
                (N = t.setDocument = function (e) {
                    var t,
                        n,
                        r = e ? e.ownerDocument || e : j;
                    return r !== O && 9 === r.nodeType && r.documentElement
                        ? ((O = r),
                          (A = O.documentElement),
                          (D = !C(O)),
                          (n = O.defaultView) && n.top !== n && (n.addEventListener ? n.addEventListener("unload", xe, !1) : n.attachEvent && n.attachEvent("onunload", xe)),
                          (w.attributes = i(function (e) {
                              return (e.className = "i"), !e.getAttribute("className");
                          })),
                          (w.getElementsByTagName = i(function (e) {
                              return e.appendChild(O.createComment("")), !e.getElementsByTagName("*").length;
                          })),
                          (w.getElementsByClassName = me.test(O.getElementsByClassName)),
                          (w.getById = i(function (e) {
                              return (A.appendChild(e).id = B), !O.getElementsByName || !O.getElementsByName(B).length;
                          })),
                          w.getById
                              ? ((x.find.ID = function (e, t) {
                                    if ("undefined" != typeof t.getElementById && D) {
                                        var n = t.getElementById(e);
                                        return n ? [n] : [];
                                    }
                                }),
                                (x.filter.ID = function (e) {
                                    var t = e.replace(_e, we);
                                    return function (e) {
                                        return e.getAttribute("id") === t;
                                    };
                                }))
                              : (delete x.find.ID,
                                (x.filter.ID = function (e) {
                                    var t = e.replace(_e, we);
                                    return function (e) {
                                        var n = "undefined" != typeof e.getAttributeNode && e.getAttributeNode("id");
                                        return n && n.value === t;
                                    };
                                })),
                          (x.find.TAG = w.getElementsByTagName
                              ? function (e, t) {
                                    return "undefined" != typeof t.getElementsByTagName ? t.getElementsByTagName(e) : w.qsa ? t.querySelectorAll(e) : void 0;
                                }
                              : function (e, t) {
                                    var n,
                                        r = [],
                                        i = 0,
                                        o = t.getElementsByTagName(e);
                                    if ("*" === e) {
                                        for (; (n = o[i++]); ) 1 === n.nodeType && r.push(n);
                                        return r;
                                    }
                                    return o;
                                }),
                          (x.find.CLASS =
                              w.getElementsByClassName &&
                              function (e, t) {
                                  if ("undefined" != typeof t.getElementsByClassName && D) return t.getElementsByClassName(e);
                              }),
                          (F = []),
                          (M = []),
                          (w.qsa = me.test(O.querySelectorAll)) &&
                              (i(function (e) {
                                  (A.appendChild(e).innerHTML = "<a id='" + B + "'></a><select id='" + B + "-\r\\' msallowcapture=''><option selected=''></option></select>"),
                                      e.querySelectorAll("[msallowcapture^='']").length && M.push("[*^$]=" + ne + "*(?:''|\"\")"),
                                      e.querySelectorAll("[selected]").length || M.push("\\[" + ne + "*(?:value|" + te + ")"),
                                      e.querySelectorAll("[id~=" + B + "-]").length || M.push("~="),
                                      e.querySelectorAll(":checked").length || M.push(":checked"),
                                      e.querySelectorAll("a#" + B + "+*").length || M.push(".#.+[+~]");
                              }),
                              i(function (e) {
                                  var t = O.createElement("input");
                                  t.setAttribute("type", "hidden"),
                                      e.appendChild(t).setAttribute("name", "D"),
                                      e.querySelectorAll("[name=d]").length && M.push("name" + ne + "*[*^$|!~]?="),
                                      e.querySelectorAll(":enabled").length || M.push(":enabled", ":disabled"),
                                      e.querySelectorAll("*,:x"),
                                      M.push(",.*:");
                              })),
                          (w.matchesSelector = me.test((L = A.matches || A.webkitMatchesSelector || A.mozMatchesSelector || A.oMatchesSelector || A.msMatchesSelector))) &&
                              i(function (e) {
                                  (w.disconnectedMatch = L.call(e, "div")), L.call(e, "[s!='']:x"), F.push("!=", oe);
                              }),
                          (M = M.length && new RegExp(M.join("|"))),
                          (F = F.length && new RegExp(F.join("|"))),
                          (t = me.test(A.compareDocumentPosition)),
                          (U =
                              t || me.test(A.contains)
                                  ? function (e, t) {
                                        var n = 9 === e.nodeType ? e.documentElement : e,
                                            r = t && t.parentNode;
                                        return e === r || !(!r || 1 !== r.nodeType || !(n.contains ? n.contains(r) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(r)));
                                    }
                                  : function (e, t) {
                                        if (t) for (; (t = t.parentNode); ) if (t === e) return !0;
                                        return !1;
                                    }),
                          (q = t
                              ? function (e, t) {
                                    if (e === t) return (P = !0), 0;
                                    var n = !e.compareDocumentPosition - !t.compareDocumentPosition;
                                    return n
                                        ? n
                                        : ((n = (e.ownerDocument || e) === (t.ownerDocument || t) ? e.compareDocumentPosition(t) : 1),
                                          1 & n || (!w.sortDetached && t.compareDocumentPosition(e) === n)
                                              ? e === O || (e.ownerDocument === j && U(j, e))
                                                  ? -1
                                                  : t === O || (t.ownerDocument === j && U(j, t))
                                                  ? 1
                                                  : k
                                                  ? ee(k, e) - ee(k, t)
                                                  : 0
                                              : 4 & n
                                              ? -1
                                              : 1);
                                }
                              : function (e, t) {
                                    if (e === t) return (P = !0), 0;
                                    var n,
                                        r = 0,
                                        i = e.parentNode,
                                        o = t.parentNode,
                                        s = [e],
                                        l = [t];
                                    if (!i || !o) return e === O ? -1 : t === O ? 1 : i ? -1 : o ? 1 : k ? ee(k, e) - ee(k, t) : 0;
                                    if (i === o) return a(e, t);
                                    for (n = e; (n = n.parentNode); ) s.unshift(n);
                                    for (n = t; (n = n.parentNode); ) l.unshift(n);
                                    for (; s[r] === l[r]; ) r++;
                                    return r ? a(s[r], l[r]) : s[r] === j ? -1 : l[r] === j ? 1 : 0;
                                }),
                          O)
                        : O;
                }),
                (t.matches = function (e, n) {
                    return t(e, null, null, n);
                }),
                (t.matchesSelector = function (e, n) {
                    if (((e.ownerDocument || e) !== O && N(e), (n = n.replace(ue, "='$1']")), w.matchesSelector && D && !W[n + " "] && (!F || !F.test(n)) && (!M || !M.test(n))))
                        try {
                            var r = L.call(e, n);
                            if (r || w.disconnectedMatch || (e.document && 11 !== e.document.nodeType)) return r;
                        } catch (e) {}
                    return t(n, O, null, [e]).length > 0;
                }),
                (t.contains = function (e, t) {
                    return (e.ownerDocument || e) !== O && N(e), U(e, t);
                }),
                (t.attr = function (e, t) {
                    (e.ownerDocument || e) !== O && N(e);
                    var n = x.attrHandle[t.toLowerCase()],
                        r = n && J.call(x.attrHandle, t.toLowerCase()) ? n(e, t, !D) : void 0;
                    return void 0 !== r ? r : w.attributes || !D ? e.getAttribute(t) : (r = e.getAttributeNode(t)) && r.specified ? r.value : null;
                }),
                (t.error = function (e) {
                    throw new Error("Syntax error, unrecognized expression: " + e);
                }),
                (t.uniqueSort = function (e) {
                    var t,
                        n = [],
                        r = 0,
                        i = 0;
                    if (((P = !w.detectDuplicates), (k = !w.sortStable && e.slice(0)), e.sort(q), P)) {
                        for (; (t = e[i++]); ) t === e[i] && (r = n.push(i));
                        for (; r--; ) e.splice(n[r], 1);
                    }
                    return (k = null), e;
                }),
                (E = t.getText = function (e) {
                    var t,
                        n = "",
                        r = 0,
                        i = e.nodeType;
                    if (i) {
                        if (1 === i || 9 === i || 11 === i) {
                            if ("string" == typeof e.textContent) return e.textContent;
                            for (e = e.firstChild; e; e = e.nextSibling) n += E(e);
                        } else if (3 === i || 4 === i) return e.nodeValue;
                    } else for (; (t = e[r++]); ) n += E(t);
                    return n;
                }),
                (x = t.selectors = {
                    cacheLength: 50,
                    createPseudo: r,
                    match: he,
                    attrHandle: {},
                    find: {},
                    relative: { ">": { dir: "parentNode", first: !0 }, " ": { dir: "parentNode" }, "+": { dir: "previousSibling", first: !0 }, "~": { dir: "previousSibling" } },
                    preFilter: {
                        ATTR: function (e) {
                            return (e[1] = e[1].replace(_e, we)), (e[3] = (e[3] || e[4] || e[5] || "").replace(_e, we)), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4);
                        },
                        CHILD: function (e) {
                            return (
                                (e[1] = e[1].toLowerCase()),
                                "nth" === e[1].slice(0, 3) ? (e[3] || t.error(e[0]), (e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ("even" === e[3] || "odd" === e[3]))), (e[5] = +(e[7] + e[8] || "odd" === e[3]))) : e[3] && t.error(e[0]),
                                e
                            );
                        },
                        PSEUDO: function (e) {
                            var t,
                                n = !e[6] && e[2];
                            return he.CHILD.test(e[0])
                                ? null
                                : (e[3] ? (e[2] = e[4] || e[5] || "") : n && de.test(n) && (t = T(n, !0)) && (t = n.indexOf(")", n.length - t) - n.length) && ((e[0] = e[0].slice(0, t)), (e[2] = n.slice(0, t))), e.slice(0, 3));
                        },
                    },
                    filter: {
                        TAG: function (e) {
                            var t = e.replace(_e, we).toLowerCase();
                            return "*" === e
                                ? function () {
                                      return !0;
                                  }
                                : function (e) {
                                      return e.nodeName && e.nodeName.toLowerCase() === t;
                                  };
                        },
                        CLASS: function (e) {
                            var t = H[e + " "];
                            return (
                                t ||
                                ((t = new RegExp("(^|" + ne + ")" + e + "(" + ne + "|$)")) &&
                                    H(e, function (e) {
                                        return t.test(("string" == typeof e.className && e.className) || ("undefined" != typeof e.getAttribute && e.getAttribute("class")) || "");
                                    }))
                            );
                        },
                        ATTR: function (e, n, r) {
                            return function (i) {
                                var o = t.attr(i, e);
                                return null == o
                                    ? "!=" === n
                                    : !n ||
                                          ((o += ""),
                                          "=" === n
                                              ? o === r
                                              : "!=" === n
                                              ? o !== r
                                              : "^=" === n
                                              ? r && 0 === o.indexOf(r)
                                              : "*=" === n
                                              ? r && o.indexOf(r) > -1
                                              : "$=" === n
                                              ? r && o.slice(-r.length) === r
                                              : "~=" === n
                                              ? (" " + o.replace(ae, " ") + " ").indexOf(r) > -1
                                              : "|=" === n && (o === r || o.slice(0, r.length + 1) === r + "-"));
                            };
                        },
                        CHILD: function (e, t, n, r, i) {
                            var o = "nth" !== e.slice(0, 3),
                                a = "last" !== e.slice(-4),
                                s = "of-type" === t;
                            return 1 === r && 0 === i
                                ? function (e) {
                                      return !!e.parentNode;
                                  }
                                : function (t, n, l) {
                                      var c,
                                          u,
                                          d,
                                          f,
                                          h,
                                          p,
                                          g = o !== a ? "nextSibling" : "previousSibling",
                                          m = t.parentNode,
                                          v = s && t.nodeName.toLowerCase(),
                                          b = !l && !s,
                                          y = !1;
                                      if (m) {
                                          if (o) {
                                              for (; g; ) {
                                                  for (f = t; (f = f[g]); ) if (s ? f.nodeName.toLowerCase() === v : 1 === f.nodeType) return !1;
                                                  p = g = "only" === e && !p && "nextSibling";
                                              }
                                              return !0;
                                          }
                                          if (((p = [a ? m.firstChild : m.lastChild]), a && b)) {
                                              for (
                                                  f = m, d = f[B] || (f[B] = {}), u = d[f.uniqueID] || (d[f.uniqueID] = {}), c = u[e] || [], h = c[0] === z && c[1], y = h && c[2], f = h && m.childNodes[h];
                                                  (f = (++h && f && f[g]) || (y = h = 0) || p.pop());

                                              )
                                                  if (1 === f.nodeType && ++y && f === t) {
                                                      u[e] = [z, h, y];
                                                      break;
                                                  }
                                          } else if ((b && ((f = t), (d = f[B] || (f[B] = {})), (u = d[f.uniqueID] || (d[f.uniqueID] = {})), (c = u[e] || []), (h = c[0] === z && c[1]), (y = h)), y === !1))
                                              for (
                                                  ;
                                                  (f = (++h && f && f[g]) || (y = h = 0) || p.pop()) &&
                                                  ((s ? f.nodeName.toLowerCase() !== v : 1 !== f.nodeType) || !++y || (b && ((d = f[B] || (f[B] = {})), (u = d[f.uniqueID] || (d[f.uniqueID] = {})), (u[e] = [z, y])), f !== t));

                                              );
                                          return (y -= i), y === r || (y % r === 0 && y / r >= 0);
                                      }
                                  };
                        },
                        PSEUDO: function (e, n) {
                            var i,
                                o = x.pseudos[e] || x.setFilters[e.toLowerCase()] || t.error("unsupported pseudo: " + e);
                            return o[B]
                                ? o(n)
                                : o.length > 1
                                ? ((i = [e, e, "", n]),
                                  x.setFilters.hasOwnProperty(e.toLowerCase())
                                      ? r(function (e, t) {
                                            for (var r, i = o(e, n), a = i.length; a--; ) (r = ee(e, i[a])), (e[r] = !(t[r] = i[a]));
                                        })
                                      : function (e) {
                                            return o(e, 0, i);
                                        })
                                : o;
                        },
                    },
                    pseudos: {
                        not: r(function (e) {
                            var t = [],
                                n = [],
                                i = S(e.replace(se, "$1"));
                            return i[B]
                                ? r(function (e, t, n, r) {
                                      for (var o, a = i(e, null, r, []), s = e.length; s--; ) (o = a[s]) && (e[s] = !(t[s] = o));
                                  })
                                : function (e, r, o) {
                                      return (t[0] = e), i(t, null, o, n), (t[0] = null), !n.pop();
                                  };
                        }),
                        has: r(function (e) {
                            return function (n) {
                                return t(e, n).length > 0;
                            };
                        }),
                        contains: r(function (e) {
                            return (
                                (e = e.replace(_e, we)),
                                function (t) {
                                    return (t.textContent || t.innerText || E(t)).indexOf(e) > -1;
                                }
                            );
                        }),
                        lang: r(function (e) {
                            return (
                                fe.test(e || "") || t.error("unsupported lang: " + e),
                                (e = e.replace(_e, we).toLowerCase()),
                                function (t) {
                                    var n;
                                    do if ((n = D ? t.lang : t.getAttribute("xml:lang") || t.getAttribute("lang"))) return (n = n.toLowerCase()), n === e || 0 === n.indexOf(e + "-");
                                    while ((t = t.parentNode) && 1 === t.nodeType);
                                    return !1;
                                }
                            );
                        }),
                        target: function (t) {
                            var n = e.location && e.location.hash;
                            return n && n.slice(1) === t.id;
                        },
                        root: function (e) {
                            return e === A;
                        },
                        focus: function (e) {
                            return e === O.activeElement && (!O.hasFocus || O.hasFocus()) && !!(e.type || e.href || ~e.tabIndex);
                        },
                        enabled: function (e) {
                            return e.disabled === !1;
                        },
                        disabled: function (e) {
                            return e.disabled === !0;
                        },
                        checked: function (e) {
                            var t = e.nodeName.toLowerCase();
                            return ("input" === t && !!e.checked) || ("option" === t && !!e.selected);
                        },
                        selected: function (e) {
                            return e.parentNode && e.parentNode.selectedIndex, e.selected === !0;
                        },
                        empty: function (e) {
                            for (e = e.firstChild; e; e = e.nextSibling) if (e.nodeType < 6) return !1;
                            return !0;
                        },
                        parent: function (e) {
                            return !x.pseudos.empty(e);
                        },
                        header: function (e) {
                            return ge.test(e.nodeName);
                        },
                        input: function (e) {
                            return pe.test(e.nodeName);
                        },
                        button: function (e) {
                            var t = e.nodeName.toLowerCase();
                            return ("input" === t && "button" === e.type) || "button" === t;
                        },
                        text: function (e) {
                            var t;
                            return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || "text" === t.toLowerCase());
                        },
                        first: c(function () {
                            return [0];
                        }),
                        last: c(function (e, t) {
                            return [t - 1];
                        }),
                        eq: c(function (e, t, n) {
                            return [n < 0 ? n + t : n];
                        }),
                        even: c(function (e, t) {
                            for (var n = 0; n < t; n += 2) e.push(n);
                            return e;
                        }),
                        odd: c(function (e, t) {
                            for (var n = 1; n < t; n += 2) e.push(n);
                            return e;
                        }),
                        lt: c(function (e, t, n) {
                            for (var r = n < 0 ? n + t : n; --r >= 0; ) e.push(r);
                            return e;
                        }),
                        gt: c(function (e, t, n) {
                            for (var r = n < 0 ? n + t : n; ++r < t; ) e.push(r);
                            return e;
                        }),
                    },
                }),
                (x.pseudos.nth = x.pseudos.eq);
            for (_ in { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 }) x.pseudos[_] = s(_);
            for (_ in { submit: !0, reset: !0 }) x.pseudos[_] = l(_);
            return (
                (d.prototype = x.filters = x.pseudos),
                (x.setFilters = new d()),
                (T = t.tokenize = function (e, n) {
                    var r,
                        i,
                        o,
                        a,
                        s,
                        l,
                        c,
                        u = $[e + " "];
                    if (u) return n ? 0 : u.slice(0);
                    for (s = e, l = [], c = x.preFilter; s; ) {
                        (r && !(i = le.exec(s))) || (i && (s = s.slice(i[0].length) || s), l.push((o = []))), (r = !1), (i = ce.exec(s)) && ((r = i.shift()), o.push({ value: r, type: i[0].replace(se, " ") }), (s = s.slice(r.length)));
                        for (a in x.filter) !(i = he[a].exec(s)) || (c[a] && !(i = c[a](i))) || ((r = i.shift()), o.push({ value: r, type: a, matches: i }), (s = s.slice(r.length)));
                        if (!r) break;
                    }
                    return n ? s.length : s ? t.error(e) : $(e, l).slice(0);
                }),
                (S = t.compile = function (e, t) {
                    var n,
                        r = [],
                        i = [],
                        o = W[e + " "];
                    if (!o) {
                        for (t || (t = T(e)), n = t.length; n--; ) (o = b(t[n])), o[B] ? r.push(o) : i.push(o);
                        (o = W(e, y(i, r))), (o.selector = e);
                    }
                    return o;
                }),
                (R = t.select = function (e, t, n, r) {
                    var i,
                        o,
                        a,
                        s,
                        l,
                        c = "function" == typeof e && e,
                        d = !r && T((e = c.selector || e));
                    if (((n = n || []), 1 === d.length)) {
                        if (((o = d[0] = d[0].slice(0)), o.length > 2 && "ID" === (a = o[0]).type && w.getById && 9 === t.nodeType && D && x.relative[o[1].type])) {
                            if (((t = (x.find.ID(a.matches[0].replace(_e, we), t) || [])[0]), !t)) return n;
                            c && (t = t.parentNode), (e = e.slice(o.shift().value.length));
                        }
                        for (i = he.needsContext.test(e) ? 0 : o.length; i-- && ((a = o[i]), !x.relative[(s = a.type)]); )
                            if ((l = x.find[s]) && (r = l(a.matches[0].replace(_e, we), (be.test(o[0].type) && u(t.parentNode)) || t))) {
                                if ((o.splice(i, 1), (e = r.length && f(o)), !e)) return Y.apply(n, r), n;
                                break;
                            }
                    }
                    return (c || S(e, d))(r, t, !D, n, !t || (be.test(e) && u(t.parentNode)) || t), n;
                }),
                (w.sortStable = B.split("").sort(q).join("") === B),
                (w.detectDuplicates = !!P),
                N(),
                (w.sortDetached = i(function (e) {
                    return 1 & e.compareDocumentPosition(O.createElement("div"));
                })),
                i(function (e) {
                    return (e.innerHTML = "<a href='#'></a>"), "#" === e.firstChild.getAttribute("href");
                }) ||
                    o("type|href|height|width", function (e, t, n) {
                        if (!n) return e.getAttribute(t, "type" === t.toLowerCase() ? 1 : 2);
                    }),
                (w.attributes &&
                    i(function (e) {
                        return (e.innerHTML = "<input/>"), e.firstChild.setAttribute("value", ""), "" === e.firstChild.getAttribute("value");
                    })) ||
                    o("value", function (e, t, n) {
                        if (!n && "input" === e.nodeName.toLowerCase()) return e.defaultValue;
                    }),
                i(function (e) {
                    return null == e.getAttribute("disabled");
                }) ||
                    o(te, function (e, t, n) {
                        var r;
                        if (!n) return e[t] === !0 ? t.toLowerCase() : (r = e.getAttributeNode(t)) && r.specified ? r.value : null;
                    }),
                t
            );
        })(e);
        (oe.find = ue), (oe.expr = ue.selectors), (oe.expr[":"] = oe.expr.pseudos), (oe.uniqueSort = oe.unique = ue.uniqueSort), (oe.text = ue.getText), (oe.isXMLDoc = ue.isXML), (oe.contains = ue.contains);
        var de = function (e, t, n) {
                for (var r = [], i = void 0 !== n; (e = e[t]) && 9 !== e.nodeType; )
                    if (1 === e.nodeType) {
                        if (i && oe(e).is(n)) break;
                        r.push(e);
                    }
                return r;
            },
            fe = function (e, t) {
                for (var n = []; e; e = e.nextSibling) 1 === e.nodeType && e !== t && n.push(e);
                return n;
            },
            he = oe.expr.match.needsContext,
            pe = /^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,
            ge = /^.[^:#\[\.,]*$/;
        (oe.filter = function (e, t, n) {
            var r = t[0];
            return (
                n && (e = ":not(" + e + ")"),
                1 === t.length && 1 === r.nodeType
                    ? oe.find.matchesSelector(r, e)
                        ? [r]
                        : []
                    : oe.find.matches(
                          e,
                          oe.grep(t, function (e) {
                              return 1 === e.nodeType;
                          })
                      )
            );
        }),
            oe.fn.extend({
                find: function (e) {
                    var t,
                        n = this.length,
                        r = [],
                        i = this;
                    if ("string" != typeof e)
                        return this.pushStack(
                            oe(e).filter(function () {
                                for (t = 0; t < n; t++) if (oe.contains(i[t], this)) return !0;
                            })
                        );
                    for (t = 0; t < n; t++) oe.find(e, i[t], r);
                    return (r = this.pushStack(n > 1 ? oe.unique(r) : r)), (r.selector = this.selector ? this.selector + " " + e : e), r;
                },
                filter: function (e) {
                    return this.pushStack(r(this, e || [], !1));
                },
                not: function (e) {
                    return this.pushStack(r(this, e || [], !0));
                },
                is: function (e) {
                    return !!r(this, "string" == typeof e && he.test(e) ? oe(e) : e || [], !1).length;
                },
            });
        var me,
            ve = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
            be = (oe.fn.init = function (e, t, n) {
                var r, i;
                if (!e) return this;
                if (((n = n || me), "string" == typeof e)) {
                    if (((r = "<" === e[0] && ">" === e[e.length - 1] && e.length >= 3 ? [null, e, null] : ve.exec(e)), !r || (!r[1] && t))) return !t || t.jquery ? (t || n).find(e) : this.constructor(t).find(e);
                    if (r[1]) {
                        if (((t = t instanceof oe ? t[0] : t), oe.merge(this, oe.parseHTML(r[1], t && t.nodeType ? t.ownerDocument || t : K, !0)), pe.test(r[1]) && oe.isPlainObject(t)))
                            for (r in t) oe.isFunction(this[r]) ? this[r](t[r]) : this.attr(r, t[r]);
                        return this;
                    }
                    return (i = K.getElementById(r[2])), i && i.parentNode && ((this.length = 1), (this[0] = i)), (this.context = K), (this.selector = e), this;
                }
                return e.nodeType
                    ? ((this.context = this[0] = e), (this.length = 1), this)
                    : oe.isFunction(e)
                    ? void 0 !== n.ready
                        ? n.ready(e)
                        : e(oe)
                    : (void 0 !== e.selector && ((this.selector = e.selector), (this.context = e.context)), oe.makeArray(e, this));
            });
        (be.prototype = oe.fn), (me = oe(K));
        var ye = /^(?:parents|prev(?:Until|All))/,
            _e = { children: !0, contents: !0, next: !0, prev: !0 };
        oe.fn.extend({
            has: function (e) {
                var t = oe(e, this),
                    n = t.length;
                return this.filter(function () {
                    for (var e = 0; e < n; e++) if (oe.contains(this, t[e])) return !0;
                });
            },
            closest: function (e, t) {
                for (var n, r = 0, i = this.length, o = [], a = he.test(e) || "string" != typeof e ? oe(e, t || this.context) : 0; r < i; r++)
                    for (n = this[r]; n && n !== t; n = n.parentNode)
                        if (n.nodeType < 11 && (a ? a.index(n) > -1 : 1 === n.nodeType && oe.find.matchesSelector(n, e))) {
                            o.push(n);
                            break;
                        }
                return this.pushStack(o.length > 1 ? oe.uniqueSort(o) : o);
            },
            index: function (e) {
                return e ? ("string" == typeof e ? Z.call(oe(e), this[0]) : Z.call(this, e.jquery ? e[0] : e)) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1;
            },
            add: function (e, t) {
                return this.pushStack(oe.uniqueSort(oe.merge(this.get(), oe(e, t))));
            },
            addBack: function (e) {
                return this.add(null == e ? this.prevObject : this.prevObject.filter(e));
            },
        }),
            oe.each(
                {
                    parent: function (e) {
                        var t = e.parentNode;
                        return t && 11 !== t.nodeType ? t : null;
                    },
                    parents: function (e) {
                        return de(e, "parentNode");
                    },
                    parentsUntil: function (e, t, n) {
                        return de(e, "parentNode", n);
                    },
                    next: function (e) {
                        return i(e, "nextSibling");
                    },
                    prev: function (e) {
                        return i(e, "previousSibling");
                    },
                    nextAll: function (e) {
                        return de(e, "nextSibling");
                    },
                    prevAll: function (e) {
                        return de(e, "previousSibling");
                    },
                    nextUntil: function (e, t, n) {
                        return de(e, "nextSibling", n);
                    },
                    prevUntil: function (e, t, n) {
                        return de(e, "previousSibling", n);
                    },
                    siblings: function (e) {
                        return fe((e.parentNode || {}).firstChild, e);
                    },
                    children: function (e) {
                        return fe(e.firstChild);
                    },
                    contents: function (e) {
                        return e.contentDocument || oe.merge([], e.childNodes);
                    },
                },
                function (e, t) {
                    oe.fn[e] = function (n, r) {
                        var i = oe.map(this, t, n);
                        return "Until" !== e.slice(-5) && (r = n), r && "string" == typeof r && (i = oe.filter(r, i)), this.length > 1 && (_e[e] || oe.uniqueSort(i), ye.test(e) && i.reverse()), this.pushStack(i);
                    };
                }
            );
        var we = /\S+/g;
        (oe.Callbacks = function (e) {
            e = "string" == typeof e ? o(e) : oe.extend({}, e);
            var t,
                n,
                r,
                i,
                a = [],
                s = [],
                l = -1,
                c = function () {
                    for (i = e.once, r = t = !0; s.length; l = -1) for (n = s.shift(); ++l < a.length; ) a[l].apply(n[0], n[1]) === !1 && e.stopOnFalse && ((l = a.length), (n = !1));
                    e.memory || (n = !1), (t = !1), i && (a = n ? [] : "");
                },
                u = {
                    add: function () {
                        return (
                            a &&
                                (n && !t && ((l = a.length - 1), s.push(n)),
                                (function t(n) {
                                    oe.each(n, function (n, r) {
                                        oe.isFunction(r) ? (e.unique && u.has(r)) || a.push(r) : r && r.length && "string" !== oe.type(r) && t(r);
                                    });
                                })(arguments),
                                n && !t && c()),
                            this
                        );
                    },
                    remove: function () {
                        return (
                            oe.each(arguments, function (e, t) {
                                for (var n; (n = oe.inArray(t, a, n)) > -1; ) a.splice(n, 1), n <= l && l--;
                            }),
                            this
                        );
                    },
                    has: function (e) {
                        return e ? oe.inArray(e, a) > -1 : a.length > 0;
                    },
                    empty: function () {
                        return a && (a = []), this;
                    },
                    disable: function () {
                        return (i = s = []), (a = n = ""), this;
                    },
                    disabled: function () {
                        return !a;
                    },
                    lock: function () {
                        return (i = s = []), n || (a = n = ""), this;
                    },
                    locked: function () {
                        return !!i;
                    },
                    fireWith: function (e, n) {
                        return i || ((n = n || []), (n = [e, n.slice ? n.slice() : n]), s.push(n), t || c()), this;
                    },
                    fire: function () {
                        return u.fireWith(this, arguments), this;
                    },
                    fired: function () {
                        return !!r;
                    },
                };
            return u;
        }),
            oe.extend({
                Deferred: function (e) {
                    var t = [
                            ["resolve", "done", oe.Callbacks("once memory"), "resolved"],
                            ["reject", "fail", oe.Callbacks("once memory"), "rejected"],
                            ["notify", "progress", oe.Callbacks("memory")],
                        ],
                        n = "pending",
                        r = {
                            state: function () {
                                return n;
                            },
                            always: function () {
                                return i.done(arguments).fail(arguments), this;
                            },
                            then: function () {
                                var e = arguments;
                                return oe
                                    .Deferred(function (n) {
                                        oe.each(t, function (t, o) {
                                            var a = oe.isFunction(e[t]) && e[t];
                                            i[o[1]](function () {
                                                var e = a && a.apply(this, arguments);
                                                e && oe.isFunction(e.promise) ? e.promise().progress(n.notify).done(n.resolve).fail(n.reject) : n[o[0] + "With"](this === r ? n.promise() : this, a ? [e] : arguments);
                                            });
                                        }),
                                            (e = null);
                                    })
                                    .promise();
                            },
                            promise: function (e) {
                                return null != e ? oe.extend(e, r) : r;
                            },
                        },
                        i = {};
                    return (
                        (r.pipe = r.then),
                        oe.each(t, function (e, o) {
                            var a = o[2],
                                s = o[3];
                            (r[o[1]] = a.add),
                                s &&
                                    a.add(
                                        function () {
                                            n = s;
                                        },
                                        t[1 ^ e][2].disable,
                                        t[2][2].lock
                                    ),
                                (i[o[0]] = function () {
                                    return i[o[0] + "With"](this === i ? r : this, arguments), this;
                                }),
                                (i[o[0] + "With"] = a.fireWith);
                        }),
                        r.promise(i),
                        e && e.call(i, i),
                        i
                    );
                },
                when: function (e) {
                    var t,
                        n,
                        r,
                        i = 0,
                        o = X.call(arguments),
                        a = o.length,
                        s = 1 !== a || (e && oe.isFunction(e.promise)) ? a : 0,
                        l = 1 === s ? e : oe.Deferred(),
                        c = function (e, n, r) {
                            return function (i) {
                                (n[e] = this), (r[e] = arguments.length > 1 ? X.call(arguments) : i), r === t ? l.notifyWith(n, r) : --s || l.resolveWith(n, r);
                            };
                        };
                    if (a > 1) for (t = new Array(a), n = new Array(a), r = new Array(a); i < a; i++) o[i] && oe.isFunction(o[i].promise) ? o[i].promise().progress(c(i, n, t)).done(c(i, r, o)).fail(l.reject) : --s;
                    return s || l.resolveWith(r, o), l.promise();
                },
            });
        var xe;
        (oe.fn.ready = function (e) {
            return oe.ready.promise().done(e), this;
        }),
            oe.extend({
                isReady: !1,
                readyWait: 1,
                holdReady: function (e) {
                    e ? oe.readyWait++ : oe.ready(!0);
                },
                ready: function (e) {
                    (e === !0 ? --oe.readyWait : oe.isReady) || ((oe.isReady = !0), (e !== !0 && --oe.readyWait > 0) || (xe.resolveWith(K, [oe]), oe.fn.triggerHandler && (oe(K).triggerHandler("ready"), oe(K).off("ready"))));
                },
            }),
            (oe.ready.promise = function (t) {
                return (
                    xe ||
                        ((xe = oe.Deferred()),
                        "complete" === K.readyState || ("loading" !== K.readyState && !K.documentElement.doScroll) ? e.setTimeout(oe.ready) : (K.addEventListener("DOMContentLoaded", a), e.addEventListener("load", a))),
                    xe.promise(t)
                );
            }),
            oe.ready.promise();
        var Ee = function (e, t, n, r, i, o, a) {
                var s = 0,
                    l = e.length,
                    c = null == n;
                if ("object" === oe.type(n)) {
                    i = !0;
                    for (s in n) Ee(e, t, s, n[s], !0, o, a);
                } else if (
                    void 0 !== r &&
                    ((i = !0),
                    oe.isFunction(r) || (a = !0),
                    c &&
                        (a
                            ? (t.call(e, r), (t = null))
                            : ((c = t),
                              (t = function (e, t, n) {
                                  return c.call(oe(e), n);
                              }))),
                    t)
                )
                    for (; s < l; s++) t(e[s], n, a ? r : r.call(e[s], s, t(e[s], n)));
                return i ? e : c ? t.call(e) : l ? t(e[0], n) : o;
            },
            Ce = function (e) {
                return 1 === e.nodeType || 9 === e.nodeType || !+e.nodeType;
            };
        (s.uid = 1),
            (s.prototype = {
                register: function (e, t) {
                    var n = t || {};
                    return e.nodeType ? (e[this.expando] = n) : Object.defineProperty(e, this.expando, { value: n, writable: !0, configurable: !0 }), e[this.expando];
                },
                cache: function (e) {
                    if (!Ce(e)) return {};
                    var t = e[this.expando];
                    return t || ((t = {}), Ce(e) && (e.nodeType ? (e[this.expando] = t) : Object.defineProperty(e, this.expando, { value: t, configurable: !0 }))), t;
                },
                set: function (e, t, n) {
                    var r,
                        i = this.cache(e);
                    if ("string" == typeof t) i[t] = n;
                    else for (r in t) i[r] = t[r];
                    return i;
                },
                get: function (e, t) {
                    return void 0 === t ? this.cache(e) : e[this.expando] && e[this.expando][t];
                },
                access: function (e, t, n) {
                    var r;
                    return void 0 === t || (t && "string" == typeof t && void 0 === n) ? ((r = this.get(e, t)), void 0 !== r ? r : this.get(e, oe.camelCase(t))) : (this.set(e, t, n), void 0 !== n ? n : t);
                },
                remove: function (e, t) {
                    var n,
                        r,
                        i,
                        o = e[this.expando];
                    if (void 0 !== o) {
                        if (void 0 === t) this.register(e);
                        else {
                            oe.isArray(t) ? (r = t.concat(t.map(oe.camelCase))) : ((i = oe.camelCase(t)), t in o ? (r = [t, i]) : ((r = i), (r = r in o ? [r] : r.match(we) || []))), (n = r.length);
                            for (; n--; ) delete o[r[n]];
                        }
                        (void 0 === t || oe.isEmptyObject(o)) && (e.nodeType ? (e[this.expando] = void 0) : delete e[this.expando]);
                    }
                },
                hasData: function (e) {
                    var t = e[this.expando];
                    return void 0 !== t && !oe.isEmptyObject(t);
                },
            });
        var Te = new s(),
            Se = new s(),
            Re = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
            Ie = /[A-Z]/g;
        oe.extend({
            hasData: function (e) {
                return Se.hasData(e) || Te.hasData(e);
            },
            data: function (e, t, n) {
                return Se.access(e, t, n);
            },
            removeData: function (e, t) {
                Se.remove(e, t);
            },
            _data: function (e, t, n) {
                return Te.access(e, t, n);
            },
            _removeData: function (e, t) {
                Te.remove(e, t);
            },
        }),
            oe.fn.extend({
                data: function (e, t) {
                    var n,
                        r,
                        i,
                        o = this[0],
                        a = o && o.attributes;
                    if (void 0 === e) {
                        if (this.length && ((i = Se.get(o)), 1 === o.nodeType && !Te.get(o, "hasDataAttrs"))) {
                            for (n = a.length; n--; ) a[n] && ((r = a[n].name), 0 === r.indexOf("data-") && ((r = oe.camelCase(r.slice(5))), l(o, r, i[r])));
                            Te.set(o, "hasDataAttrs", !0);
                        }
                        return i;
                    }
                    return "object" == typeof e
                        ? this.each(function () {
                              Se.set(this, e);
                          })
                        : Ee(
                              this,
                              function (t) {
                                  var n, r;
                                  if (o && void 0 === t) {
                                      if (((n = Se.get(o, e) || Se.get(o, e.replace(Ie, "-$&").toLowerCase())), void 0 !== n)) return n;
                                      if (((r = oe.camelCase(e)), (n = Se.get(o, r)), void 0 !== n)) return n;
                                      if (((n = l(o, r, void 0)), void 0 !== n)) return n;
                                  } else
                                      (r = oe.camelCase(e)),
                                          this.each(function () {
                                              var n = Se.get(this, r);
                                              Se.set(this, r, t), e.indexOf("-") > -1 && void 0 !== n && Se.set(this, e, t);
                                          });
                              },
                              null,
                              t,
                              arguments.length > 1,
                              null,
                              !0
                          );
                },
                removeData: function (e) {
                    return this.each(function () {
                        Se.remove(this, e);
                    });
                },
            }),
            oe.extend({
                queue: function (e, t, n) {
                    var r;
                    if (e) return (t = (t || "fx") + "queue"), (r = Te.get(e, t)), n && (!r || oe.isArray(n) ? (r = Te.access(e, t, oe.makeArray(n))) : r.push(n)), r || [];
                },
                dequeue: function (e, t) {
                    t = t || "fx";
                    var n = oe.queue(e, t),
                        r = n.length,
                        i = n.shift(),
                        o = oe._queueHooks(e, t),
                        a = function () {
                            oe.dequeue(e, t);
                        };
                    "inprogress" === i && ((i = n.shift()), r--), i && ("fx" === t && n.unshift("inprogress"), delete o.stop, i.call(e, a, o)), !r && o && o.empty.fire();
                },
                _queueHooks: function (e, t) {
                    var n = t + "queueHooks";
                    return (
                        Te.get(e, n) ||
                        Te.access(e, n, {
                            empty: oe.Callbacks("once memory").add(function () {
                                Te.remove(e, [t + "queue", n]);
                            }),
                        })
                    );
                },
            }),
            oe.fn.extend({
                queue: function (e, t) {
                    var n = 2;
                    return (
                        "string" != typeof e && ((t = e), (e = "fx"), n--),
                        arguments.length < n
                            ? oe.queue(this[0], e)
                            : void 0 === t
                            ? this
                            : this.each(function () {
                                  var n = oe.queue(this, e, t);
                                  oe._queueHooks(this, e), "fx" === e && "inprogress" !== n[0] && oe.dequeue(this, e);
                              })
                    );
                },
                dequeue: function (e) {
                    return this.each(function () {
                        oe.dequeue(this, e);
                    });
                },
                clearQueue: function (e) {
                    return this.queue(e || "fx", []);
                },
                promise: function (e, t) {
                    var n,
                        r = 1,
                        i = oe.Deferred(),
                        o = this,
                        a = this.length,
                        s = function () {
                            --r || i.resolveWith(o, [o]);
                        };
                    for ("string" != typeof e && ((t = e), (e = void 0)), e = e || "fx"; a--; ) (n = Te.get(o[a], e + "queueHooks")), n && n.empty && (r++, n.empty.add(s));
                    return s(), i.promise(t);
                },
            });
        var ke = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
            Pe = new RegExp("^(?:([+-])=|)(" + ke + ")([a-z%]*)$", "i"),
            Ne = ["Top", "Right", "Bottom", "Left"],
            Oe = function (e, t) {
                return (e = t || e), "none" === oe.css(e, "display") || !oe.contains(e.ownerDocument, e);
            },
            Ae = /^(?:checkbox|radio)$/i,
            De = /<([\w:-]+)/,
            Me = /^$|\/(?:java|ecma)script/i,
            Fe = {
                option: [1, "<select multiple='multiple'>", "</select>"],
                thead: [1, "<table>", "</table>"],
                col: [2, "<table><colgroup>", "</colgroup></table>"],
                tr: [2, "<table><tbody>", "</tbody></table>"],
                td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
                _default: [0, "", ""],
            };
        (Fe.optgroup = Fe.option), (Fe.tbody = Fe.tfoot = Fe.colgroup = Fe.caption = Fe.thead), (Fe.th = Fe.td);
        var Le = /<|&#?\w+;/;
        !(function () {
            var e = K.createDocumentFragment(),
                t = e.appendChild(K.createElement("div")),
                n = K.createElement("input");
            n.setAttribute("type", "radio"),
                n.setAttribute("checked", "checked"),
                n.setAttribute("name", "t"),
                t.appendChild(n),
                (re.checkClone = t.cloneNode(!0).cloneNode(!0).lastChild.checked),
                (t.innerHTML = "<textarea>x</textarea>"),
                (re.noCloneChecked = !!t.cloneNode(!0).lastChild.defaultValue);
        })();
        var Ue = /^key/,
            Be = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,
            je = /^([^.]*)(?:\.(.+)|)/;
        (oe.event = {
            global: {},
            add: function (e, t, n, r, i) {
                var o,
                    a,
                    s,
                    l,
                    c,
                    u,
                    d,
                    f,
                    h,
                    p,
                    g,
                    m = Te.get(e);
                if (m)
                    for (
                        n.handler && ((o = n), (n = o.handler), (i = o.selector)),
                            n.guid || (n.guid = oe.guid++),
                            (l = m.events) || (l = m.events = {}),
                            (a = m.handle) ||
                                (a = m.handle = function (t) {
                                    return "undefined" != typeof oe && oe.event.triggered !== t.type ? oe.event.dispatch.apply(e, arguments) : void 0;
                                }),
                            t = (t || "").match(we) || [""],
                            c = t.length;
                        c--;

                    )
                        (s = je.exec(t[c]) || []),
                            (h = g = s[1]),
                            (p = (s[2] || "").split(".").sort()),
                            h &&
                                ((d = oe.event.special[h] || {}),
                                (h = (i ? d.delegateType : d.bindType) || h),
                                (d = oe.event.special[h] || {}),
                                (u = oe.extend({ type: h, origType: g, data: r, handler: n, guid: n.guid, selector: i, needsContext: i && oe.expr.match.needsContext.test(i), namespace: p.join(".") }, o)),
                                (f = l[h]) || ((f = l[h] = []), (f.delegateCount = 0), (d.setup && d.setup.call(e, r, p, a) !== !1) || (e.addEventListener && e.addEventListener(h, a))),
                                d.add && (d.add.call(e, u), u.handler.guid || (u.handler.guid = n.guid)),
                                i ? f.splice(f.delegateCount++, 0, u) : f.push(u),
                                (oe.event.global[h] = !0));
            },
            remove: function (e, t, n, r, i) {
                var o,
                    a,
                    s,
                    l,
                    c,
                    u,
                    d,
                    f,
                    h,
                    p,
                    g,
                    m = Te.hasData(e) && Te.get(e);
                if (m && (l = m.events)) {
                    for (t = (t || "").match(we) || [""], c = t.length; c--; )
                        if (((s = je.exec(t[c]) || []), (h = g = s[1]), (p = (s[2] || "").split(".").sort()), h)) {
                            for (d = oe.event.special[h] || {}, h = (r ? d.delegateType : d.bindType) || h, f = l[h] || [], s = s[2] && new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)"), a = o = f.length; o--; )
                                (u = f[o]),
                                    (!i && g !== u.origType) ||
                                        (n && n.guid !== u.guid) ||
                                        (s && !s.test(u.namespace)) ||
                                        (r && r !== u.selector && ("**" !== r || !u.selector)) ||
                                        (f.splice(o, 1), u.selector && f.delegateCount--, d.remove && d.remove.call(e, u));
                            a && !f.length && ((d.teardown && d.teardown.call(e, p, m.handle) !== !1) || oe.removeEvent(e, h, m.handle), delete l[h]);
                        } else for (h in l) oe.event.remove(e, h + t[c], n, r, !0);
                    oe.isEmptyObject(l) && Te.remove(e, "handle events");
                }
            },
            dispatch: function (e) {
                e = oe.event.fix(e);
                var t,
                    n,
                    r,
                    i,
                    o,
                    a = [],
                    s = X.call(arguments),
                    l = (Te.get(this, "events") || {})[e.type] || [],
                    c = oe.event.special[e.type] || {};
                if (((s[0] = e), (e.delegateTarget = this), !c.preDispatch || c.preDispatch.call(this, e) !== !1)) {
                    for (a = oe.event.handlers.call(this, e, l), t = 0; (i = a[t++]) && !e.isPropagationStopped(); )
                        for (e.currentTarget = i.elem, n = 0; (o = i.handlers[n++]) && !e.isImmediatePropagationStopped(); )
                            (e.rnamespace && !e.rnamespace.test(o.namespace)) ||
                                ((e.handleObj = o), (e.data = o.data), (r = ((oe.event.special[o.origType] || {}).handle || o.handler).apply(i.elem, s)), void 0 !== r && (e.result = r) === !1 && (e.preventDefault(), e.stopPropagation()));
                    return c.postDispatch && c.postDispatch.call(this, e), e.result;
                }
            },
            handlers: function (e, t) {
                var n,
                    r,
                    i,
                    o,
                    a = [],
                    s = t.delegateCount,
                    l = e.target;
                if (s && l.nodeType && ("click" !== e.type || isNaN(e.button) || e.button < 1))
                    for (; l !== this; l = l.parentNode || this)
                        if (1 === l.nodeType && (l.disabled !== !0 || "click" !== e.type)) {
                            for (r = [], n = 0; n < s; n++) (o = t[n]), (i = o.selector + " "), void 0 === r[i] && (r[i] = o.needsContext ? oe(i, this).index(l) > -1 : oe.find(i, this, null, [l]).length), r[i] && r.push(o);
                            r.length && a.push({ elem: l, handlers: r });
                        }
                return s < t.length && a.push({ elem: this, handlers: t.slice(s) }), a;
            },
            props: "altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
            fixHooks: {},
            keyHooks: {
                props: "char charCode key keyCode".split(" "),
                filter: function (e, t) {
                    return null == e.which && (e.which = null != t.charCode ? t.charCode : t.keyCode), e;
                },
            },
            mouseHooks: {
                props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
                filter: function (e, t) {
                    var n,
                        r,
                        i,
                        o = t.button;
                    return (
                        null == e.pageX &&
                            null != t.clientX &&
                            ((n = e.target.ownerDocument || K),
                            (r = n.documentElement),
                            (i = n.body),
                            (e.pageX = t.clientX + ((r && r.scrollLeft) || (i && i.scrollLeft) || 0) - ((r && r.clientLeft) || (i && i.clientLeft) || 0)),
                            (e.pageY = t.clientY + ((r && r.scrollTop) || (i && i.scrollTop) || 0) - ((r && r.clientTop) || (i && i.clientTop) || 0))),
                        e.which || void 0 === o || (e.which = 1 & o ? 1 : 2 & o ? 3 : 4 & o ? 2 : 0),
                        e
                    );
                },
            },
            fix: function (e) {
                if (e[oe.expando]) return e;
                var t,
                    n,
                    r,
                    i = e.type,
                    o = e,
                    a = this.fixHooks[i];
                for (a || (this.fixHooks[i] = a = Be.test(i) ? this.mouseHooks : Ue.test(i) ? this.keyHooks : {}), r = a.props ? this.props.concat(a.props) : this.props, e = new oe.Event(o), t = r.length; t--; ) (n = r[t]), (e[n] = o[n]);
                return e.target || (e.target = K), 3 === e.target.nodeType && (e.target = e.target.parentNode), a.filter ? a.filter(e, o) : e;
            },
            special: {
                load: { noBubble: !0 },
                focus: {
                    trigger: function () {
                        if (this !== g() && this.focus) return this.focus(), !1;
                    },
                    delegateType: "focusin",
                },
                blur: {
                    trigger: function () {
                        if (this === g() && this.blur) return this.blur(), !1;
                    },
                    delegateType: "focusout",
                },
                click: {
                    trigger: function () {
                        if ("checkbox" === this.type && this.click && oe.nodeName(this, "input")) return this.click(), !1;
                    },
                    _default: function (e) {
                        return oe.nodeName(e.target, "a");
                    },
                },
                beforeunload: {
                    postDispatch: function (e) {
                        void 0 !== e.result && e.originalEvent && (e.originalEvent.returnValue = e.result);
                    },
                },
            },
        }),
            (oe.removeEvent = function (e, t, n) {
                e.removeEventListener && e.removeEventListener(t, n);
            }),
            (oe.Event = function (e, t) {
                return this instanceof oe.Event
                    ? (e && e.type ? ((this.originalEvent = e), (this.type = e.type), (this.isDefaultPrevented = e.defaultPrevented || (void 0 === e.defaultPrevented && e.returnValue === !1) ? h : p)) : (this.type = e),
                      t && oe.extend(this, t),
                      (this.timeStamp = (e && e.timeStamp) || oe.now()),
                      void (this[oe.expando] = !0))
                    : new oe.Event(e, t);
            }),
            (oe.Event.prototype = {
                constructor: oe.Event,
                isDefaultPrevented: p,
                isPropagationStopped: p,
                isImmediatePropagationStopped: p,
                isSimulated: !1,
                preventDefault: function () {
                    var e = this.originalEvent;
                    (this.isDefaultPrevented = h), e && !this.isSimulated && e.preventDefault();
                },
                stopPropagation: function () {
                    var e = this.originalEvent;
                    (this.isPropagationStopped = h), e && !this.isSimulated && e.stopPropagation();
                },
                stopImmediatePropagation: function () {
                    var e = this.originalEvent;
                    (this.isImmediatePropagationStopped = h), e && !this.isSimulated && e.stopImmediatePropagation(), this.stopPropagation();
                },
            }),
            oe.each({ mouseenter: "mouseover", mouseleave: "mouseout", pointerenter: "pointerover", pointerleave: "pointerout" }, function (e, t) {
                oe.event.special[e] = {
                    delegateType: t,
                    bindType: t,
                    handle: function (e) {
                        var n,
                            r = this,
                            i = e.relatedTarget,
                            o = e.handleObj;
                        return (i && (i === r || oe.contains(r, i))) || ((e.type = o.origType), (n = o.handler.apply(this, arguments)), (e.type = t)), n;
                    },
                };
            }),
            oe.fn.extend({
                on: function (e, t, n, r) {
                    return m(this, e, t, n, r);
                },
                one: function (e, t, n, r) {
                    return m(this, e, t, n, r, 1);
                },
                off: function (e, t, n) {
                    var r, i;
                    if (e && e.preventDefault && e.handleObj) return (r = e.handleObj), oe(e.delegateTarget).off(r.namespace ? r.origType + "." + r.namespace : r.origType, r.selector, r.handler), this;
                    if ("object" == typeof e) {
                        for (i in e) this.off(i, t, e[i]);
                        return this;
                    }
                    return (
                        (t !== !1 && "function" != typeof t) || ((n = t), (t = void 0)),
                        n === !1 && (n = p),
                        this.each(function () {
                            oe.event.remove(this, e, n, t);
                        })
                    );
                },
            });
        var ze = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,
            Ve = /<script|<style|<link/i,
            He = /checked\s*(?:[^=]|=\s*.checked.)/i,
            $e = /^true\/(.*)/,
            We = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;
        oe.extend({
            htmlPrefilter: function (e) {
                return e.replace(ze, "<$1></$2>");
            },
            clone: function (e, t, n) {
                var r,
                    i,
                    o,
                    a,
                    s = e.cloneNode(!0),
                    l = oe.contains(e.ownerDocument, e);
                if (!(re.noCloneChecked || (1 !== e.nodeType && 11 !== e.nodeType) || oe.isXMLDoc(e))) for (a = u(s), o = u(e), r = 0, i = o.length; r < i; r++) w(o[r], a[r]);
                if (t)
                    if (n) for (o = o || u(e), a = a || u(s), r = 0, i = o.length; r < i; r++) _(o[r], a[r]);
                    else _(e, s);
                return (a = u(s, "script")), a.length > 0 && d(a, !l && u(e, "script")), s;
            },
            cleanData: function (e) {
                for (var t, n, r, i = oe.event.special, o = 0; void 0 !== (n = e[o]); o++)
                    if (Ce(n)) {
                        if ((t = n[Te.expando])) {
                            if (t.events) for (r in t.events) i[r] ? oe.event.remove(n, r) : oe.removeEvent(n, r, t.handle);
                            n[Te.expando] = void 0;
                        }
                        n[Se.expando] && (n[Se.expando] = void 0);
                    }
            },
        }),
            oe.fn.extend({
                domManip: x,
                detach: function (e) {
                    return E(this, e, !0);
                },
                remove: function (e) {
                    return E(this, e);
                },
                text: function (e) {
                    return Ee(
                        this,
                        function (e) {
                            return void 0 === e
                                ? oe.text(this)
                                : this.empty().each(function () {
                                      (1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType) || (this.textContent = e);
                                  });
                        },
                        null,
                        e,
                        arguments.length
                    );
                },
                append: function () {
                    return x(this, arguments, function (e) {
                        if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                            var t = v(this, e);
                            t.appendChild(e);
                        }
                    });
                },
                prepend: function () {
                    return x(this, arguments, function (e) {
                        if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                            var t = v(this, e);
                            t.insertBefore(e, t.firstChild);
                        }
                    });
                },
                before: function () {
                    return x(this, arguments, function (e) {
                        this.parentNode && this.parentNode.insertBefore(e, this);
                    });
                },
                after: function () {
                    return x(this, arguments, function (e) {
                        this.parentNode && this.parentNode.insertBefore(e, this.nextSibling);
                    });
                },
                empty: function () {
                    for (var e, t = 0; null != (e = this[t]); t++) 1 === e.nodeType && (oe.cleanData(u(e, !1)), (e.textContent = ""));
                    return this;
                },
                clone: function (e, t) {
                    return (
                        (e = null != e && e),
                        (t = null == t ? e : t),
                        this.map(function () {
                            return oe.clone(this, e, t);
                        })
                    );
                },
                html: function (e) {
                    return Ee(
                        this,
                        function (e) {
                            var t = this[0] || {},
                                n = 0,
                                r = this.length;
                            if (void 0 === e && 1 === t.nodeType) return t.innerHTML;
                            if ("string" == typeof e && !Ve.test(e) && !Fe[(De.exec(e) || ["", ""])[1].toLowerCase()]) {
                                e = oe.htmlPrefilter(e);
                                try {
                                    for (; n < r; n++) (t = this[n] || {}), 1 === t.nodeType && (oe.cleanData(u(t, !1)), (t.innerHTML = e));
                                    t = 0;
                                } catch (e) {}
                            }
                            t && this.empty().append(e);
                        },
                        null,
                        e,
                        arguments.length
                    );
                },
                replaceWith: function () {
                    var e = [];
                    return x(
                        this,
                        arguments,
                        function (t) {
                            var n = this.parentNode;
                            oe.inArray(this, e) < 0 && (oe.cleanData(u(this)), n && n.replaceChild(t, this));
                        },
                        e
                    );
                },
            }),
            oe.each({ appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith" }, function (e, t) {
                oe.fn[e] = function (e) {
                    for (var n, r = [], i = oe(e), o = i.length - 1, a = 0; a <= o; a++) (n = a === o ? this : this.clone(!0)), oe(i[a])[t](n), Y.apply(r, n.get());
                    return this.pushStack(r);
                };
            });
        var qe,
            Ge = { HTML: "block", BODY: "block" },
            Je = /^margin/,
            Ke = new RegExp("^(" + ke + ")(?!px)[a-z%]+$", "i"),
            Xe = function (t) {
                var n = t.ownerDocument.defaultView;
                return (n && n.opener) || (n = e), n.getComputedStyle(t);
            },
            Qe = function (e, t, n, r) {
                var i,
                    o,
                    a = {};
                for (o in t) (a[o] = e.style[o]), (e.style[o] = t[o]);
                i = n.apply(e, r || []);
                for (o in t) e.style[o] = a[o];
                return i;
            },
            Ye = K.documentElement;
        !(function () {
            function t() {
                (s.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%"), (s.innerHTML = ""), Ye.appendChild(a);
                var t = e.getComputedStyle(s);
                (n = "1%" !== t.top), (o = "2px" === t.marginLeft), (r = "4px" === t.width), (s.style.marginRight = "50%"), (i = "4px" === t.marginRight), Ye.removeChild(a);
            }
            var n,
                r,
                i,
                o,
                a = K.createElement("div"),
                s = K.createElement("div");
            s.style &&
                ((s.style.backgroundClip = "content-box"),
                (s.cloneNode(!0).style.backgroundClip = ""),
                (re.clearCloneStyle = "content-box" === s.style.backgroundClip),
                (a.style.cssText = "border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute"),
                a.appendChild(s),
                oe.extend(re, {
                    pixelPosition: function () {
                        return t(), n;
                    },
                    boxSizingReliable: function () {
                        return null == r && t(), r;
                    },
                    pixelMarginRight: function () {
                        return null == r && t(), i;
                    },
                    reliableMarginLeft: function () {
                        return null == r && t(), o;
                    },
                    reliableMarginRight: function () {
                        var t,
                            n = s.appendChild(K.createElement("div"));
                        return (
                            (n.style.cssText = s.style.cssText = "-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0"),
                            (n.style.marginRight = n.style.width = "0"),
                            (s.style.width = "1px"),
                            Ye.appendChild(a),
                            (t = !parseFloat(e.getComputedStyle(n).marginRight)),
                            Ye.removeChild(a),
                            s.removeChild(n),
                            t
                        );
                    },
                }));
        })();
        var Ze = /^(none|table(?!-c[ea]).+)/,
            et = { position: "absolute", visibility: "hidden", display: "block" },
            tt = { letterSpacing: "0", fontWeight: "400" },
            nt = ["Webkit", "O", "Moz", "ms"],
            rt = K.createElement("div").style;
        oe.extend({
            cssHooks: {
                opacity: {
                    get: function (e, t) {
                        if (t) {
                            var n = S(e, "opacity");
                            return "" === n ? "1" : n;
                        }
                    },
                },
            },
            cssNumber: { animationIterationCount: !0, columnCount: !0, fillOpacity: !0, flexGrow: !0, flexShrink: !0, fontWeight: !0, lineHeight: !0, opacity: !0, order: !0, orphans: !0, widows: !0, zIndex: !0, zoom: !0 },
            cssProps: { float: "cssFloat" },
            style: function (e, t, n, r) {
                if (e && 3 !== e.nodeType && 8 !== e.nodeType && e.style) {
                    var i,
                        o,
                        a,
                        s = oe.camelCase(t),
                        l = e.style;
                    return (
                        (t = oe.cssProps[s] || (oe.cssProps[s] = I(s) || s)),
                        (a = oe.cssHooks[t] || oe.cssHooks[s]),
                        void 0 === n
                            ? a && "get" in a && void 0 !== (i = a.get(e, !1, r))
                                ? i
                                : l[t]
                            : ((o = typeof n),
                              "string" === o && (i = Pe.exec(n)) && i[1] && ((n = c(e, t, i)), (o = "number")),
                              null != n &&
                                  n === n &&
                                  ("number" === o && (n += (i && i[3]) || (oe.cssNumber[s] ? "" : "px")),
                                  re.clearCloneStyle || "" !== n || 0 !== t.indexOf("background") || (l[t] = "inherit"),
                                  (a && "set" in a && void 0 === (n = a.set(e, n, r))) || (l[t] = n)),
                              void 0)
                    );
                }
            },
            css: function (e, t, n, r) {
                var i,
                    o,
                    a,
                    s = oe.camelCase(t);
                return (
                    (t = oe.cssProps[s] || (oe.cssProps[s] = I(s) || s)),
                    (a = oe.cssHooks[t] || oe.cssHooks[s]),
                    a && "get" in a && (i = a.get(e, !0, n)),
                    void 0 === i && (i = S(e, t, r)),
                    "normal" === i && t in tt && (i = tt[t]),
                    "" === n || n ? ((o = parseFloat(i)), n === !0 || isFinite(o) ? o || 0 : i) : i
                );
            },
        }),
            oe.each(["height", "width"], function (e, t) {
                oe.cssHooks[t] = {
                    get: function (e, n, r) {
                        if (n)
                            return Ze.test(oe.css(e, "display")) && 0 === e.offsetWidth
                                ? Qe(e, et, function () {
                                      return N(e, t, r);
                                  })
                                : N(e, t, r);
                    },
                    set: function (e, n, r) {
                        var i,
                            o = r && Xe(e),
                            a = r && P(e, t, r, "border-box" === oe.css(e, "boxSizing", !1, o), o);
                        return a && (i = Pe.exec(n)) && "px" !== (i[3] || "px") && ((e.style[t] = n), (n = oe.css(e, t))), k(e, n, a);
                    },
                };
            }),
            (oe.cssHooks.marginLeft = R(re.reliableMarginLeft, function (e, t) {
                if (t)
                    return (
                        (parseFloat(S(e, "marginLeft")) ||
                            e.getBoundingClientRect().left -
                                Qe(e, { marginLeft: 0 }, function () {
                                    return e.getBoundingClientRect().left;
                                })) + "px"
                    );
            })),
            (oe.cssHooks.marginRight = R(re.reliableMarginRight, function (e, t) {
                if (t) return Qe(e, { display: "inline-block" }, S, [e, "marginRight"]);
            })),
            oe.each({ margin: "", padding: "", border: "Width" }, function (e, t) {
                (oe.cssHooks[e + t] = {
                    expand: function (n) {
                        for (var r = 0, i = {}, o = "string" == typeof n ? n.split(" ") : [n]; r < 4; r++) i[e + Ne[r] + t] = o[r] || o[r - 2] || o[0];
                        return i;
                    },
                }),
                    Je.test(e) || (oe.cssHooks[e + t].set = k);
            }),
            oe.fn.extend({
                css: function (e, t) {
                    return Ee(
                        this,
                        function (e, t, n) {
                            var r,
                                i,
                                o = {},
                                a = 0;
                            if (oe.isArray(t)) {
                                for (r = Xe(e), i = t.length; a < i; a++) o[t[a]] = oe.css(e, t[a], !1, r);
                                return o;
                            }
                            return void 0 !== n ? oe.style(e, t, n) : oe.css(e, t);
                        },
                        e,
                        t,
                        arguments.length > 1
                    );
                },
                show: function () {
                    return O(this, !0);
                },
                hide: function () {
                    return O(this);
                },
                toggle: function (e) {
                    return "boolean" == typeof e
                        ? e
                            ? this.show()
                            : this.hide()
                        : this.each(function () {
                              Oe(this) ? oe(this).show() : oe(this).hide();
                          });
                },
            }),
            (oe.Tween = A),
            (A.prototype = {
                constructor: A,
                init: function (e, t, n, r, i, o) {
                    (this.elem = e), (this.prop = n), (this.easing = i || oe.easing._default), (this.options = t), (this.start = this.now = this.cur()), (this.end = r), (this.unit = o || (oe.cssNumber[n] ? "" : "px"));
                },
                cur: function () {
                    var e = A.propHooks[this.prop];
                    return e && e.get ? e.get(this) : A.propHooks._default.get(this);
                },
                run: function (e) {
                    var t,
                        n = A.propHooks[this.prop];
                    return (
                        this.options.duration ? (this.pos = t = oe.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration)) : (this.pos = t = e),
                        (this.now = (this.end - this.start) * t + this.start),
                        this.options.step && this.options.step.call(this.elem, this.now, this),
                        n && n.set ? n.set(this) : A.propHooks._default.set(this),
                        this
                    );
                },
            }),
            (A.prototype.init.prototype = A.prototype),
            (A.propHooks = {
                _default: {
                    get: function (e) {
                        var t;
                        return 1 !== e.elem.nodeType || (null != e.elem[e.prop] && null == e.elem.style[e.prop]) ? e.elem[e.prop] : ((t = oe.css(e.elem, e.prop, "")), t && "auto" !== t ? t : 0);
                    },
                    set: function (e) {
                        oe.fx.step[e.prop] ? oe.fx.step[e.prop](e) : 1 !== e.elem.nodeType || (null == e.elem.style[oe.cssProps[e.prop]] && !oe.cssHooks[e.prop]) ? (e.elem[e.prop] = e.now) : oe.style(e.elem, e.prop, e.now + e.unit);
                    },
                },
            }),
            (A.propHooks.scrollTop = A.propHooks.scrollLeft = {
                set: function (e) {
                    e.elem.nodeType && e.elem.parentNode && (e.elem[e.prop] = e.now);
                },
            }),
            (oe.easing = {
                linear: function (e) {
                    return e;
                },
                swing: function (e) {
                    return 0.5 - Math.cos(e * Math.PI) / 2;
                },
                _default: "swing",
            }),
            (oe.fx = A.prototype.init),
            (oe.fx.step = {});
        var it,
            ot,
            at = /^(?:toggle|show|hide)$/,
            st = /queueHooks$/;
        (oe.Animation = oe.extend(B, {
            tweeners: {
                "*": [
                    function (e, t) {
                        var n = this.createTween(e, t);
                        return c(n.elem, e, Pe.exec(t), n), n;
                    },
                ],
            },
            tweener: function (e, t) {
                oe.isFunction(e) ? ((t = e), (e = ["*"])) : (e = e.match(we));
                for (var n, r = 0, i = e.length; r < i; r++) (n = e[r]), (B.tweeners[n] = B.tweeners[n] || []), B.tweeners[n].unshift(t);
            },
            prefilters: [L],
            prefilter: function (e, t) {
                t ? B.prefilters.unshift(e) : B.prefilters.push(e);
            },
        })),
            (oe.speed = function (e, t, n) {
                var r = e && "object" == typeof e ? oe.extend({}, e) : { complete: n || (!n && t) || (oe.isFunction(e) && e), duration: e, easing: (n && t) || (t && !oe.isFunction(t) && t) };
                return (
                    (r.duration = oe.fx.off ? 0 : "number" == typeof r.duration ? r.duration : r.duration in oe.fx.speeds ? oe.fx.speeds[r.duration] : oe.fx.speeds._default),
                    (null != r.queue && r.queue !== !0) || (r.queue = "fx"),
                    (r.old = r.complete),
                    (r.complete = function () {
                        oe.isFunction(r.old) && r.old.call(this), r.queue && oe.dequeue(this, r.queue);
                    }),
                    r
                );
            }),
            oe.fn.extend({
                fadeTo: function (e, t, n, r) {
                    return this.filter(Oe).css("opacity", 0).show().end().animate({ opacity: t }, e, n, r);
                },
                animate: function (e, t, n, r) {
                    var i = oe.isEmptyObject(e),
                        o = oe.speed(t, n, r),
                        a = function () {
                            var t = B(this, oe.extend({}, e), o);
                            (i || Te.get(this, "finish")) && t.stop(!0);
                        };
                    return (a.finish = a), i || o.queue === !1 ? this.each(a) : this.queue(o.queue, a);
                },
                stop: function (e, t, n) {
                    var r = function (e) {
                        var t = e.stop;
                        delete e.stop, t(n);
                    };
                    return (
                        "string" != typeof e && ((n = t), (t = e), (e = void 0)),
                        t && e !== !1 && this.queue(e || "fx", []),
                        this.each(function () {
                            var t = !0,
                                i = null != e && e + "queueHooks",
                                o = oe.timers,
                                a = Te.get(this);
                            if (i) a[i] && a[i].stop && r(a[i]);
                            else for (i in a) a[i] && a[i].stop && st.test(i) && r(a[i]);
                            for (i = o.length; i--; ) o[i].elem !== this || (null != e && o[i].queue !== e) || (o[i].anim.stop(n), (t = !1), o.splice(i, 1));
                            (!t && n) || oe.dequeue(this, e);
                        })
                    );
                },
                finish: function (e) {
                    return (
                        e !== !1 && (e = e || "fx"),
                        this.each(function () {
                            var t,
                                n = Te.get(this),
                                r = n[e + "queue"],
                                i = n[e + "queueHooks"],
                                o = oe.timers,
                                a = r ? r.length : 0;
                            for (n.finish = !0, oe.queue(this, e, []), i && i.stop && i.stop.call(this, !0), t = o.length; t--; ) o[t].elem === this && o[t].queue === e && (o[t].anim.stop(!0), o.splice(t, 1));
                            for (t = 0; t < a; t++) r[t] && r[t].finish && r[t].finish.call(this);
                            delete n.finish;
                        })
                    );
                },
            }),
            oe.each(["toggle", "show", "hide"], function (e, t) {
                var n = oe.fn[t];
                oe.fn[t] = function (e, r, i) {
                    return null == e || "boolean" == typeof e ? n.apply(this, arguments) : this.animate(M(t, !0), e, r, i);
                };
            }),
            oe.each({ slideDown: M("show"), slideUp: M("hide"), slideToggle: M("toggle"), fadeIn: { opacity: "show" }, fadeOut: { opacity: "hide" }, fadeToggle: { opacity: "toggle" } }, function (e, t) {
                oe.fn[e] = function (e, n, r) {
                    return this.animate(t, e, n, r);
                };
            }),
            (oe.timers = []),
            (oe.fx.tick = function () {
                var e,
                    t = 0,
                    n = oe.timers;
                for (it = oe.now(); t < n.length; t++) (e = n[t]), e() || n[t] !== e || n.splice(t--, 1);
                n.length || oe.fx.stop(), (it = void 0);
            }),
            (oe.fx.timer = function (e) {
                oe.timers.push(e), e() ? oe.fx.start() : oe.timers.pop();
            }),
            (oe.fx.interval = 13),
            (oe.fx.start = function () {
                ot || (ot = e.setInterval(oe.fx.tick, oe.fx.interval));
            }),
            (oe.fx.stop = function () {
                e.clearInterval(ot), (ot = null);
            }),
            (oe.fx.speeds = { slow: 600, fast: 200, _default: 400 }),
            (oe.fn.delay = function (t, n) {
                return (
                    (t = oe.fx ? oe.fx.speeds[t] || t : t),
                    (n = n || "fx"),
                    this.queue(n, function (n, r) {
                        var i = e.setTimeout(n, t);
                        r.stop = function () {
                            e.clearTimeout(i);
                        };
                    })
                );
            }),
            (function () {
                var e = K.createElement("input"),
                    t = K.createElement("select"),
                    n = t.appendChild(K.createElement("option"));
                (e.type = "checkbox"),
                    (re.checkOn = "" !== e.value),
                    (re.optSelected = n.selected),
                    (t.disabled = !0),
                    (re.optDisabled = !n.disabled),
                    (e = K.createElement("input")),
                    (e.value = "t"),
                    (e.type = "radio"),
                    (re.radioValue = "t" === e.value);
            })();
        var lt,
            ct = oe.expr.attrHandle;
        oe.fn.extend({
            attr: function (e, t) {
                return Ee(this, oe.attr, e, t, arguments.length > 1);
            },
            removeAttr: function (e) {
                return this.each(function () {
                    oe.removeAttr(this, e);
                });
            },
        }),
            oe.extend({
                attr: function (e, t, n) {
                    var r,
                        i,
                        o = e.nodeType;
                    if (3 !== o && 8 !== o && 2 !== o)
                        return "undefined" == typeof e.getAttribute
                            ? oe.prop(e, t, n)
                            : ((1 === o && oe.isXMLDoc(e)) || ((t = t.toLowerCase()), (i = oe.attrHooks[t] || (oe.expr.match.bool.test(t) ? lt : void 0))),
                              void 0 !== n
                                  ? null === n
                                      ? void oe.removeAttr(e, t)
                                      : i && "set" in i && void 0 !== (r = i.set(e, n, t))
                                      ? r
                                      : (e.setAttribute(t, n + ""), n)
                                  : i && "get" in i && null !== (r = i.get(e, t))
                                  ? r
                                  : ((r = oe.find.attr(e, t)), null == r ? void 0 : r));
                },
                attrHooks: {
                    type: {
                        set: function (e, t) {
                            if (!re.radioValue && "radio" === t && oe.nodeName(e, "input")) {
                                var n = e.value;
                                return e.setAttribute("type", t), n && (e.value = n), t;
                            }
                        },
                    },
                },
                removeAttr: function (e, t) {
                    var n,
                        r,
                        i = 0,
                        o = t && t.match(we);
                    if (o && 1 === e.nodeType) for (; (n = o[i++]); ) (r = oe.propFix[n] || n), oe.expr.match.bool.test(n) && (e[r] = !1), e.removeAttribute(n);
                },
            }),
            (lt = {
                set: function (e, t, n) {
                    return t === !1 ? oe.removeAttr(e, n) : e.setAttribute(n, n), n;
                },
            }),
            oe.each(oe.expr.match.bool.source.match(/\w+/g), function (e, t) {
                var n = ct[t] || oe.find.attr;
                ct[t] = function (e, t, r) {
                    var i, o;
                    return r || ((o = ct[t]), (ct[t] = i), (i = null != n(e, t, r) ? t.toLowerCase() : null), (ct[t] = o)), i;
                };
            });
        var ut = /^(?:input|select|textarea|button)$/i,
            dt = /^(?:a|area)$/i;
        oe.fn.extend({
            prop: function (e, t) {
                return Ee(this, oe.prop, e, t, arguments.length > 1);
            },
            removeProp: function (e) {
                return this.each(function () {
                    delete this[oe.propFix[e] || e];
                });
            },
        }),
            oe.extend({
                prop: function (e, t, n) {
                    var r,
                        i,
                        o = e.nodeType;
                    if (3 !== o && 8 !== o && 2 !== o)
                        return (
                            (1 === o && oe.isXMLDoc(e)) || ((t = oe.propFix[t] || t), (i = oe.propHooks[t])),
                            void 0 !== n ? (i && "set" in i && void 0 !== (r = i.set(e, n, t)) ? r : (e[t] = n)) : i && "get" in i && null !== (r = i.get(e, t)) ? r : e[t]
                        );
                },
                propHooks: {
                    tabIndex: {
                        get: function (e) {
                            var t = oe.find.attr(e, "tabindex");
                            return t ? parseInt(t, 10) : ut.test(e.nodeName) || (dt.test(e.nodeName) && e.href) ? 0 : -1;
                        },
                    },
                },
                propFix: { for: "htmlFor", class: "className" },
            }),
            re.optSelected ||
                (oe.propHooks.selected = {
                    get: function (e) {
                        var t = e.parentNode;
                        return t && t.parentNode && t.parentNode.selectedIndex, null;
                    },
                    set: function (e) {
                        var t = e.parentNode;
                        t && (t.selectedIndex, t.parentNode && t.parentNode.selectedIndex);
                    },
                }),
            oe.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function () {
                oe.propFix[this.toLowerCase()] = this;
            });
        var ft = /[\t\r\n\f]/g;
        oe.fn.extend({
            addClass: function (e) {
                var t,
                    n,
                    r,
                    i,
                    o,
                    a,
                    s,
                    l = 0;
                if (oe.isFunction(e))
                    return this.each(function (t) {
                        oe(this).addClass(e.call(this, t, j(this)));
                    });
                if ("string" == typeof e && e)
                    for (t = e.match(we) || []; (n = this[l++]); )
                        if (((i = j(n)), (r = 1 === n.nodeType && (" " + i + " ").replace(ft, " ")))) {
                            for (a = 0; (o = t[a++]); ) r.indexOf(" " + o + " ") < 0 && (r += o + " ");
                            (s = oe.trim(r)), i !== s && n.setAttribute("class", s);
                        }
                return this;
            },
            removeClass: function (e) {
                var t,
                    n,
                    r,
                    i,
                    o,
                    a,
                    s,
                    l = 0;
                if (oe.isFunction(e))
                    return this.each(function (t) {
                        oe(this).removeClass(e.call(this, t, j(this)));
                    });
                if (!arguments.length) return this.attr("class", "");
                if ("string" == typeof e && e)
                    for (t = e.match(we) || []; (n = this[l++]); )
                        if (((i = j(n)), (r = 1 === n.nodeType && (" " + i + " ").replace(ft, " ")))) {
                            for (a = 0; (o = t[a++]); ) for (; r.indexOf(" " + o + " ") > -1; ) r = r.replace(" " + o + " ", " ");
                            (s = oe.trim(r)), i !== s && n.setAttribute("class", s);
                        }
                return this;
            },
            toggleClass: function (e, t) {
                var n = typeof e;
                return "boolean" == typeof t && "string" === n
                    ? t
                        ? this.addClass(e)
                        : this.removeClass(e)
                    : oe.isFunction(e)
                    ? this.each(function (n) {
                          oe(this).toggleClass(e.call(this, n, j(this), t), t);
                      })
                    : this.each(function () {
                          var t, r, i, o;
                          if ("string" === n) for (r = 0, i = oe(this), o = e.match(we) || []; (t = o[r++]); ) i.hasClass(t) ? i.removeClass(t) : i.addClass(t);
                          else (void 0 !== e && "boolean" !== n) || ((t = j(this)), t && Te.set(this, "__className__", t), this.setAttribute && this.setAttribute("class", t || e === !1 ? "" : Te.get(this, "__className__") || ""));
                      });
            },
            hasClass: function (e) {
                var t,
                    n,
                    r = 0;
                for (t = " " + e + " "; (n = this[r++]); ) if (1 === n.nodeType && (" " + j(n) + " ").replace(ft, " ").indexOf(t) > -1) return !0;
                return !1;
            },
        });
        var ht = /\r/g,
            pt = /[\x20\t\r\n\f]+/g;
        oe.fn.extend({
            val: function (e) {
                var t,
                    n,
                    r,
                    i = this[0];
                {
                    if (arguments.length)
                        return (
                            (r = oe.isFunction(e)),
                            this.each(function (n) {
                                var i;
                                1 === this.nodeType &&
                                    ((i = r ? e.call(this, n, oe(this).val()) : e),
                                    null == i
                                        ? (i = "")
                                        : "number" == typeof i
                                        ? (i += "")
                                        : oe.isArray(i) &&
                                          (i = oe.map(i, function (e) {
                                              return null == e ? "" : e + "";
                                          })),
                                    (t = oe.valHooks[this.type] || oe.valHooks[this.nodeName.toLowerCase()]),
                                    (t && "set" in t && void 0 !== t.set(this, i, "value")) || (this.value = i));
                            })
                        );
                    if (i)
                        return (t = oe.valHooks[i.type] || oe.valHooks[i.nodeName.toLowerCase()]), t && "get" in t && void 0 !== (n = t.get(i, "value")) ? n : ((n = i.value), "string" == typeof n ? n.replace(ht, "") : null == n ? "" : n);
                }
            },
        }),
            oe.extend({
                valHooks: {
                    option: {
                        get: function (e) {
                            var t = oe.find.attr(e, "value");
                            return null != t ? t : oe.trim(oe.text(e)).replace(pt, " ");
                        },
                    },
                    select: {
                        get: function (e) {
                            for (var t, n, r = e.options, i = e.selectedIndex, o = "select-one" === e.type || i < 0, a = o ? null : [], s = o ? i + 1 : r.length, l = i < 0 ? s : o ? i : 0; l < s; l++)
                                if (((n = r[l]), (n.selected || l === i) && (re.optDisabled ? !n.disabled : null === n.getAttribute("disabled")) && (!n.parentNode.disabled || !oe.nodeName(n.parentNode, "optgroup")))) {
                                    if (((t = oe(n).val()), o)) return t;
                                    a.push(t);
                                }
                            return a;
                        },
                        set: function (e, t) {
                            for (var n, r, i = e.options, o = oe.makeArray(t), a = i.length; a--; ) (r = i[a]), (r.selected = oe.inArray(oe.valHooks.option.get(r), o) > -1) && (n = !0);
                            return n || (e.selectedIndex = -1), o;
                        },
                    },
                },
            }),
            oe.each(["radio", "checkbox"], function () {
                (oe.valHooks[this] = {
                    set: function (e, t) {
                        if (oe.isArray(t)) return (e.checked = oe.inArray(oe(e).val(), t) > -1);
                    },
                }),
                    re.checkOn ||
                        (oe.valHooks[this].get = function (e) {
                            return null === e.getAttribute("value") ? "on" : e.value;
                        });
            });
        var gt = /^(?:focusinfocus|focusoutblur)$/;
        oe.extend(oe.event, {
            trigger: function (t, n, r, i) {
                var o,
                    a,
                    s,
                    l,
                    c,
                    u,
                    d,
                    f = [r || K],
                    h = ne.call(t, "type") ? t.type : t,
                    p = ne.call(t, "namespace") ? t.namespace.split(".") : [];
                if (
                    ((a = s = r = r || K),
                    3 !== r.nodeType &&
                        8 !== r.nodeType &&
                        !gt.test(h + oe.event.triggered) &&
                        (h.indexOf(".") > -1 && ((p = h.split(".")), (h = p.shift()), p.sort()),
                        (c = h.indexOf(":") < 0 && "on" + h),
                        (t = t[oe.expando] ? t : new oe.Event(h, "object" == typeof t && t)),
                        (t.isTrigger = i ? 2 : 3),
                        (t.namespace = p.join(".")),
                        (t.rnamespace = t.namespace ? new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)") : null),
                        (t.result = void 0),
                        t.target || (t.target = r),
                        (n = null == n ? [t] : oe.makeArray(n, [t])),
                        (d = oe.event.special[h] || {}),
                        i || !d.trigger || d.trigger.apply(r, n) !== !1))
                ) {
                    if (!i && !d.noBubble && !oe.isWindow(r)) {
                        for (l = d.delegateType || h, gt.test(l + h) || (a = a.parentNode); a; a = a.parentNode) f.push(a), (s = a);
                        s === (r.ownerDocument || K) && f.push(s.defaultView || s.parentWindow || e);
                    }
                    for (o = 0; (a = f[o++]) && !t.isPropagationStopped(); )
                        (t.type = o > 1 ? l : d.bindType || h),
                            (u = (Te.get(a, "events") || {})[t.type] && Te.get(a, "handle")),
                            u && u.apply(a, n),
                            (u = c && a[c]),
                            u && u.apply && Ce(a) && ((t.result = u.apply(a, n)), t.result === !1 && t.preventDefault());
                    return (
                        (t.type = h),
                        i ||
                            t.isDefaultPrevented() ||
                            (d._default && d._default.apply(f.pop(), n) !== !1) ||
                            !Ce(r) ||
                            (c && oe.isFunction(r[h]) && !oe.isWindow(r) && ((s = r[c]), s && (r[c] = null), (oe.event.triggered = h), r[h](), (oe.event.triggered = void 0), s && (r[c] = s))),
                        t.result
                    );
                }
            },
            simulate: function (e, t, n) {
                var r = oe.extend(new oe.Event(), n, { type: e, isSimulated: !0 });
                oe.event.trigger(r, null, t);
            },
        }),
            oe.fn.extend({
                trigger: function (e, t) {
                    return this.each(function () {
                        oe.event.trigger(e, t, this);
                    });
                },
                triggerHandler: function (e, t) {
                    var n = this[0];
                    if (n) return oe.event.trigger(e, t, n, !0);
                },
            }),
            oe.each(
                "blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
                function (e, t) {
                    oe.fn[t] = function (e, n) {
                        return arguments.length > 0 ? this.on(t, null, e, n) : this.trigger(t);
                    };
                }
            ),
            oe.fn.extend({
                hover: function (e, t) {
                    return this.mouseenter(e).mouseleave(t || e);
                },
            }),
            (re.focusin = "onfocusin" in e),
            re.focusin ||
                oe.each({ focus: "focusin", blur: "focusout" }, function (e, t) {
                    var n = function (e) {
                        oe.event.simulate(t, e.target, oe.event.fix(e));
                    };
                    oe.event.special[t] = {
                        setup: function () {
                            var r = this.ownerDocument || this,
                                i = Te.access(r, t);
                            i || r.addEventListener(e, n, !0), Te.access(r, t, (i || 0) + 1);
                        },
                        teardown: function () {
                            var r = this.ownerDocument || this,
                                i = Te.access(r, t) - 1;
                            i ? Te.access(r, t, i) : (r.removeEventListener(e, n, !0), Te.remove(r, t));
                        },
                    };
                });
        var mt = e.location,
            vt = oe.now(),
            bt = /\?/;
        (oe.parseJSON = function (e) {
            return JSON.parse(e + "");
        }),
            (oe.parseXML = function (t) {
                var n;
                if (!t || "string" != typeof t) return null;
                try {
                    n = new e.DOMParser().parseFromString(t, "text/xml");
                } catch (e) {
                    n = void 0;
                }
                return (n && !n.getElementsByTagName("parsererror").length) || oe.error("Invalid XML: " + t), n;
            });
        var yt = /#.*$/,
            _t = /([?&])_=[^&]*/,
            wt = /^(.*?):[ \t]*([^\r\n]*)$/gm,
            xt = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
            Et = /^(?:GET|HEAD)$/,
            Ct = /^\/\//,
            Tt = {},
            St = {},
            Rt = "*/".concat("*"),
            It = K.createElement("a");
        (It.href = mt.href),
            oe.extend({
                active: 0,
                lastModified: {},
                etag: {},
                ajaxSettings: {
                    url: mt.href,
                    type: "GET",
                    isLocal: xt.test(mt.protocol),
                    global: !0,
                    processData: !0,
                    async: !0,
                    contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                    accepts: { "*": Rt, text: "text/plain", html: "text/html", xml: "application/xml, text/xml", json: "application/json, text/javascript" },
                    contents: { xml: /\bxml\b/, html: /\bhtml/, json: /\bjson\b/ },
                    responseFields: { xml: "responseXML", text: "responseText", json: "responseJSON" },
                    converters: { "* text": String, "text html": !0, "text json": oe.parseJSON, "text xml": oe.parseXML },
                    flatOptions: { url: !0, context: !0 },
                },
                ajaxSetup: function (e, t) {
                    return t ? H(H(e, oe.ajaxSettings), t) : H(oe.ajaxSettings, e);
                },
                ajaxPrefilter: z(Tt),
                ajaxTransport: z(St),
                ajax: function (t, n) {
                    function r(t, n, r, s) {
                        var c,
                            d,
                            b,
                            y,
                            w,
                            E = n;
                        2 !== _ &&
                            ((_ = 2),
                            l && e.clearTimeout(l),
                            (i = void 0),
                            (a = s || ""),
                            (x.readyState = t > 0 ? 4 : 0),
                            (c = (t >= 200 && t < 300) || 304 === t),
                            r && (y = $(f, x, r)),
                            (y = W(f, y, x, c)),
                            c
                                ? (f.ifModified && ((w = x.getResponseHeader("Last-Modified")), w && (oe.lastModified[o] = w), (w = x.getResponseHeader("etag")), w && (oe.etag[o] = w)),
                                  204 === t || "HEAD" === f.type ? (E = "nocontent") : 304 === t ? (E = "notmodified") : ((E = y.state), (d = y.data), (b = y.error), (c = !b)))
                                : ((b = E), (!t && E) || ((E = "error"), t < 0 && (t = 0))),
                            (x.status = t),
                            (x.statusText = (n || E) + ""),
                            c ? g.resolveWith(h, [d, E, x]) : g.rejectWith(h, [x, E, b]),
                            x.statusCode(v),
                            (v = void 0),
                            u && p.trigger(c ? "ajaxSuccess" : "ajaxError", [x, f, c ? d : b]),
                            m.fireWith(h, [x, E]),
                            u && (p.trigger("ajaxComplete", [x, f]), --oe.active || oe.event.trigger("ajaxStop")));
                    }
                    "object" == typeof t && ((n = t), (t = void 0)), (n = n || {});
                    var i,
                        o,
                        a,
                        s,
                        l,
                        c,
                        u,
                        d,
                        f = oe.ajaxSetup({}, n),
                        h = f.context || f,
                        p = f.context && (h.nodeType || h.jquery) ? oe(h) : oe.event,
                        g = oe.Deferred(),
                        m = oe.Callbacks("once memory"),
                        v = f.statusCode || {},
                        b = {},
                        y = {},
                        _ = 0,
                        w = "canceled",
                        x = {
                            readyState: 0,
                            getResponseHeader: function (e) {
                                var t;
                                if (2 === _) {
                                    if (!s) for (s = {}; (t = wt.exec(a)); ) s[t[1].toLowerCase()] = t[2];
                                    t = s[e.toLowerCase()];
                                }
                                return null == t ? null : t;
                            },
                            getAllResponseHeaders: function () {
                                return 2 === _ ? a : null;
                            },
                            setRequestHeader: function (e, t) {
                                var n = e.toLowerCase();
                                return _ || ((e = y[n] = y[n] || e), (b[e] = t)), this;
                            },
                            overrideMimeType: function (e) {
                                return _ || (f.mimeType = e), this;
                            },
                            statusCode: function (e) {
                                var t;
                                if (e)
                                    if (_ < 2) for (t in e) v[t] = [v[t], e[t]];
                                    else x.always(e[x.status]);
                                return this;
                            },
                            abort: function (e) {
                                var t = e || w;
                                return i && i.abort(t), r(0, t), this;
                            },
                        };
                    if (
                        ((g.promise(x).complete = m.add),
                        (x.success = x.done),
                        (x.error = x.fail),
                        (f.url = ((t || f.url || mt.href) + "").replace(yt, "").replace(Ct, mt.protocol + "//")),
                        (f.type = n.method || n.type || f.method || f.type),
                        (f.dataTypes = oe
                            .trim(f.dataType || "*")
                            .toLowerCase()
                            .match(we) || [""]),
                        null == f.crossDomain)
                    ) {
                        c = K.createElement("a");
                        try {
                            (c.href = f.url), (c.href = c.href), (f.crossDomain = It.protocol + "//" + It.host != c.protocol + "//" + c.host);
                        } catch (e) {
                            f.crossDomain = !0;
                        }
                    }
                    if ((f.data && f.processData && "string" != typeof f.data && (f.data = oe.param(f.data, f.traditional)), V(Tt, f, n, x), 2 === _)) return x;
                    (u = oe.event && f.global),
                        u && 0 === oe.active++ && oe.event.trigger("ajaxStart"),
                        (f.type = f.type.toUpperCase()),
                        (f.hasContent = !Et.test(f.type)),
                        (o = f.url),
                        f.hasContent || (f.data && ((o = f.url += (bt.test(o) ? "&" : "?") + f.data), delete f.data), f.cache === !1 && (f.url = _t.test(o) ? o.replace(_t, "$1_=" + vt++) : o + (bt.test(o) ? "&" : "?") + "_=" + vt++)),
                        f.ifModified && (oe.lastModified[o] && x.setRequestHeader("If-Modified-Since", oe.lastModified[o]), oe.etag[o] && x.setRequestHeader("If-None-Match", oe.etag[o])),
                        ((f.data && f.hasContent && f.contentType !== !1) || n.contentType) && x.setRequestHeader("Content-Type", f.contentType),
                        x.setRequestHeader("Accept", f.dataTypes[0] && f.accepts[f.dataTypes[0]] ? f.accepts[f.dataTypes[0]] + ("*" !== f.dataTypes[0] ? ", " + Rt + "; q=0.01" : "") : f.accepts["*"]);
                    for (d in f.headers) x.setRequestHeader(d, f.headers[d]);
                    if (f.beforeSend && (f.beforeSend.call(h, x, f) === !1 || 2 === _)) return x.abort();
                    w = "abort";
                    for (d in { success: 1, error: 1, complete: 1 }) x[d](f[d]);
                    if ((i = V(St, f, n, x))) {
                        if (((x.readyState = 1), u && p.trigger("ajaxSend", [x, f]), 2 === _)) return x;
                        f.async &&
                            f.timeout > 0 &&
                            (l = e.setTimeout(function () {
                                x.abort("timeout");
                            }, f.timeout));
                        try {
                            (_ = 1), i.send(b, r);
                        } catch (e) {
                            if (!(_ < 2)) throw e;
                            r(-1, e);
                        }
                    } else r(-1, "No Transport");
                    return x;
                },
                getJSON: function (e, t, n) {
                    return oe.get(e, t, n, "json");
                },
                getScript: function (e, t) {
                    return oe.get(e, void 0, t, "script");
                },
            }),
            oe.each(["get", "post"], function (e, t) {
                oe[t] = function (e, n, r, i) {
                    return oe.isFunction(n) && ((i = i || r), (r = n), (n = void 0)), oe.ajax(oe.extend({ url: e, type: t, dataType: i, data: n, success: r }, oe.isPlainObject(e) && e));
                };
            }),
            (oe._evalUrl = function (e) {
                return oe.ajax({ url: e, type: "GET", dataType: "script", async: !1, global: !1, throws: !0 });
            }),
            oe.fn.extend({
                wrapAll: function (e) {
                    var t;
                    return oe.isFunction(e)
                        ? this.each(function (t) {
                              oe(this).wrapAll(e.call(this, t));
                          })
                        : (this[0] &&
                              ((t = oe(e, this[0].ownerDocument).eq(0).clone(!0)),
                              this[0].parentNode && t.insertBefore(this[0]),
                              t
                                  .map(function () {
                                      for (var e = this; e.firstElementChild; ) e = e.firstElementChild;
                                      return e;
                                  })
                                  .append(this)),
                          this);
                },
                wrapInner: function (e) {
                    return oe.isFunction(e)
                        ? this.each(function (t) {
                              oe(this).wrapInner(e.call(this, t));
                          })
                        : this.each(function () {
                              var t = oe(this),
                                  n = t.contents();
                              n.length ? n.wrapAll(e) : t.append(e);
                          });
                },
                wrap: function (e) {
                    var t = oe.isFunction(e);
                    return this.each(function (n) {
                        oe(this).wrapAll(t ? e.call(this, n) : e);
                    });
                },
                unwrap: function () {
                    return this.parent()
                        .each(function () {
                            oe.nodeName(this, "body") || oe(this).replaceWith(this.childNodes);
                        })
                        .end();
                },
            }),
            (oe.expr.filters.hidden = function (e) {
                return !oe.expr.filters.visible(e);
            }),
            (oe.expr.filters.visible = function (e) {
                return e.offsetWidth > 0 || e.offsetHeight > 0 || e.getClientRects().length > 0;
            });
        var kt = /%20/g,
            Pt = /\[\]$/,
            Nt = /\r?\n/g,
            Ot = /^(?:submit|button|image|reset|file)$/i,
            At = /^(?:input|select|textarea|keygen)/i;
        (oe.param = function (e, t) {
            var n,
                r = [],
                i = function (e, t) {
                    (t = oe.isFunction(t) ? t() : null == t ? "" : t), (r[r.length] = encodeURIComponent(e) + "=" + encodeURIComponent(t));
                };
            if ((void 0 === t && (t = oe.ajaxSettings && oe.ajaxSettings.traditional), oe.isArray(e) || (e.jquery && !oe.isPlainObject(e))))
                oe.each(e, function () {
                    i(this.name, this.value);
                });
            else for (n in e) q(n, e[n], t, i);
            return r.join("&").replace(kt, "+");
        }),
            oe.fn.extend({
                serialize: function () {
                    return oe.param(this.serializeArray());
                },
                serializeArray: function () {
                    return this.map(function () {
                        var e = oe.prop(this, "elements");
                        return e ? oe.makeArray(e) : this;
                    })
                        .filter(function () {
                            var e = this.type;
                            return this.name && !oe(this).is(":disabled") && At.test(this.nodeName) && !Ot.test(e) && (this.checked || !Ae.test(e));
                        })
                        .map(function (e, t) {
                            var n = oe(this).val();
                            return null == n
                                ? null
                                : oe.isArray(n)
                                ? oe.map(n, function (e) {
                                      return { name: t.name, value: e.replace(Nt, "\r\n") };
                                  })
                                : { name: t.name, value: n.replace(Nt, "\r\n") };
                        })
                        .get();
                },
            }),
            (oe.ajaxSettings.xhr = function () {
                try {
                    return new e.XMLHttpRequest();
                } catch (e) {}
            });
        var Dt = { 0: 200, 1223: 204 },
            Mt = oe.ajaxSettings.xhr();
        (re.cors = !!Mt && "withCredentials" in Mt),
            (re.ajax = Mt = !!Mt),
            oe.ajaxTransport(function (t) {
                var n, r;
                if (re.cors || (Mt && !t.crossDomain))
                    return {
                        send: function (i, o) {
                            var a,
                                s = t.xhr();
                            if ((s.open(t.type, t.url, t.async, t.username, t.password), t.xhrFields)) for (a in t.xhrFields) s[a] = t.xhrFields[a];
                            t.mimeType && s.overrideMimeType && s.overrideMimeType(t.mimeType), t.crossDomain || i["X-Requested-With"] || (i["X-Requested-With"] = "XMLHttpRequest");
                            for (a in i) s.setRequestHeader(a, i[a]);
                            (n = function (e) {
                                return function () {
                                    n &&
                                        ((n = r = s.onload = s.onerror = s.onabort = s.onreadystatechange = null),
                                        "abort" === e
                                            ? s.abort()
                                            : "error" === e
                                            ? "number" != typeof s.status
                                                ? o(0, "error")
                                                : o(s.status, s.statusText)
                                            : o(
                                                  Dt[s.status] || s.status,
                                                  s.statusText,
                                                  "text" !== (s.responseType || "text") || "string" != typeof s.responseText ? { binary: s.response } : { text: s.responseText },
                                                  s.getAllResponseHeaders()
                                              ));
                                };
                            }),
                                (s.onload = n()),
                                (r = s.onerror = n("error")),
                                void 0 !== s.onabort
                                    ? (s.onabort = r)
                                    : (s.onreadystatechange = function () {
                                          4 === s.readyState &&
                                              e.setTimeout(function () {
                                                  n && r();
                                              });
                                      }),
                                (n = n("abort"));
                            try {
                                s.send((t.hasContent && t.data) || null);
                            } catch (e) {
                                if (n) throw e;
                            }
                        },
                        abort: function () {
                            n && n();
                        },
                    };
            }),
            oe.ajaxSetup({
                accepts: { script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript" },
                contents: { script: /\b(?:java|ecma)script\b/ },
                converters: {
                    "text script": function (e) {
                        return oe.globalEval(e), e;
                    },
                },
            }),
            oe.ajaxPrefilter("script", function (e) {
                void 0 === e.cache && (e.cache = !1), e.crossDomain && (e.type = "GET");
            }),
            oe.ajaxTransport("script", function (e) {
                if (e.crossDomain) {
                    var t, n;
                    return {
                        send: function (r, i) {
                            (t = oe("<script>")
                                .prop({ charset: e.scriptCharset, src: e.url })
                                .on(
                                    "load error",
                                    (n = function (e) {
                                        t.remove(), (n = null), e && i("error" === e.type ? 404 : 200, e.type);
                                    })
                                )),
                                K.head.appendChild(t[0]);
                        },
                        abort: function () {
                            n && n();
                        },
                    };
                }
            });
        var Ft = [],
            Lt = /(=)\?(?=&|$)|\?\?/;
        oe.ajaxSetup({
            jsonp: "callback",
            jsonpCallback: function () {
                var e = Ft.pop() || oe.expando + "_" + vt++;
                return (this[e] = !0), e;
            },
        }),
            oe.ajaxPrefilter("json jsonp", function (t, n, r) {
                var i,
                    o,
                    a,
                    s = t.jsonp !== !1 && (Lt.test(t.url) ? "url" : "string" == typeof t.data && 0 === (t.contentType || "").indexOf("application/x-www-form-urlencoded") && Lt.test(t.data) && "data");
                if (s || "jsonp" === t.dataTypes[0])
                    return (
                        (i = t.jsonpCallback = oe.isFunction(t.jsonpCallback) ? t.jsonpCallback() : t.jsonpCallback),
                        s ? (t[s] = t[s].replace(Lt, "$1" + i)) : t.jsonp !== !1 && (t.url += (bt.test(t.url) ? "&" : "?") + t.jsonp + "=" + i),
                        (t.converters["script json"] = function () {
                            return a || oe.error(i + " was not called"), a[0];
                        }),
                        (t.dataTypes[0] = "json"),
                        (o = e[i]),
                        (e[i] = function () {
                            a = arguments;
                        }),
                        r.always(function () {
                            void 0 === o ? oe(e).removeProp(i) : (e[i] = o), t[i] && ((t.jsonpCallback = n.jsonpCallback), Ft.push(i)), a && oe.isFunction(o) && o(a[0]), (a = o = void 0);
                        }),
                        "script"
                    );
            }),
            (oe.parseHTML = function (e, t, n) {
                if (!e || "string" != typeof e) return null;
                "boolean" == typeof t && ((n = t), (t = !1)), (t = t || K);
                var r = pe.exec(e),
                    i = !n && [];
                return r ? [t.createElement(r[1])] : ((r = f([e], t, i)), i && i.length && oe(i).remove(), oe.merge([], r.childNodes));
            });
        var Ut = oe.fn.load;
        (oe.fn.load = function (e, t, n) {
            if ("string" != typeof e && Ut) return Ut.apply(this, arguments);
            var r,
                i,
                o,
                a = this,
                s = e.indexOf(" ");
            return (
                s > -1 && ((r = oe.trim(e.slice(s))), (e = e.slice(0, s))),
                oe.isFunction(t) ? ((n = t), (t = void 0)) : t && "object" == typeof t && (i = "POST"),
                a.length > 0 &&
                    oe
                        .ajax({ url: e, type: i || "GET", dataType: "html", data: t })
                        .done(function (e) {
                            (o = arguments), a.html(r ? oe("<div>").append(oe.parseHTML(e)).find(r) : e);
                        })
                        .always(
                            n &&
                                function (e, t) {
                                    a.each(function () {
                                        n.apply(this, o || [e.responseText, t, e]);
                                    });
                                }
                        ),
                this
            );
        }),
            oe.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function (e, t) {
                oe.fn[t] = function (e) {
                    return this.on(t, e);
                };
            }),
            (oe.expr.filters.animated = function (e) {
                return oe.grep(oe.timers, function (t) {
                    return e === t.elem;
                }).length;
            }),
            (oe.offset = {
                setOffset: function (e, t, n) {
                    var r,
                        i,
                        o,
                        a,
                        s,
                        l,
                        c,
                        u = oe.css(e, "position"),
                        d = oe(e),
                        f = {};
                    "static" === u && (e.style.position = "relative"),
                        (s = d.offset()),
                        (o = oe.css(e, "top")),
                        (l = oe.css(e, "left")),
                        (c = ("absolute" === u || "fixed" === u) && (o + l).indexOf("auto") > -1),
                        c ? ((r = d.position()), (a = r.top), (i = r.left)) : ((a = parseFloat(o) || 0), (i = parseFloat(l) || 0)),
                        oe.isFunction(t) && (t = t.call(e, n, oe.extend({}, s))),
                        null != t.top && (f.top = t.top - s.top + a),
                        null != t.left && (f.left = t.left - s.left + i),
                        "using" in t ? t.using.call(e, f) : d.css(f);
                },
            }),
            oe.fn.extend({
                offset: function (e) {
                    if (arguments.length)
                        return void 0 === e
                            ? this
                            : this.each(function (t) {
                                  oe.offset.setOffset(this, e, t);
                              });
                    var t,
                        n,
                        r = this[0],
                        i = { top: 0, left: 0 },
                        o = r && r.ownerDocument;
                    if (o) return (t = o.documentElement), oe.contains(t, r) ? ((i = r.getBoundingClientRect()), (n = G(o)), { top: i.top + n.pageYOffset - t.clientTop, left: i.left + n.pageXOffset - t.clientLeft }) : i;
                },
                position: function () {
                    if (this[0]) {
                        var e,
                            t,
                            n = this[0],
                            r = { top: 0, left: 0 };
                        return (
                            "fixed" === oe.css(n, "position")
                                ? (t = n.getBoundingClientRect())
                                : ((e = this.offsetParent()), (t = this.offset()), oe.nodeName(e[0], "html") || (r = e.offset()), (r.top += oe.css(e[0], "borderTopWidth", !0)), (r.left += oe.css(e[0], "borderLeftWidth", !0))),
                            { top: t.top - r.top - oe.css(n, "marginTop", !0), left: t.left - r.left - oe.css(n, "marginLeft", !0) }
                        );
                    }
                },
                offsetParent: function () {
                    return this.map(function () {
                        for (var e = this.offsetParent; e && "static" === oe.css(e, "position"); ) e = e.offsetParent;
                        return e || Ye;
                    });
                },
            }),
            oe.each({ scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function (e, t) {
                var n = "pageYOffset" === t;
                oe.fn[e] = function (r) {
                    return Ee(
                        this,
                        function (e, r, i) {
                            var o = G(e);
                            return void 0 === i ? (o ? o[t] : e[r]) : void (o ? o.scrollTo(n ? o.pageXOffset : i, n ? i : o.pageYOffset) : (e[r] = i));
                        },
                        e,
                        r,
                        arguments.length
                    );
                };
            }),
            oe.each(["top", "left"], function (e, t) {
                oe.cssHooks[t] = R(re.pixelPosition, function (e, n) {
                    if (n) return (n = S(e, t)), Ke.test(n) ? oe(e).position()[t] + "px" : n;
                });
            }),
            oe.each({ Height: "height", Width: "width" }, function (e, t) {
                oe.each({ padding: "inner" + e, content: t, "": "outer" + e }, function (n, r) {
                    oe.fn[r] = function (r, i) {
                        var o = arguments.length && (n || "boolean" != typeof r),
                            a = n || (r === !0 || i === !0 ? "margin" : "border");
                        return Ee(
                            this,
                            function (t, n, r) {
                                var i;
                                return oe.isWindow(t)
                                    ? t.document.documentElement["client" + e]
                                    : 9 === t.nodeType
                                    ? ((i = t.documentElement), Math.max(t.body["scroll" + e], i["scroll" + e], t.body["offset" + e], i["offset" + e], i["client" + e]))
                                    : void 0 === r
                                    ? oe.css(t, n, a)
                                    : oe.style(t, n, r, a);
                            },
                            t,
                            o ? r : void 0,
                            o,
                            null
                        );
                    };
                });
            }),
            oe.fn.extend({
                bind: function (e, t, n) {
                    return this.on(e, null, t, n);
                },
                unbind: function (e, t) {
                    return this.off(e, null, t);
                },
                delegate: function (e, t, n, r) {
                    return this.on(t, e, n, r);
                },
                undelegate: function (e, t, n) {
                    return 1 === arguments.length ? this.off(e, "**") : this.off(t, e || "**", n);
                },
                size: function () {
                    return this.length;
                },
            }),
            (oe.fn.andSelf = oe.fn.addBack),
            "function" == typeof define &&
                define.amd &&
                define("jquery", [], function () {
                    return oe;
                });
        var Bt = e.jQuery,
            jt = e.$;
        return (
            (oe.noConflict = function (t) {
                return e.$ === oe && (e.$ = jt), t && e.jQuery === oe && (e.jQuery = Bt), oe;
            }),
            t || (e.jQuery = e.$ = oe),
            oe
        );
    }),
    (function (e) {
        var t = {
            NodeTypeError: function (e, t) {
                function n() {
                    this.node = e;
                }
                return (n.prototype = new Error(t)), (n.constructor = n), new n();
            },
            OutOfRangeError: function (e, t, n) {
                function r() {
                    (this.targetIndex = e), (this.maxIndex = t);
                }
                return (r.prototype = new Error(n)), (r.constructor = r()), new r();
            },
            TerminusError: function (e, t, n) {
                function r() {
                    (this.terminusType = e), (this.terminusCondition = t);
                }
                return (r.prototype = new Error(n)), (r.constructor = r()), new r();
            },
            CFIAssertionError: function (e, t, n) {
                function r() {
                    (this.expectedAssertion = e), (this.targetElementAssertion = t);
                }
                return (r.prototype = new Error(n)), (r.constructor = r()), new r();
            },
        };
        if ("function" == typeof define && "object" == typeof define.amd)
            console.log("RequireJS ... cfi_errors"),
                define("readium_cfi_js/cfi_runtime_errors", [], function () {
                    return t;
                });
        else {
            if ((console.log("!RequireJS ... cfi_errors"), !e.EPUBcfi)) throw new Error("EPUBcfi not initialised on global object?! (window or this context)");
            (e.EPUBcfi.NodeTypeError = t.NodeTypeError), (e.EPUBcfi.OutOfRangeError = t.OutOfRangeError), (e.EPUBcfi.TerminusError = t.TerminusError), (e.EPUBcfi.CFIAssertionError = t.CFIAssertionError);
        }
    })("undefined" != typeof window ? window : this),
    (function (e) {
        var t = function (e, t) {
            var n = {
                getNextNode: function (e, t, n, r, i) {
                    var o;
                    return (o = e % 2 == 0 ? this.elementNodeStep(e, t, n, r, i) : this.inferTargetTextNode(e, t, n, r, i));
                },
                followIndirectionStep: function (n, r, i, o, a) {
                    var s, l, c, u;
                    if (void 0 === r || !r.is("iframe")) throw t.NodeTypeError(r, "expected an iframe element");
                    if (r.is("iframe")) return (s = r.contents()), (l = this.applyBlacklist(s.children(), i, o, a)), (c = e(l[0])), (u = this.getNextNode(n, c, i, o, a));
                },
                textTermination: function (e, n, r) {
                    var i;
                    if (void 0 === e) throw t.NodeTypeError(e, "expected a terminating node, or node list");
                    if (0 === e.length) throw t.TerminusError("Text", "Text offset:" + n, "no nodes found for termination condition");
                    return (i = this.injectCFIMarkerIntoText(e, n, r));
                },
                targetIdMatchesIdAssertion: function (e, t) {
                    return e.attr("id") === t;
                },
                elementNodeStep: function (n, r, i, o, a) {
                    var s,
                        l,
                        c,
                        u = n / 2 - 1;
                    if (((l = this.applyBlacklist(r.children(), i, o, a)), (c = l.length), this.indexOutOfRange(u, c))) throw t.OutOfRangeError(u, c - 1, "");
                    return (s = e(l[u]));
                },
                retrieveItemRefHref: function (t, n) {
                    return e("#" + t.attr("idref"), n).attr("href");
                },
                indexOutOfRange: function (e, t) {
                    return e > t - 1;
                },
                injectCFIMarkerIntoText: function (n, r, i) {
                    var o,
                        a,
                        s,
                        l,
                        c,
                        u = n[0].ownerDocument,
                        d = 0;
                    for (o = 0; o <= n.length; o++)
                        if (n[o].nodeType === Node.TEXT_NODE) {
                            if (((currNodeMaxIndex = n[o].nodeValue.length + d), (a = r - d), currNodeMaxIndex > r))
                                return (s = n[o].nodeValue), (n[o].nodeValue = s.slice(0, a)), (l = e(i).insertAfter(n.eq(o))), (c = e(u.createTextNode(s.slice(a, s.length)))), e(c).insertAfter(l), l;
                            if (currNodeMaxIndex == r) return (l = e(i).insertAfter(n.eq(o)));
                            d = currNodeMaxIndex;
                        } else
                            n[o].nodeType === Node.COMMENT_NODE
                                ? ((currNodeMaxIndex = n[o].nodeValue.length + 7 + d), (d = currNodeMaxIndex))
                                : n[o].nodeType === Node.PROCESSING_INSTRUCTION_NODE && ((currNodeMaxIndex = n[o].nodeValue.length + n[o].target.length + 5), (d = currNodeMaxIndex));
                    throw t.TerminusError("Text", "Text offset:" + r, "The offset exceeded the length of the text");
                },
                inferTargetTextNode: function (e, n, r, i, o) {
                    var a, s, l, c, u;
                    if (
                        ((a = this.applyBlacklist(n.contents(), r, i, o)),
                        (l = (parseInt(e) + 1) / 2 - 1),
                        (s = 0),
                        (u = !1),
                        (c = a.filter(function () {
                            return s !== l
                                ? (this.nodeType === Node.TEXT_NODE || this.nodeType === Node.COMMENT_NODE || this.nodeType === Node.PROCESSING_INSTRUCTION_NODE
                                      ? (u = !0)
                                      : u || this.nodeType !== Node.ELEMENT_NODE
                                      ? u && this.nodeType !== Node.TEXT_NODE && this !== a.lastChild && (s++, (u = !1))
                                      : (s++, (u = !0)),
                                  !1)
                                : this.nodeType === Node.TEXT_NODE || this.nodeType === Node.COMMENT_NODE || this.nodeType === Node.PROCESSING_INSTRUCTION_NODE
                                ? ((u = !0), !0)
                                : u && this.nodeType !== Node.TEXT_NODE
                                ? (s++, (u = !1), !1)
                                : void 0;
                        })),
                        0 === c.length)
                    )
                        throw t.OutOfRangeError(l, s, "Index out of range");
                    return c;
                },
                applyBlacklist: function (t, n, r, i) {
                    var o;
                    return (o = t.filter(function () {
                        var t = e(this),
                            o = !0;
                        return (
                            n &&
                                e.each(n, function (e, n) {
                                    if (t.hasClass(n)) return (o = !1), !1;
                                }),
                            r &&
                                e.each(r, function (e, n) {
                                    if (t.is(n)) return (o = !1), !1;
                                }),
                            i &&
                                e.each(i, function (e, n) {
                                    if (t.attr("id") === n) return (o = !1), !1;
                                }),
                            o
                        );
                    }));
                },
            };
            return n;
        };
        if ("function" == typeof define && "object" == typeof define.amd)
            console.log("RequireJS ... cfi_instructions"),
                define("readium_cfi_js/cfi_instructions", ["jquery", "./cfi_runtime_errors"], function (e, n) {
                    return t(e, n);
                });
        else {
            if ((console.log("!RequireJS ... cfi_instructions"), !e.EPUBcfi)) throw new Error("EPUBcfi not initialised on global object?! (window or this context)");
            e.EPUBcfi.CFIInstructions = t($, { NodeTypeError: e.EPUBcfi.NodeTypeError, OutOfRangeError: e.EPUBcfi.OutOfRangeError, TerminusError: e.EPUBcfi.TerminusError, CFIAssertionError: e.EPUBcfi.CFIAssertionError });
        }
    })("undefined" != typeof window ? window : this),
    (function (e) {
        var t = function (e, t, n, r) {
            if ("undefined" == typeof t) throw new Error("UNDEFINED?! cfiParser");
            if ("undefined" == typeof n) throw new Error("UNDEFINED?! cfiInstructions");
            if ("undefined" == typeof r) throw new Error("UNDEFINED?! cfiRuntimeErrors");
            var i = {
                getContentDocHref: function (n, i, o, a, s) {
                    var l = e(i),
                        c = decodeURI(n),
                        u = t.parse(c);
                    if (!u || "CFIAST" !== u.type) throw r.NodeTypeError(u, "expected CFI AST root node");
                    var d = e(e("package", l)[0]),
                        f = this.interpretIndexStepNode(u.cfiString.path, d, o, a, s);
                    return (foundHref = this.searchLocalPathForHref(f, l, u.cfiString.localPath, o, a, s)), foundHref ? foundHref : void 0;
                },
                injectElement: function (n, r, i, o, a, s) {
                    var l,
                        c,
                        u,
                        d = decodeURI(n),
                        f = t.parse(d);
                    return (
                        (c = this.getFirstIndirectionStepNum(f)),
                        (l = f.cfiString.localPath.steps[c]),
                        (l.type = "indexStep"),
                        (u = this.interpretLocalPath(f.cfiString.localPath, c, e(r.documentElement, r), o, a, s)),
                        (u = this.interpretTextTerminusNode(f.cfiString.localPath.termStep, u, i))
                    );
                },
                injectRangeElements: function (n, r, i, o, a, s, l) {
                    var c,
                        u,
                        d,
                        f,
                        h,
                        p = decodeURI(n),
                        g = t.parse(p);
                    return (
                        (u = this.getFirstIndirectionStepNum(g)),
                        (c = g.cfiString.localPath.steps[u]),
                        (c.type = "indexStep"),
                        (d = this.interpretLocalPath(g.cfiString.localPath, u, e(r.documentElement, r), a, s, l)),
                        (f = this.interpretLocalPath(g.cfiString.range1, 0, d, a, s, l)),
                        (f = this.interpretTextTerminusNode(g.cfiString.range1.termStep, f, i)),
                        (h = this.interpretLocalPath(g.cfiString.range2, 0, d, a, s, l)),
                        (h = this.interpretTextTerminusNode(g.cfiString.range2.termStep, h, o)),
                        { startElement: f[0], endElement: h[0] }
                    );
                },
                getTargetElement: function (n, r, i, o, a) {
                    var s,
                        l,
                        c,
                        u = decodeURI(n),
                        d = t.parse(u);
                    return (l = this.getFirstIndirectionStepNum(d)), (s = d.cfiString.localPath.steps[l]), (s.type = "indexStep"), (c = this.interpretLocalPath(d.cfiString.localPath, l, e(r.documentElement, r), i, o, a));
                },
                getRangeTargetElements: function (n, r, i, o, a) {
                    var s,
                        l,
                        c,
                        u,
                        d,
                        f = decodeURI(n),
                        h = t.parse(f);
                    (l = this.getFirstIndirectionStepNum(h)),
                        (s = h.cfiString.localPath.steps[l]),
                        (s.type = "indexStep"),
                        (c = this.interpretLocalPath(h.cfiString.localPath, l, e(r.documentElement, r), i, o, a)),
                        (u = this.interpretLocalPath(h.cfiString.range1, 0, c, i, o, a)),
                        (d = this.interpretLocalPath(h.cfiString.range2, 0, c, i, o, a));
                    var p = parseInt(h.cfiString.range1.termStep.offsetValue) || void 0,
                        g = parseInt(h.cfiString.range2.termStep.offsetValue) || void 0;
                    return { startElement: u[0], startOffset: p, endElement: d[0], endOffset: g };
                },
                getTargetElementWithPartialCFI: function (n, r, i, o, a) {
                    var s = decodeURI(n),
                        l = t.parse(s),
                        c = this.interpretIndexStepNode(l.cfiString.path, e(r.documentElement, r), i, o, a);
                    return (c = this.interpretLocalPath(l.cfiString.localPath, 0, c, i, o, a));
                },
                getTextTerminusInfoWithPartialCFI: function (n, r, i, o, a) {
                    var s,
                        l = decodeURI(n),
                        c = t.parse(l),
                        u = this.interpretIndexStepNode(c.cfiString.path, e(r.documentElement, r), i, o, a);
                    return (u = this.interpretLocalPath(c.cfiString.localPath, 0, u, i, o, a)), (s = parseInt(c.cfiString.localPath.termStep.offsetValue)), { textNode: u[0], textOffset: s };
                },
                getTextTerminusInfo: function (n, r, i, o, a) {
                    var s,
                        l,
                        c,
                        u,
                        d = decodeURI(n),
                        f = t.parse(d);
                    return (
                        (l = this.getFirstIndirectionStepNum(f)),
                        (s = f.cfiString.localPath.steps[l]),
                        (s.type = "indexStep"),
                        (c = this.interpretLocalPath(f.cfiString.localPath, l, e(r.documentElement, r), i, o, a)),
                        (u = parseInt(f.cfiString.localPath.termStep.offsetValue)),
                        { textNode: c[0], textOffset: u }
                    );
                },
                isRangeCfi: function (e) {
                    var n = t.parse(e);
                    return !!n.cfiString.range1;
                },
                hasTextTerminus: function (e) {
                    var n = t.parse(e);
                    return !!n.cfiString.localPath.termStep;
                },
                getFirstIndirectionStepNum: function (e) {
                    var t = 0;
                    for (t; t <= e.cfiString.localPath.steps.length - 1; t++) if (((nextStepNode = e.cfiString.localPath.steps[t]), "indirectionStep" === nextStepNode.type)) return t;
                },
                interpretLocalPath: function (e, t, n, r, i, o) {
                    var a,
                        s = t;
                    for (s; s <= e.steps.length - 1; s++) (a = e.steps[s]), "indexStep" === a.type ? (n = this.interpretIndexStepNode(a, n, r, i, o)) : "indirectionStep" === a.type && (n = this.interpretIndirectionStepNode(a, n, r, i, o));
                    return n;
                },
                interpretIndexStepNode: function (e, t, i, o, a) {
                    if (void 0 === e || "indexStep" !== e.type) throw r.NodeTypeError(e, "expected index step node");
                    var s = n.getNextNode(e.stepLength, t, i, o, a);
                    if (e.idAssertion && !n.targetIdMatchesIdAssertion(s, e.idAssertion)) throw r.CFIAssertionError(e.idAssertion, s.attr("id"), "Id assertion failed");
                    return s;
                },
                interpretIndirectionStepNode: function (e, t, i, o, a) {
                    if (void 0 === e || "indirectionStep" !== e.type) throw r.NodeTypeError(e, "expected indirection step node");
                    var s = n.followIndirectionStep(e.stepLength, t, i, o);
                    if (e.idAssertion && !n.targetIdMatchesIdAssertion(s, e.idAssertion)) throw r.CFIAssertionError(e.idAssertion, s.attr("id"), "Id assertion failed");
                    return s;
                },
                interpretTextTerminusNode: function (e, t, i) {
                    if (void 0 === e || "textTerminus" !== e.type) throw r.NodeTypeError(e, "expected text terminus node");
                    var o = n.textTermination(t, e.offsetValue, i);
                    return o;
                },
                searchLocalPathForHref: function (e, t, r, i, o, a) {
                    var s,
                        l = 0;
                    for (l = 0; l <= r.steps.length - 1; l++)
                        if (((s = r.steps[l]), "indexStep" === s.type ? (e = this.interpretIndexStepNode(s, e, i, o, a)) : "indirectionStep" === s.type && (e = this.interpretIndirectionStepNode(s, e, i, o, a)), e.is("itemref")))
                            return n.retrieveItemRefHref(e, t);
                },
            };
            return i;
        };
        if ("function" == typeof define && "object" == typeof define.amd)
            console.log("RequireJS ... cfi_interpreter"),
                define("readium_cfi_js/cfi_interpreter", ["jquery", "readium_cfi_js/cfi_parser", "./cfi_instructions", "./cfi_runtime_errors"], function (e, n, r, i) {
                    return t(e, n, r, i);
                });
        else {
            if ((console.log("!RequireJS ... cfi_interpreter"), !e.EPUBcfi)) throw new Error("EPUBcfi not initialised on global object?! (window or this context)");
            e.EPUBcfi.Interpreter = t($, e.EPUBcfi.Parser, e.EPUBcfi.CFIInstructions, {
                NodeTypeError: e.EPUBcfi.NodeTypeError,
                OutOfRangeError: e.EPUBcfi.OutOfRangeError,
                TerminusError: e.EPUBcfi.TerminusError,
                CFIAssertionError: e.EPUBcfi.CFIAssertionError,
            });
        }
    })("undefined" != typeof window ? window : this),
    (function (e) {
        var t = function (e, t, n) {
            if ("undefined" == typeof t) throw new Error("UNDEFINED?! cfiInstructions");
            if ("undefined" == typeof n) throw new Error("UNDEFINED?! cfiRuntimeErrors");
            var r = {
                generateCharOffsetRangeComponent: function (t, n, r, i, o, a, s) {
                    var l,
                        c,
                        u,
                        d,
                        f,
                        h,
                        p,
                        g,
                        m,
                        v = t.ownerDocument;
                    return (
                        this.validateStartTextNode(t),
                        this.validateStartTextNode(r),
                        e(t).parent()[0] === e(r).parent()[0]
                            ? ((f = this.createCFITextNodeStep(e(t), n, o, a, s)),
                              (p = this.createCFITextNodeStep(e(r), i, o, a, s)),
                              (m = this.createCFIElementSteps(e(t).parent(), "html", o, a, s)),
                              m.substring(1, m.length) + "," + f + "," + p)
                            : ((l = v.createRange()),
                              l.setStart(t, n),
                              l.setEnd(r, i),
                              (c = l.commonAncestorContainer),
                              (f = this.createCFITextNodeStep(e(t), n, o, a, s)),
                              (u = e(t).parent()),
                              (h = u[0] === c ? f : this.createCFIElementSteps(u, c, o, a, s) + f),
                              (p = this.createCFITextNodeStep(e(r), i, o, a, s)),
                              (d = e(r).parent()),
                              (g = d[0] === c ? p : this.createCFIElementSteps(d, c, o, a, s) + p),
                              (m = this.createCFIElementSteps(e(c), "html", o, a, s)),
                              m.substring(1, m.length) + "," + h + "," + g)
                    );
                },
                generateElementRangeComponent: function (t, n, r, i, o) {
                    var a,
                        s,
                        l,
                        c,
                        u,
                        d = t.ownerDocument;
                    if ((this.validateStartElement(t), this.validateStartElement(n), t === n)) throw new Error("Start and end element cannot be the same for a CFI range");
                    return (
                        (a = d.createRange()),
                        a.setStart(t, 0),
                        a.setEnd(n, n.childNodes.length),
                        (s = a.commonAncestorContainer),
                        (l = this.createCFIElementSteps(e(t), s, r, i, o)),
                        (c = this.createCFIElementSteps(e(n), s, r, i, o)),
                        (u = this.createCFIElementSteps(e(s), "html", r, i, o)),
                        u.substring(1, u.length) + "," + l + "," + c
                    );
                },
                generateRangeComponent: function (t, n, r, i, o, a, s) {
                    var l = t.ownerDocument;
                    if (t.nodeType === Node.ELEMENT_NODE && r.nodeType === Node.ELEMENT_NODE) return this.generateElementRangeComponent(t, r, o, a, s);
                    if (t.nodeType === Node.TEXT_NODE && r.nodeType === Node.TEXT_NODE) return this.generateCharOffsetRangeComponent(t, n, r, i, o, a, s);
                    var c, u, d, f, h, p, g;
                    return (
                        (c = l.createRange()),
                        c.setStart(t, n),
                        c.setEnd(r, i),
                        (p = c.commonAncestorContainer),
                        t.nodeType === Node.ELEMENT_NODE
                            ? (this.validateStartElement(t), (u = this.createCFIElementSteps(e(t), p, o, a, s)))
                            : (this.validateStartTextNode(t), (d = this.createCFITextNodeStep(e(t), n, o, a, s)), (u = e(t).parent().is(p) ? d : this.createCFIElementSteps(e(t).parent(), p, o, a, s) + d)),
                        r.nodeType === Node.ELEMENT_NODE
                            ? (this.validateStartElement(r), (f = this.createCFIElementSteps(e(r), p, o, a, s)))
                            : (this.validateStartTextNode(r), (h = this.createCFITextNodeStep(e(r), i, o, a, s)), (f = e(r).parent().is(p) ? h : this.createCFIElementSteps(e(r).parent(), p, o, a, s) + h)),
                        (g = this.createCFIElementSteps(e(p), "html", o, a, s)),
                        g.substring(1, g.length) + "," + u + "," + f
                    );
                },
                generateCharacterOffsetCFIComponent: function (t, n, r, i, o) {
                    var a, s;
                    return this.validateStartTextNode(t, n), (a = this.createCFITextNodeStep(e(t), n, r, i, o)), (s = this.createCFIElementSteps(e(t).parent(), "html", r, i, o) + a), s.substring(1, s.length);
                },
                generateElementCFIComponent: function (t, n, r, i) {
                    var o;
                    return this.validateStartElement(t), (o = this.createCFIElementSteps(e(t), "html", n, r, i)), o.substring(1, o.length);
                },
                generatePackageDocumentCFIComponent: function (t, n, r, i, o) {
                    return (
                        this.validateContentDocumentName(t),
                        this.validatePackageDocument(n, t),
                        ($itemRefStartNode = e("itemref[idref='" + t + "']", e(n))),
                        (packageDocCFIComponent = this.createCFIElementSteps($itemRefStartNode, "package", r, i, o)),
                        packageDocCFIComponent + "!"
                    );
                },
                generatePackageDocumentCFIComponentWithSpineIndex: function (t, n, r, i, o) {
                    return ($itemRefStartNode = e(e("spine", n).children()[t])), (packageDocCFIComponent = this.createCFIElementSteps($itemRefStartNode, "package", r, i, o)), packageDocCFIComponent + "!";
                },
                generateCompleteCFI: function (e, t) {
                    return "epubcfi(" + e + t + ")";
                },
                validateStartTextNode: function (e, t) {
                    if (!e) throw new n.NodeTypeError(e, "Cannot generate a character offset from a starting point that is not a text node");
                    if (3 != e.nodeType) throw new n.NodeTypeError(e, "Cannot generate a character offset from a starting point that is not a text node");
                    if (t < 0) throw new n.OutOfRangeError(t, 0, "Character offset cannot be less than 0");
                    if (t > e.nodeValue.length) throw new n.OutOfRangeError(t, e.nodeValue.length - 1, "character offset cannot be greater than the length of the text node");
                },
                validateStartElement: function (e) {
                    if (!e) throw new n.NodeTypeError(e, "CFI target element is undefined");
                    if (!e.nodeType || 1 !== e.nodeType) throw new n.NodeTypeError(e, "CFI target element is not an HTML element");
                },
                validateContentDocumentName: function (e) {
                    if (!e) throw new Error("The idref for the content document, as found in the spine, must be supplied");
                },
                validatePackageDocument: function (t, n) {
                    if (!t) throw new Error("A package document must be supplied to generate a CFI");
                    if (0 === e(e("itemref[idref='" + n + "']", t)[0]).length) throw new Error("The idref of the content document could not be found in the spine");
                },
                createCFITextNodeStep: function (n, r, i, o, a) {
                    var s, l, c, u;
                    (s = n.parent()), (l = t.applyBlacklist(s.contents(), i, o, a));
                    var d,
                        f,
                        h = 0,
                        p = 0,
                        g = 0;
                    return (
                        e.each(l, function (e) {
                            if (this.nodeType !== Node.TEXT_NODE && d)
                                this.nodeType === Node.ELEMENT_NODE
                                    ? ((d = !1), (f = void 0), (p = 0))
                                    : this.nodeType === Node.COMMENT_NODE
                                    ? (p = p + this.length + 7)
                                    : this.nodeType === Node.PROCESSING_INSTRUCTION_NODE && (p = p + this.data.length + this.target.length + 5);
                            else if (this.nodeType === Node.TEXT_NODE) {
                                if (this === n[0]) return d ? ((u = f), (g = p)) : (u = h), !1;
                                (d = !0), (p += this.length), void 0 === f && ((f = h), (h += 1));
                            } else
                                this.nodeType === Node.ELEMENT_NODE
                                    ? (h += 1)
                                    : this.nodeType === Node.COMMENT_NODE
                                    ? ((d = !0), (p = p + this.length + 7), void 0 === f && (f = h))
                                    : this.nodeType === Node.PROCESSING_INSTRUCTION_NODE && ((d = !0), (p = p + this.data.length + this.target.length + 5), void 0 === f && (f = h));
                        }),
                        (c = 2 * u + 1),
                        "/" + c + ":" + (g + r)
                    );
                },
                createCFIElementSteps: function (n, r, i, o, a) {
                    var s, l, c, u, d;
                    return n[0] === r
                        ? ""
                        : ((s = t.applyBlacklist(n.parent().children(), i, o, a)),
                          e.each(s, function (e, t) {
                              if (this === n[0]) return (c = e), !1;
                          }),
                          (u = 2 * (c + 1)),
                          (d = n.attr("id") ? "/" + u + "[" + n.attr("id") + "]" : "/" + u),
                          (l = n.parent()),
                          l.is(r) || n.is(r) ? ("html" === r ? "!" + d : d) : this.createCFIElementSteps(l, r, i, o, a) + d);
                },
            };
            return r;
        };
        if ("function" == typeof define && "object" == typeof define.amd)
            console.log("RequireJS ... cfi_generator"),
                define("readium_cfi_js/cfi_generator", ["jquery", "./cfi_instructions", "./cfi_runtime_errors"], function (e, n, r) {
                    return t(e, n, r);
                });
        else {
            if ((console.log("!RequireJS ... cfi_generator"), !e.EPUBcfi)) throw new Error("EPUBcfi not initialised on global object?! (window or this context)");
            e.EPUBcfi.Generator = t($, e.EPUBcfi.CFIInstructions, {
                NodeTypeError: e.EPUBcfi.NodeTypeError,
                OutOfRangeError: e.EPUBcfi.OutOfRangeError,
                TerminusError: e.EPUBcfi.TerminusError,
                CFIAssertionError: e.EPUBcfi.CFIAssertionError,
            });
        }
    })("undefined" != typeof window ? window : this),
    (function (e) {
        var t = function (t, n, r, i, o) {
            if ("undefined" == typeof t) throw new Error("UNDEFINED?! cfiParser");
            if ("undefined" == typeof n) throw new Error("UNDEFINED?! cfiInterpreter");
            if ("undefined" == typeof r) throw new Error("UNDEFINED?! cfiInstructions");
            if ("undefined" == typeof i) throw new Error("UNDEFINED?! cfiRuntimeErrors");
            if ("undefined" == typeof o) throw new Error("UNDEFINED?! cfiGenerator");
            var a = {
                getContentDocHref: function (e, t) {
                    return n.getContentDocHref(e, t);
                },
                injectElement: function (e, t, r, i, o, a) {
                    return n.injectElement(e, t, r, i, o, a);
                },
                getTargetElement: function (e, t, r, i, o) {
                    return n.getTargetElement(e, t, r, i, o);
                },
                getTargetElementWithPartialCFI: function (e, t, r, i, o) {
                    return n.getTargetElementWithPartialCFI(e, t, r, i, o);
                },
                injectRangeElements: function (e, t, r, i, o, a, s) {
                    return n.injectRangeElements(e, t, r, i, o, a, s);
                },
                getRangeTargetElements: function (e, t, r, i, o) {
                    return n.getRangeTargetElements(e, t, r, i, o);
                },
                isRangeCfi: function (e) {
                    return n.isRangeCfi(e);
                },
                hasTextTerminus: function (e) {
                    return n.hasTextTerminus(e);
                },
                getTextTerminusInfo: function (e, t, r, i, o) {
                    return n.getTextTerminusInfo(e, t, r, i, o);
                },
                getTextTerminusInfoWithPartialCFI: function (e, t, r, i, o) {
                    return n.getTextTerminusInfoWithPartialCFI(e, t, r, i, o);
                },
                generateCharacterOffsetCFIComponent: function (e, t, n, r, i) {
                    return o.generateCharacterOffsetCFIComponent(e, t, n, r, i);
                },
                generateElementCFIComponent: function (e, t, n, r) {
                    return o.generateElementCFIComponent(e, t, n, r);
                },
                generatePackageDocumentCFIComponent: function (e, t, n, r, i) {
                    return o.generatePackageDocumentCFIComponent(e, t, n, r, i);
                },
                generatePackageDocumentCFIComponentWithSpineIndex: function (e, t, n, r, i) {
                    return o.generatePackageDocumentCFIComponentWithSpineIndex(e, t, n, r, i);
                },
                generateCompleteCFI: function (e, t) {
                    return o.generateCompleteCFI(e, t);
                },
                generateCharOffsetRangeComponent: function (e, t, n, r, i, a, s) {
                    return o.generateCharOffsetRangeComponent(e, t, n, r, i, a, s);
                },
                generateElementRangeComponent: function (e, t, n, r, i) {
                    return o.generateElementRangeComponent(e, t, n, r, i);
                },
                generateRangeComponent: function (e, t, n, r, i, a, s) {
                    return o.generateRangeComponent(e, t, n, r, i, a, s);
                },
                injectElementAtOffset: function (e, t, n) {
                    return r.injectCFIMarkerIntoText(e, t, n);
                },
            };
            return (
                (a.CFIInstructions = r),
                (a.Parser = t),
                (a.Interpreter = n),
                (a.Generator = o),
                (a.NodeTypeError = i.NodeTypeError),
                (a.OutOfRangeError = i.OutOfRangeError),
                (a.TerminusError = i.TerminusError),
                (a.CFIAssertionError = i.CFIAssertionError),
                (e.EPUBcfi = a),
                console.log("#######################################"),
                a
            );
        };
        if ("function" == typeof define && "object" == typeof define.amd)
            console.log("RequireJS ... cfi_API"),
                define("readium_cfi_js/cfi_API", ["readium_cfi_js/cfi_parser", "./cfi_interpreter", "./cfi_instructions", "./cfi_runtime_errors", "./cfi_generator"], function (e, n, r, i, o) {
                    return t(e, n, r, i, o);
                });
        else {
            if ((console.log("!RequireJS ... cfi_API"), !e.EPUBcfi)) throw new Error("EPUBcfi not initialised on global object?! (window or this context)");
            t(
                e.EPUBcfi.Parser,
                e.EPUBcfi.Interpreter,
                e.EPUBcfi.CFIInstructions,
                { NodeTypeError: e.EPUBcfi.NodeTypeError, OutOfRangeError: e.EPUBcfi.OutOfRangeError, TerminusError: e.EPUBcfi.TerminusError, CFIAssertionError: e.EPUBcfi.CFIAssertionError },
                e.EPUBcfi.Generator
            );
        }
    })("undefined" != typeof window ? window : this),
    define("readium_cfi_js", ["readium_cfi_js/cfi_API"], function (e) {
        return e;
    }),
    function () {
        function e(e) {
            function t(t, n, r, i, o, a) {
                for (; o >= 0 && o < a; o += e) {
                    var s = i ? i[o] : o;
                    r = n(r, t[s], s, t);
                }
                return r;
            }
            return function (n, r, i, o) {
                r = y(r, o, 4);
                var a = !S(n) && b.keys(n),
                    s = (a || n).length,
                    l = e > 0 ? 0 : s - 1;
                return arguments.length < 3 && ((i = n[a ? a[l] : l]), (l += e)), t(n, r, i, a, l, s);
            };
        }
        function t(e) {
            return function (t, n, r) {
                n = _(n, r);
                for (var i = T(t), o = e > 0 ? 0 : i - 1; o >= 0 && o < i; o += e) if (n(t[o], o, t)) return o;
                return -1;
            };
        }
        function n(e, t, n) {
            return function (r, i, o) {
                var a = 0,
                    s = T(r);
                if ("number" == typeof o) e > 0 ? (a = o >= 0 ? o : Math.max(o + s, a)) : (s = o >= 0 ? Math.min(o + 1, s) : o + s + 1);
                else if (n && o && s) return (o = n(r, i)), r[o] === i ? o : -1;
                if (i !== i) return (o = t(u.call(r, a, s), b.isNaN)), o >= 0 ? o + a : -1;
                for (o = e > 0 ? a : s - 1; o >= 0 && o < s; o += e) if (r[o] === i) return o;
                return -1;
            };
        }
        function r(e, t) {
            var n = N.length,
                r = e.constructor,
                i = (b.isFunction(r) && r.prototype) || s,
                o = "constructor";
            for (b.has(e, o) && !b.contains(t, o) && t.push(o); n--; ) (o = N[n]), o in e && e[o] !== i[o] && !b.contains(t, o) && t.push(o);
        }
        var i = this,
            o = i._,
            a = Array.prototype,
            s = Object.prototype,
            l = Function.prototype,
            c = a.push,
            u = a.slice,
            d = s.toString,
            f = s.hasOwnProperty,
            h = Array.isArray,
            p = Object.keys,
            g = l.bind,
            m = Object.create,
            v = function () {},
            b = function (e) {
                return e instanceof b ? e : this instanceof b ? void (this._wrapped = e) : new b(e);
            };
        "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = b), (exports._ = b)) : (i._ = b), (b.VERSION = "1.8.3");
        var y = function (e, t, n) {
                if (void 0 === t) return e;
                switch (null == n ? 3 : n) {
                    case 1:
                        return function (n) {
                            return e.call(t, n);
                        };
                    case 2:
                        return function (n, r) {
                            return e.call(t, n, r);
                        };
                    case 3:
                        return function (n, r, i) {
                            return e.call(t, n, r, i);
                        };
                    case 4:
                        return function (n, r, i, o) {
                            return e.call(t, n, r, i, o);
                        };
                }
                return function () {
                    return e.apply(t, arguments);
                };
            },
            _ = function (e, t, n) {
                return null == e ? b.identity : b.isFunction(e) ? y(e, t, n) : b.isObject(e) ? b.matcher(e) : b.property(e);
            };
        b.iteratee = function (e, t) {
            return _(e, t, 1 / 0);
        };
        var w = function (e, t) {
                return function (n) {
                    var r = arguments.length;
                    if (r < 2 || null == n) return n;
                    for (var i = 1; i < r; i++)
                        for (var o = arguments[i], a = e(o), s = a.length, l = 0; l < s; l++) {
                            var c = a[l];
                            (t && void 0 !== n[c]) || (n[c] = o[c]);
                        }
                    return n;
                };
            },
            x = function (e) {
                if (!b.isObject(e)) return {};
                if (m) return m(e);
                v.prototype = e;
                var t = new v();
                return (v.prototype = null), t;
            },
            E = function (e) {
                return function (t) {
                    return null == t ? void 0 : t[e];
                };
            },
            C = Math.pow(2, 53) - 1,
            T = E("length"),
            S = function (e) {
                var t = T(e);
                return "number" == typeof t && t >= 0 && t <= C;
            };
        (b.each = b.forEach = function (e, t, n) {
            t = y(t, n);
            var r, i;
            if (S(e)) for (r = 0, i = e.length; r < i; r++) t(e[r], r, e);
            else {
                var o = b.keys(e);
                for (r = 0, i = o.length; r < i; r++) t(e[o[r]], o[r], e);
            }
            return e;
        }),
            (b.map = b.collect = function (e, t, n) {
                t = _(t, n);
                for (var r = !S(e) && b.keys(e), i = (r || e).length, o = Array(i), a = 0; a < i; a++) {
                    var s = r ? r[a] : a;
                    o[a] = t(e[s], s, e);
                }
                return o;
            }),
            (b.reduce = b.foldl = b.inject = e(1)),
            (b.reduceRight = b.foldr = e(-1)),
            (b.find = b.detect = function (e, t, n) {
                var r;
                if (((r = S(e) ? b.findIndex(e, t, n) : b.findKey(e, t, n)), void 0 !== r && r !== -1)) return e[r];
            }),
            (b.filter = b.select = function (e, t, n) {
                var r = [];
                return (
                    (t = _(t, n)),
                    b.each(e, function (e, n, i) {
                        t(e, n, i) && r.push(e);
                    }),
                    r
                );
            }),
            (b.reject = function (e, t, n) {
                return b.filter(e, b.negate(_(t)), n);
            }),
            (b.every = b.all = function (e, t, n) {
                t = _(t, n);
                for (var r = !S(e) && b.keys(e), i = (r || e).length, o = 0; o < i; o++) {
                    var a = r ? r[o] : o;
                    if (!t(e[a], a, e)) return !1;
                }
                return !0;
            }),
            (b.some = b.any = function (e, t, n) {
                t = _(t, n);
                for (var r = !S(e) && b.keys(e), i = (r || e).length, o = 0; o < i; o++) {
                    var a = r ? r[o] : o;
                    if (t(e[a], a, e)) return !0;
                }
                return !1;
            }),
            (b.contains = b.includes = b.include = function (e, t, n, r) {
                return S(e) || (e = b.values(e)), ("number" != typeof n || r) && (n = 0), b.indexOf(e, t, n) >= 0;
            }),
            (b.invoke = function (e, t) {
                var n = u.call(arguments, 2),
                    r = b.isFunction(t);
                return b.map(e, function (e) {
                    var i = r ? t : e[t];
                    return null == i ? i : i.apply(e, n);
                });
            }),
            (b.pluck = function (e, t) {
                return b.map(e, b.property(t));
            }),
            (b.where = function (e, t) {
                return b.filter(e, b.matcher(t));
            }),
            (b.findWhere = function (e, t) {
                return b.find(e, b.matcher(t));
            }),
            (b.max = function (e, t, n) {
                var r,
                    i,
                    o = -(1 / 0),
                    a = -(1 / 0);
                if (null == t && null != e) {
                    e = S(e) ? e : b.values(e);
                    for (var s = 0, l = e.length; s < l; s++) (r = e[s]), r > o && (o = r);
                } else
                    (t = _(t, n)),
                        b.each(e, function (e, n, r) {
                            (i = t(e, n, r)), (i > a || (i === -(1 / 0) && o === -(1 / 0))) && ((o = e), (a = i));
                        });
                return o;
            }),
            (b.min = function (e, t, n) {
                var r,
                    i,
                    o = 1 / 0,
                    a = 1 / 0;
                if (null == t && null != e) {
                    e = S(e) ? e : b.values(e);
                    for (var s = 0, l = e.length; s < l; s++) (r = e[s]), r < o && (o = r);
                } else
                    (t = _(t, n)),
                        b.each(e, function (e, n, r) {
                            (i = t(e, n, r)), (i < a || (i === 1 / 0 && o === 1 / 0)) && ((o = e), (a = i));
                        });
                return o;
            }),
            (b.shuffle = function (e) {
                for (var t, n = S(e) ? e : b.values(e), r = n.length, i = Array(r), o = 0; o < r; o++) (t = b.random(0, o)), t !== o && (i[o] = i[t]), (i[t] = n[o]);
                return i;
            }),
            (b.sample = function (e, t, n) {
                return null == t || n ? (S(e) || (e = b.values(e)), e[b.random(e.length - 1)]) : b.shuffle(e).slice(0, Math.max(0, t));
            }),
            (b.sortBy = function (e, t, n) {
                return (
                    (t = _(t, n)),
                    b.pluck(
                        b
                            .map(e, function (e, n, r) {
                                return { value: e, index: n, criteria: t(e, n, r) };
                            })
                            .sort(function (e, t) {
                                var n = e.criteria,
                                    r = t.criteria;
                                if (n !== r) {
                                    if (n > r || void 0 === n) return 1;
                                    if (n < r || void 0 === r) return -1;
                                }
                                return e.index - t.index;
                            }),
                        "value"
                    )
                );
            });
        var R = function (e) {
            return function (t, n, r) {
                var i = {};
                return (
                    (n = _(n, r)),
                    b.each(t, function (r, o) {
                        var a = n(r, o, t);
                        e(i, r, a);
                    }),
                    i
                );
            };
        };
        (b.groupBy = R(function (e, t, n) {
            b.has(e, n) ? e[n].push(t) : (e[n] = [t]);
        })),
            (b.indexBy = R(function (e, t, n) {
                e[n] = t;
            })),
            (b.countBy = R(function (e, t, n) {
                b.has(e, n) ? e[n]++ : (e[n] = 1);
            })),
            (b.toArray = function (e) {
                return e ? (b.isArray(e) ? u.call(e) : S(e) ? b.map(e, b.identity) : b.values(e)) : [];
            }),
            (b.size = function (e) {
                return null == e ? 0 : S(e) ? e.length : b.keys(e).length;
            }),
            (b.partition = function (e, t, n) {
                t = _(t, n);
                var r = [],
                    i = [];
                return (
                    b.each(e, function (e, n, o) {
                        (t(e, n, o) ? r : i).push(e);
                    }),
                    [r, i]
                );
            }),
            (b.first = b.head = b.take = function (e, t, n) {
                if (null != e) return null == t || n ? e[0] : b.initial(e, e.length - t);
            }),
            (b.initial = function (e, t, n) {
                return u.call(e, 0, Math.max(0, e.length - (null == t || n ? 1 : t)));
            }),
            (b.last = function (e, t, n) {
                if (null != e) return null == t || n ? e[e.length - 1] : b.rest(e, Math.max(0, e.length - t));
            }),
            (b.rest = b.tail = b.drop = function (e, t, n) {
                return u.call(e, null == t || n ? 1 : t);
            }),
            (b.compact = function (e) {
                return b.filter(e, b.identity);
            });
        var I = function (e, t, n, r) {
            for (var i = [], o = 0, a = r || 0, s = T(e); a < s; a++) {
                var l = e[a];
                if (S(l) && (b.isArray(l) || b.isArguments(l))) {
                    t || (l = I(l, t, n));
                    var c = 0,
                        u = l.length;
                    for (i.length += u; c < u; ) i[o++] = l[c++];
                } else n || (i[o++] = l);
            }
            return i;
        };
        (b.flatten = function (e, t) {
            return I(e, t, !1);
        }),
            (b.without = function (e) {
                return b.difference(e, u.call(arguments, 1));
            }),
            (b.uniq = b.unique = function (e, t, n, r) {
                b.isBoolean(t) || ((r = n), (n = t), (t = !1)), null != n && (n = _(n, r));
                for (var i = [], o = [], a = 0, s = T(e); a < s; a++) {
                    var l = e[a],
                        c = n ? n(l, a, e) : l;
                    t ? ((a && o === c) || i.push(l), (o = c)) : n ? b.contains(o, c) || (o.push(c), i.push(l)) : b.contains(i, l) || i.push(l);
                }
                return i;
            }),
            (b.union = function () {
                return b.uniq(I(arguments, !0, !0));
            }),
            (b.intersection = function (e) {
                for (var t = [], n = arguments.length, r = 0, i = T(e); r < i; r++) {
                    var o = e[r];
                    if (!b.contains(t, o)) {
                        for (var a = 1; a < n && b.contains(arguments[a], o); a++);
                        a === n && t.push(o);
                    }
                }
                return t;
            }),
            (b.difference = function (e) {
                var t = I(arguments, !0, !0, 1);
                return b.filter(e, function (e) {
                    return !b.contains(t, e);
                });
            }),
            (b.zip = function () {
                return b.unzip(arguments);
            }),
            (b.unzip = function (e) {
                for (var t = (e && b.max(e, T).length) || 0, n = Array(t), r = 0; r < t; r++) n[r] = b.pluck(e, r);
                return n;
            }),
            (b.object = function (e, t) {
                for (var n = {}, r = 0, i = T(e); r < i; r++) t ? (n[e[r]] = t[r]) : (n[e[r][0]] = e[r][1]);
                return n;
            }),
            (b.findIndex = t(1)),
            (b.findLastIndex = t(-1)),
            (b.sortedIndex = function (e, t, n, r) {
                n = _(n, r, 1);
                for (var i = n(t), o = 0, a = T(e); o < a; ) {
                    var s = Math.floor((o + a) / 2);
                    n(e[s]) < i ? (o = s + 1) : (a = s);
                }
                return o;
            }),
            (b.indexOf = n(1, b.findIndex, b.sortedIndex)),
            (b.lastIndexOf = n(-1, b.findLastIndex)),
            (b.range = function (e, t, n) {
                null == t && ((t = e || 0), (e = 0)), (n = n || 1);
                for (var r = Math.max(Math.ceil((t - e) / n), 0), i = Array(r), o = 0; o < r; o++, e += n) i[o] = e;
                return i;
            });
        var k = function (e, t, n, r, i) {
            if (!(r instanceof t)) return e.apply(n, i);
            var o = x(e.prototype),
                a = e.apply(o, i);
            return b.isObject(a) ? a : o;
        };
        (b.bind = function (e, t) {
            if (g && e.bind === g) return g.apply(e, u.call(arguments, 1));
            if (!b.isFunction(e)) throw new TypeError("Bind must be called on a function");
            var n = u.call(arguments, 2),
                r = function () {
                    return k(e, r, t, this, n.concat(u.call(arguments)));
                };
            return r;
        }),
            (b.partial = function (e) {
                var t = u.call(arguments, 1),
                    n = function () {
                        for (var r = 0, i = t.length, o = Array(i), a = 0; a < i; a++) o[a] = t[a] === b ? arguments[r++] : t[a];
                        for (; r < arguments.length; ) o.push(arguments[r++]);
                        return k(e, n, this, this, o);
                    };
                return n;
            }),
            (b.bindAll = function (e) {
                var t,
                    n,
                    r = arguments.length;
                if (r <= 1) throw new Error("bindAll must be passed function names");
                for (t = 1; t < r; t++) (n = arguments[t]), (e[n] = b.bind(e[n], e));
                return e;
            }),
            (b.memoize = function (e, t) {
                var n = function (r) {
                    var i = n.cache,
                        o = "" + (t ? t.apply(this, arguments) : r);
                    return b.has(i, o) || (i[o] = e.apply(this, arguments)), i[o];
                };
                return (n.cache = {}), n;
            }),
            (b.delay = function (e, t) {
                var n = u.call(arguments, 2);
                return setTimeout(function () {
                    return e.apply(null, n);
                }, t);
            }),
            (b.defer = b.partial(b.delay, b, 1)),
            (b.throttle = function (e, t, n) {
                var r,
                    i,
                    o,
                    a = null,
                    s = 0;
                n || (n = {});
                var l = function () {
                    (s = n.leading === !1 ? 0 : b.now()), (a = null), (o = e.apply(r, i)), a || (r = i = null);
                };
                return function () {
                    var c = b.now();
                    s || n.leading !== !1 || (s = c);
                    var u = t - (c - s);
                    return (r = this), (i = arguments), u <= 0 || u > t ? (a && (clearTimeout(a), (a = null)), (s = c), (o = e.apply(r, i)), a || (r = i = null)) : a || n.trailing === !1 || (a = setTimeout(l, u)), o;
                };
            }),
            (b.debounce = function (e, t, n) {
                var r,
                    i,
                    o,
                    a,
                    s,
                    l = function () {
                        var c = b.now() - a;
                        c < t && c >= 0 ? (r = setTimeout(l, t - c)) : ((r = null), n || ((s = e.apply(o, i)), r || (o = i = null)));
                    };
                return function () {
                    (o = this), (i = arguments), (a = b.now());
                    var c = n && !r;
                    return r || (r = setTimeout(l, t)), c && ((s = e.apply(o, i)), (o = i = null)), s;
                };
            }),
            (b.wrap = function (e, t) {
                return b.partial(t, e);
            }),
            (b.negate = function (e) {
                return function () {
                    return !e.apply(this, arguments);
                };
            }),
            (b.compose = function () {
                var e = arguments,
                    t = e.length - 1;
                return function () {
                    for (var n = t, r = e[t].apply(this, arguments); n--; ) r = e[n].call(this, r);
                    return r;
                };
            }),
            (b.after = function (e, t) {
                return function () {
                    if (--e < 1) return t.apply(this, arguments);
                };
            }),
            (b.before = function (e, t) {
                var n;
                return function () {
                    return --e > 0 && (n = t.apply(this, arguments)), e <= 1 && (t = null), n;
                };
            }),
            (b.once = b.partial(b.before, 2));
        var P = !{ toString: null }.propertyIsEnumerable("toString"),
            N = ["valueOf", "isPrototypeOf", "toString", "propertyIsEnumerable", "hasOwnProperty", "toLocaleString"];
        (b.keys = function (e) {
            if (!b.isObject(e)) return [];
            if (p) return p(e);
            var t = [];
            for (var n in e) b.has(e, n) && t.push(n);
            return P && r(e, t), t;
        }),
            (b.allKeys = function (e) {
                if (!b.isObject(e)) return [];
                var t = [];
                for (var n in e) t.push(n);
                return P && r(e, t), t;
            }),
            (b.values = function (e) {
                for (var t = b.keys(e), n = t.length, r = Array(n), i = 0; i < n; i++) r[i] = e[t[i]];
                return r;
            }),
            (b.mapObject = function (e, t, n) {
                t = _(t, n);
                for (var r, i = b.keys(e), o = i.length, a = {}, s = 0; s < o; s++) (r = i[s]), (a[r] = t(e[r], r, e));
                return a;
            }),
            (b.pairs = function (e) {
                for (var t = b.keys(e), n = t.length, r = Array(n), i = 0; i < n; i++) r[i] = [t[i], e[t[i]]];
                return r;
            }),
            (b.invert = function (e) {
                for (var t = {}, n = b.keys(e), r = 0, i = n.length; r < i; r++) t[e[n[r]]] = n[r];
                return t;
            }),
            (b.functions = b.methods = function (e) {
                var t = [];
                for (var n in e) b.isFunction(e[n]) && t.push(n);
                return t.sort();
            }),
            (b.extend = w(b.allKeys)),
            (b.extendOwn = b.assign = w(b.keys)),
            (b.findKey = function (e, t, n) {
                t = _(t, n);
                for (var r, i = b.keys(e), o = 0, a = i.length; o < a; o++) if (((r = i[o]), t(e[r], r, e))) return r;
            }),
            (b.pick = function (e, t, n) {
                var r,
                    i,
                    o = {},
                    a = e;
                if (null == a) return o;
                b.isFunction(t)
                    ? ((i = b.allKeys(a)), (r = y(t, n)))
                    : ((i = I(arguments, !1, !1, 1)),
                      (r = function (e, t, n) {
                          return t in n;
                      }),
                      (a = Object(a)));
                for (var s = 0, l = i.length; s < l; s++) {
                    var c = i[s],
                        u = a[c];
                    r(u, c, a) && (o[c] = u);
                }
                return o;
            }),
            (b.omit = function (e, t, n) {
                if (b.isFunction(t)) t = b.negate(t);
                else {
                    var r = b.map(I(arguments, !1, !1, 1), String);
                    t = function (e, t) {
                        return !b.contains(r, t);
                    };
                }
                return b.pick(e, t, n);
            }),
            (b.defaults = w(b.allKeys, !0)),
            (b.create = function (e, t) {
                var n = x(e);
                return t && b.extendOwn(n, t), n;
            }),
            (b.clone = function (e) {
                return b.isObject(e) ? (b.isArray(e) ? e.slice() : b.extend({}, e)) : e;
            }),
            (b.tap = function (e, t) {
                return t(e), e;
            }),
            (b.isMatch = function (e, t) {
                var n = b.keys(t),
                    r = n.length;
                if (null == e) return !r;
                for (var i = Object(e), o = 0; o < r; o++) {
                    var a = n[o];
                    if (t[a] !== i[a] || !(a in i)) return !1;
                }
                return !0;
            });
        var O = function (e, t, n, r) {
            if (e === t) return 0 !== e || 1 / e === 1 / t;
            if (null == e || null == t) return e === t;
            e instanceof b && (e = e._wrapped), t instanceof b && (t = t._wrapped);
            var i = d.call(e);
            if (i !== d.call(t)) return !1;
            switch (i) {
                case "[object RegExp]":
                case "[object String]":
                    return "" + e == "" + t;
                case "[object Number]":
                    return +e !== +e ? +t !== +t : 0 === +e ? 1 / +e === 1 / t : +e === +t;
                case "[object Date]":
                case "[object Boolean]":
                    return +e === +t;
            }
            var o = "[object Array]" === i;
            if (!o) {
                if ("object" != typeof e || "object" != typeof t) return !1;
                var a = e.constructor,
                    s = t.constructor;
                if (a !== s && !(b.isFunction(a) && a instanceof a && b.isFunction(s) && s instanceof s) && "constructor" in e && "constructor" in t) return !1;
            }
            (n = n || []), (r = r || []);
            for (var l = n.length; l--; ) if (n[l] === e) return r[l] === t;
            if ((n.push(e), r.push(t), o)) {
                if (((l = e.length), l !== t.length)) return !1;
                for (; l--; ) if (!O(e[l], t[l], n, r)) return !1;
            } else {
                var c,
                    u = b.keys(e);
                if (((l = u.length), b.keys(t).length !== l)) return !1;
                for (; l--; ) if (((c = u[l]), !b.has(t, c) || !O(e[c], t[c], n, r))) return !1;
            }
            return n.pop(), r.pop(), !0;
        };
        (b.isEqual = function (e, t) {
            return O(e, t);
        }),
            (b.isEmpty = function (e) {
                return null == e || (S(e) && (b.isArray(e) || b.isString(e) || b.isArguments(e)) ? 0 === e.length : 0 === b.keys(e).length);
            }),
            (b.isElement = function (e) {
                return !(!e || 1 !== e.nodeType);
            }),
            (b.isArray =
                h ||
                function (e) {
                    return "[object Array]" === d.call(e);
                }),
            (b.isObject = function (e) {
                var t = typeof e;
                return "function" === t || ("object" === t && !!e);
            }),
            b.each(["Arguments", "Function", "String", "Number", "Date", "RegExp", "Error"], function (e) {
                b["is" + e] = function (t) {
                    return d.call(t) === "[object " + e + "]";
                };
            }),
            b.isArguments(arguments) ||
                (b.isArguments = function (e) {
                    return b.has(e, "callee");
                }),
            "function" != typeof /./ &&
                "object" != typeof Int8Array &&
                (b.isFunction = function (e) {
                    return "function" == typeof e || !1;
                }),
            (b.isFinite = function (e) {
                return isFinite(e) && !isNaN(parseFloat(e));
            }),
            (b.isNaN = function (e) {
                return b.isNumber(e) && e !== +e;
            }),
            (b.isBoolean = function (e) {
                return e === !0 || e === !1 || "[object Boolean]" === d.call(e);
            }),
            (b.isNull = function (e) {
                return null === e;
            }),
            (b.isUndefined = function (e) {
                return void 0 === e;
            }),
            (b.has = function (e, t) {
                return null != e && f.call(e, t);
            }),
            (b.noConflict = function () {
                return (i._ = o), this;
            }),
            (b.identity = function (e) {
                return e;
            }),
            (b.constant = function (e) {
                return function () {
                    return e;
                };
            }),
            (b.noop = function () {}),
            (b.property = E),
            (b.propertyOf = function (e) {
                return null == e
                    ? function () {}
                    : function (t) {
                          return e[t];
                      };
            }),
            (b.matcher = b.matches = function (e) {
                return (
                    (e = b.extendOwn({}, e)),
                    function (t) {
                        return b.isMatch(t, e);
                    }
                );
            }),
            (b.times = function (e, t, n) {
                var r = Array(Math.max(0, e));
                t = y(t, n, 1);
                for (var i = 0; i < e; i++) r[i] = t(i);
                return r;
            }),
            (b.random = function (e, t) {
                return null == t && ((t = e), (e = 0)), e + Math.floor(Math.random() * (t - e + 1));
            }),
            (b.now =
                Date.now ||
                function () {
                    return new Date().getTime();
                });
        var A = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#x27;", "`": "&#x60;" },
            D = b.invert(A),
            M = function (e) {
                var t = function (t) {
                        return e[t];
                    },
                    n = "(?:" + b.keys(e).join("|") + ")",
                    r = RegExp(n),
                    i = RegExp(n, "g");
                return function (e) {
                    return (e = null == e ? "" : "" + e), r.test(e) ? e.replace(i, t) : e;
                };
            };
        (b.escape = M(A)),
            (b.unescape = M(D)),
            (b.result = function (e, t, n) {
                var r = null == e ? void 0 : e[t];
                return void 0 === r && (r = n), b.isFunction(r) ? r.call(e) : r;
            });
        var F = 0;
        (b.uniqueId = function (e) {
            var t = ++F + "";
            return e ? e + t : t;
        }),
            (b.templateSettings = { evaluate: /<%([\s\S]+?)%>/g, interpolate: /<%=([\s\S]+?)%>/g, escape: /<%-([\s\S]+?)%>/g });
        var L = /(.)^/,
            U = { "'": "'", "\\": "\\", "\r": "r", "\n": "n", "\u2028": "u2028", "\u2029": "u2029" },
            B = /\\|'|\r|\n|\u2028|\u2029/g,
            j = function (e) {
                return "\\" + U[e];
            };
        (b.template = function (e, t, n) {
            !t && n && (t = n), (t = b.defaults({}, t, b.templateSettings));
            var r = RegExp([(t.escape || L).source, (t.interpolate || L).source, (t.evaluate || L).source].join("|") + "|$", "g"),
                i = 0,
                o = "__p+='";
            e.replace(r, function (t, n, r, a, s) {
                return (o += e.slice(i, s).replace(B, j)), (i = s + t.length), n ? (o += "'+\n((__t=(" + n + "))==null?'':_.escape(__t))+\n'") : r ? (o += "'+\n((__t=(" + r + "))==null?'':__t)+\n'") : a && (o += "';\n" + a + "\n__p+='"), t;
            }),
                (o += "';\n"),
                t.variable || (o = "with(obj||{}){\n" + o + "}\n"),
                (o = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + o + "return __p;\n");
            try {
                var a = new Function(t.variable || "obj", "_", o);
            } catch (e) {
                throw ((e.source = o), e);
            }
            var s = function (e) {
                    return a.call(this, e, b);
                },
                l = t.variable || "obj";
            return (s.source = "function(" + l + "){\n" + o + "}"), s;
        }),
            (b.chain = function (e) {
                var t = b(e);
                return (t._chain = !0), t;
            });
        var z = function (e, t) {
            return e._chain ? b(t).chain() : t;
        };
        (b.mixin = function (e) {
            b.each(b.functions(e), function (t) {
                var n = (b[t] = e[t]);
                b.prototype[t] = function () {
                    var e = [this._wrapped];
                    return c.apply(e, arguments), z(this, n.apply(b, e));
                };
            });
        }),
            b.mixin(b),
            b.each(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function (e) {
                var t = a[e];
                b.prototype[e] = function () {
                    var n = this._wrapped;
                    return t.apply(n, arguments), ("shift" !== e && "splice" !== e) || 0 !== n.length || delete n[0], z(this, n);
                };
            }),
            b.each(["concat", "join", "slice"], function (e) {
                var t = a[e];
                b.prototype[e] = function () {
                    return z(this, t.apply(this._wrapped, arguments));
                };
            }),
            (b.prototype.value = function () {
                return this._wrapped;
            }),
            (b.prototype.valueOf = b.prototype.toJSON = b.prototype.value),
            (b.prototype.toString = function () {
                return "" + this._wrapped;
            }),
            "function" == typeof define &&
                define.amd &&
                define("underscore", [], function () {
                    return b;
                });
    }.call(this),
    define("eventEmitter", ["require", "exports", "module"], function (e, t, n) {
        "use strict";
        function r() {}
        function i(e, t, n) {
            (this.fn = e), (this.context = t), (this.once = n || !1);
        }
        function o() {
            (this._events = new r()), (this._eventsCount = 0);
        }
        var a = Object.prototype.hasOwnProperty,
            s = "~";
        Object.create && ((r.prototype = Object.create(null)), new r().__proto__ || (s = !1)),
            (o.prototype.eventNames = function () {
                var e,
                    t,
                    n = [];
                if (0 === this._eventsCount) return n;
                for (t in (e = this._events)) a.call(e, t) && n.push(s ? t.slice(1) : t);
                return Object.getOwnPropertySymbols ? n.concat(Object.getOwnPropertySymbols(e)) : n;
            }),
            (o.prototype.listeners = function (e, t) {
                var n = s ? s + e : e,
                    r = this._events[n];
                if (t) return !!r;
                if (!r) return [];
                if (r.fn) return [r.fn];
                for (var i = 0, o = r.length, a = new Array(o); i < o; i++) a[i] = r[i].fn;
                return a;
            }),
            (o.prototype.emit = function (e, t, n, r, i, o) {
                var a = s ? s + e : e;
                if (!this._events[a]) return !1;
                var l,
                    c,
                    u = this._events[a],
                    d = arguments.length;
                if (u.fn) {
                    switch ((u.once && this.removeListener(e, u.fn, void 0, !0), d)) {
                        case 1:
                            return u.fn.call(u.context), !0;
                        case 2:
                            return u.fn.call(u.context, t), !0;
                        case 3:
                            return u.fn.call(u.context, t, n), !0;
                        case 4:
                            return u.fn.call(u.context, t, n, r), !0;
                        case 5:
                            return u.fn.call(u.context, t, n, r, i), !0;
                        case 6:
                            return u.fn.call(u.context, t, n, r, i, o), !0;
                    }
                    for (c = 1, l = new Array(d - 1); c < d; c++) l[c - 1] = arguments[c];
                    u.fn.apply(u.context, l);
                } else {
                    var f,
                        h = u.length;
                    for (c = 0; c < h; c++)
                        switch ((u[c].once && this.removeListener(e, u[c].fn, void 0, !0), d)) {
                            case 1:
                                u[c].fn.call(u[c].context);
                                break;
                            case 2:
                                u[c].fn.call(u[c].context, t);
                                break;
                            case 3:
                                u[c].fn.call(u[c].context, t, n);
                                break;
                            case 4:
                                u[c].fn.call(u[c].context, t, n, r);
                                break;
                            default:
                                if (!l) for (f = 1, l = new Array(d - 1); f < d; f++) l[f - 1] = arguments[f];
                                u[c].fn.apply(u[c].context, l);
                        }
                }
                return !0;
            }),
            (o.prototype.on = function (e, t, n) {
                var r = new i(t, n || this),
                    o = s ? s + e : e;
                return this._events[o] ? (this._events[o].fn ? (this._events[o] = [this._events[o], r]) : this._events[o].push(r)) : ((this._events[o] = r), this._eventsCount++), this;
            }),
            (o.prototype.once = function (e, t, n) {
                var r = new i(t, n || this, !0),
                    o = s ? s + e : e;
                return this._events[o] ? (this._events[o].fn ? (this._events[o] = [this._events[o], r]) : this._events[o].push(r)) : ((this._events[o] = r), this._eventsCount++), this;
            }),
            (o.prototype.removeListener = function (e, t, n, i) {
                var o = s ? s + e : e;
                if (!this._events[o]) return this;
                if (!t) return 0 === --this._eventsCount ? (this._events = new r()) : delete this._events[o], this;
                var a = this._events[o];
                if (a.fn) a.fn !== t || (i && !a.once) || (n && a.context !== n) || (0 === --this._eventsCount ? (this._events = new r()) : delete this._events[o]);
                else {
                    for (var l = 0, c = [], u = a.length; l < u; l++) (a[l].fn !== t || (i && !a[l].once) || (n && a[l].context !== n)) && c.push(a[l]);
                    c.length ? (this._events[o] = 1 === c.length ? c[0] : c) : 0 === --this._eventsCount ? (this._events = new r()) : delete this._events[o];
                }
                return this;
            }),
            (o.prototype.removeAllListeners = function (e) {
                var t;
                return e ? ((t = s ? s + e : e), this._events[t] && (0 === --this._eventsCount ? (this._events = new r()) : delete this._events[t])) : ((this._events = new r()), (this._eventsCount = 0)), this;
            }),
            (o.prototype.off = o.prototype.removeListener),
            (o.prototype.addListener = o.prototype.on),
            (o.prototype.setMaxListeners = function () {
                return this;
            }),
            (o.prefixed = s),
            (o.EventEmitter = o),
            "undefined" != typeof n && (n.exports = o);
    }),
    define("readium_js_plugins", ["jquery", "underscore", "eventEmitter"], function (e, t, n) {
        function r(e, t) {
            (this.reader = e), (this.plugin = t);
        }
        function i(e) {
            this.create = function (t) {
                return { host: e, instance: new r(e, t) };
            };
        }
        function o(e, t, n) {
            (this.name = e), (this.dependencies = t), (this.initialized = !1), (this.supported = !1), (this.initializer = n);
        }
        var a = {},
            s = function () {
                (this.initialize = function (e) {
                    var n = new i(e);
                    if (e.plugins) throw new Error("Already initialized on reader!");
                    (e.plugins = {}),
                        t.each(a, function (e) {
                            e.init(n);
                        });
                }),
                    (this.getLoadedPlugins = function () {
                        return a;
                    }),
                    (this.register = function (t, r, i) {
                        if (a[t]) throw new Error("Duplicate registration for plugin with name: " + t);
                        var s;
                        "function" == typeof r ? (i = r) : (s = r),
                            (a[t] = new o(t, s, function (t, r) {
                                if (!t.initialized || !r.host.plugins[t.name]) {
                                    t.initialized = !0;
                                    try {
                                        var o = {};
                                        e.extend(o, new n()), i.call(o, r.instance), (t.supported = !0), (r.host.plugins[t.name] = o);
                                    } catch (e) {
                                        t.fail(e);
                                    }
                                }
                            }));
                    });
            };
        o.prototype = {
            init: function (e) {
                for (var t, n, r = this.dependencies || [], i = 0, s = r.length; i < s; ++i) {
                    if (((n = r[i]), (t = a[n]), !(t && t instanceof o))) throw new Error("required Plugin '" + n + "' not found");
                    if ((t.init(e), !t.supported)) throw new Error("required Plugin '" + n + "' not supported");
                }
                this.initializer(this, e.create(this));
            },
            fail: function (e) {
                throw ((this.initialized = !0), (this.supported = !1), new Error("Plugin '" + this.name + "' failed to load: " + e));
            },
            warn: function (e) {
                console.warn("Plugin " + this.name + ": " + e);
            },
            deprecationNotice: function (e, t) {
                console.warn("DEPRECATED: " + e + " in Plugin " + this.name + "is deprecated. Please use " + t + " instead");
            },
            createError: function (e) {
                return new Error("Error in " + this.name + " Plugin: " + e);
            },
        };
        var l = new s();
        return l;
    }),
    define("readium_shared_js/globals", ["jquery", "eventEmitter"], function (e, t) {
        var n = !1,
            r = {
                version: function () {
                    return "0.8.0";
                },
                Views: { ORIENTATION_LANDSCAPE: "orientation_landscape", ORIENTATION_PORTRAIT: "orientation_portrait" },
                Events: {
                    READER_INITIALIZED: "ReaderInitialized",
                    PAGINATION_CHANGED: "PaginationChanged",
                    SETTINGS_APPLIED: "SettingsApplied",
                    FXL_VIEW_RESIZED: "FXLViewResized",
                    READER_VIEW_CREATED: "ReaderViewCreated",
                    READER_VIEW_DESTROYED: "ReaderViewDestroyed",
                    CONTENT_DOCUMENT_LOAD_START: "ContentDocumentLoadStart",
                    CONTENT_DOCUMENT_LOADED: "ContentDocumentLoaded",
                    CONTENT_DOCUMENT_UNLOADED: "ContentDocumentUnloaded",
                    MEDIA_OVERLAY_STATUS_CHANGED: "MediaOverlayStatusChanged",
                    MEDIA_OVERLAY_TTS_SPEAK: "MediaOverlayTTSSpeak",
                    MEDIA_OVERLAY_TTS_STOP: "MediaOverlayTTSStop",
                    PLUGINS_LOADED: "PluginsLoaded",
                },
                InternalEvents: { CURRENT_VIEW_PAGINATION_CHANGED: "CurrentViewPaginationChanged" },
                logEvent: function (e, t, r) {
                    n && console.debug("#### ReadiumSDK.Events." + e + " - " + t + " - " + r);
                },
            };
        return e.extend(r, new t()), r;
    }),
    (navigator.epubReadingSystem = {
        name: "",
        version: "0.0.0",
        layoutStyle: "paginated",
        hasFeature: function (e, t) {
            return (!t || "1.0" === t) && ("dom-manipulation" === e || "layout-changes" === e || ("touch-events" !== e && ("mouse-events" === e || "keyboard-events" === e || "spine-scripting" === e)));
        },
    }),
    define("readium_plugin_highlights/lib/class", [], function () {
        var e = !1,
            t = /xyz/.test(function () {
                xyz;
            })
                ? /\b_super\b/
                : /.*/,
            n = function () {};
        return (
            (n.extend = function (n) {
                function r() {
                    !e && this.init && this.init.apply(this, arguments);
                }
                var i = this.prototype;
                e = !0;
                var o = new this();
                e = !1;
                for (var a in n)
                    o[a] =
                        "function" == typeof n[a] && "function" == typeof i[a] && t.test(n[a])
                            ? (function (e, t) {
                                  return function () {
                                      var n = this._super;
                                      this._super = i[e];
                                      var r = t.apply(this, arguments);
                                      return (this._super = n), r;
                                  };
                              })(a, n[a])
                            : n[a];
                return (r.prototype = o), (r.prototype.constructor = r), (r.extend = arguments.callee), r;
            }),
            n
        );
    }),
    define("readium_plugin_highlights/helpers", [], function () {
        var e = {
            getMatrix: function (e) {
                var t = e.css("-webkit-transform") || e.css("-moz-transform") || e.css("-ms-transform") || e.css("-o-transform") || e.css("transform");
                return "none" === t ? void 0 : t;
            },
            getScaleFromMatrix: function (e) {
                var t = /matrix\((-?\d*\.?\d+),\s*0,\s*0,\s*(-?\d*\.?\d+),\s*0,\s*0\)/,
                    n = e.match(t);
                return n[1];
            },
        };
        return e;
    }),
    define("readium_plugin_highlights/models/text_line_inferrer", ["../lib/class"], function (e) {
        var t = e.extend({
            init: function (e) {
                (this.lineHorizontalThreshold = e.lineHorizontalThreshold || 0), (this.lineHorizontalLimit = e.lineHorizontalLimit || 0);
            },
            inferLines: function (e) {
                for (var t, n, r, i, o = [], a = e.length, s = 0, l = 0; l <= a - 1; l++)
                    (r = e[l]),
                        (n = r.rect),
                        (i = !1),
                        o.length > 0 && ((t = o[o.length - 1]), this.includeRectInLine(t.line, n.top, n.left, n.width, n.height) && ((i = this.expandLine(t.line, n.left, n.top, n.width, n.height)), t.data.push(r))),
                        i || (o.push({ data: [r], line: this.createNewLine(n.left, n.top, n.width, n.height) }), (s += 1));
                return o;
            },
            includeRectInLine: function (e, t, n, r, i) {
                return !(!this.rectIsWithinLineVertically(t, i, e.maxTop, e.maxBottom) || !this.rectIsWithinLineHorizontally(n, r, e.left, e.width, e.avgHeight));
            },
            rectIsWithinLineVertically: function (e, t, n, r) {
                var i = e + t,
                    o = r - n,
                    a = (0.75 * o) / 2,
                    s = (0.75 * t) / 2;
                return (e += s), (i -= s), (n += a), (r -= a), (e === n && i === r) || (e < n && i < r && i > n) || (e > n && i > r && e < r) || (e > n && i < r) || (e < n && i > r);
            },
            rectIsWithinLineHorizontally: function (e, t, n, r, i) {
                var o = 2 * i,
                    a = e + t,
                    s = e + r;
                return !(n - a > o) && !(e - s > o);
            },
            createNewLine: function (e, t, n, r) {
                var i = t + r;
                return { left: e, startTop: t, width: n, avgHeight: r, maxTop: t, maxBottom: i, numRects: 1 };
            },
            expandLine: function (e, t, n, r, i) {
                var o = (e.left + e.width, t + r),
                    a = n + i,
                    s = e.numRects + 1,
                    l = e.avgHeight * e.numRects,
                    c = Math.ceil((l + i) / s);
                return (e.avgHeight = c), (e.numRects = s), (e = this.expandLineVertically(e, n, a)), (e = this.expandLineHorizontally(e, t, o));
            },
            expandLineVertically: function (e, t, n) {
                return t < e.maxTop && (e.maxTop = t), n > e.maxBottom && (e.maxBottom = n), e;
            },
            expandLineHorizontally: function (e, t, n) {
                var r = e.left <= t ? e.left : t,
                    i = e.left + e.width,
                    o = i >= n ? i : n,
                    a = o - r,
                    s = this.lineHorizontalThreshold,
                    l = this.lineHorizontalLimit,
                    c = Math.floor(r / l) * l,
                    u = c + s,
                    d = c + l;
                if (!((r > c && o > u && r < u) || (r > u && o > d))) return (e.left = r), (e.width = a), e;
            },
        });
        return t;
    }),
    define("readium_plugin_highlights/lib/length", [], function () {
        return function (e) {
            "use strict";
            function t(e, t, r, i) {
                r = r || "width";
                var a,
                    s,
                    u,
                    d = (t.match(l) || [])[2],
                    f = "px" === d ? 1 : c[d + "toPx"],
                    h = /r?em/i;
                if (f || (h.test(d) && !i)) (e = f ? e : "rem" === d ? o : "fontSize" === r ? e.parentNode || e : e), (f = f || parseFloat(n(e, "fontSize"))), (u = parseFloat(t));
                else {
                    (a = e.style), (s = a[r]);
                    try {
                        a[r] = t;
                    } catch (e) {
                        return 0;
                    }
                    (u = a[r] ? parseFloat(n(e, r)) : 0), (a[r] = void 0 !== s ? s : null);
                }
                return u;
            }
            function n(e, i) {
                var o,
                    a,
                    c,
                    u,
                    d,
                    f = /^top|bottom/,
                    h = ["paddingTop", "paddingBottom", "borderTop", "borderBottom"],
                    p = 4;
                if (((o = s ? s(e)[i] : (a = e.style["pixel" + i.charAt(0).toUpperCase() + i.slice(1)]) ? a + "px" : "fontSize" === i ? t(e, "1em", "left", 1) + "px" : e.currentStyle[i]), (c = (o.match(l) || [])[2]), "%" === c && r))
                    if (f.test(i)) {
                        for (u = (d = e.parentNode || e).offsetHeight; p--; ) u -= parseFloat(n(d, h[p]));
                        o = parseFloat(o) / 100;
                    } else o = t(e, o);
                else ("auto" === o || (c && "px" !== c)) && s ? (o = 0) : c && "px" !== c && !s && (o = t(e, o) + "px");
                return o;
            }
            var r,
                i = e.createElement("test"),
                o = e.documentElement,
                a = e.defaultView,
                s = a && a.getComputedStyle,
                l = /^(-?[\d+\.\-]+)([a-z]+|%)$/i,
                c = {},
                u = [1 / 25.4, 1 / 2.54, 1 / 72, 1 / 6],
                d = ["mm", "cm", "pt", "pc", "in", "mozmm"],
                f = 6;
            for (o.appendChild(i), s && ((i.style.marginTop = "1%"), (r = "1%" === s(i).marginTop)); f--; ) c[d[f] + "toPx"] = u[f] ? u[f] * c.inToPx : t(i, "1" + d[f]);
            return o.removeChild(i), (i = void 0), { toPx: t };
        };
    }),
    define("readium_plugin_highlights/models/copied_text_styles", [], function () {
        return [
            "color",
            "font-family",
            "font-size",
            "font-weight",
            "font-style",
            "text-decoration",
            "text-transform",
            "text-shadow",
            "letter-spacing",
            "text-rendering",
            "font-kerning",
            "font-language-override",
            "font-size-adjust",
            "font-stretch",
            "font-synthesis",
            "font-variant",
            "font-variant-alternates",
            "font-variant-caps",
            "font-variant-east-asian",
            "font-variant-ligatures",
            "font-variant-numeric",
            "font-variant-position",
            "-webkit-font-smoothing ",
            "-ms-writing-mode",
            "-webkit-writing-mode",
            "-moz-writing-mode",
            "-ms-writing-mode",
            "writing-mode",
            "-webkit-text-orientation",
            "-moz-text-orientation",
            "-ms-text-orientation",
            "text-orientation: mixed",
        ];
    }),
    define("readium_plugin_highlights/views/view", ["jquery", "underscore", "../lib/class", "../lib/length", "../models/text_line_inferrer", "../models/copied_text_styles"], function (e, t, n, r, i, o) {
        var a = n.extend({
            template: '<div class="rd-highlight"></div>',
            init: function (e, t) {
                (this.context = e),
                    (this.lengthLib = new r(this.context.document)),
                    (this.highlight = { id: t.id, CFI: t.CFI, type: t.type, top: t.top, left: t.left, height: t.height, width: t.width, styles: t.styles, contentRenderData: t.contentRenderData }),
                    (this.swipeThreshold = 10),
                    (this.swipeVelocity = 0.65);
            },
            render: function () {
                return (this.$el = e(this.template, this.context.document)), this.$el.attr("data-id", this.highlight.id), this.updateStyles(), this.renderContent(), this.$el;
            },
            remove: function () {
                (this.highlight = null), (this.context = null), this.$el.remove();
            },
            resetPosition: function (e, n, r, i) {
                t.assign(this.highlight, { top: e, left: n, height: r, width: i }), this.setCSS();
            },
            setStyles: function (e) {
                (this.highlight.styles = e), this.updateStyles();
            },
            update: function (e, n) {
                var r = this.highlight.type;
                t.assign(this.highlight, { type: e, styles: n }), this.$el.removeAttr("style"), this.$el.removeClass(r), this.updateStyles();
            },
            updateStyles: function () {
                this.setBaseHighlight(), this.setCSS();
            },
            getFirstTextNodeChild: function (e) {
                for (var t = 0; t < e.childNodes.length; t++) {
                    var n = e.childNodes[t];
                    if (n.nodeType === Node.TEXT_NODE) return n;
                    if (n.nodeType === Node.ELEMENT_NODE) {
                        var r = n.ownerDocument,
                            i = r.defaultView.getComputedStyle(n);
                        if ("absolute" !== i.position && "fixed" !== i.position && "none" === i.float && "none" !== i.display) {
                            if ("inline" !== i.display) return !1;
                            var o = this.getFirstTextNodeChild(n);
                            if (o) return o;
                            if (o === !1) return !1;
                        }
                    }
                }
                return null;
            },
            getFirstLineStyles: function (e) {
                var t = e.ownerDocument.defaultView;
                if (!t.getMatchedCSSRules) return null;
                for (; e; ) {
                    var n = t.getMatchedCSSRules(e, "first-line");
                    if (n) return n[0].style;
                    for (var r = e; (r = r.previousSibling); )
                        if (r.nodeType === Node.ELEMENT_NODE) {
                            var i = t.getComputedStyle(r);
                            if ("none" !== i.display) return null;
                        } else if (r.nodeType === Node.TEXT_NODE && r.textContent.match(/\S/)) return null;
                    e = e.parentNode;
                }
            },
            renderContent: function () {
                var n = this,
                    r = this.highlight.contentRenderData;
                r &&
                    (t.each(r.data, function (a) {
                        var s = e(a.ancestorEl),
                            l = e(a.blockAncestorEl),
                            c = a.ancestorEl.ownerDocument,
                            u = c.createElement("div");
                        (u.style.position = "absolute"), (u.style.top = a.rect.top - r.top + "px"), (u.style.left = a.rect.left - r.left + "px"), (u.style.width = a.rect.width + 1 + "px"), (u.style.height = a.rect.height + "px");
                        var d = function (e, n) {
                                t.each(o, function (t) {
                                    var r = e[t];
                                    r && (n[t] = r);
                                });
                            },
                            f = s.data("rd-copied-text-styles");
                        if (!f) {
                            f = {};
                            var h = c.defaultView.getComputedStyle(a.ancestorEl);
                            d(h, f), s.data("rd-copied-text-styles", f);
                        }
                        var p = l.data("rd-copied-first-line-styles");
                        if (void 0 === p) {
                            p = null;
                            var g = n.getFirstLineStyles(a.blockAncestorEl);
                            g &&
                                ((p = {}),
                                d(g, p),
                                delete p["text-transform"],
                                t.each(["font-size", "letter-spacing"], function (e) {
                                    p[e] && (p[e] = n.lengthLib.toPx(a.ancestorEl, p[e]) + "px");
                                })),
                                l.data("rd-copied-first-line-styles", p);
                        }
                        if (p) {
                            var m = n.getFirstTextNodeChild(a.blockAncestorEl),
                                v = c.createRange();
                            v.setStart(m, 0), v.setEnd(a.node, a.startOffset + 1);
                            var b = v.getClientRects(),
                                y = new i({ lineHorizontalThreshold: e("body", c).clientWidth, lineHorizontalLimit: c.defaultView.innerWidth });
                            y.inferLines(
                                t.map(b, function (e) {
                                    return { rect: e };
                                })
                            ).length > 1 && (p = null);
                        }
                        t.each(f, function (e, t) {
                            (e = p ? p[t] || e : e), (u.style[t] = e);
                        }),
                            (u.style["line-height"] = a.rect.height + "px"),
                            u.appendChild(c.createTextNode(a.text)),
                            n.$el[0].appendChild(u);
                    }),
                    (processedElements = null),
                    (computedStyles = null));
            },
            setCSS: function () {
                this.$el.css({ position: "absolute", top: this.highlight.top + "px", left: this.highlight.left + "px", height: this.highlight.height + "px", width: this.highlight.width + "px" });
                var e = this.highlight.styles || {};
                try {
                    this.$el.css(e);
                } catch (e) {
                    console.log("EpubAnnotations: invalid css styles");
                }
            },
            setBaseHighlight: function (e) {
                var t = this.highlight.type;
                this.$el.addClass(t), this.$el.removeClass("hover-" + t), e && this.$el.removeClass("focused-" + t);
            },
            setHoverHighlight: function () {
                var e = this.highlight.type;
                this.$el.addClass("hover-" + e), this.$el.removeClass(e);
            },
            setFocusedHighlight: function () {
                var e = this.highlight.type;
                this.$el.addClass("focused-" + e), this.$el.removeClass(e).removeClass("hover-" + e);
            },
            setVisibility: function (e) {
                e ? this.$el.css("display", "") : this.$el.css("display", "none");
            },
        });
        return a;
    }),
    define("readium_plugin_highlights/views/border_view", ["./view"], function (e) {
        var t = e.extend({
            template: '<div class="rd-highlight-border"></div>',
            setCSS: function () {
                this.$el.css({ backgroundClip: "padding-box", borderStyle: "solid", borderWidth: "5px", boxSizing: "border-box" }), this._super();
            },
            setBaseHighlight: function () {
                this.$el.addClass("highlight-border"), this.$el.removeClass("hover-highlight-border").removeClass("focused-highlight-border");
            },
            setHoverHighlight: function () {
                this.$el.addClass("hover-highlight-border"), this.$el.removeClass("highlight-border");
            },
            setFocusedHighlight: function () {
                this.$el.addClass("focused-highlight-border"), this.$el.removeClass("highlight-border").removeClass("hover-highlight-border");
            },
        });
        return t;
    }),
    define("readium_plugin_highlights/models/group", ["jquery", "underscore", "../lib/class", "./text_line_inferrer", "../views/view", "../views/border_view", "../helpers"], function (e, t, n, r, i, o, a) {
        var s = t.debounce(function (e, t) {
                e(t);
            }, 10),
            l = n.extend({
                init: function (e, t) {
                    (this.context = e),
                        (this.highlightViews = []),
                        (this.CFI = t.CFI),
                        (this.selectedNodes = t.selectedNodes),
                        (this.offsetTopAddition = t.offsetTopAddition),
                        (this.offsetLeftAddition = t.offsetLeftAddition),
                        (this.styles = t.styles),
                        (this.id = t.id),
                        (this.type = t.type),
                        (this.scale = t.scale),
                        (this.selectionText = t.selectionText),
                        (this.visible = t.visible),
                        (this.rangeInfo = t.rangeInfo),
                        this.constructHighlightViews();
                },
                onHighlightEvent: function (e, n) {
                    var r = this,
                        i = this.context.iframe,
                        o = this.context.manager,
                        a = t.partial(o.trigger, t, r.type, r.CFI, r.id, e, i);
                    if ("click" === n || "touchend" === n) s(a, "annotationClicked");
                    else if ("contextmenu" === n) a("annotationRightClicked");
                    else if ("mousemove" === n) a("annotationMouseMove");
                    else if ("mouseenter" === n) a("annotationHoverIn");
                    else if ("mouseleave" === n) a("annotationHoverOut");
                    else if ("mousedown" === n) {
                        var l = function (e) {
                            e.preventDefault(), e.stopPropagation(), i.contentDocument.removeEventListener(e.type, l);
                        };
                        2 === e.button &&
                            (e.preventDefault(),
                            i.contentDocument.addEventListener("selectstart", l),
                            i.contentDocument.addEventListener("mouseup", l),
                            i.contentDocument.addEventListener("click", l),
                            i.contentDocument.addEventListener("contextmenu", l));
                    }
                    ("mouseenter" !== n && "mouseleave" !== n) ||
                        t.each(this.highlightViews, function (e) {
                            "mouseenter" === n ? e.setHoverHighlight() : "mouseleave" === n && e.setBaseHighlight(!1);
                        });
                },
                normalizeRectangle: function (e) {
                    return { left: e.left, right: e.right, top: e.top, bottom: e.bottom, width: e.right - e.left, height: e.bottom - e.top };
                },
                getBoundHighlightContainerEvents: function () {
                    var e = ["click", "touchstart", "touchend", "touchmove", "contextmenu", "mouseenter", "mouseleave", "mousemove", "mousedown"],
                        t = ".rdjsam-" + this.id;
                    return e
                        .map(function (e) {
                            return e + t;
                        })
                        .join(" ");
                },
                getFirstBlockParent: function (e) {
                    var t = e.ownerDocument.defaultView;
                    do {
                        var n = t.getComputedStyle(e);
                        if ("inline" !== n.display) return e;
                    } while ((e = e.parentNode));
                },
                constructHighlightViews: function () {
                    function n(e) {
                        var n,
                            r = e.toString(),
                            i = [],
                            o = e.startContainer,
                            a = e.commonAncestorContainer.nodeType === Node.ELEMENT_NODE ? e.commonAncestorContainer : e.commonAncestorContainer.parentNode,
                            s = c.getFirstBlockParent(a),
                            l = e.startOffset,
                            u = /\S+/g;
                        if (w)
                            for (; (n = u.exec(r)); ) {
                                var d = l + u.lastIndex - n[0].length,
                                    h = l + u.lastIndex;
                                e.setStart(o, d), e.setEnd(o, h);
                                for (var p = e.getClientRects(), g = 0, m = d, v = m; g < p.length; ) {
                                    var b = !1;
                                    if (0 !== p[g].width && 0 !== p[g].height) {
                                        if (g === p.length - 1) (v = h), (b = !0);
                                        else {
                                            v++, e.setStart(o, m), e.setEnd(o, v);
                                            var y = e.getClientRects(),
                                                _ = y[0];
                                            y.length > 1 && (0 === _.width || 0 === _.height) && (_ = y[1]);
                                            var x = 0;
                                            t.each(["top", "left", "bottom", "right"], function (e) {
                                                x += y[0][e] !== p[g][e] ? 1 : 0;
                                            }),
                                                0 === x && (b = !0);
                                        }
                                        b && (i.push({ rect: p[g], text: o.textContent.substring(m, v), node: o, startOffset: m }), g++, (m = v));
                                    } else g++;
                                }
                            }
                        else
                            t.each(e.getClientRects(), function (e) {
                                i.push({ rect: e, text: r });
                            });
                        t.each(i, function (e) {
                            var t = c.normalizeRectangle(e.rect);
                            0 !== t.width && 0 !== t.height && f.push({ rect: t, text: e.text, ancestorEl: a, blockAncestorEl: s, node: e.node, startOffset: e.startOffset });
                        });
                    }
                    function s() {
                        var e = c.scale,
                            t = a.getMatrix(C);
                        return t || (!c.context.isIe9 && !c.context.isIe10) ? t && (e = a.getScaleFromMatrix(t)) : (e = window.screen.deviceXDPI / 96), e;
                    }
                    function l(e, t) {
                        return e.x > t.left && e.x < t.right && e.y > t.top && e.y < t.bottom;
                    }
                    var c = this;
                    if (this.visible) {
                        var u,
                            d,
                            f = [],
                            h = [],
                            p = [],
                            g = 2,
                            m = this.rangeInfo,
                            v = this.selectedNodes,
                            b = this.includeMedia,
                            y = this.context.iframe,
                            _ = this.styles,
                            w = !!_ && "clone-text" === _["-rd-highlight-mode"];
                        if (m && m.startNode === m.endNode) {
                            var x = m.startNode,
                                E = c.context.document.createRange();
                            E.setStart(x, m.startOffset), E.setEnd(x, m.endOffset), x.nodeType === Node.TEXT_NODE && (n(E), (v = []));
                        }
                        t.each(v, function (e) {
                            var r = c.context.document.createRange();
                            e.nodeType === Node.TEXT_NODE
                                ? (m && e === m.startNode && 0 !== m.startOffset
                                      ? (r.setStart(e, m.startOffset), r.setEnd(e, e.length))
                                      : m && e === m.endNode && 0 !== m.endOffset
                                      ? (r.setStart(e, 0), r.setEnd(e, m.endOffset))
                                      : r.selectNodeContents(e),
                                  n(r))
                                : e.nodeType === Node.ELEMENT_NODE && b && t.contains(["img", "video", "audio"], e.tagName.toLowerCase()) && (r.selectNode(e), h.push(r.getBoundingClientRect()));
                        });
                        var C = e(c.context.document.documentElement),
                            T = s();
                        (u = new r({ lineHorizontalThreshold: e("body", C).clientWidth, lineHorizontalLimit: y.contentWindow.innerWidth })),
                            (d = u.inferLines(f)),
                            t.each(d, function (e, n) {
                                var r = e.data;
                                e = e.line;
                                var o = (e.startTop + c.offsetTopAddition) / T,
                                    a = (e.left + c.offsetLeftAddition) / T,
                                    s = e.avgHeight / T,
                                    l = e.width / T;
                                p.push({ top: o - g, left: a - g, bottom: o + s + 2 * g, right: a + l + 2 * g });
                                var u = new i(c.context, {
                                    id: c.id,
                                    CFI: c.CFI,
                                    type: c.type,
                                    top: o,
                                    left: a,
                                    height: s,
                                    width: l,
                                    styles: t.extend({ "z-index": "1000", "pointer-events": "none" }, _),
                                    contentRenderData: w ? { data: r, top: e.startTop, left: e.left } : null,
                                });
                                c.highlightViews.push(u);
                            }),
                            t.each(h, function (e) {
                                var t = (e.top + c.offsetTopAddition) / T,
                                    n = (e.left + c.offsetLeftAddition) / T,
                                    r = e.height / T,
                                    i = e.width / T;
                                p.push({ top: t - g, left: n - g, bottom: t + r + 2 * g, right: n + i + 2 * g });
                                var a = new o(this.context, { highlightId: c.id, CFI: c.CFI, top: t, left: n, height: r, width: i, styles: _ });
                                c.highlightViews.push(a);
                            });
                        var S = !1;
                        (c.boundHighlightCallback = function (e) {
                            var n = s(),
                                r = !1,
                                i = e.pageX,
                                o = e.pageY;
                            if ("touchend" === e.type) {
                                var a = t.last(e.changedTouches);
                                (i = a.pageX), (o = a.pageY);
                            }
                            var u = { x: (i + c.offsetLeftAddition) / n, y: (o + c.offsetTopAddition) / n };
                            t.each(p, function (t) {
                                if (l(u, t)) {
                                    if (((r = !0), "click" === e.type)) {
                                        var n = e.target.ownerDocument.getSelection();
                                        if (n && n.rangeCount && !n.getRangeAt(0).collapsed) return;
                                    }
                                    var i = e.type.indexOf("touch") !== -1;
                                    if ((i && c.onHighlightEvent(e, e.type), !S)) return c.onHighlightEvent(e, "mouseenter"), void (S = !0);
                                    i || c.onHighlightEvent(e, e.type);
                                }
                            }),
                                !r && S && ((S = !1), c.onHighlightEvent(e, "mouseleave"));
                        }),
                            (c.boundHighlightElement = C),
                            C.on(this.getBoundHighlightContainerEvents(), c.boundHighlightCallback);
                    }
                },
                resetHighlights: function (e, t, n) {
                    (this.offsetTopAddition = t), (this.offsetLeftAddition = n), this.destroyCurrentHighlights(), this.constructHighlightViews(), this.renderHighlights(e);
                },
                destroyCurrentHighlights: function () {
                    var e = this;
                    t.each(this.highlightViews, function (e) {
                        e.remove();
                    });
                    var n = e.getBoundHighlightContainerEvents(),
                        r = this.boundHighlightElement;
                    r && r.off(n, this.boundHighlightCallback), (this.boundHighlightCallback = null), (this.boundHighlightElement = null), (this.highlightViews.length = 0);
                },
                renderHighlights: function (n) {
                    this.visible &&
                        t.each(this.highlightViews, function (t, r) {
                            e(n).append(t.render());
                        });
                },
                toInfo: function () {
                    var e = [],
                        n = this.offsetTopAddition,
                        r = this.offsetLeftAddition,
                        i = this.scale;
                    return (
                        t.each(this.highlightViews, function (t, o) {
                            var a = t.highlight;
                            e.push({ top: (a.top - n) * i, left: (a.left - r) * i, height: a.height * i, width: a.width * i });
                        }),
                        { id: this.id, type: this.type, CFI: this.CFI, rectangleArray: e, selectedText: this.selectionText }
                    );
                },
                setStyles: function (e) {
                    (this.styles = e),
                        t.each(this.highlightViews, function (t, n) {
                            t.setStyles(e);
                        });
                },
                update: function (e, n) {
                    (this.type = e),
                        (this.styles = n),
                        t.each(this.highlightViews, function (t, r) {
                            t.update(e, n);
                        });
                },
                setState: function (e, n) {
                    t.each(this.highlightViews, function (t, r) {
                        "hover" === e ? (n ? t.setHoverHighlight() : t.setBaseHighlight(!1)) : "visible" === e ? t.setVisibility(n) : "focused" === e && (n ? t.setFocusedHighlight() : t.setBaseHighlight(!0));
                    });
                },
            });
        return l;
    }),
    define("readium_plugin_highlights/controller", ["jquery", "underscore", "./lib/class", "./helpers", "./models/group"], function (e, t, n, r, i) {
        var o = n.extend({
            highlights: [],
            annotationHash: {},
            offsetTopAddition: 0,
            offsetLeftAddition: 0,
            readerBoundElement: void 0,
            scale: 0,
            init: function (e, t) {
                (this.context = e),
                    (this.epubCFI = EPUBcfi),
                    (this.readerBoundElement = this.context.document.documentElement),
                    t.getVisibleCfiRangeFn && (this.getVisibleCfiRange = t.getVisibleCfiRangeFn),
                    this.context.cssUrl && this._injectAnnotationCSS(this.context.cssUrl);
                var n = this;
                this.context.document.addEventListener("mouseup", function (e) {
                    var t = n._getCurrentSelectionRange();
                    void 0 !== t && t.startOffset - t.endOffset && n.context.manager.trigger("textSelectionEvent", e, t, n.context.iframe);
                }),
                    rangy.initialized || rangy.init();
            },
            getVisibleCfiRange: function () {},
            redraw: function () {
                var e = this,
                    n = -this._getPaginationLeftOffset(),
                    r = this.context.paginationInfo().isVerticalWritingMode,
                    i = this.getVisibleCfiRange();
                t.each(this.highlights, function (t) {
                    var o = !0;
                    i && i.firstVisibleCfi && i.firstVisibleCfi.contentCFI && i.lastVisibleCfi && i.lastVisibleCfi.contentCFI && (o = e._cfiIsBetweenTwoCfis(t.CFI, i.firstVisibleCfi.contentCFI, i.lastVisibleCfi.contentCFI)),
                        (t.visible = o),
                        t.resetHighlights(e.readerBoundElement, r ? n : 0, r ? 0 : n);
                });
            },
            getHighlight: function (e) {
                var t = this.annotationHash[e];
                return t ? t.toInfo() : void 0;
            },
            getHighlights: function () {
                var e = [];
                return (
                    t.each(this.highlights, function (t) {
                        e.push(t.toInfo());
                    }),
                    e
                );
            },
            removeHighlight: function (e) {
                var n = this.annotationHash,
                    r = this.highlights;
                delete n[e],
                    (r = t.reject(r, function (t) {
                        return t.id == e && (t.destroyCurrentHighlights(), !0);
                    })),
                    (this.highlights = r);
            },
            removeHighlightsByType: function (e) {
                var n = this.annotationHash,
                    r = this.highlights;
                (r = t.reject(r, function (t) {
                    return t.type === e && (delete n[t.id], t.destroyCurrentHighlights(), !0);
                })),
                    (this.highlights = r);
            },
            generateIdPrefix: function () {
                var e = "xxxxxxxx".replace(/[x]/g, function (e) {
                    var t = (16 * Math.random()) | 0;
                    return t.toString(16);
                });
                return (e += "_");
            },
            addHighlight: function (t, n, i, o) {
                var a,
                    s,
                    l,
                    c,
                    u = this.context.document,
                    d = 1,
                    f = r.getMatrix(e("html", u));
                f && (d = r.getScaleFromMatrix(f));
                var h = e('<div style="font-size: 50px; position: absolute; background: red; top:-9001px;">##</div>');
                e(u.documentElement).append(h), (s = u.createRange()), s.selectNode(h[0]);
                var p = this._normalizeRectangle(s.getBoundingClientRect()).width,
                    g = h[0].clientWidth;
                h.remove();
                var m = p / g;
                1 === m ? (d = 1) : (this.context.isIe9 || this.context.isIe10) && (d = m), (this.scale = d);
                var v = "/99!",
                    b = "epubcfi(" + v + t + ")";
                if (this.epubCFI.Interpreter.isRangeCfi(b)) {
                    a = this.epubCFI.getRangeTargetElements(b, u, ["cfi-marker", "cfi-blacklist", "mo-cfi-highlight"], [], ["MathJax_Message", "MathJax_SVG_Hidden"]);
                    var y = a.startElement,
                        _ = a.endElement;
                    (s = rangy.createRange(u)), y.length < a.startOffset && (a.startOffset = y.length), s.setStart(y, a.startOffset), s.setEnd(_, a.endOffset), (l = s.getNodes());
                } else {
                    var w = this.epubCFI.getTargetElement(b, u, ["cfi-marker", "cfi-blacklist", "mo-cfi-highlight"], [], ["MathJax_Message", "MathJax_SVG_Hidden"]);
                    (l = [w ? w[0] : null]), (s = null);
                }
                c = -this._getPaginationLeftOffset();
                var x = this.context.paginationInfo().isVerticalWritingMode;
                return this._addHighlightHelper(t, n, i, o, l, s, y, _, x ? c : 0, x ? 0 : c), { selectedElements: l, CFI: t };
            },
            getCurrentSelectionCFI: function () {
                var e,
                    t = this._getCurrentSelectionRange();
                return t && ((selectionInfo = this._getSelectionInfo(t)), (e = selectionInfo.CFI)), e;
            },
            getCurrentSelectionOffsetCFI: function () {
                var e,
                    t = this._getCurrentSelectionRange();
                return t && (e = this._generateCharOffsetCFI(t)), e;
            },
            addSelectionHighlight: function (t, n, r, i) {
                var o = this.getCurrentSelectionCFI();
                if (o) {
                    if ((e(document).trigger("textSelected", o), i)) {
                        var a = this.context.document;
                        if (a.getSelection) {
                            var s = a.getSelection();
                            s.collapseToStart();
                        }
                    }
                    return this.addHighlight(o, t, n, r);
                }
                throw new Error("Nothing selected");
            },
            updateAnnotation: function (e, t, n) {
                var r = this.annotationHash[e];
                return r && r.update(t, n), r;
            },
            replaceAnnotation: function (e, t, n, r) {
                var i = this.annotationHash[e];
                return i && (this.removeHighlight(e), this.addHighlight(t, e, n, r)), i;
            },
            updateAnnotationView: function (e, t) {
                var n = this.annotationHash[e];
                return n && n.setStyles(t), n;
            },
            setAnnotationViewState: function (e, t, n) {
                var r = this.annotationHash[e];
                return r && r.setState(t, n), r;
            },
            setAnnotationViewStateForAll: function (e, n) {
                var r = this.annotationHash;
                t.each(r, function (t) {
                    t.setState(e, n);
                });
            },
            _parseContentCfi: function (e) {
                return e
                    .replace(/\[(.*?)\]/, "")
                    .split(/[\/,:]/)
                    .map(function (e) {
                        return parseInt(e);
                    })
                    .filter(Boolean);
            },
            _contentCfiComparator: function (e, t) {
                (e = this._parseContentCfi(e)), (t = this._parseContentCfi(t));
                for (var n = 0; n < e.length; n++) {
                    if (e[n] > t[n]) return 1;
                    if (e[n] < t[n]) return -1;
                }
                return e.length < t.length ? -1 : 0;
            },
            _cfiIsBetweenTwoCfis: function (e, t, n) {
                if (!t || !n) return null;
                var r = this._contentCfiComparator(e, t),
                    i = this._contentCfiComparator(e, n);
                return r >= 0 && i <= 0;
            },
            _addHighlightHelper: function (e, t, n, r, o, a, s, l, c, u) {
                c || (c = this.offsetTopAddition), u || (u = this.offsetLeftAddition);
                var d,
                    f = this.getVisibleCfiRange();
                if (
                    ((d = !(f && f.firstVisibleCfi && f.firstVisibleCfi.contentCFI && f.lastVisibleCfi && f.lastVisibleCfi.contentCFI) || this._cfiIsBetweenTwoCfis(e, f.firstVisibleCfi.contentCFI, f.lastVisibleCfi.contentCFI)),
                    (t = t.toString()),
                    this.annotationHash[t])
                )
                    throw new Error("That annotation id already exists; annotation not added");
                var h = new i(this.context, {
                    CFI: e,
                    selectedNodes: o,
                    offsetTopAddition: c,
                    offsetLeftAddition: u,
                    styles: r,
                    id: t,
                    type: n,
                    scale: this.scale,
                    selectionText: a ? a.toString() : "",
                    visible: d,
                    rangeInfo: a ? { startNode: s, startOffset: a.startOffset, endNode: l, endOffset: a.endOffset } : null,
                });
                (this.annotationHash[t] = h), this.highlights.push(h), h.renderHighlights(this.readerBoundElement);
            },
            _normalizeRectangle: function (e) {
                return { left: e.left, right: e.right, top: e.top, bottom: e.bottom, width: e.right - e.left, height: e.bottom - e.top };
            },
            _getSelectionInfo: function (e, t) {
                var n = this._generateRangeCFI(e),
                    r = { startElementFound: !1, endElementFound: !1 },
                    i = [];
                if (!t) var t = ["text"];
                return this._findSelectedElements(e.commonAncestorContainer, e.startContainer, e.endContainer, r, i, t), { CFI: n, selectedElements: i };
            },
            _generateRangeCFI: function (e) {
                var t,
                    n,
                    r,
                    i = e.startContainer,
                    o = e.endContainer;
                e.commonAncestorContainer;
                return (t = e.startOffset), (n = e.endOffset), (r = this.epubCFI.generateRangeComponent(i, t, o, n, ["cfi-marker", "cfi-blacklist", "mo-cfi-highlight"], [], ["MathJax_Message", "MathJax_SVG_Hidden"]));
            },
            _generateCharOffsetCFI: function (e) {
                var t,
                    n = e.startContainer,
                    r = e.startOffset;
                return n.nodeType === Node.TEXT_NODE && (t = this.epubCFI.generateCharacterOffsetCFIComponent(n, r, ["cfi-marker", "cfi-blacklist", "mo-cfi-highlight"], [], ["MathJax_Message", "MathJax_SVG_Hidden"])), t;
            },
            _findSelectedElements: function (e, t, n, r, i, o) {
                return (
                    e === t && (r.startElementFound = !0),
                    r.startElementFound === !0 && this._addElement(e, i, o),
                    e === n
                        ? void (r.endElementFound = !0)
                        : void ((e.firstChild && (this._findSelectedElements(e.firstChild, t, n, r, i, o), r.endElementFound)) || (e.nextSibling && (this._findSelectedElements(e.nextSibling, t, n, r, i, o), r.endElementFound)))
                );
            },
            _addElement: function (n, r, i) {
                t.each(i, function (t) {
                    "text" === t ? n.nodeType === Node.TEXT_NODE && r.push(n) : e(n).is(t) && r.push(n);
                });
            },
            _getCurrentSelectionRange: function () {
                var e,
                    t = this.context.document;
                if (t.getSelection) {
                    if (((e = t.getSelection()), !e || 0 === e.rangeCount)) return;
                    var n = e.getRangeAt(0);
                    return "" !== n.toString() ? n : void 0;
                }
                return t.selection ? t.selection.createRange() : void 0;
            },
            _getPaginationLeftOffset: function () {
                var t = e(this.context.document.documentElement);
                if (!t || !t.length) return 0;
                var n = t.css(this.context.paginationInfo().isVerticalWritingMode ? "top" : this.context.isRTL ? "right" : "left"),
                    r = parseInt(n.replace("px", ""));
                return isNaN(r) && (r = 0), this.context.isRTL && !this.context.paginationInfo().isVerticalWritingMode ? -r : r;
            },
            _injectAnnotationCSS: function (t) {
                var n = this.context.document;
                setTimeout(function () {
                    var r = e("head", n);
                    r.append(e("<link/>", { rel: "stylesheet", href: t, type: "text/css" }));
                }, 0);
            },
        });
        return o;
    }),
    define("readium_shared_js/models/bookmark_data", [], function () {
        var e = function (e, t) {
            var n = this;
            (this.idref = e),
                (this.contentCFI = t),
                (this.toString = function () {
                    return JSON.stringify(n);
                });
        };
        return (
            (e.fromString = function (t) {
                var n = JSON.parse(t);
                return new e(n.idref, n.contentCFI);
            }),
            e
        );
    }),
    define("readium_plugin_highlights/manager", ["jquery", "underscore", "eventEmitter", "./controller", "./helpers", "readium_shared_js/models/bookmark_data"], function (e, t, n, r, i, o) {
        var a = {},
            s = document.createElement("div");
        (s.innerHTML = "<!--[if IE 9]><i></i><![endif]-->"), (a.isIe9 = 1 == s.getElementsByTagName("i").length), (a.isIe10 = window.MSPointerEvent && !window.PointerEvent);
        var l = function (s, l) {
            function c(e) {
                return e.element ? e.element : e;
            }
            var u = this,
                d = {},
                f = {},
                h = s,
                p = l.annotationCSSUrl;
            p || console.warn("WARNING! Annotations CSS not supplied. Highlighting might not work."), t.extend(this, new n());
            var g = u.emit,
                m = function () {
                    var e = Array.prototype.slice.call(arguments),
                        t = function (t) {
                            if (e.length && e[0] === t)
                                for (var n in d) {
                                    var r = e[5],
                                        i = e[4];
                                    "undefined" == typeof i.clientX && ((i.clientX = i.pageX), (i.clientY = i.pageY));
                                    var o = e[3],
                                        a = e[2],
                                        s = e[1];
                                    if (d[n].getHighlight(o)) {
                                        var l = f[n].idref;
                                        e = [t, s, l, a, o, i, r];
                                    }
                                }
                        };
                    t("annotationClicked"), t("annotationTouched"), t("annotationRightClicked"), t("annotationHoverIn"), t("annotationHoverOut"), g.apply(this, e), g.apply(h, e);
                };
            (this.trigger = m),
                (this.emit = m),
                (this.attachAnnotations = function (e, n, i) {
                    var o = e[0],
                        s = t.extend(
                            {
                                document: o.contentDocument,
                                window: o.contentWindow,
                                iframe: o,
                                manager: u,
                                cssUrl: p,
                                isFixedLayout: n.isFixedLayout(),
                                isRTL: n.spine.isRightToLeft(),
                                paginationInfo: function () {
                                    return n.paginationInfo;
                                },
                            },
                            a
                        );
                    (d[n.index] = new r(s, { getVisibleCfiRangeFn: l.getVisibleCfiRangeFn })), (f[n.index] = n);
                    for (var c in d) d.hasOwnProperty(c) && !t.contains(i, f[c]) && delete d[c];
                }),
                (this.getCurrentSelectionCfi = function () {
                    for (var e in d) {
                        var t = d[e],
                            n = t.getCurrentSelectionCFI();
                        if (n) return { idref: f[e].idref, cfi: n };
                    }
                }),
                (this.addSelectionHighlight = function (e, t, n, r) {
                    for (var i in d) {
                        var a = d[i];
                        if (a.getCurrentSelectionCFI()) {
                            var s = a.addSelectionHighlight(e, t, n, r);
                            return new o(f[i].idref, s.CFI);
                        }
                    }
                }),
                (this.addHighlight = function (e, t, n, r, i) {
                    for (var a in d)
                        if (f[a].idref === e) {
                            var s = d[a],
                                l = s.addHighlight(t, n, r, i);
                            if (l) return new o(e, l.CFI);
                        }
                }),
                (this.removeHighlight = function (e) {
                    var t = void 0;
                    for (var n in d) {
                        var r = d[n];
                        t = r.removeHighlight(e);
                    }
                    return t;
                }),
                (this.removeHighlightsByType = function (e) {
                    var t = void 0;
                    for (var n in d) {
                        var r = d[n];
                        t = r.removeHighlightsByType(e);
                    }
                    return t;
                }),
                (this.getHighlight = function (e) {
                    var t = void 0;
                    for (var n in d) {
                        var r = d[n];
                        if (((t = r.getHighlight(e)), void 0 !== t)) return t;
                    }
                    return t;
                }),
                (this.updateAnnotation = function (e, t, n) {
                    var r = void 0;
                    for (var i in d) {
                        var o = d[i];
                        if ((r = o.updateAnnotation(e, t, n))) break;
                    }
                    return r;
                }),
                (this.replaceAnnotation = function (e, t, n, r) {
                    var i = void 0;
                    for (var o in d) {
                        var a = d[o];
                        if ((i = a.replaceAnnotation(e, t, n, r))) break;
                    }
                    return i;
                }),
                (this.redrawAnnotations = function () {
                    for (var e in d) d[e].redraw();
                }),
                (this.updateAnnotationView = function (e, t) {
                    var n = void 0;
                    for (var r in d) {
                        var i = d[r];
                        if ((n = i.updateAnnotationView(e, t))) break;
                    }
                    return n;
                }),
                (this.setAnnotationViewState = function (e, t, n) {
                    var r = void 0;
                    for (var i in d) {
                        var o = d[i];
                        if ((r = o.setAnnotationViewState(e, t, n))) break;
                    }
                    return r;
                }),
                (this.setAnnotationViewStateForAll = function (e, t) {
                    var n = void 0;
                    for (var r in d) {
                        var i = d[r];
                        if ((n = i.setAnnotationViewStateForAll(e, t))) break;
                    }
                    return n;
                }),
                (this.cfiIsBetweenTwoCfis = function (e, t, n) {
                    var r = void 0;
                    for (var i in d) {
                        var o = d[i];
                        if ((r = o.cfiIsBetweenTwoCfis(e, t, n))) break;
                    }
                    return r;
                }),
                (this.contentCfiComparator = function (e, t) {
                    var n = void 0;
                    for (var r in d) {
                        var i = d[r];
                        if ((n = i.contentCfiComparator(e, t))) break;
                    }
                    return n;
                }),
                (this.getAnnotationMidpoints = function (n) {
                    var r = [];
                    return (
                        t.each(n, function (n) {
                            var o = [],
                                a = null,
                                s = { top: 0, left: 0 };
                            if (n.elements && n.elements.length > 0) {
                                var l = c(n.elements[0]),
                                    u = l.ownerDocument.defaultView.frameElement.parentElement;
                                s = { top: u.offsetTop, left: u.offsetLeft };
                            }
                            t.each(n.elements, function (t) {
                                var n = e(c(t)),
                                    r = n.attr("data-id");
                                if (!r) return void console.warn("AnnotationsManager:getAnnotationMidpoints: Got an annotation element with no ID??");
                                if (r !== a) {
                                    a = r;
                                    var l = 1,
                                        u = n.parent(),
                                        d = i.getMatrix(u);
                                    d && (l = i.getScaleFromMatrix(d));
                                    var f = n.offset();
                                    (f.top += s.top + n.height() / 2), (f.left += s.left), 1 !== l && (f = { top: f.top * l * (1 / l), left: f.left });
                                    var h = { id: r, position: f, lineHeight: parseInt(n.css("line-height"), 10) };
                                    o.push(h);
                                }
                            }),
                                r.push({ annotations: o, spineItem: n.spineItem });
                        }),
                        r
                    );
                }),
                (this.getAnnotationsElementSelector = function () {
                    return "div.rd-highlight, div.rd-highlight-border";
                });
        };
        return l;
    }),
    define("readium_plugin_highlights/main", ["readium_js_plugins", "readium_shared_js/globals", "./manager"], function (e, t, n) {
        var r = {};
        return (
            e.register("highlights", function (e) {
                function r() {
                    return a || e.plugin.warn("Not initialized!"), a;
                }
                var i,
                    o = e.reader,
                    a = !1,
                    s = !1,
                    l = this;
                (this.initialize = function (t) {
                    return (
                        (t = t || {}),
                        setTimeout(r, 1e3),
                        a
                            ? void e.plugin.warn("Already initialized!")
                            : (o.getFirstVisibleCfi &&
                                  o.getLastVisibleCfi &&
                                  !t.getVisibleCfiRangeFn &&
                                  (t.getVisibleCfiRangeFn = function () {
                                      return { firstVisibleCfi: o.getFirstVisibleCfi(), lastVisibleCfi: o.getLastVisibleCfi() };
                                  }),
                              (i = new n(l, t)),
                              s && e.plugin.warn("Unable to attach to currently loaded content document.\nInitialize the plugin before loading a content document."),
                              void (a = !0))
                    );
                }),
                    (this.getHighlightsManager = function () {
                        return i;
                    }),
                    (this.getCurrentSelectionCfi = function () {
                        return i.getCurrentSelectionCfi();
                    }),
                    (this.addHighlight = function (e, t, n, r, o) {
                        return i.addHighlight(e, t, n, r, o);
                    }),
                    (this.addSelectionHighlight = function (e, t, n, r) {
                        return i.addSelectionHighlight(e, t, n, r);
                    }),
                    (this.removeHighlight = function (e) {
                        return i.removeHighlight(e);
                    }),
                    (this.removeHighlightsByType = function (e) {
                        return i.removeHighlightsByType(e);
                    }),
                    (this.getHighlight = function (e) {
                        return i.getHighlight(e);
                    }),
                    (this.updateAnnotation = function (e, t, n) {
                        i.updateAnnotation(e, t, n);
                    }),
                    (this.replaceAnnotation = function (e, t, n, r) {
                        i.replaceAnnotation(e, t, n, r);
                    }),
                    (this.redrawAnnotations = function () {
                        i.redrawAnnotations();
                    }),
                    (this.updateAnnotationView = function (e, t) {
                        i.updateAnnotationView(e, t);
                    }),
                    (this.setAnnotationViewState = function (e, t, n) {
                        return i.setAnnotationViewState(e, t, n);
                    }),
                    (this.setAnnotationViewStateForAll = function (e, t) {
                        return i.setAnnotationViewStateForAll(e, t);
                    }),
                    (this.getVisibleAnnotationMidpoints = function () {
                        if (o.getVisibleElements) {
                            var e = o.getVisibleElements(i.getAnnotationsElementSelector(), !0),
                                t = i.getAnnotationMidpoints(e);
                            return t || [];
                        }
                        console.warn("getAnnotationMidpoints won't work with this version of Readium");
                    }),
                    o.on(t.Events.CONTENT_DOCUMENT_LOADED, function (e, t) {
                        a ? i.attachAnnotations(e, t, o.getLoadedSpineItems()) : (s = !0);
                    });
            }),
            r
        );
    }),
    define("readium_plugin_highlights", ["readium_plugin_highlights/main"], function (e) {
        return e;
    }),
    (function () {
        "use strict";
        console.debug || (console.debug = console.log), console.info || (console.info = console.log), console.warn || (console.warn = console.log), console.error || (console.error = console.log);
    })(),
    define("console_shim", function () {}),
    (function (e) {
        "use strict";
        function t(e, t) {
            function r(e) {
                return this && this.constructor === r ? ((this._keys = []), (this._values = []), (this._itp = []), (this.objectOnly = t), void (e && n.call(this, e))) : new r(e);
            }
            return t || y(e, "size", { get: m }), (e.constructor = r), (r.prototype = e), r;
        }
        function n(e) {
            this.add
                ? e.forEach(this.add, this)
                : e.forEach(function (e) {
                      this.set(e[0], e[1]);
                  }, this);
        }
        function r(e) {
            return (
                this.has(e) &&
                    (this._keys.splice(b, 1),
                    this._values.splice(b, 1),
                    this._itp.forEach(function (e) {
                        b < e[0] && e[0]--;
                    })),
                -1 < b
            );
        }
        function i(e) {
            return this.has(e) ? this._values[b] : void 0;
        }
        function o(e, t) {
            if (this.objectOnly && t !== Object(t)) throw new TypeError("Invalid value used as weak collection key");
            if (t != t || 0 === t) for (b = e.length; b-- && !_(e[b], t); );
            else b = e.indexOf(t);
            return -1 < b;
        }
        function a(e) {
            return o.call(this, this._values, e);
        }
        function s(e) {
            return o.call(this, this._keys, e);
        }
        function l(e, t) {
            return this.has(e) ? (this._values[b] = t) : (this._values[this._keys.push(e) - 1] = t), this;
        }
        function c(e) {
            return this.has(e) || this._values.push(e), this;
        }
        function u() {
            (this._keys || 0).length = this._values.length = 0;
        }
        function d() {
            return g(this._itp, this._keys);
        }
        function f() {
            return g(this._itp, this._values);
        }
        function h() {
            return g(this._itp, this._keys, this._values);
        }
        function p() {
            return g(this._itp, this._values, this._values);
        }
        function g(e, t, n) {
            var r = [0],
                i = !1;
            return (
                e.push(r),
                {
                    next: function () {
                        var o,
                            a = r[0];
                        return !i && a < t.length ? ((o = n ? [t[a], n[a]] : t[a]), r[0]++) : ((i = !0), e.splice(e.indexOf(r), 1)), { done: i, value: o };
                    },
                }
            );
        }
        function m() {
            return this._values.length;
        }
        function v(e, t) {
            for (var n = this.entries(); ; ) {
                var r = n.next();
                if (r.done) break;
                e.call(t, r.value[1], r.value[0], this);
            }
        }
        var b,
            y = Object.defineProperty,
            _ = function (e, t) {
                return e === t || (e !== e && t !== t);
            };
        "undefined" == typeof WeakMap && (e.WeakMap = t({ delete: r, clear: u, get: i, has: s, set: l }, !0)),
            ("undefined" != typeof Map && "function" == typeof new Map().values && new Map().values().next) || (e.Map = t({ delete: r, has: s, get: i, set: l, keys: d, values: f, entries: h, forEach: v, clear: u })),
            ("undefined" != typeof Set && "function" == typeof new Set().values && new Set().values().next) || (e.Set = t({ has: a, add: c, delete: r, clear: u, keys: f, values: f, entries: p, forEach: v })),
            "undefined" == typeof WeakSet && (e.WeakSet = t({ delete: r, add: c, clear: u, has: a }, !0));
    })("undefined" != typeof exports && "undefined" != typeof global ? global : window),
    define("es6-collections", function () {}),
    (function (e) {
        function t(e) {
            throw new RangeError(P[e]);
        }
        function n(e, t) {
            for (var n = e.length, r = []; n--; ) r[n] = t(e[n]);
            return r;
        }
        function r(e, t) {
            var r = e.split("@"),
                i = "";
            r.length > 1 && ((i = r[0] + "@"), (e = r[1])), (e = e.replace(k, "."));
            var o = e.split("."),
                a = n(o, t).join(".");
            return i + a;
        }
        function i(e) {
            for (var t, n, r = [], i = 0, o = e.length; i < o; )
                (t = e.charCodeAt(i++)), t >= 55296 && t <= 56319 && i < o ? ((n = e.charCodeAt(i++)), 56320 == (64512 & n) ? r.push(((1023 & t) << 10) + (1023 & n) + 65536) : (r.push(t), i--)) : r.push(t);
            return r;
        }
        function o(e) {
            return n(e, function (e) {
                var t = "";
                return e > 65535 && ((e -= 65536), (t += A(((e >>> 10) & 1023) | 55296)), (e = 56320 | (1023 & e))), (t += A(e));
            }).join("");
        }
        function a(e) {
            return e - 48 < 10 ? e - 22 : e - 65 < 26 ? e - 65 : e - 97 < 26 ? e - 97 : y;
        }
        function s(e, t) {
            return e + 22 + 75 * (e < 26) - ((0 != t) << 5);
        }
        function l(e, t, n) {
            var r = 0;
            for (e = n ? O(e / E) : e >> 1, e += O(e / t); e > (N * w) >> 1; r += y) e = O(e / N);
            return O(r + ((N + 1) * e) / (e + x));
        }
        function c(e) {
            var n,
                r,
                i,
                s,
                c,
                u,
                d,
                f,
                h,
                p,
                g = [],
                m = e.length,
                v = 0,
                x = T,
                E = C;
            for (r = e.lastIndexOf(S), r < 0 && (r = 0), i = 0; i < r; ++i) e.charCodeAt(i) >= 128 && t("not-basic"), g.push(e.charCodeAt(i));
            for (s = r > 0 ? r + 1 : 0; s < m; ) {
                for (c = v, u = 1, d = y; s >= m && t("invalid-input"), (f = a(e.charCodeAt(s++))), (f >= y || f > O((b - v) / u)) && t("overflow"), (v += f * u), (h = d <= E ? _ : d >= E + w ? w : d - E), !(f < h); d += y)
                    (p = y - h), u > O(b / p) && t("overflow"), (u *= p);
                (n = g.length + 1), (E = l(v - c, n, 0 == c)), O(v / n) > b - x && t("overflow"), (x += O(v / n)), (v %= n), g.splice(v++, 0, x);
            }
            return o(g);
        }
        function u(e) {
            var n,
                r,
                o,
                a,
                c,
                u,
                d,
                f,
                h,
                p,
                g,
                m,
                v,
                x,
                E,
                R = [];
            for (e = i(e), m = e.length, n = T, r = 0, c = C, u = 0; u < m; ++u) (g = e[u]), g < 128 && R.push(A(g));
            for (o = a = R.length, a && R.push(S); o < m; ) {
                for (d = b, u = 0; u < m; ++u) (g = e[u]), g >= n && g < d && (d = g);
                for (v = o + 1, d - n > O((b - r) / v) && t("overflow"), r += (d - n) * v, n = d, u = 0; u < m; ++u)
                    if (((g = e[u]), g < n && ++r > b && t("overflow"), g == n)) {
                        for (f = r, h = y; (p = h <= c ? _ : h >= c + w ? w : h - c), !(f < p); h += y) (E = f - p), (x = y - p), R.push(A(s(p + (E % x), 0))), (f = O(E / x));
                        R.push(A(s(f, 0))), (c = l(r, v, o == a)), (r = 0), ++o;
                    }
                ++r, ++n;
            }
            return R.join("");
        }
        function d(e) {
            return r(e, function (e) {
                return R.test(e) ? c(e.slice(4).toLowerCase()) : e;
            });
        }
        function f(e) {
            return r(e, function (e) {
                return I.test(e) ? "xn--" + u(e) : e;
            });
        }
        var h = "object" == typeof exports && exports && !exports.nodeType && exports,
            p = "object" == typeof module && module && !module.nodeType && module,
            g = "object" == typeof global && global;
        (g.global !== g && g.window !== g && g.self !== g) || (e = g);
        var m,
            v,
            b = 2147483647,
            y = 36,
            _ = 1,
            w = 26,
            x = 38,
            E = 700,
            C = 72,
            T = 128,
            S = "-",
            R = /^xn--/,
            I = /[^\x20-\x7E]/,
            k = /[\x2E\u3002\uFF0E\uFF61]/g,
            P = { overflow: "Overflow: input needs wider integers to process", "not-basic": "Illegal input >= 0x80 (not a basic code point)", "invalid-input": "Invalid input" },
            N = y - _,
            O = Math.floor,
            A = String.fromCharCode;
        if (((m = { version: "1.3.2", ucs2: { decode: i, encode: o }, decode: c, encode: u, toASCII: f, toUnicode: d }), "function" == typeof define && "object" == typeof define.amd && define.amd))
            define("punycode", [], function () {
                return m;
            });
        else if (h && p)
            if (module.exports == h) p.exports = m;
            else for (v in m) m.hasOwnProperty(v) && (h[v] = m[v]);
        else e.punycode = m;
    })(this),
    (function (e, t) {
        "use strict";
        "object" == typeof exports ? (module.exports = t()) : "function" == typeof define && define.amd ? define("IPv6", t) : (e.IPv6 = t(e));
    })(this, function (e) {
        "use strict";
        function t(e) {
            var t = e.toLowerCase(),
                n = t.split(":"),
                r = n.length,
                i = 8;
            "" === n[0] && "" === n[1] && "" === n[2] ? (n.shift(), n.shift()) : "" === n[0] && "" === n[1] ? n.shift() : "" === n[r - 1] && "" === n[r - 2] && n.pop(), (r = n.length), n[r - 1].indexOf(".") !== -1 && (i = 7);
            var o;
            for (o = 0; o < r && "" !== n[o]; o++);
            if (o < i) for (n.splice(o, 1, "0000"); n.length < i; ) n.splice(o, 0, "0000");
            for (var a, s = 0; s < i; s++) {
                a = n[s].split("");
                for (var l = 0; l < 3 && "0" === a[0] && a.length > 1; l++) a.splice(0, 1);
                n[s] = a.join("");
            }
            var c = -1,
                u = 0,
                d = 0,
                f = -1,
                h = !1;
            for (s = 0; s < i; s++) h ? ("0" === n[s] ? (d += 1) : ((h = !1), d > u && ((c = f), (u = d)))) : "0" === n[s] && ((h = !0), (f = s), (d = 1));
            d > u && ((c = f), (u = d)), u > 1 && n.splice(c, u, ""), (r = n.length);
            var p = "";
            for ("" === n[0] && (p = ":"), s = 0; s < r && ((p += n[s]), s !== r - 1); s++) p += ":";
            return "" === n[r - 1] && (p += ":"), p;
        }
        function n() {
            return e.IPv6 === this && (e.IPv6 = r), this;
        }
        var r = e && e.IPv6;
        return { best: t, noConflict: n };
    }),
    (function (e, t) {
        "use strict";
        "object" == typeof exports ? (module.exports = t()) : "function" == typeof define && define.amd ? define("SecondLevelDomains", t) : (e.SecondLevelDomains = t(e));
    })(this, function (e) {
        "use strict";
        var t = e && e.SecondLevelDomains,
            n = {
                list: {
                    ac: " com gov mil net org ",
                    ae: " ac co gov mil name net org pro sch ",
                    af: " com edu gov net org ",
                    al: " com edu gov mil net org ",
                    ao: " co ed gv it og pb ",
                    ar: " com edu gob gov int mil net org tur ",
                    at: " ac co gv or ",
                    au: " asn com csiro edu gov id net org ",
                    ba: " co com edu gov mil net org rs unbi unmo unsa untz unze ",
                    bb: " biz co com edu gov info net org store tv ",
                    bh: " biz cc com edu gov info net org ",
                    bn: " com edu gov net org ",
                    bo: " com edu gob gov int mil net org tv ",
                    br:
                        " adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",
                    bs: " com edu gov net org ",
                    bz: " du et om ov rg ",
                    ca: " ab bc mb nb nf nl ns nt nu on pe qc sk yk ",
                    ck: " biz co edu gen gov info net org ",
                    cn: " ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",
                    co: " com edu gov mil net nom org ",
                    cr: " ac c co ed fi go or sa ",
                    cy: " ac biz com ekloges gov ltd name net org parliament press pro tm ",
                    do: " art com edu gob gov mil net org sld web ",
                    dz: " art asso com edu gov net org pol ",
                    ec: " com edu fin gov info med mil net org pro ",
                    eg: " com edu eun gov mil name net org sci ",
                    er: " com edu gov ind mil net org rochest w ",
                    es: " com edu gob nom org ",
                    et: " biz com edu gov info name net org ",
                    fj: " ac biz com info mil name net org pro ",
                    fk: " ac co gov net nom org ",
                    fr: " asso com f gouv nom prd presse tm ",
                    gg: " co net org ",
                    gh: " com edu gov mil org ",
                    gn: " ac com gov net org ",
                    gr: " com edu gov mil net org ",
                    gt: " com edu gob ind mil net org ",
                    gu: " com edu gov net org ",
                    hk: " com edu gov idv net org ",
                    hu: " 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",
                    id: " ac co go mil net or sch web ",
                    il: " ac co gov idf k12 muni net org ",
                    in: " ac co edu ernet firm gen gov i ind mil net nic org res ",
                    iq: " com edu gov i mil net org ",
                    ir: " ac co dnssec gov i id net org sch ",
                    it: " edu gov ",
                    je: " co net org ",
                    jo: " com edu gov mil name net org sch ",
                    jp: " ac ad co ed go gr lg ne or ",
                    ke: " ac co go info me mobi ne or sc ",
                    kh: " com edu gov mil net org per ",
                    ki: " biz com de edu gov info mob net org tel ",
                    km: " asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",
                    kn: " edu gov net org ",
                    kr: " ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",
                    kw: " com edu gov net org ",
                    ky: " com edu gov net org ",
                    kz: " com edu gov mil net org ",
                    lb: " com edu gov net org ",
                    lk: " assn com edu gov grp hotel int ltd net ngo org sch soc web ",
                    lr: " com edu gov net org ",
                    lv: " asn com conf edu gov id mil net org ",
                    ly: " com edu gov id med net org plc sch ",
                    ma: " ac co gov m net org press ",
                    mc: " asso tm ",
                    me: " ac co edu gov its net org priv ",
                    mg: " com edu gov mil nom org prd tm ",
                    mk: " com edu gov inf name net org pro ",
                    ml: " com edu gov net org presse ",
                    mn: " edu gov org ",
                    mo: " com edu gov net org ",
                    mt: " com edu gov net org ",
                    mv: " aero biz com coop edu gov info int mil museum name net org pro ",
                    mw: " ac co com coop edu gov int museum net org ",
                    mx: " com edu gob net org ",
                    my: " com edu gov mil name net org sch ",
                    nf: " arts com firm info net other per rec store web ",
                    ng: " biz com edu gov mil mobi name net org sch ",
                    ni: " ac co com edu gob mil net nom org ",
                    np: " com edu gov mil net org ",
                    nr: " biz com edu gov info net org ",
                    om: " ac biz co com edu gov med mil museum net org pro sch ",
                    pe: " com edu gob mil net nom org sld ",
                    ph: " com edu gov i mil net ngo org ",
                    pk: " biz com edu fam gob gok gon gop gos gov net org web ",
                    pl: " art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",
                    pr: " ac biz com edu est gov info isla name net org pro prof ",
                    ps: " com edu gov net org plo sec ",
                    pw: " belau co ed go ne or ",
                    ro: " arts com firm info nom nt org rec store tm www ",
                    rs: " ac co edu gov in org ",
                    sb: " com edu gov net org ",
                    sc: " com edu gov net org ",
                    sh: " co com edu gov net nom org ",
                    sl: " com edu gov net org ",
                    st: " co com consulado edu embaixada gov mil net org principe saotome store ",
                    sv: " com edu gob org red ",
                    sz: " ac co org ",
                    tr: " av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",
                    tt: " aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",
                    tw: " club com ebiz edu game gov idv mil net org ",
                    mu: " ac co com gov net or org ",
                    mz: " ac co edu gov org ",
                    na: " co com ",
                    nz: " ac co cri geek gen govt health iwi maori mil net org parliament school ",
                    pa: " abo ac com edu gob ing med net nom org sld ",
                    pt: " com edu gov int net nome org publ ",
                    py: " com edu gov mil net org ",
                    qa: " com edu gov mil net org ",
                    re: " asso com nom ",
                    ru:
                        " ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",
                    rw: " ac co com edu gouv gov int mil net ",
                    sa: " com edu gov med net org pub sch ",
                    sd: " com edu gov info med net org tv ",
                    se: " a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",
                    sg: " com edu gov idn net org per ",
                    sn: " art com edu gouv org perso univ ",
                    sy: " com edu gov mil net news org ",
                    th: " ac co go in mi net or ",
                    tj: " ac biz co com edu go gov info int mil name net nic org test web ",
                    tn: " agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",
                    tz: " ac co go ne or ",
                    ua:
                        " biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",
                    ug: " ac co go ne or org sc ",
                    uk: " ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",
                    us: " dni fed isa kids nsn ",
                    uy: " com edu gub mil net org ",
                    ve: " co com edu gob info mil net org web ",
                    vi: " co com k12 net org ",
                    vn: " ac biz com edu gov health info int name net org pro ",
                    ye: " co com gov ltd me net org plc ",
                    yu: " ac co edu gov org ",
                    za: " ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",
                    zm: " ac co com edu gov net org sch ",
                },
                has: function (e) {
                    var t = e.lastIndexOf(".");
                    if (t <= 0 || t >= e.length - 1) return !1;
                    var r = e.lastIndexOf(".", t - 1);
                    if (r <= 0 || r >= t - 1) return !1;
                    var i = n.list[e.slice(t + 1)];
                    return !!i && i.indexOf(" " + e.slice(r + 1, t) + " ") >= 0;
                },
                is: function (e) {
                    var t = e.lastIndexOf(".");
                    if (t <= 0 || t >= e.length - 1) return !1;
                    var r = e.lastIndexOf(".", t - 1);
                    if (r >= 0) return !1;
                    var i = n.list[e.slice(t + 1)];
                    return !!i && i.indexOf(" " + e.slice(0, t) + " ") >= 0;
                },
                get: function (e) {
                    var t = e.lastIndexOf(".");
                    if (t <= 0 || t >= e.length - 1) return null;
                    var r = e.lastIndexOf(".", t - 1);
                    if (r <= 0 || r >= t - 1) return null;
                    var i = n.list[e.slice(t + 1)];
                    return i ? (i.indexOf(" " + e.slice(r + 1, t) + " ") < 0 ? null : e.slice(r + 1)) : null;
                },
                noConflict: function () {
                    return e.SecondLevelDomains === this && (e.SecondLevelDomains = t), this;
                },
            };
        return n;
    }),
    (function (e, t) {
        "use strict";
        "object" == typeof exports
            ? (module.exports = t(require("./punycode"), require("./IPv6"), require("./SecondLevelDomains")))
            : "function" == typeof define && define.amd
            ? define("URIjs", ["./punycode", "./IPv6", "./SecondLevelDomains"], t)
            : (e.URI = t(e.punycode, e.IPv6, e.SecondLevelDomains, e));
    })(this, function (e, t, n, r) {
        "use strict";
        function i(e, t) {
            var n = arguments.length >= 1,
                r = arguments.length >= 2;
            if (!(this instanceof i)) return n ? (r ? new i(e, t) : new i(e)) : new i();
            if (void 0 === e) {
                if (n) throw new TypeError("undefined is not a valid argument for URI");
                e = "undefined" != typeof location ? location.href + "" : "";
            }
            return this.href(e), void 0 !== t ? this.absoluteTo(t) : this;
        }
        function o(e) {
            return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g, "\\$1");
        }
        function a(e) {
            return void 0 === e ? "Undefined" : String(Object.prototype.toString.call(e)).slice(8, -1);
        }
        function s(e) {
            return "Array" === a(e);
        }
        function l(e, t) {
            var n,
                r,
                i = {};
            if ("RegExp" === a(t)) i = null;
            else if (s(t)) for (n = 0, r = t.length; n < r; n++) i[t[n]] = !0;
            else i[t] = !0;
            for (n = 0, r = e.length; n < r; n++) {
                var o = (i && void 0 !== i[e[n]]) || (!i && t.test(e[n]));
                o && (e.splice(n, 1), r--, n--);
            }
            return e;
        }
        function c(e, t) {
            var n, r;
            if (s(t)) {
                for (n = 0, r = t.length; n < r; n++) if (!c(e, t[n])) return !1;
                return !0;
            }
            var i = a(t);
            for (n = 0, r = e.length; n < r; n++)
                if ("RegExp" === i) {
                    if ("string" == typeof e[n] && e[n].match(t)) return !0;
                } else if (e[n] === t) return !0;
            return !1;
        }
        function u(e, t) {
            if (!s(e) || !s(t)) return !1;
            if (e.length !== t.length) return !1;
            e.sort(), t.sort();
            for (var n = 0, r = e.length; n < r; n++) if (e[n] !== t[n]) return !1;
            return !0;
        }
        function d(e) {
            var t = /^\/+|\/+$/g;
            return e.replace(t, "");
        }
        function f(e) {
            return escape(e);
        }
        function h(e) {
            return encodeURIComponent(e)
                .replace(/[!'()*]/g, f)
                .replace(/\*/g, "%2A");
        }
        function p(e) {
            return function (t, n) {
                return void 0 === t ? this._parts[e] || "" : ((this._parts[e] = t || null), this.build(!n), this);
            };
        }
        function g(e, t) {
            return function (n, r) {
                return void 0 === n ? this._parts[e] || "" : (null !== n && ((n += ""), n.charAt(0) === t && (n = n.substring(1))), (this._parts[e] = n), this.build(!r), this);
            };
        }
        var m = r && r.URI;
        i.version = "1.18.2";
        var v = i.prototype,
            b = Object.prototype.hasOwnProperty;
        (i._parts = function () {
            return {
                protocol: null,
                username: null,
                password: null,
                hostname: null,
                urn: null,
                port: null,
                path: null,
                query: null,
                fragment: null,
                duplicateQueryParameters: i.duplicateQueryParameters,
                escapeQuerySpace: i.escapeQuerySpace,
            };
        }),
            (i.duplicateQueryParameters = !1),
            (i.escapeQuerySpace = !0),
            (i.protocol_expression = /^[a-z][a-z0-9.+-]*$/i),
            (i.idn_expression = /[^a-z0-9\.-]/i),
            (i.punycode_expression = /(xn--)/i),
            (i.ip4_expression = /^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/),
            (i.ip6_expression = /^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/),
            (i.find_uri_expression = /\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]))/gi),
            (i.findUri = { start: /\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi, end: /[\s\r\n]|$/, trim: /[`!()\[\]{};:'".,<>?]+$/ }),
            (i.defaultPorts = { http: "80", https: "443", ftp: "21", gopher: "70", ws: "80", wss: "443" }),
            (i.invalid_hostname_characters = /[^a-zA-Z0-9\.-]/),
            (i.domAttributes = {
                a: "href",
                blockquote: "cite",
                link: "href",
                base: "href",
                script: "src",
                form: "action",
                img: "src",
                area: "href",
                iframe: "src",
                embed: "src",
                source: "src",
                track: "src",
                input: "src",
                audio: "src",
                video: "src",
            }),
            (i.getDomAttribute = function (e) {
                if (e && e.nodeName) {
                    var t = e.nodeName.toLowerCase();
                    if ("input" !== t || "image" === e.type) return i.domAttributes[t];
                }
            }),
            (i.encode = h),
            (i.decode = decodeURIComponent),
            (i.iso8859 = function () {
                (i.encode = escape), (i.decode = unescape);
            }),
            (i.unicode = function () {
                (i.encode = h), (i.decode = decodeURIComponent);
            }),
            (i.characters = {
                pathname: {
                    encode: { expression: /%(24|26|2B|2C|3B|3D|3A|40)/gi, map: { "%24": "$", "%26": "&", "%2B": "+", "%2C": ",", "%3B": ";", "%3D": "=", "%3A": ":", "%40": "@" } },
                    decode: { expression: /[\/\?#]/g, map: { "/": "%2F", "?": "%3F", "#": "%23" } },
                },
                reserved: {
                    encode: {
                        expression: /%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,
                        map: {
                            "%3A": ":",
                            "%2F": "/",
                            "%3F": "?",
                            "%23": "#",
                            "%5B": "[",
                            "%5D": "]",
                            "%40": "@",
                            "%21": "!",
                            "%24": "$",
                            "%26": "&",
                            "%27": "'",
                            "%28": "(",
                            "%29": ")",
                            "%2A": "*",
                            "%2B": "+",
                            "%2C": ",",
                            "%3B": ";",
                            "%3D": "=",
                        },
                    },
                },
                urnpath: {
                    encode: { expression: /%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi, map: { "%21": "!", "%24": "$", "%27": "'", "%28": "(", "%29": ")", "%2A": "*", "%2B": "+", "%2C": ",", "%3B": ";", "%3D": "=", "%40": "@" } },
                    decode: { expression: /[\/\?#:]/g, map: { "/": "%2F", "?": "%3F", "#": "%23", ":": "%3A" } },
                },
            }),
            (i.encodeQuery = function (e, t) {
                var n = i.encode(e + "");
                return void 0 === t && (t = i.escapeQuerySpace), t ? n.replace(/%20/g, "+") : n;
            }),
            (i.decodeQuery = function (e, t) {
                (e += ""), void 0 === t && (t = i.escapeQuerySpace);
                try {
                    return i.decode(t ? e.replace(/\+/g, "%20") : e);
                } catch (t) {
                    return e;
                }
            });
        var y,
            _ = { encode: "encode", decode: "decode" },
            w = function (e, t) {
                return function (n) {
                    try {
                        return i[t](n + "").replace(i.characters[e][t].expression, function (n) {
                            return i.characters[e][t].map[n];
                        });
                    } catch (e) {
                        return n;
                    }
                };
            };
        for (y in _) (i[y + "PathSegment"] = w("pathname", _[y])), (i[y + "UrnPathSegment"] = w("urnpath", _[y]));
        var x = function (e, t, n) {
            return function (r) {
                var o;
                o = n
                    ? function (e) {
                          return i[t](i[n](e));
                      }
                    : i[t];
                for (var a = (r + "").split(e), s = 0, l = a.length; s < l; s++) a[s] = o(a[s]);
                return a.join(e);
            };
        };
        (i.decodePath = x("/", "decodePathSegment")),
            (i.decodeUrnPath = x(":", "decodeUrnPathSegment")),
            (i.recodePath = x("/", "encodePathSegment", "decode")),
            (i.recodeUrnPath = x(":", "encodeUrnPathSegment", "decode")),
            (i.encodeReserved = w("reserved", "encode")),
            (i.parse = function (e, t) {
                var n;
                return (
                    t || (t = {}),
                    (n = e.indexOf("#")),
                    n > -1 && ((t.fragment = e.substring(n + 1) || null), (e = e.substring(0, n))),
                    (n = e.indexOf("?")),
                    n > -1 && ((t.query = e.substring(n + 1) || null), (e = e.substring(0, n))),
                    "//" === e.substring(0, 2)
                        ? ((t.protocol = null), (e = e.substring(2)), (e = i.parseAuthority(e, t)))
                        : ((n = e.indexOf(":")),
                          n > -1 &&
                              ((t.protocol = e.substring(0, n) || null),
                              t.protocol && !t.protocol.match(i.protocol_expression)
                                  ? (t.protocol = void 0)
                                  : "//" === e.substring(n + 1, n + 3)
                                  ? ((e = e.substring(n + 3)), (e = i.parseAuthority(e, t)))
                                  : ((e = e.substring(n + 1)), (t.urn = !0)))),
                    (t.path = e),
                    t
                );
            }),
            (i.parseHost = function (e, t) {
                e = e.replace(/\\/g, "/");
                var n,
                    r,
                    i = e.indexOf("/");
                if ((i === -1 && (i = e.length), "[" === e.charAt(0))) (n = e.indexOf("]")), (t.hostname = e.substring(1, n) || null), (t.port = e.substring(n + 2, i) || null), "/" === t.port && (t.port = null);
                else {
                    var o = e.indexOf(":"),
                        a = e.indexOf("/"),
                        s = e.indexOf(":", o + 1);
                    s !== -1 && (a === -1 || s < a) ? ((t.hostname = e.substring(0, i) || null), (t.port = null)) : ((r = e.substring(0, i).split(":")), (t.hostname = r[0] || null), (t.port = r[1] || null));
                }
                return t.hostname && "/" !== e.substring(i).charAt(0) && (i++, (e = "/" + e)), e.substring(i) || "/";
            }),
            (i.parseAuthority = function (e, t) {
                return (e = i.parseUserinfo(e, t)), i.parseHost(e, t);
            }),
            (i.parseUserinfo = function (e, t) {
                var n,
                    r = e.indexOf("/"),
                    o = e.lastIndexOf("@", r > -1 ? r : e.length - 1);
                return (
                    o > -1 && (r === -1 || o < r)
                        ? ((n = e.substring(0, o).split(":")), (t.username = n[0] ? i.decode(n[0]) : null), n.shift(), (t.password = n[0] ? i.decode(n.join(":")) : null), (e = e.substring(o + 1)))
                        : ((t.username = null), (t.password = null)),
                    e
                );
            }),
            (i.parseQuery = function (e, t) {
                if (!e) return {};
                if (((e = e.replace(/&+/g, "&").replace(/^\?*&*|&+$/g, "")), !e)) return {};
                for (var n, r, o, a = {}, s = e.split("&"), l = s.length, c = 0; c < l; c++)
                    (n = s[c].split("=")), (r = i.decodeQuery(n.shift(), t)), (o = n.length ? i.decodeQuery(n.join("="), t) : null), b.call(a, r) ? (("string" != typeof a[r] && null !== a[r]) || (a[r] = [a[r]]), a[r].push(o)) : (a[r] = o);
                return a;
            }),
            (i.build = function (e) {
                var t = "";
                return (
                    e.protocol && (t += e.protocol + ":"),
                    e.urn || (!t && !e.hostname) || (t += "//"),
                    (t += i.buildAuthority(e) || ""),
                    "string" == typeof e.path && ("/" !== e.path.charAt(0) && "string" == typeof e.hostname && (t += "/"), (t += e.path)),
                    "string" == typeof e.query && e.query && (t += "?" + e.query),
                    "string" == typeof e.fragment && e.fragment && (t += "#" + e.fragment),
                    t
                );
            }),
            (i.buildHost = function (e) {
                var t = "";
                return e.hostname ? ((t += i.ip6_expression.test(e.hostname) ? "[" + e.hostname + "]" : e.hostname), e.port && (t += ":" + e.port), t) : "";
            }),
            (i.buildAuthority = function (e) {
                return i.buildUserinfo(e) + i.buildHost(e);
            }),
            (i.buildUserinfo = function (e) {
                var t = "";
                return e.username && (t += i.encode(e.username)), e.password && (t += ":" + i.encode(e.password)), t && (t += "@"), t;
            }),
            (i.buildQuery = function (e, t, n) {
                var r,
                    o,
                    a,
                    l,
                    c = "";
                for (o in e)
                    if (b.call(e, o) && o)
                        if (s(e[o])) for (r = {}, a = 0, l = e[o].length; a < l; a++) void 0 !== e[o][a] && void 0 === r[e[o][a] + ""] && ((c += "&" + i.buildQueryParameter(o, e[o][a], n)), t !== !0 && (r[e[o][a] + ""] = !0));
                        else void 0 !== e[o] && (c += "&" + i.buildQueryParameter(o, e[o], n));
                return c.substring(1);
            }),
            (i.buildQueryParameter = function (e, t, n) {
                return i.encodeQuery(e, n) + (null !== t ? "=" + i.encodeQuery(t, n) : "");
            }),
            (i.addQuery = function (e, t, n) {
                if ("object" == typeof t) for (var r in t) b.call(t, r) && i.addQuery(e, r, t[r]);
                else {
                    if ("string" != typeof t) throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");
                    if (void 0 === e[t]) return void (e[t] = n);
                    "string" == typeof e[t] && (e[t] = [e[t]]), s(n) || (n = [n]), (e[t] = (e[t] || []).concat(n));
                }
            }),
            (i.removeQuery = function (e, t, n) {
                var r, o, c;
                if (s(t)) for (r = 0, o = t.length; r < o; r++) e[t[r]] = void 0;
                else if ("RegExp" === a(t)) for (c in e) t.test(c) && (e[c] = void 0);
                else if ("object" == typeof t) for (c in t) b.call(t, c) && i.removeQuery(e, c, t[c]);
                else {
                    if ("string" != typeof t) throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");
                    void 0 !== n
                        ? "RegExp" === a(n)
                            ? !s(e[t]) && n.test(e[t])
                                ? (e[t] = void 0)
                                : (e[t] = l(e[t], n))
                            : e[t] !== String(n) || (s(n) && 1 !== n.length)
                            ? s(e[t]) && (e[t] = l(e[t], n))
                            : (e[t] = void 0)
                        : (e[t] = void 0);
                }
            }),
            (i.hasQuery = function (e, t, n, r) {
                switch (a(t)) {
                    case "String":
                        break;
                    case "RegExp":
                        for (var o in e) if (b.call(e, o) && t.test(o) && (void 0 === n || i.hasQuery(e, o, n))) return !0;
                        return !1;
                    case "Object":
                        for (var l in t) if (b.call(t, l) && !i.hasQuery(e, l, t[l])) return !1;
                        return !0;
                    default:
                        throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter");
                }
                switch (a(n)) {
                    case "Undefined":
                        return t in e;
                    case "Boolean":
                        var d = Boolean(s(e[t]) ? e[t].length : e[t]);
                        return n === d;
                    case "Function":
                        return !!n(e[t], t, e);
                    case "Array":
                        if (!s(e[t])) return !1;
                        var f = r ? c : u;
                        return f(e[t], n);
                    case "RegExp":
                        return s(e[t]) ? !!r && c(e[t], n) : Boolean(e[t] && e[t].match(n));
                    case "Number":
                        n = String(n);
                    case "String":
                        return s(e[t]) ? !!r && c(e[t], n) : e[t] === n;
                    default:
                        throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter");
                }
            }),
            (i.joinPaths = function () {
                for (var e = [], t = [], n = 0, r = 0; r < arguments.length; r++) {
                    var o = new i(arguments[r]);
                    e.push(o);
                    for (var a = o.segment(), s = 0; s < a.length; s++) "string" == typeof a[s] && t.push(a[s]), a[s] && n++;
                }
                if (!t.length || !n) return new i("");
                var l = new i("").segment(t);
                return ("" !== e[0].path() && "/" !== e[0].path().slice(0, 1)) || l.path("/" + l.path()), l.normalize();
            }),
            (i.commonPath = function (e, t) {
                var n,
                    r = Math.min(e.length, t.length);
                for (n = 0; n < r; n++)
                    if (e.charAt(n) !== t.charAt(n)) {
                        n--;
                        break;
                    }
                return n < 1 ? (e.charAt(0) === t.charAt(0) && "/" === e.charAt(0) ? "/" : "") : (("/" === e.charAt(n) && "/" === t.charAt(n)) || (n = e.substring(0, n).lastIndexOf("/")), e.substring(0, n + 1));
            }),
            (i.withinString = function (e, t, n) {
                n || (n = {});
                var r = n.start || i.findUri.start,
                    o = n.end || i.findUri.end,
                    a = n.trim || i.findUri.trim,
                    s = /[a-z0-9-]=["']?$/i;
                for (r.lastIndex = 0; ; ) {
                    var l = r.exec(e);
                    if (!l) break;
                    var c = l.index;
                    if (n.ignoreHtml) {
                        var u = e.slice(Math.max(c - 3, 0), c);
                        if (u && s.test(u)) continue;
                    }
                    var d = c + e.slice(c).search(o),
                        f = e.slice(c, d).replace(a, "");
                    if (!n.ignore || !n.ignore.test(f)) {
                        d = c + f.length;
                        var h = t(f, c, d, e);
                        void 0 !== h ? ((h = String(h)), (e = e.slice(0, c) + h + e.slice(d)), (r.lastIndex = c + h.length)) : (r.lastIndex = d);
                    }
                }
                return (r.lastIndex = 0), e;
            }),
            (i.ensureValidHostname = function (t) {
                if (t.match(i.invalid_hostname_characters)) {
                    if (!e) throw new TypeError('Hostname "' + t + '" contains characters other than [A-Z0-9.-] and Punycode.js is not available');
                    if (e.toASCII(t).match(i.invalid_hostname_characters)) throw new TypeError('Hostname "' + t + '" contains characters other than [A-Z0-9.-]');
                }
            }),
            (i.noConflict = function (e) {
                if (e) {
                    var t = { URI: this.noConflict() };
                    return (
                        r.URITemplate && "function" == typeof r.URITemplate.noConflict && (t.URITemplate = r.URITemplate.noConflict()),
                        r.IPv6 && "function" == typeof r.IPv6.noConflict && (t.IPv6 = r.IPv6.noConflict()),
                        r.SecondLevelDomains && "function" == typeof r.SecondLevelDomains.noConflict && (t.SecondLevelDomains = r.SecondLevelDomains.noConflict()),
                        t
                    );
                }
                return r.URI === this && (r.URI = m), this;
            }),
            (v.build = function (e) {
                return e === !0 ? (this._deferred_build = !0) : (void 0 === e || this._deferred_build) && ((this._string = i.build(this._parts)), (this._deferred_build = !1)), this;
            }),
            (v.clone = function () {
                return new i(this);
            }),
            (v.valueOf = v.toString = function () {
                return this.build(!1)._string;
            }),
            (v.protocol = p("protocol")),
            (v.username = p("username")),
            (v.password = p("password")),
            (v.hostname = p("hostname")),
            (v.port = p("port")),
            (v.query = g("query", "?")),
            (v.fragment = g("fragment", "#")),
            (v.search = function (e, t) {
                var n = this.query(e, t);
                return "string" == typeof n && n.length ? "?" + n : n;
            }),
            (v.hash = function (e, t) {
                var n = this.fragment(e, t);
                return "string" == typeof n && n.length ? "#" + n : n;
            }),
            (v.pathname = function (e, t) {
                if (void 0 === e || e === !0) {
                    var n = this._parts.path || (this._parts.hostname ? "/" : "");
                    return e ? (this._parts.urn ? i.decodeUrnPath : i.decodePath)(n) : n;
                }
                return this._parts.urn ? (this._parts.path = e ? i.recodeUrnPath(e) : "") : (this._parts.path = e ? i.recodePath(e) : "/"), this.build(!t), this;
            }),
            (v.path = v.pathname),
            (v.href = function (e, t) {
                var n;
                if (void 0 === e) return this.toString();
                (this._string = ""), (this._parts = i._parts());
                var r = e instanceof i,
                    o = "object" == typeof e && (e.hostname || e.path || e.pathname);
                if (e.nodeName) {
                    var a = i.getDomAttribute(e);
                    (e = e[a] || ""), (o = !1);
                }
                if ((!r && o && void 0 !== e.pathname && (e = e.toString()), "string" == typeof e || e instanceof String)) this._parts = i.parse(String(e), this._parts);
                else {
                    if (!r && !o) throw new TypeError("invalid input");
                    var s = r ? e._parts : e;
                    for (n in s) b.call(this._parts, n) && (this._parts[n] = s[n]);
                }
                return this.build(!t), this;
            }),
            (v.is = function (e) {
                var t = !1,
                    r = !1,
                    o = !1,
                    a = !1,
                    s = !1,
                    l = !1,
                    c = !1,
                    u = !this._parts.urn;
                switch (
                    (this._parts.hostname &&
                        ((u = !1),
                        (r = i.ip4_expression.test(this._parts.hostname)),
                        (o = i.ip6_expression.test(this._parts.hostname)),
                        (t = r || o),
                        (a = !t),
                        (s = a && n && n.has(this._parts.hostname)),
                        (l = a && i.idn_expression.test(this._parts.hostname)),
                        (c = a && i.punycode_expression.test(this._parts.hostname))),
                    e.toLowerCase())
                ) {
                    case "relative":
                        return u;
                    case "absolute":
                        return !u;
                    case "domain":
                    case "name":
                        return a;
                    case "sld":
                        return s;
                    case "ip":
                        return t;
                    case "ip4":
                    case "ipv4":
                    case "inet4":
                        return r;
                    case "ip6":
                    case "ipv6":
                    case "inet6":
                        return o;
                    case "idn":
                        return l;
                    case "url":
                        return !this._parts.urn;
                    case "urn":
                        return !!this._parts.urn;
                    case "punycode":
                        return c;
                }
                return null;
            });
        var E = v.protocol,
            C = v.port,
            T = v.hostname;
        (v.protocol = function (e, t) {
            if (void 0 !== e && e && ((e = e.replace(/:(\/\/)?$/, "")), !e.match(i.protocol_expression))) throw new TypeError('Protocol "' + e + "\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");
            return E.call(this, e, t);
        }),
            (v.scheme = v.protocol),
            (v.port = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (void 0 !== e && (0 === e && (e = null), e && ((e += ""), ":" === e.charAt(0) && (e = e.substring(1)), e.match(/[^0-9]/)))) throw new TypeError('Port "' + e + '" contains characters other than [0-9]');
                return C.call(this, e, t);
            }),
            (v.hostname = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (void 0 !== e) {
                    var n = {},
                        r = i.parseHost(e, n);
                    if ("/" !== r) throw new TypeError('Hostname "' + e + '" contains characters other than [A-Z0-9.-]');
                    e = n.hostname;
                }
                return T.call(this, e, t);
            }),
            (v.origin = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (void 0 === e) {
                    var n = this.protocol(),
                        r = this.authority();
                    return r ? (n ? n + "://" : "") + this.authority() : "";
                }
                var o = i(e);
                return this.protocol(o.protocol()).authority(o.authority()).build(!t), this;
            }),
            (v.host = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (void 0 === e) return this._parts.hostname ? i.buildHost(this._parts) : "";
                var n = i.parseHost(e, this._parts);
                if ("/" !== n) throw new TypeError('Hostname "' + e + '" contains characters other than [A-Z0-9.-]');
                return this.build(!t), this;
            }),
            (v.authority = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (void 0 === e) return this._parts.hostname ? i.buildAuthority(this._parts) : "";
                var n = i.parseAuthority(e, this._parts);
                if ("/" !== n) throw new TypeError('Hostname "' + e + '" contains characters other than [A-Z0-9.-]');
                return this.build(!t), this;
            }),
            (v.userinfo = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (void 0 === e) {
                    var n = i.buildUserinfo(this._parts);
                    return n ? n.substring(0, n.length - 1) : n;
                }
                return "@" !== e[e.length - 1] && (e += "@"), i.parseUserinfo(e, this._parts), this.build(!t), this;
            }),
            (v.resource = function (e, t) {
                var n;
                return void 0 === e ? this.path() + this.search() + this.hash() : ((n = i.parse(e)), (this._parts.path = n.path), (this._parts.query = n.query), (this._parts.fragment = n.fragment), this.build(!t), this);
            }),
            (v.subdomain = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (void 0 === e) {
                    if (!this._parts.hostname || this.is("IP")) return "";
                    var n = this._parts.hostname.length - this.domain().length - 1;
                    return this._parts.hostname.substring(0, n) || "";
                }
                var r = this._parts.hostname.length - this.domain().length,
                    a = this._parts.hostname.substring(0, r),
                    s = new RegExp("^" + o(a));
                return e && "." !== e.charAt(e.length - 1) && (e += "."), e && i.ensureValidHostname(e), (this._parts.hostname = this._parts.hostname.replace(s, e)), this.build(!t), this;
            }),
            (v.domain = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (("boolean" == typeof e && ((t = e), (e = void 0)), void 0 === e)) {
                    if (!this._parts.hostname || this.is("IP")) return "";
                    var n = this._parts.hostname.match(/\./g);
                    if (n && n.length < 2) return this._parts.hostname;
                    var r = this._parts.hostname.length - this.tld(t).length - 1;
                    return (r = this._parts.hostname.lastIndexOf(".", r - 1) + 1), this._parts.hostname.substring(r) || "";
                }
                if (!e) throw new TypeError("cannot set domain empty");
                if ((i.ensureValidHostname(e), !this._parts.hostname || this.is("IP"))) this._parts.hostname = e;
                else {
                    var a = new RegExp(o(this.domain()) + "$");
                    this._parts.hostname = this._parts.hostname.replace(a, e);
                }
                return this.build(!t), this;
            }),
            (v.tld = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (("boolean" == typeof e && ((t = e), (e = void 0)), void 0 === e)) {
                    if (!this._parts.hostname || this.is("IP")) return "";
                    var r = this._parts.hostname.lastIndexOf("."),
                        i = this._parts.hostname.substring(r + 1);
                    return t !== !0 && n && n.list[i.toLowerCase()] ? n.get(this._parts.hostname) || i : i;
                }
                var a;
                if (!e) throw new TypeError("cannot set TLD empty");
                if (e.match(/[^a-zA-Z0-9-]/)) {
                    if (!n || !n.is(e)) throw new TypeError('TLD "' + e + '" contains characters other than [A-Z0-9]');
                    (a = new RegExp(o(this.tld()) + "$")), (this._parts.hostname = this._parts.hostname.replace(a, e));
                } else {
                    if (!this._parts.hostname || this.is("IP")) throw new ReferenceError("cannot set TLD on non-domain host");
                    (a = new RegExp(o(this.tld()) + "$")), (this._parts.hostname = this._parts.hostname.replace(a, e));
                }
                return this.build(!t), this;
            }),
            (v.directory = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (void 0 === e || e === !0) {
                    if (!this._parts.path && !this._parts.hostname) return "";
                    if ("/" === this._parts.path) return "/";
                    var n = this._parts.path.length - this.filename().length - 1,
                        r = this._parts.path.substring(0, n) || (this._parts.hostname ? "/" : "");
                    return e ? i.decodePath(r) : r;
                }
                var a = this._parts.path.length - this.filename().length,
                    s = this._parts.path.substring(0, a),
                    l = new RegExp("^" + o(s));
                return (
                    this.is("relative") || (e || (e = "/"), "/" !== e.charAt(0) && (e = "/" + e)),
                    e && "/" !== e.charAt(e.length - 1) && (e += "/"),
                    (e = i.recodePath(e)),
                    (this._parts.path = this._parts.path.replace(l, e)),
                    this.build(!t),
                    this
                );
            }),
            (v.filename = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (void 0 === e || e === !0) {
                    if (!this._parts.path || "/" === this._parts.path) return "";
                    var n = this._parts.path.lastIndexOf("/"),
                        r = this._parts.path.substring(n + 1);
                    return e ? i.decodePathSegment(r) : r;
                }
                var a = !1;
                "/" === e.charAt(0) && (e = e.substring(1)), e.match(/\.?\//) && (a = !0);
                var s = new RegExp(o(this.filename()) + "$");
                return (e = i.recodePath(e)), (this._parts.path = this._parts.path.replace(s, e)), a ? this.normalizePath(t) : this.build(!t), this;
            }),
            (v.suffix = function (e, t) {
                if (this._parts.urn) return void 0 === e ? "" : this;
                if (void 0 === e || e === !0) {
                    if (!this._parts.path || "/" === this._parts.path) return "";
                    var n,
                        r,
                        a = this.filename(),
                        s = a.lastIndexOf(".");
                    return s === -1 ? "" : ((n = a.substring(s + 1)), (r = /^[a-z0-9%]+$/i.test(n) ? n : ""), e ? i.decodePathSegment(r) : r);
                }
                "." === e.charAt(0) && (e = e.substring(1));
                var l,
                    c = this.suffix();
                if (c) l = e ? new RegExp(o(c) + "$") : new RegExp(o("." + c) + "$");
                else {
                    if (!e) return this;
                    this._parts.path += "." + i.recodePath(e);
                }
                return l && ((e = i.recodePath(e)), (this._parts.path = this._parts.path.replace(l, e))), this.build(!t), this;
            }),
            (v.segment = function (e, t, n) {
                var r = this._parts.urn ? ":" : "/",
                    i = this.path(),
                    o = "/" === i.substring(0, 1),
                    a = i.split(r);
                if ((void 0 !== e && "number" != typeof e && ((n = t), (t = e), (e = void 0)), void 0 !== e && "number" != typeof e)) throw new Error('Bad segment "' + e + '", must be 0-based integer');
                if ((o && a.shift(), e < 0 && (e = Math.max(a.length + e, 0)), void 0 === t)) return void 0 === e ? a : a[e];
                if (null === e || void 0 === a[e])
                    if (s(t)) {
                        a = [];
                        for (var l = 0, c = t.length; l < c; l++) (t[l].length || (a.length && a[a.length - 1].length)) && (a.length && !a[a.length - 1].length && a.pop(), a.push(d(t[l])));
                    } else (t || "string" == typeof t) && ((t = d(t)), "" === a[a.length - 1] ? (a[a.length - 1] = t) : a.push(t));
                else t ? (a[e] = d(t)) : a.splice(e, 1);
                return o && a.unshift(""), this.path(a.join(r), n);
            }),
            (v.segmentCoded = function (e, t, n) {
                var r, o, a;
                if (("number" != typeof e && ((n = t), (t = e), (e = void 0)), void 0 === t)) {
                    if (((r = this.segment(e, t, n)), s(r))) for (o = 0, a = r.length; o < a; o++) r[o] = i.decode(r[o]);
                    else r = void 0 !== r ? i.decode(r) : void 0;
                    return r;
                }
                if (s(t)) for (o = 0, a = t.length; o < a; o++) t[o] = i.encode(t[o]);
                else t = "string" == typeof t || t instanceof String ? i.encode(t) : t;
                return this.segment(e, t, n);
            });
        var S = v.query;
        return (
            (v.query = function (e, t) {
                if (e === !0) return i.parseQuery(this._parts.query, this._parts.escapeQuerySpace);
                if ("function" == typeof e) {
                    var n = i.parseQuery(this._parts.query, this._parts.escapeQuerySpace),
                        r = e.call(this, n);
                    return (this._parts.query = i.buildQuery(r || n, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace)), this.build(!t), this;
                }
                return void 0 !== e && "string" != typeof e ? ((this._parts.query = i.buildQuery(e, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace)), this.build(!t), this) : S.call(this, e, t);
            }),
            (v.setQuery = function (e, t, n) {
                var r = i.parseQuery(this._parts.query, this._parts.escapeQuerySpace);
                if ("string" == typeof e || e instanceof String) r[e] = void 0 !== t ? t : null;
                else {
                    if ("object" != typeof e) throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");
                    for (var o in e) b.call(e, o) && (r[o] = e[o]);
                }
                return (this._parts.query = i.buildQuery(r, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace)), "string" != typeof e && (n = t), this.build(!n), this;
            }),
            (v.addQuery = function (e, t, n) {
                var r = i.parseQuery(this._parts.query, this._parts.escapeQuerySpace);
                return i.addQuery(r, e, void 0 === t ? null : t), (this._parts.query = i.buildQuery(r, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace)), "string" != typeof e && (n = t), this.build(!n), this;
            }),
            (v.removeQuery = function (e, t, n) {
                var r = i.parseQuery(this._parts.query, this._parts.escapeQuerySpace);
                return i.removeQuery(r, e, t), (this._parts.query = i.buildQuery(r, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace)), "string" != typeof e && (n = t), this.build(!n), this;
            }),
            (v.hasQuery = function (e, t, n) {
                var r = i.parseQuery(this._parts.query, this._parts.escapeQuerySpace);
                return i.hasQuery(r, e, t, n);
            }),
            (v.setSearch = v.setQuery),
            (v.addSearch = v.addQuery),
            (v.removeSearch = v.removeQuery),
            (v.hasSearch = v.hasQuery),
            (v.normalize = function () {
                return this._parts.urn
                    ? this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()
                    : this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build();
            }),
            (v.normalizeProtocol = function (e) {
                return "string" == typeof this._parts.protocol && ((this._parts.protocol = this._parts.protocol.toLowerCase()), this.build(!e)), this;
            }),
            (v.normalizeHostname = function (n) {
                return (
                    this._parts.hostname &&
                        (this.is("IDN") && e ? (this._parts.hostname = e.toASCII(this._parts.hostname)) : this.is("IPv6") && t && (this._parts.hostname = t.best(this._parts.hostname)),
                        (this._parts.hostname = this._parts.hostname.toLowerCase()),
                        this.build(!n)),
                    this
                );
            }),
            (v.normalizePort = function (e) {
                return "string" == typeof this._parts.protocol && this._parts.port === i.defaultPorts[this._parts.protocol] && ((this._parts.port = null), this.build(!e)), this;
            }),
            (v.normalizePath = function (e) {
                var t = this._parts.path;
                if (!t) return this;
                if (this._parts.urn) return (this._parts.path = i.recodeUrnPath(this._parts.path)), this.build(!e), this;
                if ("/" === this._parts.path) return this;
                t = i.recodePath(t);
                var n,
                    r,
                    o,
                    a = "";
                for (
                    "/" !== t.charAt(0) && ((n = !0), (t = "/" + t)),
                        ("/.." !== t.slice(-3) && "/." !== t.slice(-2)) || (t += "/"),
                        t = t.replace(/(\/(\.\/)+)|(\/\.$)/g, "/").replace(/\/{2,}/g, "/"),
                        n && ((a = t.substring(1).match(/^(\.\.\/)+/) || ""), a && (a = a[0]));
                    ;

                ) {
                    if (((r = t.search(/\/\.\.(\/|$)/)), r === -1)) break;
                    0 !== r ? ((o = t.substring(0, r).lastIndexOf("/")), o === -1 && (o = r), (t = t.substring(0, o) + t.substring(r + 3))) : (t = t.substring(3));
                }
                return n && this.is("relative") && (t = a + t.substring(1)), (this._parts.path = t), this.build(!e), this;
            }),
            (v.normalizePathname = v.normalizePath),
            (v.normalizeQuery = function (e) {
                return "string" == typeof this._parts.query && (this._parts.query.length ? this.query(i.parseQuery(this._parts.query, this._parts.escapeQuerySpace)) : (this._parts.query = null), this.build(!e)), this;
            }),
            (v.normalizeFragment = function (e) {
                return this._parts.fragment || ((this._parts.fragment = null), this.build(!e)), this;
            }),
            (v.normalizeSearch = v.normalizeQuery),
            (v.normalizeHash = v.normalizeFragment),
            (v.iso8859 = function () {
                var e = i.encode,
                    t = i.decode;
                (i.encode = escape), (i.decode = decodeURIComponent);
                try {
                    this.normalize();
                } finally {
                    (i.encode = e), (i.decode = t);
                }
                return this;
            }),
            (v.unicode = function () {
                var e = i.encode,
                    t = i.decode;
                (i.encode = h), (i.decode = unescape);
                try {
                    this.normalize();
                } finally {
                    (i.encode = e), (i.decode = t);
                }
                return this;
            }),
            (v.readable = function () {
                var t = this.clone();
                t.username("").password("").normalize();
                var n = "";
                if (
                    (t._parts.protocol && (n += t._parts.protocol + "://"),
                    t._parts.hostname && (t.is("punycode") && e ? ((n += e.toUnicode(t._parts.hostname)), t._parts.port && (n += ":" + t._parts.port)) : (n += t.host())),
                    t._parts.hostname && t._parts.path && "/" !== t._parts.path.charAt(0) && (n += "/"),
                    (n += t.path(!0)),
                    t._parts.query)
                ) {
                    for (var r = "", o = 0, a = t._parts.query.split("&"), s = a.length; o < s; o++) {
                        var l = (a[o] || "").split("=");
                        (r += "&" + i.decodeQuery(l[0], this._parts.escapeQuerySpace).replace(/&/g, "%26")), void 0 !== l[1] && (r += "=" + i.decodeQuery(l[1], this._parts.escapeQuerySpace).replace(/&/g, "%26"));
                    }
                    n += "?" + r.substring(1);
                }
                return (n += i.decodeQuery(t.hash(), !0));
            }),
            (v.absoluteTo = function (e) {
                var t,
                    n,
                    r,
                    o = this.clone(),
                    a = ["protocol", "username", "password", "hostname", "port"];
                if ((e instanceof i || (e = new i(e)), "filesystem" == this._parts.protocol)) return o;
                if ("filesystem" == e._parts.protocol) {
                    var s = this.absoluteTo(e._parts.path);
                    return e._parts.path.indexOf("chrome-extension:") !== -1 || e._parts.path.indexOf("http:") !== -1 || e._parts.path.indexOf("https:") !== -1 ? new i("filesystem:" + s.toString()) : s;
                }
                if (this._parts.urn) throw new Error("URNs do not have any generally defined hierarchical components");
                if ((o._parts.protocol || (o._parts.protocol = e._parts.protocol), this._parts.hostname)) return o;
                for (n = 0; (r = a[n]); n++) o._parts[r] = e._parts[r];
                return (
                    o._parts.path
                        ? (".." === o._parts.path.substring(-2) && (o._parts.path += "/"),
                          "/" !== o.path().charAt(0) && ((t = e.directory()), (t = t ? t : 0 === e.path().indexOf("/") ? "/" : ""), (o._parts.path = (t ? t + "/" : "") + o._parts.path), o.normalizePath()))
                        : ((o._parts.path = e._parts.path), o._parts.query || (o._parts.query = e._parts.query)),
                    o.build(),
                    o
                );
            }),
            (v.relativeTo = function (e) {
                var t,
                    n,
                    r,
                    o,
                    a,
                    s = this.clone().normalize();
                if (s._parts.urn) throw new Error("URNs do not have any generally defined hierarchical components");
                if (((e = new i(e).normalize()), (t = s._parts), (n = e._parts), (o = s.path()), (a = e.path()), "/" !== o.charAt(0))) throw new Error("URI is already relative");
                if ("/" !== a.charAt(0)) throw new Error("Cannot calculate a URI relative to another relative URI");
                if ((t.protocol === n.protocol && (t.protocol = null), t.username !== n.username || t.password !== n.password)) return s.build();
                if (null !== t.protocol || null !== t.username || null !== t.password) return s.build();
                if (t.hostname !== n.hostname || t.port !== n.port) return s.build();
                if (((t.hostname = null), (t.port = null), o === a)) return (t.path = ""), s.build();
                if (((r = i.commonPath(o, a)), !r)) return s.build();
                var l = n.path
                    .substring(r.length)
                    .replace(/[^\/]*$/, "")
                    .replace(/.*?\//g, "../");
                return (t.path = l + t.path.substring(r.length) || "./"), s.build();
            }),
            (v.equals = function (e) {
                var t,
                    n,
                    r,
                    o = this.clone(),
                    a = new i(e),
                    l = {},
                    c = {},
                    d = {};
                if ((o.normalize(), a.normalize(), o.toString() === a.toString())) return !0;
                if (((t = o.query()), (n = a.query()), o.query(""), a.query(""), o.toString() !== a.toString())) return !1;
                if (t.length !== n.length) return !1;
                (l = i.parseQuery(t, this._parts.escapeQuerySpace)), (c = i.parseQuery(n, this._parts.escapeQuerySpace));
                for (r in l)
                    if (b.call(l, r)) {
                        if (s(l[r])) {
                            if (!u(l[r], c[r])) return !1;
                        } else if (l[r] !== c[r]) return !1;
                        d[r] = !0;
                    }
                for (r in c) if (b.call(c, r) && !d[r]) return !1;
                return !0;
            }),
            (v.duplicateQueryParameters = function (e) {
                return (this._parts.duplicateQueryParameters = !!e), this;
            }),
            (v.escapeQuerySpace = function (e) {
                return (this._parts.escapeQuerySpace = !!e), this;
            }),
            i
        );
    }),
    define("readium_shared_js/globalsSetup", ["./globals", "jquery", "console_shim", "es6-collections", "eventEmitter", "URIjs", "readium_cfi_js", "readium_js_plugins"], function (e, t, n, r, i, o, a, s) {
        if (
            (console.log("Globals..."),
            window.ReadiumSDK ? (console.log("ReadiumSDK extend."), t.extend(e, window.ReadiumSDK)) : console.log("ReadiumSDK set."),
            (window.ReadiumSDK = e),
            (i.prototype.trigger = i.prototype.emit),
            (window.EventEmitter = i),
            (window.URI = o),
            "URL" in window == !1)
        ) {
            if ("webkitURL" in window == !1) throw Error("Browser does not support window.URL");
            window.URL = window.webkitURL;
        }
        if (
            ((e.Plugins = s),
            e.on(e.Events.READER_INITIALIZED, function (t) {
                e.logEvent("READER_INITIALIZED", "ON", "globalsSetup.js");
                try {
                    s.initialize(t);
                } catch (e) {
                    console.error("Plugins failed to initialize:", e);
                }
                _.defer(function () {
                    e.logEvent("PLUGINS_LOADED", "EMIT", "globalsSetup.js"), e.emit(e.Events.PLUGINS_LOADED, t);
                });
            }),
            window._RJS_isBrowser)
        ) {
            var l = window._RJS_pluginsList;
            console.log(
                "Plugins included: ",
                l.map(function (e) {
                    return e.replace("readium_plugin_", "");
                })
            ),
                require(l);
        } else
            setTimeout(function () {
                var e = Object.keys(s.getLoadedPlugins());
                console.log("Plugins included: ", e);
            }, 0);
    }),
    define("readium_shared_js", ["readium_shared_js/globalsSetup"], function (e) {
        return e;
    }),
    define("readium_shared_js/models/current_pages_info", [], function () {
        var e = function (e, t) {
            (this.isRightToLeft = e.isRightToLeft()),
                (this.isFixedLayout = t),
                (this.spineItemCount = e.items.length),
                (this.openPages = []),
                (this.addOpenPage = function (e, t, n, r) {
                    this.openPages.push({ spineItemPageIndex: e, spineItemPageCount: t, idref: n, spineItemIndex: r }), this.sort();
                }),
                (this.canGoLeft = function () {
                    return this.isRightToLeft ? this.canGoNext() : this.canGoPrev();
                }),
                (this.canGoRight = function () {
                    return this.isRightToLeft ? this.canGoPrev() : this.canGoNext();
                }),
                (this.canGoNext = function () {
                    if (0 == this.openPages.length) return !1;
                    var t = this.openPages[this.openPages.length - 1];
                    return t.spineItemIndex < e.last().index || t.spineItemPageIndex < t.spineItemPageCount - 1;
                }),
                (this.canGoPrev = function () {
                    if (0 == this.openPages.length) return !1;
                    var t = this.openPages[0];
                    return e.first().index < t.spineItemIndex || 0 < t.spineItemPageIndex;
                }),
                (this.sort = function () {
                    this.openPages.sort(function (e, t) {
                        return e.spineItemIndex != t.spineItemIndex ? e.spineItemIndex - t.spineItemIndex : e.spineItemPageIndex - t.spineItemPageIndex;
                    });
                });
        };
        return e;
    }),
    define("readium_shared_js/models/fixed_page_spread", [], function () {
        var e = function (t, n) {
            function r() {
                (s.leftItem = void 0), (s.rightItem = void 0), (s.centerItem = void 0);
            }
            function i(t, n) {
                n == e.POSITION_LEFT ? (s.leftItem = t) : n == e.POSITION_RIGHT ? (s.rightItem = t) : (n != e.POSITION_CENTER && console.error("Unrecognized position value"), (s.centerItem = t));
            }
            function o(t) {
                return l ? (t.isLeftPage() ? e.POSITION_LEFT : t.isRightPage() ? e.POSITION_RIGHT : e.POSITION_CENTER) : e.POSITION_CENTER;
            }
            function a(e) {
                return e.isLeftPage() ? (s.spine.isRightToLeft() ? s.spine.prevItem(e) : s.spine.nextItem(e)) : e.isRightPage() ? (s.spine.isRightToLeft() ? s.spine.nextItem(e) : s.spine.prevItem(e)) : void 0;
            }
            var s = this;
            (this.spine = t), (this.leftItem = void 0), (this.rightItem = void 0), (this.centerItem = void 0);
            var l = n;
            (this.setSyntheticSpread = function (e) {
                l = e;
            }),
                (this.isSyntheticSpread = function () {
                    return l;
                }),
                (this.openFirst = function () {
                    0 == this.spine.items.length ? r() : this.openItem(this.spine.first());
                }),
                (this.openLast = function () {
                    0 == this.spine.items.length ? r() : this.openItem(this.spine.last());
                }),
                (this.openItem = function (t) {
                    r();
                    var n = o(t);
                    if ((i(t, n), n != e.POSITION_CENTER && this.spine.isValidLinearItem(t.index))) {
                        var s = a(t);
                        if (s) {
                            var l = o(s);
                            l != n && l != e.POSITION_CENTER && !s.isReflowable() && s.isRenditionSpreadAllowed() && i(s, l);
                        }
                    }
                }),
                (this.openNext = function () {
                    var e = this.validItems();
                    if (0 == e.length) this.openFirst();
                    else {
                        var t = this.spine.nextItem(e[e.length - 1]);
                        t && this.openItem(t);
                    }
                }),
                (this.openPrev = function () {
                    var e = this.validItems();
                    if (0 == e.length) this.openLast();
                    else {
                        var t = this.spine.prevItem(e[0]);
                        t && this.openItem(t);
                    }
                }),
                (this.validItems = function () {
                    var e = [];
                    return (
                        this.leftItem && e.push(this.leftItem),
                        this.rightItem && e.push(this.rightItem),
                        this.centerItem && e.push(this.centerItem),
                        e.sort(function (e, t) {
                            return e.index - t.index;
                        }),
                        e
                    );
                });
        };
        return (e.POSITION_LEFT = "left"), (e.POSITION_RIGHT = "right"), (e.POSITION_CENTER = "center"), e;
    }),
    (function (e) {
        "use strict";
        var t = function (e) {
            return parseInt(e, 10) || 0;
        };
        e.each(["min", "max"], function (n, r) {
            e.fn[r + "Size"] = function (e) {
                var n, i;
                return e
                    ? (void 0 !== e.width && this.css(r + "-width", e.width), void 0 !== e.height && this.css(r + "-height", e.height), this)
                    : ((n = this.css(r + "-width")),
                      (i = this.css(r + "-height")),
                      { width: ("max" === r && (void 0 === n || "none" === n || t(n) === -1) && Number.MAX_VALUE) || t(n), height: ("max" === r && (void 0 === i || "none" === i || t(i) === -1) && Number.MAX_VALUE) || t(i) });
            };
        }),
            (e.fn.isVisible = function () {
                return this.is(":visible");
            }),
            e.each(["border", "margin", "padding"], function (n, r) {
                e.fn[r] = function (e) {
                    return e
                        ? (void 0 !== e.top && this.css(r + "-top" + ("border" === r ? "-width" : ""), e.top),
                          void 0 !== e.bottom && this.css(r + "-bottom" + ("border" === r ? "-width" : ""), e.bottom),
                          void 0 !== e.left && this.css(r + "-left" + ("border" === r ? "-width" : ""), e.left),
                          void 0 !== e.right && this.css(r + "-right" + ("border" === r ? "-width" : ""), e.right),
                          this)
                        : {
                              top: t(this.css(r + "-top" + ("border" === r ? "-width" : ""))),
                              bottom: t(this.css(r + "-bottom" + ("border" === r ? "-width" : ""))),
                              left: t(this.css(r + "-left" + ("border" === r ? "-width" : ""))),
                              right: t(this.css(r + "-right" + ("border" === r ? "-width" : ""))),
                          };
                };
            });
    })(jQuery),
    define("jquerySizes", ["jquery"], (function (e) {
        return function () {
            var t;
            return t || e.jQuery;
        };
    })(this)),
    define("readium_shared_js/models/spine_item", [], function () {
        var e = function (t, n, r) {
            function i() {
                a.page_spread && a.page_spread != e.SPREAD_LEFT && a.page_spread != e.SPREAD_RIGHT && a.page_spread != e.SPREAD_CENTER && console.error(a.page_spread + " is not a recognized spread type");
            }
            function o(e, t) {
                return a[e] ? a[e] === t : !!a.spine.package[e] && a.spine.package[e] === t;
            }
            var a = this;
            (this.idref = t.idref),
                (this.href = t.href),
                (this.linear = t.linear ? t.linear.toLowerCase() : t.linear),
                (this.page_spread = t.page_spread),
                (this.rendition_viewport = t.rendition_viewport),
                (this.rendition_spread = t.rendition_spread),
                (this.rendition_orientation = t.rendition_orientation),
                (this.rendition_layout = t.rendition_layout),
                (this.rendition_flow = t.rendition_flow),
                (this.media_overlay_id = t.media_overlay_id),
                (this.media_type = t.media_type),
                (this.index = n),
                (this.spine = r),
                i(),
                (this.setSpread = function (e) {
                    (this.page_spread = e), i();
                }),
                (this.isRenditionSpreadAllowed = function () {
                    var t = a.getRenditionSpread();
                    return !t || t != e.RENDITION_SPREAD_NONE;
                }),
                (this.isLeftPage = function () {
                    return a.page_spread == e.SPREAD_LEFT;
                }),
                (this.isRightPage = function () {
                    return a.page_spread == e.SPREAD_RIGHT;
                }),
                (this.isCenterPage = function () {
                    return a.page_spread == e.SPREAD_CENTER;
                }),
                (this.isReflowable = function () {
                    return !a.isFixedLayout();
                }),
                (this.isFixedLayout = function () {
                    var t = a.getRenditionLayout();
                    if (t) {
                        if (a.rendition_layout) {
                            if (a.rendition_layout === e.RENDITION_LAYOUT_PREPAGINATED) return !0;
                            if (a.rendition_layout === e.RENDITION_LAYOUT_REFLOWABLE) return !1;
                        }
                        return a.spine.package.isFixedLayout();
                    }
                    return a.media_type.indexOf("image/") >= 0;
                }),
                (this.getRenditionFlow = function () {
                    return a.rendition_flow ? a.rendition_flow : a.spine.package.rendition_flow;
                }),
                (this.getRenditionViewport = function () {
                    return a.rendition_viewport ? a.rendition_viewport : a.spine.package.rendition_viewport;
                }),
                (this.getRenditionSpread = function () {
                    return a.rendition_spread ? a.rendition_spread : a.spine.package.rendition_spread;
                }),
                (this.getRenditionOrientation = function () {
                    return a.rendition_orientation ? a.rendition_orientation : a.spine.package.rendition_orientation;
                }),
                (this.getRenditionLayout = function () {
                    return a.rendition_layout ? a.rendition_layout : a.spine.package.rendition_layout;
                }),
                (this.isFlowScrolledContinuous = function () {
                    return o("rendition_flow", e.RENDITION_FLOW_SCROLLED_CONTINUOUS);
                }),
                (this.isFlowScrolledDoc = function () {
                    return o("rendition_flow", e.RENDITION_FLOW_SCROLLED_DOC);
                });
        };
        return (
            (e.RENDITION_LAYOUT_REFLOWABLE = "reflowable"),
            (e.RENDITION_LAYOUT_PREPAGINATED = "pre-paginated"),
            (e.RENDITION_ORIENTATION_LANDSCAPE = "landscape"),
            (e.RENDITION_ORIENTATION_PORTRAIT = "portrait"),
            (e.RENDITION_ORIENTATION_AUTO = "auto"),
            (e.SPREAD_LEFT = "page-spread-left"),
            (e.SPREAD_RIGHT = "page-spread-right"),
            (e.SPREAD_CENTER = "page-spread-center"),
            (e.RENDITION_SPREAD_NONE = "none"),
            (e.RENDITION_SPREAD_LANDSCAPE = "landscape"),
            (e.RENDITION_SPREAD_PORTRAIT = "portrait"),
            (e.RENDITION_SPREAD_BOTH = "both"),
            (e.RENDITION_SPREAD_AUTO = "auto"),
            (e.RENDITION_FLOW_PAGINATED = "paginated"),
            (e.RENDITION_FLOW_SCROLLED_CONTINUOUS = "scrolled-continuous"),
            (e.RENDITION_FLOW_SCROLLED_DOC = "scrolled-doc"),
            (e.RENDITION_FLOW_AUTO = "auto"),
            (e.alternateSpread = function (t) {
                return t === e.SPREAD_LEFT ? e.SPREAD_RIGHT : t === e.SPREAD_RIGHT ? e.SPREAD_LEFT : t;
            }),
            e
        );
    }),
    define("readium_shared_js/helpers", ["./globals", "underscore", "jquery", "jquerySizes", "./models/spine_item"], function (e, t, n, r, i) {
        !(function () {
            "use strict";
            if (window.performance) {
                if (window.performance.now) return;
                for (var e = ["webkitNow", "mozNow", "msNow", "oNow"], t = 0; t < e.length; t++) if (e[t] in window.performance) return void (window.performance.now = window.performance[e[t]]);
            } else window.performance = {};
            return Date.now
                ? void (window.performance.now = function () {
                      return Date.now();
                  })
                : void (window.performance.now = function () {
                      return +new Date();
                  });
        })();
        var o = {};
        return (
            (o.getEbookUrlFilePath = function (e) {
                return window.Blob && window.File ? (e instanceof File ? e.name : e instanceof Blob ? "readium-ebook.epub" : e) : e;
            }),
            (o.getURLQueryParams = function () {
                var e = {},
                    t = window.location.search;
                if (t && t.length) {
                    t = t.substring(1);
                    for (var n = t.split("&"), r = 0; r < n.length; r++) {
                        var i = n[r].split("=");
                        i.length > 1 && (e[i[0]] = decodeURIComponent(i[1]));
                    }
                }
                return e;
            }),
            (o.buildUrlQueryParameters = function (e, t) {
                e || (e = window.location ? window.location.protocol + "//" + window.location.hostname + (window.location.port ? ":" + window.location.port : "") + window.location.pathname : "index.html");
                var n = "";
                for (var r in t)
                    if (t.hasOwnProperty(r) && t[r]) {
                        var i = t[r].trim();
                        i && (console.debug("URL QUERY PARAM OVERRIDE: " + r + " = " + i), (n += r + "=" + encodeURIComponent(i)), (n += "&"));
                    }
                var a = o.getURLQueryParams();
                for (var r in a)
                    if (a.hasOwnProperty(r) && a[r] && !t[r]) {
                        var i = a[r].trim();
                        i && (console.debug("URL QUERY PARAM PRESERVED: " + r + " = " + i), (n += r + "=" + encodeURIComponent(i)), (n += "&"));
                    }
                return e + "?" + n;
            }),
            (o.Rect = function (e, t, n, r) {
                (this.left = e),
                    (this.top = t),
                    (this.width = n),
                    (this.height = r),
                    (this.right = function () {
                        return this.left + this.width;
                    }),
                    (this.bottom = function () {
                        return this.top + this.height;
                    }),
                    (this.isOverlap = function (e, t) {
                        return void 0 == t && (t = 0), !(e.right() < this.left + t || e.left > this.right() - t || e.bottom() < this.top + t || e.top > this.bottom() - t);
                    });
            }),
            (o.Rect.fromElement = function (e) {
                var n;
                (n = t.isArray(e) || e instanceof jQuery ? e[0] : e), 3 === n.nodeType && (n = e.parent()[0]);
                for (var r = n.offsetLeft, i = n.offsetTop, a = n.offsetWidth, s = n.offsetHeight; (n = n.offsetParent); ) (r += n.offsetLeft), (i += n.offsetTop);
                return new o.Rect(r, i, a, s);
            }),
            (o.UpdateHtmlFontSize = function (e, t) {
                var r = !1;
                if (r) var i = window.performance.now();
                for (var o, a = t / 100, s = e[0].ownerDocument.defaultView, l = n("p, div, span, h1, h2, h3, h4, h5, h6, li, blockquote, td, pre", e), c = 0; c < l.length; c++) {
                    var u = l[c],
                        d = u.getAttribute("data-original-font-size");
                    if (!d) {
                        var f = s.getComputedStyle(u),
                            h = parseInt(f.fontSize);
                        (o = parseInt(f.lineHeight)), u.setAttribute("data-original-font-size", h), o && u.setAttribute("data-original-line-height", o);
                    }
                }
                o = 0;
                for (var c = 0; c < l.length; c++) {
                    var u = l[c],
                        d = u.getAttribute("data-original-font-size"),
                        p = u.getAttribute("data-original-line-height"),
                        h = Number(d);
                    (o = p ? Number(p) : 0), n(u).css("font-size", h * a + "px"), o && n(u).css("line-height", o * a + "px");
                }
                if ((e.css("font-size", t + "%"), r)) {
                    var g = window.performance.now(),
                        m = g - i;
                    console.log(m);
                }
            }),
            (o.ResolveContentRef = function (e, t) {
                if (!t) return e;
                var n = t.split("/");
                n.pop();
                for (var r = e.split("/"); n.length > 0 && ".." === r[0]; ) n.pop(), r.splice(0, 1);
                var i = n.concat(r);
                return i.join("/");
            }),
            (o.EndsWith = function (e, t) {
                return e.indexOf(t, e.length - t.length) !== -1;
            }),
            (o.BeginsWith = function (e, t) {
                return 0 === e.indexOf(t);
            }),
            (o.RemoveFromString = function (e, t) {
                var n = e.indexOf(t);
                return n == -1 ? e : e.substring(0, n) + e.substring(n + t.length);
            }),
            (o.Margins = function (e, t, n) {
                (this.margin = e),
                    (this.border = t),
                    (this.padding = n),
                    (this.left = this.margin.left + this.border.left + this.padding.left),
                    (this.right = this.margin.right + this.border.right + this.padding.right),
                    (this.top = this.margin.top + this.border.top + this.padding.top),
                    (this.bottom = this.margin.bottom + this.border.bottom + this.padding.bottom),
                    (this.width = function () {
                        return this.left + this.right;
                    }),
                    (this.height = function () {
                        return this.top + this.bottom;
                    });
            }),
            (o.triggerLayout = function (e) {
                var t = e[0].contentDocument;
                if (t) {
                    var n = void 0;
                    try {
                        if (((n = t.styleSheets && t.styleSheets.length ? t.styleSheets[0] : void 0), !n)) {
                            var r = t.createElement("style");
                            t.head.appendChild(r), r.appendChild(t.createTextNode("")), (n = r.sheet);
                        }
                        if (n) {
                            var i = "body:first-child::before {content:'READIUM';color: red;font-weight: bold;}";
                            n.cssRules ? n.insertRule(i, n.cssRules.length) : n.insertRule(i, 0);
                        }
                    } catch (e) {
                        console.error(e);
                    }
                    try {
                        var o = t.createElementNS("http://www.w3.org/1999/xhtml", "style");
                        o.appendChild(t.createTextNode("*{}")), t.body.appendChild(o), t.body.removeChild(o), n && (n.cssRules ? n.deleteRule(n.cssRules.length - 1) : n.deleteRule(0));
                    } catch (e) {
                        console.error(e);
                    }
                    if (t.body) {
                        t.body.offsetTop;
                    }
                }
            }),
            (o.deduceSyntheticSpread = function (t, n, r) {
                if (!t || 0 == t.length) return 0;
                var a = n ? n.getRenditionSpread() : void 0;
                if (a === i.RENDITION_SPREAD_NONE) return !1;
                if ("double" == r.syntheticSpread) return !0;
                if ("single" == r.syntheticSpread) return !1;
                if (!n) return 0;
                if (a === i.RENDITION_SPREAD_BOTH) return !0;
                var s = o.getOrientation(t);
                if (a === i.RENDITION_SPREAD_LANDSCAPE) return s === e.Views.ORIENTATION_LANDSCAPE;
                if (a === i.RENDITION_SPREAD_PORTRAIT) return s === e.Views.ORIENTATION_PORTRAIT;
                if (!a || a === i.RENDITION_SPREAD_AUTO) {
                    var l = s === e.Views.ORIENTATION_LANDSCAPE;
                    return l ? 1 : 0;
                }
                return console.warn("Helpers.deduceSyntheticSpread: spread properties?!"), 0;
            }),
            (o.Margins.fromElement = function (e) {
                return new this(e.margin(), e.border(), e.padding());
            }),
            (o.Margins.empty = function () {
                return new this({ left: 0, right: 0, top: 0, bottom: 0 }, { left: 0, right: 0, top: 0, bottom: 0 }, { left: 0, right: 0, top: 0, bottom: 0 });
            }),
            (o.loadTemplate = function (e, t) {
                return o.loadTemplate.cache[e];
            }),
            (o.loadTemplate.cache = {
                fixed_book_frame: '<div id="fixed-book-frame" class="clearfix book-frame fixed-book-frame"></div>',
                single_page_frame: '<div><div id="scaler"><iframe scrolling="no" class="iframe-fixed"></iframe></div></div>',
                scrolled_book_frame: '<div id="reflowable-book-frame" class="clearfix book-frame reflowable-book-frame"><div id="scrolled-content-frame"></div></div>',
                reflowable_book_frame: '<div id="reflowable-book-frame" class="clearfix book-frame reflowable-book-frame"></div>',
                reflowable_book_page_frame: '<div id="reflowable-content-frame" class="reflowable-content-frame"><iframe scrolling="no" id="epubContentIframe"></iframe></div>',
            }),
            (o.setStyles = function (e, t) {
                var r = e.length;
                if (r)
                    for (var i = 0; i < r; i++) {
                        var o = e[i];
                        o.selector ? n(o.selector, t).css(o.declarations) : t.css(o.declarations);
                    }
            }),
            (o.isIframeAlive = function (e) {
                var t = void 0,
                    n = void 0;
                try {
                    (t = e.contentWindow), (n = e.contentDocument);
                } catch (e) {
                    return console.error(e), !1;
                }
                return t && n;
            }),
            (o.getOrientation = function (t) {
                var n = t.width(),
                    r = t.height();
                if (n && r) return n >= r ? e.Views.ORIENTATION_LANDSCAPE : e.Views.ORIENTATION_PORTRAIT;
            }),
            (o.isRenditionSpreadPermittedForItem = function (t, n) {
                var r = t.getRenditionSpread();
                return (
                    !r || r == i.RENDITION_SPREAD_BOTH || r == i.RENDITION_SPREAD_AUTO || (r == i.RENDITION_SPREAD_LANDSCAPE && n == e.Views.ORIENTATION_LANDSCAPE) || (r == i.RENDITION_SPREAD_PORTRAIT && n == e.Views.ORIENTATION_PORTRAIT)
                );
            }),
            (o.CSSTransition = function (e, n) {
                var r = {};
                t.each(["", "-webkit-", "-moz-", "-ms-"], function (e) {
                    r[e + "transition"] = e + n;
                }),
                    e.css(r);
            }),
            (o.CSSTransformString = function (e) {
                var t,
                    n,
                    r,
                    i = !!e.enable3D,
                    o = e.origin;
                if (e.left || e.top) {
                    var a = e.left || 0,
                        s = e.top || 0;
                    t = i ? "translate3D(" + a + "px, " + s + "px, 0)" : "translate(" + a + "px, " + s + "px)";
                }
                if ((e.scale && (n = i ? "scale3D(" + e.scale + ", " + e.scale + ", 0)" : "scale(" + e.scale + ")"), e.angle && (r = i ? "rotate3D(0,0," + e.angle + "deg)" : "rotate(" + e.angle + "deg)"), !(t || n || r))) return {};
                var l = t && n ? t + " " + n : t ? t : n;
                r && (l = l + " " + r);
                var c = {};
                return (c.transform = l), (c["transform-origin"] = o ? o : i ? "0 0 0" : "0 0"), c;
            }),
            (o.extendedThrottle = function (e, t, n, r, i, o) {
                r || (r = 250), i || (i = r);
                var a,
                    s,
                    l = !0;
                return function () {
                    var c = o || this,
                        u = (Date.now && Date.now()) || new Date().getTime(),
                        d = arguments;
                    (a && u < a + r) || ((a = u), l ? (e.apply(c, d), (l = !1)) : t.apply(c, d)),
                        clearTimeout(s),
                        (s = setTimeout(function () {
                            (a = u), (l = !0), n.apply(c, d);
                        }, i));
                };
            }),
            (o.escapeJQuerySelector = function (e) {
                if (e) {
                    var t = e.replace(/([;&,\.\+\*\~\?':"\!\^#$%@\[\]\(\)<=>\|\/\\{}`])/g, "\\$1");
                    return t;
                }
            }),
            (o.polyfillCaretRangeFromPoint = function (e) {
                if (!e.caretRangeFromPoint)
                    if (e.caretPositionFromPoint)
                        e.caretRangeFromPoint = function (t, n) {
                            var r = e.createRange(),
                                i = e.caretPositionFromPoint(t, n);
                            return i ? (i.offsetNode && (r.setStart(i.offsetNode, i.offset), r.setEnd(i.offsetNode, i.offset)), r) : null;
                        };
                    else if ((e.body || e.createElement("body")).createTextRange) {
                        var t = {
                            convertToDOMRange: function (e, t) {
                                var n = function (e, n, r) {
                                        var i = t.createElement("a"),
                                            o = n.duplicate();
                                        o.collapse(r);
                                        var a = o.parentElement();
                                        do a.insertBefore(i, i.previousSibling), o.moveToElementText(i);
                                        while (o.compareEndPoints(r ? "StartToStart" : "StartToEnd", n) > 0 && i.previousSibling);
                                        o.compareEndPoints(r ? "StartToStart" : "StartToEnd", n) == -1 && i.nextSibling
                                            ? (o.setEndPoint(r ? "EndToStart" : "EndToEnd", n), e[r ? "setStart" : "setEnd"](i.nextSibling, o.text.length))
                                            : e[r ? "setStartBefore" : "setEndBefore"](i),
                                            i.parentNode.removeChild(i);
                                    },
                                    r = t.createRange();
                                return n(r, e, !0), n(r, e, !1), r;
                            },
                        };
                        e.caretRangeFromPoint = function (n, r) {
                            for (var i = 40, o = e.body.createTextRange(), a = i; a; a -= 4)
                                try {
                                    return o.moveToPoint(n, a + r - i), t.convertToDOMRange(o, e);
                                } catch (e) {}
                            try {
                                var s = e.elementFromPoint(n - 1, r - 1),
                                    l = e.createRange();
                                return l.setStartAfter(s), l;
                            } catch (e) {
                                return null;
                            }
                        };
                    }
            }),
            o
        );
    }),
    define("readium_shared_js/views/cfi_navigation_logic", ["jquery", "underscore", "../helpers", "readium_cfi_js"], function (e, t, n, r) {
        var i = function (r) {
            function i() {
                return Q.getRootDocument().createRange();
            }
            function o(e) {
                var t = i();
                return t.selectNode(e), C(t.getBoundingClientRect(), 0, 0);
            }
            function a(e) {
                var t = i();
                return t.selectNodeContents(e), C(t.getBoundingClientRect(), 0, 0);
            }
            function s(e, t, n, r) {
                var o = i();
                return o.setStart(e, t ? t : 0), n.nodeType === Node.ELEMENT_NODE ? o.setEnd(n, r ? r : n.childNodes.length) : n.nodeType === Node.TEXT_NODE && o.setEnd(n, r ? r : 0), C(o.getBoundingClientRect(), 0, 0);
            }
            function l(e, n) {
                n = n || m();
                var r = i();
                return (
                    r.selectNode(e),
                    t.map(r.getClientRects(), function (e) {
                        return C(e, n.left, n.top);
                    })
                );
            }
            function c() {
                return r.frameDimensions ? r.frameDimensions() : (console.error("CfiNavigationLogic: No frame dimensions specified!"), null);
            }
            function u(e, t, r) {
                return (r = r || Q.getRootDocument()), n.polyfillCaretRangeFromPoint(r), r.caretRangeFromPoint(e, t);
            }
            function d() {
                return !!r.paginationInfo;
            }
            function f() {
                return r.paginationInfo && !!r.paginationInfo.rightToLeft;
            }
            function h() {
                return r.paginationInfo && !!r.paginationInfo.isVerticalWritingMode;
            }
            function p(e, t, n, r) {
                return (
                    (n = n || c()),
                    (r = r || h()),
                    !!e &&
                        (0 != e.left || 0 != e.right || 0 != e.top || 0 != e.bottom) &&
                        (d() ? (e.left >= 0 && e.left < n.width) || (!t && e.left < 0 && e.right >= 0) : (e.top >= 0 && e.top < n.height) || (!t && e.top < 0 && e.bottom >= 0))
                );
            }
            function g() {
                return !r.paginationInfo || h() ? r.$iframe.width() : r.paginationInfo.columnWidth + r.paginationInfo.columnGap;
            }
            function m() {
                return r.visibleContentOffsets ? r.visibleContentOffsets() : h() ? { top: r.paginationInfo ? r.paginationInfo.pageOffset : 0, left: 0 } : { top: 0, left: 0 };
            }
            function v(e, t, n, r) {
                (n = n || m()), (r = r || c());
                var i = x(e, n);
                if (0 === i.length) return null;
                var o = 0;
                if (1 === i.length) {
                    var a = i[0];
                    d() && (a.bottom > r.height || a.top < 0) && S(a, !0, r), p(a, !1, r) && (o = t && a.top < 0 ? Math.floor((100 * (a.height + a.top)) / a.height) : 100);
                } else
                    for (var s = 0, l = i.length; s < l; ++s)
                        if (p(i[s], !1, r)) {
                            o = t ? w(i, s) : 100;
                            break;
                        }
                return o;
            }
            function b(e, t) {
                var n = m(),
                    r = x(e, n);
                return 0 === r.length ? null : y(r, t);
            }
            function y(e, n, i, o) {
                var a = f(),
                    s = h();
                (o = o || g()), (i = i || c()), n && R(e, n, i, o, a, s);
                var l = t.first(e);
                1 === e.length && S(l, !1, i, o, a, s);
                var u;
                if (s) {
                    var d = l.top;
                    u = Math.floor(d / i.height);
                } else {
                    var p = l.left;
                    a && (p = o * (r.paginationInfo ? r.paginationInfo.visibleColumnCount : 1) - p), (u = Math.floor(p / o));
                }
                return u < 0 ? (u = 0) : u >= (r.paginationInfo ? r.paginationInfo.columnCount : 1) && (u = r.paginationInfo ? r.paginationInfo.columnCount - 1 : 0), u;
            }
            function _(e, t, n) {
                (t = t || m()), (n = n || c());
                var r = C(e, t.left, t.top);
                return y([r], n);
            }
            function w(e, n) {
                var r = 0,
                    i = 0;
                return (
                    e.length > 1
                        ? t.each(e, function (e, t) {
                              (r += e.height), t >= n && (i += e.height);
                          })
                        : ((r = e[0].height), (i = e[0].height - Math.max(0, -e[0].top))),
                    i === r ? 100 : Math.floor((100 * i) / r)
                );
            }
            function x(e, t) {
                t = t || {};
                var n,
                    r = t.left || 0,
                    o = t.top || 0,
                    a = e[0].nodeType === Node.TEXT_NODE;
                if (a) {
                    var s = i();
                    s.selectNode(e[0]), (n = s.getClientRects());
                } else n = e[0].getClientRects();
                for (var l = [], c = 0, u = n.length; c < u; ++c) n[c].height > 0 && l.push(C(n[c], r, o));
                return l;
            }
            function E(e, t) {
                t = t || {};
                var n,
                    r = t.left || 0,
                    o = t.top || 0,
                    a = e[0].nodeType === Node.TEXT_NODE;
                if (a) {
                    var s = i();
                    s.selectNode(e[0]), (n = s.getBoundingClientRect());
                } else n = e[0].getBoundingClientRect();
                return C(n, r, o);
            }
            function C(e, t, n) {
                var r = { left: e.left, right: e.right, top: e.top, bottom: e.bottom, width: e.right - e.left, height: e.bottom - e.top };
                return T(r, t, n), r;
            }
            function T(e, t, n) {
                (e.left += t), (e.right += t), (e.top += n), (e.bottom += n);
            }
            function S(e, t, n, r, i, o) {
                if (((n = n || c()), (r = r || g()), (i = i || f()), (o = o || h()), !o)) {
                    for (i && (r *= -1); e.top < 0; ) T(e, -r, n.height);
                    if (t) for (; e.bottom >= n.height && !p(e, !1, n, o); ) T(e, r, -n.height);
                }
            }
            function R(e, n, r, i, o, a) {
                if (((r = r || c()), (i = i || g()), (o = o || f()), (a = a || h()), !a)) {
                    var s = t.reduce(
                            e,
                            function (e, t) {
                                return e + t.height;
                            },
                            0
                        ),
                        l = (s * n) / 100;
                    if (e.length > 1) {
                        var u = 0;
                        do {
                            if (((u += e[0].height), u > l)) break;
                            e.shift();
                        } while (e.length > 1);
                    } else {
                        for (o && (i *= -1); e[0].bottom >= r.height; ) T(e[0], i, -r.height);
                        (e[0].top += l), (e[0].height -= l);
                    }
                }
            }
            function I(e) {
                if (h()) {
                    var t = e.right - e.width / 2;
                    return [
                        { x: t, y: e.top },
                        { x: t, y: e.bottom },
                    ];
                }
                var n = e.top + e.height / 2,
                    r = [
                        { x: e.left, y: n },
                        { x: e.right, y: n },
                    ];
                return f() ? r.reverse() : r;
            }
            function k(e, n, r, i) {
                r = r || m();
                var o = l(e, r),
                    a = t.filter(o, function (e) {
                        return p(e, !1, i);
                    }),
                    s = n(a);
                if (!s) return null;
                var c = n(I(s));
                (c.x -= r.left), (c.y -= r.top);
                var d = u(c.x, c.y);
                if (d && d.startContainer !== e && d.startContainer === e.parentNode) {
                    Z && console.log("ieTextRangeWorkaround needed");
                    var f = n([0, 1]);
                    if (d.startOffset === d.endOffset) {
                        var h = d.startContainer.childNodes[Math.max(d.startOffset - 1, 0)];
                        h === e && ((d = { startContainer: e, endContainer: e, startOffset: 0 === f ? 0 : e.nodeValue.length, startOffset: 0 === f ? 0 : e.nodeValue.length }), Z && console.log("ieTextRangeWorkaround #1:", d));
                    } else Z && console.log("ieTextRangeWorkaround didn't work :(");
                }
                return (
                    Z && console.log("getVisibleTextRangeOffsetsSelectedByFunc: ", "a0"),
                    (d && d.startContainer === e) || ((d = u(c.x - 1, c.y)), Z && console.log("getVisibleTextRangeOffsetsSelectedByFunc: ", "a1")),
                    (d && d.startContainer === e) || ((d = u(c.x, c.y - 1)), Z && console.log("getVisibleTextRangeOffsetsSelectedByFunc: ", "a2")),
                    (d && d.startContainer === e) || ((d = u(c.x - 1, c.y - 1)), Z && console.log("getVisibleTextRangeOffsetsSelectedByFunc: ", "a3")),
                    (d && d.startContainer === e) || ((c.x = Math.floor(c.x)), (c.y = Math.floor(c.y)), (d = u(c.x, c.y)), Z && console.log("getVisibleTextRangeOffsetsSelectedByFunc: ", "b0")),
                    (d && d.startContainer === e) || ((d = u(c.x - 1, c.y)), Z && console.log("getVisibleTextRangeOffsetsSelectedByFunc: ", "b1")),
                    (d && d.startContainer === e) || ((d = u(c.x, c.y - 1)), Z && console.log("getVisibleTextRangeOffsetsSelectedByFunc: ", "b2")),
                    (d && d.startContainer === e) || ((d = u(c.x - 1, c.y - 1)), Z && console.log("getVisibleTextRangeOffsetsSelectedByFunc: ", "b3")),
                    d
                        ? d.startContainer === e
                            ? n([
                                  { start: d.startOffset, end: d.startOffset + 1 },
                                  { start: d.startOffset - 1, end: d.startOffset },
                              ])
                            : (Z && console.warn("getVisibleTextRangeOffsetsSelectedByFunc: incorrect caret range result"), null)
                        : (Z && console.warn("getVisibleTextRangeOffsetsSelectedByFunc: no caret range result"), null)
                );
            }
            function P(n, r, o, a, s, l) {
                var c = 0;
                if (o) {
                    if (((c = n.indexOf(o)), c === -1)) return null;
                    c += r([1, -1]);
                } else {
                    c = n.indexOf(r(n));
                    var u = n[c];
                    u && (l = u.element);
                }
                var d = n[c];
                if (!d) return null;
                var f = d.element,
                    h = d.textNode;
                if (o && f !== l && !t.contains(e(h || f).parents(), l)) return Z && console.warn("findVisibleLeafNodeCfi: stopped recursion early"), null;
                if (h && z(h)) {
                    var p = k(h, r, a, s);
                    if (!p) return P(n, r, d, a, s, l);
                    var g = i();
                    return g.setStart(h, p.start), g.setEnd(h, p.end), D(g);
                }
                return Q.getCfiForElement(f);
            }
            function N(e, t, n) {
                var r = Q.getVisibleLeafNodes(t, n);
                return P(r, e, null, t, n);
            }
            function O(e, n) {
                return N(t.last, e, n);
            }
            function A(e, n) {
                return N(t.first, e, n);
            }
            function D(e) {
                return EPUBcfi.generateRangeComponent(e.startContainer, e.startOffset, e.endContainer, e.endOffset, Q.getClassBlacklist(), Q.getElementBlacklist(), Q.getIdBlacklist());
            }
            function M(e) {
                return EPUBcfi.getRangeTargetElements(L(e), Q.getRootDocument(), Q.getClassBlacklist(), Q.getElementBlacklist(), Q.getIdBlacklist());
            }
            function F(e) {
                return "epubcfi(" + e + ")";
            }
            function L(e) {
                return "epubcfi(/99!" + e + ")";
            }
            function U(e, t, n, r) {
                var i = Q.getRootDocument(),
                    o = F(e);
                try {
                    var a = EPUBcfi.getTargetElementWithPartialCFI(o, i, t, n, r);
                } catch (e) {}
                return a && 0 != a.length ? a : void console.log("Can't find element for CFI: " + e);
            }
            function B(e) {
                var t = { cfi: "", x: 0, y: 0 },
                    n = e.indexOf("@");
                if (n != -1) {
                    var r = e.substring(n + 1),
                        i = r.indexOf(":");
                    i != -1 ? ((t.x = parseInt(r.substr(0, i))), (t.y = parseInt(r.substr(i + 1)))) : console.log("Unexpected terminating step format"), (t.cfi = e.substring(0, n));
                } else t.cfi = e;
                return t;
            }
            function j(e) {
                var n = !1;
                return (
                    t.some(Q.getClassBlacklist(), function (t) {
                        return e.hasClass(t) && (n = !0), n;
                    }),
                    t.some(Q.getIdBlacklist(), function (t) {
                        return e.attr("id") === t && (n = !0), n;
                    }),
                    n
                );
            }
            function z(e) {
                return e.nodeType === Node.TEXT_NODE && V(e.nodeValue);
            }
            function V(e) {
                return e.replace(/[\s\n\r\t]/g, "").length > 0;
            }
            function H() {
                var e = this,
                    n = { leafNodeElements: !0, visibleLeafNodes: !1 };
                t.each(n, function (t, n) {
                    e[n] = new Map();
                }),
                    (this._invalidate = function () {
                        t.each(n, function (t, n) {
                            t || (e[n] = new Map());
                        });
                    });
            }
            function $() {
                for (var e = "0123456789ABCDEF".split(""), t = "#", n = 0; n < 6; n++) t += e[Math.round(15 * Math.random())];
                return t;
            }
            function W(t, n, r) {
                var i = $();
                t instanceof Array || (t = [t]);
                for (var o = 0; o != t.length; o++) {
                    var a = t[o],
                        s = r.createElement("div");
                    (s.style.position = "absolute"),
                        e(s).css("z-index", "1000"),
                        e(s).css("pointer-events", "none"),
                        e(s).css("opacity", "0.4"),
                        (s.style.border = "1px solid white"),
                        n || i ? (i && !n ? (s.style.background = i) : (n === !0 && (n = "red"), (s.style.border = "1px dashed " + n), (s.style.background = "yellow"))) : (s.style.background = "purple"),
                        (s.style.margin = s.style.padding = "0"),
                        (s.style.top = a.top + "px"),
                        (s.style.left = a.left + "px"),
                        (s.style.width = a.width - 2 + "px"),
                        (s.style.height = a.height - 2 + "px"),
                        r.documentElement.appendChild(s),
                        ne.push(e(s));
                }
            }
            function q(e) {
                var t, n;
                h() ? ((t = 0), (n = -K())) : ((t = -K()), (n = 0)), W({ left: e.left + t, top: e.top + n, width: e.width, height: e.height }, !0, Q.getRootDocument());
            }
            function G(e) {
                var t = s(e.startContainer, e.startOffset, e.endContainer, e.endOffset);
                return q(t), t;
            }
            function J(e) {
                q(o(e));
            }
            function K() {
                var t = e("html", Q.getRootDocument()),
                    n = t.css(h() ? "top" : f() ? "right" : "left"),
                    r = parseInt(n.replace("px", ""));
                return isNaN(r) && (r = 0), f() && !h() ? -r : r;
            }
            function X() {
                t.each(ne, function (e) {
                    e.remove();
                }),
                    ne.clear();
            }
            var Q = this;
            r = r || {};
            var Y = ReadiumSDK.DEBUG_MODE;
            (this.getRootElement = function () {
                return r.$iframe[0].contentDocument.documentElement;
            }),
                (this.getBodyElement = function () {
                    return this.getRootDocument().body || this.getRootElement();
                }),
                (this.getClassBlacklist = function () {
                    return r.classBlacklist || [];
                }),
                (this.getIdBlacklist = function () {
                    return r.idBlacklist || [];
                }),
                (this.getElementBlacklist = function () {
                    return r.elementBlacklist || [];
                }),
                (this.getRootDocument = function () {
                    return r.$iframe[0].contentDocument;
                }),
                (this.getCfiForElement = function (e) {
                    var t = EPUBcfi.Generator.generateElementCFIComponent(e, this.getClassBlacklist(), this.getElementBlacklist(), this.getIdBlacklist());
                    return "!" == t[0] && (t = t.substring(1)), t;
                }),
                (this.getVisibleCfiFromPoint = function (e, t, n) {
                    var r = Q.getRootDocument(),
                        o = u(e, t, r),
                        s = r.elementFromPoint(e, t),
                        l = !s || s === r.documentElement;
                    if (n) {
                        if (!s || l) return null;
                        var c = a(s);
                        if (!p(c, !1)) return null;
                        if (e < c.left || e > c.right || t < c.top || t > c.bottom) return null;
                    }
                    if (!o) {
                        if (l) return null;
                        (o = i()), o.selectNode(s);
                    }
                    var d,
                        f,
                        h,
                        g = o,
                        m = g.startContainer;
                    if (m.nodeType === Node.TEXT_NODE) {
                        if (n && m.parentNode !== s) return null;
                        1 === m.length && 1 === g.startOffset ? ((f = 0), (h = 1)) : g.startOffset === m.length ? ((f = g.startOffset - 1), (h = g.startOffset)) : ((f = g.startOffset), (h = g.startOffset + 1));
                        var v = { startContainer: m, endContainer: m, startOffset: f, endOffset: h, commonAncestorContainer: g.commonAncestorContainer };
                        Y && G(v), (d = D(v));
                    } else if (m.nodeType === Node.ELEMENT_NODE) {
                        if (((m = g.startContainer.childNodes[g.startOffset] || g.startContainer.childNodes[0] || g.startContainer), n && m !== s)) return null;
                        d = m.nodeType !== Node.ELEMENT_NODE ? D(g) : Q.getCfiForElement(m);
                    } else {
                        if (n && m !== s) return null;
                        d = Q.getCfiForElement(s);
                    }
                    return d && d.indexOf("NaN") !== -1 ? void console.log("Did not generate a valid CFI:" + d) : d;
                }),
                (this.getRangeCfiFromPoints = function (e, t, n, r) {
                    var o = Q.getRootDocument(),
                        a = u(e, t, o),
                        s = u(n, r, o),
                        l = i();
                    return (
                        l.setStart(a.startContainer, a.startOffset),
                        l.setEnd(s.startContainer, s.startOffset),
                        a.startContainer === a.endContainer && a.startContainer.nodeType === Node.TEXT_NODE && s.startContainer.length > s.startOffset + 1 && l.setEnd(s.startContainer, s.startOffset + 1),
                        D(l)
                    );
                });
            var Z = !1;
            (this.getFirstVisibleCfi = function (e, t) {
                return A(e, t);
            }),
                (this.getLastVisibleCfi = function (e, t) {
                    return O(e, t);
                }),
                (this.getDomRangeFromRangeCfi = function (e, t, n) {
                    var r = i();
                    if (t) {
                        if (Q.isRangeCfi(e)) {
                            var o = M(e);
                            r.setStart(o.startElement, o.startOffset);
                        } else {
                            var a = Q.getElementByCfi(e, this.getClassBlacklist(), this.getElementBlacklist(), this.getIdBlacklist())[0];
                            r.setStart(a, 0);
                        }
                        if (Q.isRangeCfi(t)) {
                            var s = M(t);
                            n ? r.setEnd(s.endElement, s.endOffset) : r.setEnd(s.startElement, s.startOffset);
                        } else {
                            var l = Q.getElementByCfi(t, this.getClassBlacklist(), this.getElementBlacklist(), this.getIdBlacklist())[0];
                            r.setEnd(l, l.childNodes.length);
                        }
                    } else if (Q.isRangeCfi(e)) {
                        var c = M(e);
                        r.setStart(c.startElement, c.startOffset), r.setEnd(c.endElement, c.endOffset);
                    } else {
                        var u = Q.getElementByCfi(e, this.getClassBlacklist(), this.getElementBlacklist(), this.getIdBlacklist())[0];
                        r.selectNode(u);
                    }
                    return r;
                }),
                (this.getRangeCfiFromDomRange = function (e) {
                    return D(e);
                }),
                (this.isRangeCfi = function (e) {
                    return EPUBcfi.Interpreter.isRangeCfi(F(e)) || EPUBcfi.Interpreter.isRangeCfi(L(e));
                }),
                (this.getPageForElementCfi = function (e, t, n, r) {
                    var i = B(e),
                        o = i.cfi;
                    if (this.isRangeCfi(o)) {
                        var a = this.getNodeRangeInfoFromCfi(o);
                        return _(a.clientRect);
                    }
                    var s = U(i.cfi, t, n, r);
                    if (!s) return -1;
                    var l = this.getPageForPointOnElement(s, i.x, i.y);
                    return l;
                }),
                (this.getElementFromPoint = function (e, t) {
                    var n = Q.getRootDocument();
                    return n.elementFromPoint(e, t);
                }),
                (this.getNodeRangeInfoFromCfi = function (e) {
                    var t = Q.getRootDocument();
                    if (Q.isRangeCfi(e)) {
                        var n = L(e);
                        try {
                            var r = EPUBcfi.Interpreter.getRangeTargetElements(n, t, this.getClassBlacklist(), this.getElementBlacklist(), this.getIdBlacklist());
                            Y && console.log(r);
                        } catch (e) {}
                        if (!r) return void console.log("Can't find nodes for range CFI: " + e);
                        var i = { node: r.startElement, offset: r.startOffset },
                            o = { node: r.endElement, offset: r.endOffset },
                            a = i && o ? s(i.node, i.offset, o.node, o.offset) : null;
                        return Y && (console.log(a), W(a, "purple", t)), { startInfo: i, endInfo: o, clientRect: a };
                    }
                    var l = Q.getElementByCfi(e, this.getClassBlacklist(), this.getElementBlacklist(), this.getIdBlacklist()),
                        c = m();
                    return { startInfo: null, endInfo: null, clientRect: E(l, c) };
                }),
                (this.isNodeFromRangeCfiVisible = function (e) {
                    var t = this.getNodeRangeInfoFromCfi(e);
                    return t ? p(t.clientRect, !1) : void 0;
                }),
                (this.getElementByCfi = function (e, t, n, r) {
                    var i = B(e);
                    return U(i.cfi, t, n, r);
                }),
                (this.getPageForElement = function (e) {
                    return this.getPageForPointOnElement(e, 0, 0);
                }),
                (this.getPageForPointOnElement = function (e, t, n) {
                    var r = b(e, n);
                    return null === r ? (console.warn("Impossible to locate a hidden element: ", e), 0) : r;
                }),
                (this.getVerticalOffsetForElement = function (e) {
                    return this.getVerticalOffsetForPointOnElement(e, 0, 0);
                }),
                (this.getVerticalOffsetForPointOnElement = function (e, t, r) {
                    var i = n.Rect.fromElement(e);
                    return Math.ceil(i.top + (r * i.height) / 100);
                }),
                (this.getElementById = function (t) {
                    var n = this.getRootDocument(),
                        r = e(n.getElementById(t));
                    if (0 != r.length) return r;
                }),
                (this.getPageForElementId = function (e) {
                    var t = this.getElementById(e);
                    return t ? this.getPageForElement(t) : -1;
                }),
                (this.getFirstVisibleMediaOverlayElement = function (t) {
                    function n(r) {
                        if (r && r.length)
                            for (var a = 0, s = r.length; a < s; a++) {
                                var l = r[a];
                                if (l) {
                                    var c = e(l);
                                    if (c.data("mediaOverlayData")) {
                                        var u = i.getElementVisibility(c, t);
                                        if (u && (o || (o = l), 100 == u)) return l;
                                    } else {
                                        var d = n(l.children);
                                        if (d) return d;
                                    }
                                }
                            }
                    }
                    var r = e(this.getBodyElement());
                    if (r && r.length && r[0]) {
                        var i = this,
                            o = void 0,
                            a = n([r[0]]);
                        return a || (a = o), a;
                    }
                }),
                (this.getElementVisibility = function (e, t) {
                    return v(e, !0, t);
                }),
                (this.isElementVisible = v),
                (this.getVisibleElementsWithFilter = function (t, n) {
                    var r = this.getElementsWithFilter(e(this.getBodyElement()), n);
                    return this.getVisibleElements(r, t);
                }),
                (this.getAllElementsWithFilter = function (t) {
                    var n = this.getElementsWithFilter(e(this.getBodyElement()), t);
                    return n;
                }),
                (this.getAllVisibleElementsWithSelector = function (t, n) {
                    var r = e(t, this.getRootElement()),
                        i = [];
                    e.each(r, function () {
                        i.push(e(this));
                    });
                    var o = this.getVisibleElements(i, n);
                    return o;
                }),
                (this.getVisibleElements = function (e, n, r) {
                    var i = [];
                    return (
                        t.each(e, function (e) {
                            var t = e[0].nodeType === Node.TEXT_NODE,
                                o = t ? e.parent() : e,
                                a = v(e, !0, n, r);
                            a && i.push({ element: o[0], textNode: t ? e[0] : null, percentVisible: a });
                        }),
                        i
                    );
                }),
                (this.getVisibleLeafNodes = function (t, n) {
                    if (te) {
                        var i = (r.paginationInfo || {}).currentSpreadIndex || 0,
                            o = ee.visibleLeafNodes.get(i);
                        if (o) return o;
                    }
                    var a = this.getLeafNodeElements(e(this.getBodyElement())),
                        s = this.getVisibleElements(a, t, n);
                    return te && ee.visibleLeafNodes.set(i, s), s;
                }),
                (this.getElementsWithFilter = function (t, n) {
                    function r(t) {
                        if (void 0 != t)
                            for (var o = 0, a = t.length; o < a; o++) {
                                var s = e(t[o]);
                                n(s) ? i.push(s) : r(s[0].children);
                            }
                    }
                    var i = [];
                    return r([t[0]]), i;
                }),
                (this.getLeafNodeElements = function (t) {
                    if (te) {
                        var n = ee.leafNodeElements.get(t);
                        if (n) return n;
                    }
                    for (
                        var r,
                            i = document.createNodeIterator(
                                t[0],
                                NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_TEXT,
                                function () {
                                    return NodeFilter.FILTER_ACCEPT;
                                },
                                !1
                            ),
                            o = [];
                        (r = i.nextNode());

                    ) {
                        var a = r.nodeType === Node.ELEMENT_NODE && !r.childElementCount && !V(r.textContent);
                        if (a || z(r)) {
                            var s = e(r),
                                l = r.nodeType === Node.TEXT_NODE ? s.parent() : s;
                            j(l) || o.push(s);
                        }
                    }
                    return te && ee.leafNodeElements.set(t, o), o;
                }),
                (this.getElements = function (t) {
                    return t ? e(t, this.getRootElement()) : e(this.getRootElement()).children();
                }),
                (this.getElement = function (e) {
                    var t = this.getElements(e);
                    if (t.length > 0) return t;
                });
            var ee = new H(),
                te = !1;
            this.invalidateCache = function () {
                ee._invalidate();
            };
            var ne = [];
            ReadiumSDK._DEBUG_CfiNavigationLogic = {
                clearDebugOverlays: X,
                drawDebugOverlayFromRect: q,
                drawDebugOverlayFromDomRange: G,
                drawDebugOverlayFromNode: J,
                debugVisibleCfis: function () {
                    console.log(JSON.stringify(ReadiumSDK.reader.getPaginationInfo().openPages));
                    var e = ReadiumSDK.reader.getFirstVisibleCfi(),
                        t = ReadiumSDK.reader.getDomRangeFromRangeCfi(e);
                    console.log(e, t, G(t));
                    var n = ReadiumSDK.reader.getLastVisibleCfi(),
                        r = ReadiumSDK.reader.getDomRangeFromRangeCfi(n);
                    console.log(n, r, G(r));
                },
            };
        };
        return i;
    }),
    define("readium_shared_js/models/viewer_settings", [], function () {
        var e = function (e) {
            function t(e) {
                for (var t = [], n = e.split(/[\s,;]+/), r = 0; r < n.length; r++) {
                    var i = n[r].trim();
                    "" !== i && t.push(i);
                }
                return t;
            }
            function n(e, t, n) {
                void 0 !== t[e] && (n ? (r[e] = n(t[e])) : (r[e] = t[e]));
            }
            var r = this;
            (this.syntheticSpread = "auto"),
                (this.fontSize = 100),
                (this.columnGap = 20),
                (this.columnMaxWidth = 700),
                (this.columnMinWidth = 400),
                (this.mediaOverlaysPreservePlaybackWhenScroll = !1),
                (this.mediaOverlaysSkipSkippables = !1),
                (this.mediaOverlaysEscapeEscapables = !0),
                (this.mediaOverlaysSkippables = []),
                (this.mediaOverlaysEscapables = []),
                (this.mediaOverlaysEnableClick = !0),
                (this.mediaOverlaysRate = 1),
                (this.mediaOverlaysVolume = 100),
                (this.mediaOverlaysSynchronizationGranularity = ""),
                (this.mediaOverlaysAutomaticPageTurn = !0),
                (this.enableGPUHardwareAccelerationCSS3D = !1),
                (this.pageTransition = -1),
                (this.scroll = "auto"),
                (this.update = function (e) {
                    n("columnGap", e),
                        n("columnMaxWidth", e),
                        n("columnMinWidth", e),
                        n("fontSize", e),
                        n("mediaOverlaysPreservePlaybackWhenScroll", e),
                        n("mediaOverlaysSkipSkippables", e),
                        n("mediaOverlaysEscapeEscapables", e),
                        n("mediaOverlaysSkippables", e, t),
                        n("mediaOverlaysEscapables", e, t),
                        n("mediaOverlaysEnableClick", e),
                        n("mediaOverlaysRate", e),
                        n("mediaOverlaysVolume", e),
                        n("mediaOverlaysSynchronizationGranularity", e),
                        n("mediaOverlaysAutomaticPageTurn", e),
                        n("scroll", e),
                        n("syntheticSpread", e),
                        n("pageTransition", e),
                        n("enableGPUHardwareAccelerationCSS3D", e);
                }),
                this.update(e);
        };
        return e;
    }),
    (function (e, t) {
        "function" == typeof define && define.amd ? define("ResizeSensor", t) : "object" == typeof exports ? (module.exports = t()) : (e.ResizeSensor = t());
    })(this, function () {
        function e(e, t) {
            var n = Object.prototype.toString.call(e),
                r = "[object Array]" === n || "[object NodeList]" === n || "[object HTMLCollection]" === n || ("undefined" != typeof jQuery && e instanceof jQuery) || ("undefined" != typeof Elements && e instanceof Elements),
                i = 0,
                o = e.length;
            if (r) for (; i < o; i++) t(e[i]);
            else t(e);
        }
        var t =
                window.requestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                window.webkitRequestAnimationFrame ||
                function (e) {
                    return window.setTimeout(e, 20);
                },
            n = function (r, i) {
                function o() {
                    var e = [];
                    this.add = function (t) {
                        e.push(t);
                    };
                    var t, n;
                    (this.call = function () {
                        for (t = 0, n = e.length; t < n; t++) e[t].call();
                    }),
                        (this.remove = function (r) {
                            var i = [];
                            for (t = 0, n = e.length; t < n; t++) e[t] !== r && i.push(e[t]);
                            e = i;
                        }),
                        (this.length = function () {
                            return e.length;
                        });
                }
                function a(e, t) {
                    return e.currentStyle ? e.currentStyle[t] : window.getComputedStyle ? window.getComputedStyle(e, null).getPropertyValue(t) : e.style[t];
                }
                function s(e, n) {
                    if (e.resizedAttached) {
                        if (e.resizedAttached) return void e.resizedAttached.add(n);
                    } else (e.resizedAttached = new o()), e.resizedAttached.add(n);
                    (e.resizeSensor = document.createElement("div")), (e.resizeSensor.className = "resize-sensor");
                    var r = "position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",
                        i = "position: absolute; left: 0; top: 0; transition: 0s;";
                    (e.resizeSensor.style.cssText = r),
                        (e.resizeSensor.innerHTML =
                            '<div class="resize-sensor-expand" style="' +
                            r +
                            '"><div style="' +
                            i +
                            '" class="resize-sensor-inner"></div></div><div class="resize-sensor-shrink" style="' +
                            r +
                            '"><div style="' +
                            i +
                            ' width: 200%; height: 200%" class="resize-sensor-inner"></div></div>'),
                        e.appendChild(e.resizeSensor),
                        "static" == a(e, "position") && (e.style.position = "relative");
                    var s = e.resizeSensor.childNodes[0],
                        l = s.childNodes[0],
                        c = e.resizeSensor.childNodes[1],
                        u = function () {
                            (l.style.width = 1e5 + "px"), (l.style.height = 1e5 + "px"), (s.scrollLeft = 1e5), (s.scrollTop = 1e5), (c.scrollLeft = 1e5), (c.scrollTop = 1e5);
                        };
                    u();
                    var d = !1,
                        f = function () {
                            d && e.resizedAttached && e.resizedAttached.call(), (d = !1);
                        };
                    t(f);
                    var h,
                        p,
                        g,
                        m,
                        v = function () {
                            ((g = e.offsetWidth) == h && (m = e.offsetHeight) == p) || ((d = !0), (h = g), (p = m), t(f)), u();
                        },
                        b = function (e, t, n) {
                            e.attachEvent ? e.attachEvent("on" + t, n) : e.addEventListener(t, n);
                        };
                    b(s, "scroll", v), b(c, "scroll", v);
                }
                e(r, function (e) {
                    s(e, i);
                }),
                    (this.detach = function (e) {
                        n.detach(r, e);
                    });
            };
        return (
            (n.detach = function (t, n) {
                e(t, function (e) {
                    (e.resizedAttached && "function" == typeof n && (e.resizedAttached.remove(n), e.resizedAttached.length())) ||
                        (e.resizeSensor && (e.contains(e.resizeSensor) && e.removeChild(e.resizeSensor), delete e.resizeSensor, delete e.resizedAttached));
                });
            }),
            n
        );
    }),
    define("readium_shared_js/views/one_page_view", ["../globals", "jquery", "underscore", "eventEmitter", "./cfi_navigation_logic", "../helpers", "../models/viewer_settings", "../models/bookmark_data", "ResizeSensor"], function (
        e,
        t,
        n,
        r,
        i,
        o,
        a,
        s,
        l
    ) {
        var c = function (u, d, f, h) {
            function p(n) {
                if (n) {
                    D = !0;
                    var r = S[0].contentDocument;
                    (E = t("html", r)), E && 0 != E.length ? (C = t("body", E)) : (E = t("svg", r)), L && k.applyBookStyles(), v();
                    var i = C[0];
                    (i.resizeSensor = new l(i, function () {
                        console.log("OnePageView iframe body resized", t(i).width(), t(i).height());
                        var n = P.package.resolveRelativeUrl(R.href);
                        e.logEvent("OnePageView.Events.CONTENT_SIZE_CHANGED", "EMIT", "one_page_view.js [ " + R.href + " -- " + n + " ]"), k.emit(c.Events.CONTENT_SIZE_CHANGED, S, R);
                    })),
                        F.onIFrameLoad();
                }
            }
            function g() {
                L && E && B && o.UpdateHtmlFontSize(E, B.fontSize);
            }
            function m() {
                if (!S || !S.length) return 0;
                if (o.isIframeAlive(S[0])) {
                    var e = S[0].contentWindow,
                        t = S[0].contentDocument,
                        n = Math.round(parseFloat(e.getComputedStyle(t.documentElement).height));
                    return n;
                }
                if (E) {
                    console.error("getContentDocHeight ??");
                    var r = E.height();
                    return r;
                }
                return 0;
            }
            function v() {
                (U.width = 0), (U.height = 0);
                var e = void 0,
                    n = !1,
                    r = void 0,
                    i = void 0,
                    o = S[0].contentDocument,
                    a = t("meta[name=viewport]", o).attr("content");
                if ((a || (a = t("meta[name=viewbox]", o).attr("content")), a && (e = y(a)), !e && o && o.documentElement && o.documentElement.nodeName && "svg" == o.documentElement.nodeName.toLowerCase())) {
                    var s = void 0,
                        l = void 0,
                        c = o.documentElement.getAttribute("width"),
                        u = c && c.length >= 1 && "%" == c[c.length - 1];
                    if (c)
                        try {
                            s = parseInt(c, 10);
                        } catch (e) {}
                    s && u && ((r = s), (s = void 0));
                    var d = o.documentElement.getAttribute("height"),
                        f = d && d.length >= 1 && "%" == d[d.length - 1];
                    if (d)
                        try {
                            l = parseInt(d, 10);
                        } catch (e) {}
                    l && f && ((i = l), (l = void 0)), s && l && (e = { width: s, height: l });
                }
                if ((!e && R && ((a = R.getRenditionViewport()), a && ((e = y(a)), e && console.log("Viewport: using rendition:viewport dimensions"))), !e)) {
                    var h = t(o).find("img");
                    if (h.length > 0) {
                        e = { width: h.width(), height: h.height() };
                        var p = R && R.media_type && R.media_type.length && 0 == R.media_type.indexOf("image/");
                        p || console.warn("Viewport: using img dimensions!");
                    } else if (((h = t(o).find("image")), h.length > 0)) {
                        var s = void 0,
                            l = void 0,
                            c = h[0].getAttribute("width");
                        if (c)
                            try {
                                s = parseInt(c, 10);
                            } catch (e) {}
                        var d = h[0].getAttribute("height");
                        if (d)
                            try {
                                l = parseInt(d, 10);
                            } catch (e) {}
                        s && l && ((e = { width: s, height: l }), (n = !0), console.warn("Viewport: using image dimensions!"));
                    }
                }
                if (!e) {
                    (s = A.width()), (l = A.height());
                    var g = t("iframe.iframe-fixed", A).length > 1;
                    g && (s *= 0.5), r && (s *= r / 100), i && (l *= i / 100), (e = { width: s, height: l }), (n = !0), console.warn("Viewport: using browser / e-reader viewport dimensions!");
                }
                e && ((U.width = e.width), (U.height = e.height));
            }
            function b(t) {
                t && (e.logEvent("CONTENT_DOCUMENT_UNLOADED", "EMIT", "one_page_view.js [ " + t.href + " ]"), k.emit(e.Events.CONTENT_DOCUMENT_UNLOADED, S, t));
            }
            function y(e) {
                for (var t = e.replace(/\s/g, "").split(","), n = {}, r = 0; r < t.length; r++) {
                    var i = t[r].split("=");
                    2 == i.length && (n[i[0]] = i[1]);
                }
                var o = Number.NaN,
                    a = Number.NaN;
                if ((n.width && (o = parseInt(n.width)), n.height && (a = parseInt(n.height)), !isNaN(o) && !isNaN(a))) return { width: o, height: a };
            }
            function _() {
                return { top: -T.parent().scrollTop(), left: 0 };
            }
            function w() {
                return { width: T.parent()[0].clientWidth, height: T.parent()[0].clientHeight };
            }
            function x(e) {
                return new s(R.idref, e);
            }
            t.extend(this, new r());
            var E,
                C,
                T,
                S,
                R,
                I,
                k = this,
                P = u.spine,
                N = u.iframeLoader,
                O = u.bookStyles,
                A = u.$viewport,
                D = !1,
                M = function (e) {
                    var t = function (e, t) {
                            (this.begin = e), (this.end = t);
                        },
                        n = new t(
                            function (e, t, n, r, i, o, a) {
                                r.css("opacity", "0");
                            },
                            function (e, t, n, r, i, a, s) {
                                r.css("transform", "none"), o.CSSTransition(r, "opacity 150ms ease-out"), r.css("opacity", "1");
                            }
                        ),
                        r = new t(
                            function (e, t, n, r, i, a, s) {
                                r.css("opacity", "0");
                                var l = Math.ceil(i * e),
                                    c = 0.8 * l * (2 === s ? 1 : -1),
                                    u = o.CSSTransformString({ left: Math.round(c), origin: "50% 50% 0", enable3D: f });
                                r.css(u);
                            },
                            function (e, t, n, r, i, a, s) {
                                r.css("opacity", "1"), o.CSSTransition(r, "transform 150ms ease-out"), r.css("transform", "none");
                            }
                        ),
                        i = new t(
                            function (e, t, n, r, i, a, s) {
                                r.css("opacity", "0");
                                var l = Math.ceil(i * e),
                                    c = 1.7 * l * (2 === s ? 1 : -1),
                                    u = o.CSSTransformString({ left: Math.round(c), angle: 30 * (2 === s ? -1 : 1), origin: "50% 50% 0", enable3D: f });
                                r.css(u);
                            },
                            function (e, t, n, r, i, a, s) {
                                r.css("opacity", "1"), o.CSSTransition(r, "transform 300ms ease-in-out"), r.css("transform", "none");
                            }
                        ),
                        s = new t(
                            function (e, t, n, r, i, a, s) {
                                r.css("opacity", "0");
                                for (var l = !1, c = !1, u = !1, h = 0; h < d.length; h++) {
                                    var p = d[h].toLowerCase();
                                    if (p.indexOf("left") >= 0) {
                                        l = !0;
                                        break;
                                    }
                                    if (p.indexOf("right") >= 0) {
                                        u = !0;
                                        break;
                                    }
                                    if (p.indexOf("center") >= 0) {
                                        c = !0;
                                        break;
                                    }
                                }
                                var g = Math.ceil(i * e),
                                    m = 0.5 * g * (l || (c && 1 === s) ? 1 : -1),
                                    v = o.CSSTransformString({ scale: 0.2, left: Math.round(m), angle: 30 * (l || (c && 1 === s) ? 1 : -1), origin: "50% 50% 0", enable3D: f });
                                r.css(v);
                            },
                            function (e, t, n, r, i, a, s) {
                                r.css("opacity", "1"), o.CSSTransition(r, "transform 400ms ease-out"), r.css("transform", "none");
                            }
                        ),
                        l = [];
                    l.push(n), l.push(r), l.push(i), l.push(s);
                    var c = e.disablePageTransitions || !1;
                    c = !0;
                    var u = -1,
                        f = new a({}).enableGPUHardwareAccelerationCSS3D,
                        h = void 0;
                    (this.updateOptions = function (e) {
                        h = e;
                        var t = h;
                        (t && "undefined" != typeof t.enableGPUHardwareAccelerationCSS3D) || (t = new a({})),
                            t.enableGPUHardwareAccelerationCSS3D && (f = !0),
                            null !== e.pageTransition && "undefined" != typeof e.pageTransition && (u = e.pageTransition);
                    }),
                        this.updateOptions(e);
                    var p = 0,
                        g = !1,
                        m = !1;
                    (this.updatePageSwitchDir = function (e, t) {
                        m || ((p = e), (g = t));
                    }),
                        (this.onIFrameLoad = function () {
                            m = !0;
                        }),
                        (this.transformContentImmediate_BEGIN = function (e, t, n, r) {
                            var i = g || m;
                            if (((m = !1), !c && u !== -1 && (o.CSSTransition(e, "all 0 ease 0"), i))) {
                                var a = u >= 0 && u < l.length ? l[u] : void 0;
                                0 !== p && a ? a.begin(t, n, r, e, k.meta_width(), k.meta_height(), p) : e.css("opacity", "0");
                            }
                        }),
                        (this.transformContentImmediate_END = function (e, t, n, r) {
                            return c || u === -1
                                ? void e.css("transform", "none")
                                : void setTimeout(function () {
                                      var i = u >= 0 && u < l.length ? l[u] : void 0;
                                      0 !== p && i ? i.end(t, n, r, e, k.meta_width(), k.meta_height(), p) : (e.css("transform", "none"), o.CSSTransition(e, "opacity 250ms linear"), e.css("opacity", "1"));
                                  }, 10);
                        });
                },
                F = new M(u),
                L = f || !1,
                U = { width: 0, height: 0 };
            (this.element = function () {
                return T;
            }),
                (this.meta_height = function () {
                    return U.height;
                }),
                (this.meta_width = function () {
                    return U.width;
                }),
                (this.isDisplaying = function () {
                    return D;
                }),
                (this.render = function () {
                    var e = o.loadTemplate("single_page_frame", {});
                    (T = t(e)), (I = t("#scaler", T)), o.CSSTransition(T, "all 0 ease 0"), T.css("transform", "none");
                    var n = h.viewerSettings();
                    (n && "undefined" != typeof n.enableGPUHardwareAccelerationCSS3D) || (n = new a({})), n.enableGPUHardwareAccelerationCSS3D && T.css("transform", "translateZ(0)"), T.css("height", "100%"), T.css("width", "100%");
                    for (var r = 0, i = d.length; r < i; r++) T.addClass(d[r]);
                    return (S = t("iframe", T)), this;
                }),
                (this.decorateIframe = function () {
                    S && S.length && (S.css("border-bottom", "1px dashed silver"), S.css("border-top", "1px dashed silver"));
                }),
                (this.remove = function () {
                    this.clear(), (R = void 0), T && T[0] && T.remove(), (T = void 0), (I = void 0), (S = void 0);
                }),
                (this.clear = function () {
                    (D = !1), S && S[0] && (S[0].src = "");
                }),
                (this.currentSpineItem = function () {
                    return R;
                });
            var B = void 0;
            (this.setViewSettings = function (e) {
                (B = e), L && k.applyBookStyles(), v(), F.updateOptions(e);
            }),
                (this.applyBookStyles = function () {
                    L && E && (o.setStyles(O.getStyles(), E), g());
                }),
                (this.scaleToWidth = function (e) {
                    if (!(U.width <= 0)) {
                        var t = e / U.width;
                        k.transformContentImmediate(t, 0, 0);
                    }
                }),
                (this.resizeIFrameToContent = function () {
                    var e = m();
                    k.setHeight(e), k.showIFrame();
                }),
                (this.setHeight = function (e) {
                    I.css("height", e + "px"), T.css("height", e + "px");
                });
            var j = !0;
            (this.showIFrame = function () {
                if ((S.css("visibility", "visible"), j)) {
                    S.css("transform", "none");
                    var e = !1,
                        t = B;
                    (t && "undefined" != typeof t.enableGPUHardwareAccelerationCSS3D) || (t = new a({})), t.enableGPUHardwareAccelerationCSS3D && ((e = !0), S.css("transform", "translateZ(0)"));
                } else S.css({ left: "0px", top: "0px" });
            }),
                (this.hideIFrame = function () {
                    if ((S.css("visibility", "hidden"), j)) {
                        var e = !1,
                            t = B;
                        (t && "undefined" != typeof t.enableGPUHardwareAccelerationCSS3D) || (t = new a({})), t.enableGPUHardwareAccelerationCSS3D && (e = !0);
                        var n = o.CSSTransformString({ left: "10000", top: "10000", enable3D: e });
                        S.css(n);
                    } else S.css({ left: "10000px", top: "10000px" });
                }),
                (this.updatePageSwitchDir = function (e, t) {
                    F.updatePageSwitchDir(e, t);
                }),
                (this.transformContentImmediate = function (e, t, n) {
                    var r = Math.ceil(U.width * e),
                        i = Math.floor(U.height * e);
                    if ((F.transformContentImmediate_BEGIN(T, e, t, n), T.css("left", t + "px"), T.css("top", n + "px"), T.css("width", r + "px"), T.css("height", i + "px"), E)) {
                        var s = !1,
                            l = B;
                        if (((l && "undefined" != typeof l.enableGPUHardwareAccelerationCSS3D) || (l = new a({})), l.enableGPUHardwareAccelerationCSS3D && (s = !0), h.needsFixedLayoutScalerWorkAround())) {
                            var c = o.CSSTransformString({ scale: e, enable3D: s });
                            (c["min-width"] = U.width), (c["min-height"] = U.height), E.css(c), C && C.length && C.css({ width: U.width, height: U.height });
                            var u = o.CSSTransformString({ scale: 1, enable3D: s });
                            (u.width = U.width * e), (u.height = U.height * e), I.css(u);
                        } else {
                            var d = o.CSSTransformString({ scale: e, enable3D: s });
                            (d.width = U.width), (d.height = U.height), I.css(d);
                        }
                        E.css("opacity", "0.999"),
                            k.showIFrame(),
                            setTimeout(function () {
                                E.css("opacity", "1");
                            }, 0),
                            F.transformContentImmediate_END(T, e, t, n);
                    }
                }),
                (this.getCalculatedPageHeight = function () {
                    return T.height();
                }),
                (this.transformContent = n.bind(n.debounce(this.transformContentImmediate, 50), k)),
                (this.onUnload = function () {
                    b(R);
                }),
                (this.loadSpineItem = function (t, n, r) {
                    if (R != t) {
                        var i = R;
                        R = t;
                        var a = P.package.resolveRelativeUrl(t.href);
                        k.hideIFrame(),
                            b(i),
                            e.logEvent("OnePageView.Events.SPINE_ITEM_OPEN_START", "EMIT", "one_page_view.js [ " + t.href + " -- " + a + " ]"),
                            k.emit(c.Events.SPINE_ITEM_OPEN_START, S, R),
                            N.loadIframe(
                                S[0],
                                a,
                                function (e) {
                                    if (e && n) {
                                        var i = function () {
                                            n(e, S, R, !0, r);
                                        };
                                        o.isIframeAlive(S[0]) ? (p(e), i()) : (console.error("onIFrameLoad !! doc && win + TIMEOUT"), console.debug(t.href), p(e), setTimeout(i, 500));
                                    } else p(e);
                                },
                                k,
                                { spineItem: R }
                            );
                    } else n && n(!0, S, R, !1, r);
                }),
                (this.getNavigator = function () {
                    return new i({
                        $iframe: S,
                        frameDimensions: w,
                        visibleContentOffsets: _,
                        classBlacklist: ["cfi-marker", "mo-cfi-highlight", "resize-sensor", "resize-sensor-expand", "resize-sensor-shrink"],
                        elementBlacklist: [],
                        idBlacklist: ["MathJax_Message", "MathJax_SVG_Hidden"],
                    });
                }),
                (this.getElementByCfi = function (e, t, n, r, i) {
                    if (e != R.idref) return void console.error("spine item is not loaded");
                    var o = k.getNavigator();
                    return o.getElementByCfi(t, n, r, i);
                }),
                (this.getElementById = function (e, t) {
                    if (e != R.idref) return void console.error("spine item is not loaded");
                    var n = k.getNavigator();
                    return n.getElementById(t);
                }),
                (this.getElement = function (e, t) {
                    if (e != R.idref) return void console.error("spine item is not loaded");
                    var n = k.getNavigator();
                    return n.getElement(t);
                }),
                (this.getFirstVisibleMediaOverlayElement = function () {
                    var e = k.getNavigator();
                    return e.getFirstVisibleMediaOverlayElement();
                }),
                (this.offset = function () {
                    if (S) return S.offset();
                }),
                (this.getVisibleElementsWithFilter = function (e) {
                    var t = k.getNavigator(),
                        n = t.getVisibleElementsWithFilter(null, e);
                    return n;
                }),
                (this.getVisibleElements = function (e) {
                    var t = k.getNavigator(),
                        n = t.getAllVisibleElementsWithSelector(e);
                    return n;
                }),
                (this.getAllElementsWithFilter = function (e, t) {
                    var n = k.getNavigator(),
                        r = n.getAllElementsWithFilter(e, t);
                    return r;
                }),
                (this.getElements = function (e, t) {
                    if (e != R.idref) return void console.error("spine item is not loaded");
                    var n = k.getNavigator();
                    return n.getElements(t);
                }),
                (this.getNodeRangeInfoFromCfi = function (e, t) {
                    if (e != R.idref) return void console.warn("spine item is not loaded");
                    var n = k.getNavigator();
                    return n.getNodeRangeInfoFromCfi(t);
                }),
                (this.getLoadedContentFrames = function () {
                    return [{ spineItem: R, $iframe: S }];
                }),
                (this.getFirstVisibleCfi = function (e, t) {
                    return x(k.getNavigator().getFirstVisibleCfi(e, t));
                }),
                (this.getLastVisibleCfi = function (e, t) {
                    return x(k.getNavigator().getLastVisibleCfi(e, t));
                }),
                (this.getDomRangeFromRangeCfi = function (e, t, n) {
                    return k.getNavigator().getDomRangeFromRangeCfi(e, t, n);
                }),
                (this.getRangeCfiFromDomRange = function (e) {
                    return x(k.getNavigator().getRangeCfiFromDomRange(e));
                }),
                (this.getVisibleCfiFromPoint = function (e, t, n) {
                    return x(k.getNavigator().getVisibleCfiFromPoint(e, t, n));
                }),
                (this.getRangeCfiFromPoints = function (e, t, n, r) {
                    return x(k.getNavigator().getRangeCfiFromPoints(e, t, n, r));
                }),
                (this.getCfiForElement = function (e) {
                    return x(k.getNavigator().getCfiForElement(e));
                }),
                (this.getElementFromPoint = function (e, t) {
                    return k.getNavigator().getElementFromPoint(e, t);
                });
        };
        return (c.Events = { SPINE_ITEM_OPEN_START: "SpineItemOpenStart", CONTENT_SIZE_CHANGED: "ContentSizeChanged" }), c;
    }),
    define("readium_shared_js/models/page_open_request", [], function () {
        var e = function (e, t) {
            (this.spineItem = e),
                (this.spineItemPageIndex = void 0),
                (this.elementId = void 0),
                (this.elementCfi = void 0),
                (this.firstVisibleCfi = void 0),
                (this.lastVisibleCfi = void 0),
                (this.firstPage = !1),
                (this.lastPage = !1),
                (this.initiator = t),
                (this.reset = function () {
                    (this.spineItemPageIndex = void 0), (this.elementId = void 0), (this.elementCfi = void 0), (this.firstPage = !1), (this.lastPage = !1);
                }),
                (this.setFirstPage = function () {
                    this.reset(), (this.firstPage = !0);
                }),
                (this.setLastPage = function () {
                    this.reset(), (this.lastPage = !0);
                }),
                (this.setPageIndex = function (e) {
                    this.reset(), (this.spineItemPageIndex = e);
                }),
                (this.setElementId = function (e) {
                    this.reset(), (this.elementId = e);
                }),
                (this.setElementCfi = function (e) {
                    this.reset(), (this.elementCfi = e);
                }),
                (this.setFirstAndLastVisibleCfi = function (e, t) {
                    this.reset(), (this.firstVisibleCfi = e), (this.lastVisibleCfi = t);
                });
        };
        return e;
    }),
    define("readium_shared_js/views/fixed_view", [
        "../globals",
        "jquery",
        "underscore",
        "eventEmitter",
        "../models/bookmark_data",
        "../models/current_pages_info",
        "../models/fixed_page_spread",
        "./one_page_view",
        "../models/page_open_request",
        "../helpers",
    ], function (e, t, n, r, i, o, a, s, l, c) {
        var u = function (n, i) {
            function u(t) {
                var r = new s(n, [t], !1, i);
                return (
                    r.on(s.Events.SPINE_ITEM_OPEN_START, function (t, n) {
                        e.logEvent("OnePageView.Events.SPINE_ITEM_OPEN_START", "ON", "fixed_view.js [ " + n.href + " ]"),
                            e.logEvent("CONTENT_DOCUMENT_LOAD_START", "EMIT", "fixed_view.js [ " + n.href + " ]"),
                            S.emit(e.Events.CONTENT_DOCUMENT_LOAD_START, t, n);
                    }),
                    r.on(e.Events.CONTENT_DOCUMENT_UNLOADED, function (t, n) {
                        e.logEvent("CONTENT_DOCUMENT_UNLOADED", "ON", "fixed_view.js [ " + n.href + " ]"),
                            e.logEvent("CONTENT_DOCUMENT_UNLOADED", "EMIT", "fixed_view.js [ " + n.href + " ]"),
                            S.emit(e.Events.CONTENT_DOCUMENT_UNLOADED, t, n);
                    }),
                    r
                );
            }
            function d() {
                var e = U.validItems();
                return e[0];
            }
            function f(e, n) {
                if (B) return void (j = { initiator: e, paginationRequest: n });
                B = !0;
                var r = { isElementAdded: !1 },
                    i = h([
                        { pageView: O, spineItem: U.leftItem, context: r },
                        { pageView: A, spineItem: U.rightItem, context: r },
                        { pageView: D, spineItem: U.centerItem, context: r },
                    ]);
                t.when.apply(t, i).done(function () {
                    if (((B = !1), j)) {
                        var t = j.initiator,
                            i = j.paginationRequest;
                        (j = void 0), f(t, i);
                    } else r.isElementAdded && (c.setStyles(k.getStyles(), C.parent()), _()), n ? p(e, n.spineItem, n.elementId) : p(e);
                });
            }
            function h(e) {
                for (var t = [], n = 0; n < e.length; n++) {
                    var r = w(e[n].pageView, e[n].spineItem, e[n].context);
                    t.push(r);
                }
                return t;
            }
            function p(t, n, r) {
                y(),
                    v(),
                    window.setTimeout(function () {
                        e.logEvent("InternalEvents.CURRENT_VIEW_PAGINATION_CHANGED", "EMIT", "fixed_view.js"),
                            S.emit(e.InternalEvents.CURRENT_VIEW_PAGINATION_CHANGED, { paginationInfo: S.getPaginationInfo(), initiator: t, spineItem: n, elementId: r });
                    }, 60);
            }
            function g(e, t) {
                var n = new a(I, t);
                return n.openItem(e), U.leftItem != n.leftItem || U.rightItem != n.rightItem || U.centerItem != n.centerItem;
            }
            function m() {
                if (!L || !F) return !1;
                var e = R.width(),
                    t = R.height();
                return e && t;
            }
            function v(t) {
                if ((z(0, !1), m())) {
                    var n = R.width(),
                        r = R.height(),
                        i = O.isDisplaying() ? c.Margins.fromElement(O.element()) : c.Margins.empty(),
                        o = A.isDisplaying() ? c.Margins.fromElement(A.element()) : c.Margins.empty(),
                        a = D.isDisplaying() ? c.Margins.fromElement(D.element()) : c.Margins.empty(),
                        s = b(i, o, a),
                        l = { width: n - F.width(), height: r - F.height() },
                        u = { width: l.width - s.width(), height: l.height - s.height() };
                    if (!(l.width <= 0 || l.height <= 0)) {
                        var d = u.width / L.width,
                            f = u.height / L.height;
                        R.css("overflow", "auto");
                        var h;
                        "fit-width" == P.style ? (h = d) : "fit-height" == P.style ? (h = f) : "user" == P.style ? (h = P.scale) : ((h = Math.min(d, f)), R.css("overflow", "hidden")), (T = h);
                        var p = { width: L.width * h, height: L.height * h },
                            g = { width: p.width + s.width(), height: p.height + s.height() },
                            v = { width: g.width + F.width(), height: g.height + F.height() },
                            y = Math.floor((n - v.width) / 2),
                            _ = Math.floor((r - v.height) / 2);
                        y < 0 && (y = 0), _ < 0 && (_ = 0), C.css("left", y + "px"), C.css("top", _ + "px"), C.css("width", g.width + "px"), C.css("height", g.height + "px");
                        var w = F.padding.left,
                            x = F.padding.top,
                            E = t ? "transformContentImmediate" : "transformContent";
                        O.isDisplaying() && O[E](h, w, x),
                            A.isDisplaying() && ((w += L.separatorPosition * h), O.isDisplaying() && (w += i.left), A[E](h, w, x)),
                            D.isDisplaying() && D[E](h, w, x),
                            e.logEvent("FXL_VIEW_RESIZED", "EMIT", "fixed_view.js"),
                            S.emit(e.Events.FXL_VIEW_RESIZED);
                    }
                }
            }
            function b(e, t, n) {
                var r = {
                        left: Math.max(e.margin.left, t.margin.left, n.margin.left),
                        right: Math.max(e.margin.right, t.margin.right, n.margin.right),
                        top: Math.max(e.margin.top, t.margin.top, n.margin.top),
                        bottom: Math.max(e.margin.bottom, t.margin.bottom, n.margin.bottom),
                    },
                    i = {
                        left: Math.max(e.border.left, t.border.left, n.border.left),
                        right: Math.max(e.border.right, t.border.right, n.border.right),
                        top: Math.max(e.border.top, t.border.top, n.border.top),
                        bottom: Math.max(e.border.bottom, t.border.bottom, n.border.bottom),
                    },
                    o = {
                        left: Math.max(e.padding.left, t.padding.left, n.padding.left),
                        right: Math.max(e.padding.right, t.padding.right, n.padding.right),
                        top: Math.max(e.padding.top, t.padding.top, n.padding.top),
                        bottom: Math.max(e.padding.bottom, t.padding.bottom, n.padding.bottom),
                    };
                return new c.Margins(r, i, o);
            }
            function y() {
                (L = {}),
                    D.isDisplaying()
                        ? ((L.width = D.meta_width()), (L.height = D.meta_height()), (L.separatorPosition = 0))
                        : O.isDisplaying() && A.isDisplaying()
                        ? O.meta_height() == A.meta_height()
                            ? ((L.width = O.meta_width() + A.meta_width()), (L.height = O.meta_height()), (L.separatorPosition = O.meta_width()))
                            : ((L.width = O.meta_width() + A.meta_width() * (O.meta_height() / A.meta_height())), (L.height = O.meta_height()), (L.separatorPosition = O.meta_width()))
                        : O.isDisplaying()
                        ? ((L.width = 2 * O.meta_width()), (L.height = O.meta_height()), (L.separatorPosition = O.meta_width()))
                        : A.isDisplaying()
                        ? ((L.width = 2 * A.meta_width()), (L.height = A.meta_height()), (L.separatorPosition = A.meta_width()))
                        : (L = void 0);
            }
            function _() {
                F = c.Margins.fromElement(C);
            }
            function w(n, r, i) {
                var o = t.Deferred();
                return (
                    r
                        ? (n.remove(),
                          C.append(n.render().element()),
                          (i.isElementAdded = !0),
                          n.loadSpineItem(
                              r,
                              function (t, r, i, a, s) {
                                  t &&
                                      a &&
                                      ((n.meta_height() && n.meta_width()) || console.error("Invalid document " + i.href + ": viewport is not specified!"),
                                      e.logEvent("CONTENT_DOCUMENT_LOADED", "EMIT", "fixed_view.js [ " + i.href + " ]"),
                                      S.emit(e.Events.CONTENT_DOCUMENT_LOADED, r, i)),
                                      o.resolve();
                              },
                              i
                          ))
                        : (n.isDisplaying() && n.remove(), o.resolve()),
                    o.promise()
                );
            }
            function x() {
                var e = [];
                e = I.isLeftToRight() ? [O, D, A] : [A, D, O];
                for (var t = [], n = 0, r = e.length; n < r; n++) e[n].isDisplaying() && t.push(e[n]);
                return t;
            }
            function E(e, t) {
                for (var n = x(), r = 0, i = n.length; r < i; r++) {
                    var o = n[r];
                    if (o.currentSpineItem().idref == e) return t(o);
                }
                console.error("spine item is not loaded");
            }
            t.extend(this, new r());
            var C,
                T,
                S = this,
                R = n.$viewport,
                I = n.spine,
                k = n.userStyles,
                P = (n.bookStyles, n.zoom || { style: "default" }),
                N = (n.iframeLoader, void 0),
                O = u("fixed-page-frame-left"),
                A = u("fixed-page-frame-right"),
                D = u("fixed-page-frame-center"),
                M = [];
            M.push(O), M.push(A), M.push(D);
            var F,
                L,
                U = new a(I, !1),
                B = !1,
                j = !1;
            (this.isReflowable = function () {
                return !1;
            }),
                (this.setZoom = function (e) {
                    (P = e), v(!1);
                }),
                (this.render = function () {
                    var e = c.loadTemplate("fixed_book_frame", {});
                    return (C = t(e)), c.CSSTransition(C, "all 0 ease 0"), C.css("overflow", "hidden"), R.append(C), S.applyStyles(), this;
                }),
                (this.remove = function () {
                    C.remove();
                }),
                (this.setViewSettings = function (e) {
                    (N = e), U.setSyntheticSpread(1 == c.deduceSyntheticSpread(R, d(), N));
                    for (var t = x(), n = 0, r = t.length; n < r; n++) t[n].setViewSettings(e);
                });
            var z = function (e, t) {
                O && O.updatePageSwitchDir(e, t), A && A.updatePageSwitchDir(e, t), D && D.updatePageSwitchDir(e, t);
            };
            (this.applyStyles = function () {
                c.setStyles(k.getStyles(), C.parent()), _(), y(), v();
            }),
                (this.applyBookStyles = function () {
                    for (var e = x(), t = 0, n = e.length; t < n; t++) e[t].applyBookStyles();
                }),
                (this.onViewportResize = function () {
                    var e = d();
                    if (e) {
                        var t = 1 == c.deduceSyntheticSpread(R, e, N);
                        if (g(e, t)) {
                            U.setSyntheticSpread(t);
                            var n = new l(e, S);
                            S.openPage(n);
                        } else v(!0);
                    }
                }),
                (this.getViewScale = function () {
                    return T;
                }),
                (this.openPage = function (e, t) {
                    if (e.spineItem) {
                        var n = U.leftItem,
                            r = U.rightItem,
                            i = U.centerItem,
                            o = 1 == c.deduceSyntheticSpread(R, e.spineItem, N);
                        U.setSyntheticSpread(o), U.openItem(e.spineItem);
                        var a = n !== U.leftItem || r !== U.rightItem || i !== U.centerItem;
                        (null !== t && "undefined" != typeof t) || (t = 0), z(0 === t ? 0 : U.spine.isRightToLeft() ? (1 === t ? 2 : 1) : t, a), f(e.initiator, e);
                    }
                }),
                (this.openPagePrev = function (e) {
                    U.openPrev(), z(U.spine.isRightToLeft() ? 2 : 1, !0), f(e, void 0);
                }),
                (this.openPageNext = function (e) {
                    U.openNext(), z(U.spine.isRightToLeft() ? 1 : 2, !0), f(e, void 0);
                }),
                (this.getPaginationInfo = function () {
                    for (var e = new o(I, !0), t = [U.leftItem, U.rightItem, U.centerItem], n = 0; n < t.length; n++) {
                        var r = t[n];
                        r && e.addOpenPage(0, 1, r.idref, r.index);
                    }
                    return e;
                }),
                (this.bookmarkCurrentPage = function () {
                    var e = x();
                    if (e.length > 0) return e[0].getFirstVisibleCfi();
                }),
                (this.getLoadedSpineItems = function () {
                    return U.validItems();
                }),
                (this.getElement = function (e, t) {
                    return E(e, function (n) {
                        return n.getElement(e, t);
                    });
                }),
                (this.getElementById = function (e, t) {
                    return E(e, function (n) {
                        return n.getElementById(e, t);
                    });
                }),
                (this.getElementByCfi = function (e, t, n, r, i) {
                    return E(e, function (o) {
                        return o.getElementByCfi(e, t, n, r, i);
                    });
                }),
                (this.getFirstVisibleMediaOverlayElement = function () {
                    for (var e = x(), t = 0, n = e.length; t < n; t++) {
                        var r = e[t].getFirstVisibleMediaOverlayElement();
                        if (r) return r;
                    }
                }),
                (this.insureElementVisibility = function (e, t, n) {}),
                (this.getElements = function (e, t) {
                    return E(e, function (n) {
                        return n.getElements(e, t);
                    });
                }),
                (this.isElementVisible = function (e) {
                    return !0;
                }),
                (this.getVisibleElementsWithFilter = function (e, t) {
                    for (var n = [], r = x(), i = 0, o = r.length; i < o; i++) n.push(r[i].getAllElementsWithFilter(e, t));
                    return n;
                }),
                (this.getVisibleElements = function (e, t) {
                    for (var n = [], r = x(), i = 0, o = r.length; i < o; i++)
                        t ? n.push({ elements: r[i].getElements(r[i].currentSpineItem().idref, e), spineItem: r[i].currentSpineItem() }) : n.push(r[i].getElements(r[i].currentSpineItem().idref, e));
                    return n;
                }),
                (this.isElementVisible = function (e) {
                    return !0;
                }),
                (this.isVisibleSpineItemElementCfi = function (e, t) {
                    return E(e, function (e) {
                        return !0;
                    });
                }),
                (this.getNodeRangeInfoFromCfi = function (e, t) {
                    return E(e, function (n) {
                        return n.getNodeRangeInfoFromCfi(e, t);
                    });
                }),
                (this.getFirstVisibleCfi = function () {
                    var e = x();
                    if (e.length > 0) return e[0].getFirstVisibleCfi();
                }),
                (this.getLastVisibleCfi = function () {
                    var e = x();
                    if (e.length > 0) return e[e.length - 1].getLastVisibleCfi();
                }),
                (this.getDomRangesFromRangeCfi = function (e, t, n) {
                    var r = x();
                    if (t && e.idref !== t.idref) {
                        for (var i = [], o = 0, a = r.length; o < a; o++) {
                            var s = r[o];
                            if (s.currentSpineItem().idref === e.idref) {
                                var l = s.getLastVisibleCfi();
                                i.push(s.getDomRangeFromRangeCfi(e.contentCFI, l.contentCFI, n));
                            } else if (s.currentSpineItem().idref === t.idref) {
                                var c = s.getFirstVisibleCfi();
                                i.push(s.getDomRangeFromRangeCfi(c.contentCFI, t.contentCFI, n));
                            }
                        }
                        return i;
                    }
                    return [this.getDomRangeFromRangeCfi(e, t, n)];
                }),
                (this.getDomRangeFromRangeCfi = function (e, t, n) {
                    var r = x();
                    if (t && e.idref !== t.idref) return void console.error("getDomRangeFromRangeCfi: both CFIs must be scoped under the same spineitem idref");
                    for (var i = 0, o = r.length; i < o; i++) {
                        var a = r[i];
                        if (a.currentSpineItem().idref === e.idref) return a.getDomRangeFromRangeCfi(e.contentCFI, t ? t.contentCFI : null, n);
                    }
                }),
                (this.getRangeCfiFromDomRange = function (e) {
                    for (var t = x(), n = 0, r = t.length; n < r; n++) {
                        var i = t[n];
                        if (i.getLoadedContentFrames()[0].$iframe[0].contentDocument === e.startContainer.ownerDocument) return i.getRangeCfiFromDomRange(e);
                    }
                }),
                (this.getVisibleCfiFromPoint = function (e, t, n, r) {
                    if (!r) throw new Error("getVisibleCfiFromPoint: Spine item idref must be specified for this fixed layout view.");
                    return E(r, function (r) {
                        return r.getVisibleCfiFromPoint(e, t, n);
                    });
                }),
                (this.getRangeCfiFromPoints = function (e, t, n, r, i) {
                    if (!i) throw new Error("getRangeCfiFromPoints: Spine item idref must be specified for this fixed layout view.");
                    return E(i, function (i) {
                        return i.getRangeCfiFromPoints(e, t, n, r);
                    });
                }),
                (this.getCfiForElement = function (e) {
                    for (var t = x(), n = 0, r = t.length; n < r; n++) {
                        var i = t[n];
                        if (i.getLoadedContentFrames()[0].$iframe[0].contentDocument === e.ownerDocument) return i.getCfiForElement(e);
                    }
                }),
                (this.getElementFromPoint = function (e, t, n) {
                    if (!n) throw new Error("getElementFromPoint: Spine item idref must be specified for this fixed layout view.");
                    return E(n, function (n) {
                        return n.getElementFromPoint(e, t);
                    });
                });
        };
        return u;
    }),
    define("readium_shared_js/views/iframe_loader", ["jquery", "underscore"], function (e, t) {
        var n = function () {
            var n = this,
                r = {};
            (this.addIFrameEventListener = function (e, t, n) {
                void 0 == r[e] && (r[e] = []), r[e].push({ callback: t, context: n });
            }),
                (this.updateIframeEvents = function (n) {
                    t.each(r, function (t, r) {
                        e(n.contentWindow).off(r);
                        for (var i = 0, o = t.length; i < o; i++) e(n.contentWindow).on(r, t[i].callback, t[i].context);
                    });
                }),
                (this.loadIframe = function (e, t, r, i, o) {
                    e.baseURI || ("undefined" != typeof location && (e.baseURI = location.href + ""), console.error("!iframe.baseURI => " + e.baseURI)),
                        console.log("EPUB doc iframe src:"),
                        console.log(t),
                        console.log("EPUB doc iframe base URI:"),
                        console.log(e.baseURI),
                        e.setAttribute("data-baseUri", e.baseURI),
                        e.setAttribute("data-src", t);
                    var a = new URI(t).absoluteTo(e.baseURI).search("").hash("").toString();
                    n._loadIframeWithUri(e, o, a, function () {
                        r.call(i, !0, o);
                    });
                }),
                (this._loadIframeWithUri = function (r, i, o, a) {
                    (r.onload = function () {
                        var i = r.contentDocument || r.contentWindow.document;
                        e("svg", i).on("load", function () {
                            console.log("SVG loaded");
                        }),
                            n.updateIframeEvents(r);
                        var o = r.contentWindow.MathJax;
                        if (o) {
                            console.log("MathJax VERSION: " + o.cdnVersion + " // " + o.fileversion + " // " + o.version);
                            var s = !0;
                            o.Hub.Browser.isFirefox && (s = !1),
                                o.Hub.Browser.isChrome && (s = !1),
                                window.navigator.userAgent.indexOf("Edge") > 0 && (s = !1),
                                o.Hub.Config({ showMathMenu: !1, messageStyle: "none", showProcessingMessages: !0, SVG: { useFontCache: s } });
                            var l = t.once(a);
                            try {
                                o.Hub.Queue(l);
                            } catch (e) {
                                console.error("MathJax fail!"), a();
                            }
                        } else a();
                    }),
                        r.setAttribute("src", o);
                });
        };
        return n;
    }),
    define("readium_shared_js/views/internal_links_support", ["jquery", "../helpers", "readium_cfi_js"], function (e, t, n) {
        var r = function (n) {
            function r(e) {
                var t = e.indexOf("("),
                    n = e.indexOf("!"),
                    r = e.indexOf(")");
                if (n != -1) return r == -1 && (r = e.length), { spineItemCfi: e.substring(t + 1, n), elementCfi: e.substring(n + 1, r) };
            }
            function i(e, t) {
                var r = n.package().resolveRelativeUrl(t.href),
                    i = e.absoluteTo(r);
                return i;
            }
            function o(e, o) {
                var s = i(e, o);
                if (!s) return void console.error("Unable to resolve " + e.href());
                var l = e.fragment(),
                    u = s.toString();
                (u = t.RemoveFromString(u, "#" + l)),
                    a(u, function (e) {
                        if (e) {
                            var t = new window.DOMParser(),
                                i = t.parseFromString(e, "text/xml"),
                                o = r(l);
                            if (!o) return void console.warn("Unable to split cfi:" + l);
                            var a = EPUBcfi.Interpreter.getContentDocHref("epubcfi(" + o.spineItemCfi + ")", i);
                            if (a) {
                                var s = n.spine().getItemByHref(a);
                                s ? n.openSpineItemElementCfi(s.idref, o.elementCfi, c) : console.warn("Unable to find spineItem with href=" + a);
                            } else console.warn("Unable to find document ref from " + l + " cfi");
                        }
                    });
            }
            function a(t, n) {
                e.ajax({
                    isLocal: 0 !== t.indexOf("http"),
                    url: t,
                    dataType: "text",
                    async: !0,
                    success: function (e) {
                        n(e);
                    },
                    error: function (e, r, i) {
                        console.error("Error when AJAX fetching " + t), console.error(r), console.error(i), n();
                    },
                });
            }
            function s(e) {
                var n = e.filename();
                return n && t.EndsWith(n, ".opf");
            }
            function l(e, t) {
                var r,
                    i = e.filename();
                if (i) {
                    var o = new URI(e, t.href),
                        a = decodeURIComponent(o.pathname()),
                        s = n.spine().getItemByHref(a);
                    if (!s) return void console.error("spine item with href=" + a + " not found");
                    r = s.idref;
                } else r = t.idref;
                var l = e.fragment();
                n.openSpineItemElementId(r, l, c);
            }
            var c = this;
            this.processLinkElements = function (t, n) {
                var r = t[0].contentDocument;
                e("a", r).click(function (t) {
                    var r;
                    r = t.currentTarget.attributes["xlink:href"] ? t.currentTarget.attributes["xlink:href"].value : t.currentTarget.attributes.href.value;
                    var i = !1,
                        a = new URI(r),
                        c = a.is("relative");
                    return c ? (s(a) ? (o(a, n), (i = !0)) : (l(a, n), (i = !0)), void (i && (t.preventDefault(), t.stopPropagation()))) : (e(document).trigger("externalLinkClicked", r), !1);
                });
            };
        };
        return r;
    }),
    define("readium_shared_js/models/smil_iterator", ["jquery", "../helpers"], function (e, t) {
        var n = function (n) {
            function r(e, t, n) {
                for (var i = e, o = t.children.length; i >= 0 && i < o; i += n ? -1 : 1) {
                    var a = t.children[i];
                    if ("par" == a.nodeType) return a;
                    if ((a = r(n ? a.children.length - 1 : 0, a, n))) return a;
                }
                if (t.parent) return r(t.index + (n ? -1 : 1), t.parent, n);
            }
            (this.smil = n),
                (this.currentPar = void 0),
                (this.reset = function () {
                    this.currentPar = r(0, this.smil, !1);
                }),
                (this.findTextId = function (n) {
                    if (!this.currentPar) return void console.debug("Par iterator is out of range");
                    if (!n) return !1;
                    for (; this.currentPar; ) {
                        if (this.currentPar.element) {
                            if (n === this.currentPar.text.srcFragmentId) return !0;
                            for (var r = this.currentPar.element.parentNode; r; ) {
                                if (r.id && r.id == n) return !0;
                                r = r.parentNode;
                            }
                            var i = e("#" + t.escapeJQuerySelector(n), this.currentPar.element);
                            if (i && i.length && i[0]) return !0;
                        }
                        this.next();
                    }
                    return !1;
                }),
                (this.next = function () {
                    return this.currentPar ? void (this.currentPar = r(this.currentPar.index + 1, this.currentPar.parent, !1)) : void console.debug("Par iterator is out of range");
                }),
                (this.previous = function () {
                    return this.currentPar ? void (this.currentPar = r(this.currentPar.index - 1, this.currentPar.parent, !0)) : void console.debug("Par iterator is out of range");
                }),
                (this.isLast = function () {
                    return this.currentPar ? !r(this.currentPar.index + 1, this.currentPar.parent, !1) : void console.debug("Par iterator is out of range");
                }),
                (this.goToPar = function (e) {
                    for (; this.currentPar && this.currentPar != e; ) this.next();
                }),
                this.reset();
        };
        return n;
    }),
    define("domReady", [], function () {
        "use strict";
        function e(e) {
            var t;
            for (t = 0; t < e.length; t += 1) e[t](c);
        }
        function t() {
            var t = u;
            l && t.length && ((u = []), e(t));
        }
        function n() {
            l || ((l = !0), a && clearInterval(a), t());
        }
        function r(e) {
            return l ? e(c) : u.push(e), r;
        }
        var i,
            o,
            a,
            s = "undefined" != typeof window && window.document,
            l = !s,
            c = s ? document : null,
            u = [];
        if (s) {
            if (document.addEventListener) document.addEventListener("DOMContentLoaded", n, !1), window.addEventListener("load", n, !1);
            else if (window.attachEvent) {
                window.attachEvent("onload", n), (o = document.createElement("div"));
                try {
                    i = null === window.frameElement;
                } catch (e) {}
                o.doScroll &&
                    i &&
                    window.external &&
                    (a = setInterval(function () {
                        try {
                            o.doScroll(), n();
                        } catch (e) {}
                    }, 30));
            }
            "complete" === document.readyState && n();
        }
        return (
            (r.version = "2.0.1"),
            (r.load = function (e, t, n, i) {
                i.isBuild ? n(null) : r(n);
            }),
            r
        );
    }),
    (function (e) {
        function t(e, t) {
            var n = typeof e[t];
            return n == y || !(n != b || !e[t]) || "unknown" == n;
        }
        function n(e, t) {
            return !(typeof e[t] != b || !e[t]);
        }
        function r(e, t) {
            return typeof e[t] != _;
        }
        function i(e) {
            return function (t, n) {
                for (var r = n.length; r--; ) if (!e(t, n[r])) return !1;
                return !0;
            };
        }
        function o(e) {
            return e && T(e, C) && R(e, E);
        }
        function a(e) {
            return n(e, "body") ? e.body : e.getElementsByTagName("body")[0];
        }
        function s(e) {
            n(window, "console") && t(window.console, "log") && window.console.log(e);
        }
        function l(e, t) {
            t ? window.alert(e) : s(e);
        }
        function c(e) {
            (k.initialized = !0), (k.supported = !1), l("Rangy is not supported on this page in your browser. Reason: " + e, k.config.alertOnFail);
        }
        function u(e) {
            l("Rangy warning: " + e, k.config.alertOnWarn);
        }
        function d(e) {
            return e.message || e.description || String(e);
        }
        function f() {
            if (!k.initialized) {
                var e,
                    n = !1,
                    r = !1;
                t(document, "createRange") && ((e = document.createRange()), T(e, x) && R(e, w) && (n = !0), e.detach());
                var i = a(document);
                if (!i || "body" != i.nodeName.toLowerCase()) return void c("No body element found");
                if ((i && t(i, "createTextRange") && ((e = i.createTextRange()), o(e) && (r = !0)), !n && !r)) return void c("Neither Range nor TextRange are available");
                (k.initialized = !0), (k.features = { implementsDomRange: n, implementsTextRange: r });
                var l, u;
                for (var f in I) (l = I[f]) instanceof p && l.init(l, k);
                for (var h = 0, g = N.length; h < g; ++h)
                    try {
                        N[h](k);
                    } catch (e) {
                        (u = "Rangy init listener threw an exception. Continuing. Detail: " + d(e)), s(u);
                    }
            }
        }
        function h(e) {
            (e = e || window), f();
            for (var t = 0, n = O.length; t < n; ++t) O[t](e);
        }
        function p(e, t, n) {
            (this.name = e), (this.dependencies = t), (this.initialized = !1), (this.supported = !1), (this.initializer = n);
        }
        function g(e, t, n, r) {
            var i = new p(t, n, function (e) {
                if (!e.initialized) {
                    e.initialized = !0;
                    try {
                        r(k, e), (e.supported = !0);
                    } catch (e) {
                        var n = "Module '" + t + "' failed to load: " + d(e);
                        s(n);
                    }
                }
            });
            I[t] = i;
        }
        function m() {}
        function v() {}
        var b = ("function" == typeof e.define && e.define.amd, "object"),
            y = "function",
            _ = "undefined",
            w = ["startContainer", "startOffset", "endContainer", "endOffset", "collapsed", "commonAncestorContainer"],
            x = [
                "setStart",
                "setStartBefore",
                "setStartAfter",
                "setEnd",
                "setEndBefore",
                "setEndAfter",
                "collapse",
                "selectNode",
                "selectNodeContents",
                "compareBoundaryPoints",
                "deleteContents",
                "extractContents",
                "cloneContents",
                "insertNode",
                "surroundContents",
                "cloneRange",
                "toString",
                "detach",
            ],
            E = ["boundingHeight", "boundingLeft", "boundingTop", "boundingWidth", "htmlText", "text"],
            C = ["collapse", "compareEndPoints", "duplicate", "moveToElementText", "parentElement", "select", "setEndPoint", "getBoundingClientRect"],
            T = i(t),
            S = i(n),
            R = i(r),
            I = {},
            k = {
                version: "1.3alpha.804",
                initialized: !1,
                supported: !0,
                util: { isHostMethod: t, isHostObject: n, isHostProperty: r, areHostMethods: T, areHostObjects: S, areHostProperties: R, isTextRange: o, getBody: a },
                features: {},
                modules: I,
                config: { alertOnFail: !0, alertOnWarn: !1, preferTextRange: !1 },
            };
        (k.fail = c),
            (k.warn = u),
            {}.hasOwnProperty
                ? (k.util.extend = function (e, t, n) {
                      var r, i;
                      for (var o in t) t.hasOwnProperty(o) && ((r = e[o]), (i = t[o]), n && null !== r && "object" == typeof r && null !== i && "object" == typeof i && k.util.extend(r, i, !0), (e[o] = i));
                      return e;
                  })
                : c("hasOwnProperty not supported"),
            (function () {
                var e = document.createElementNS("http://www.w3.org/1999/xhtml", "div");
                e.appendChild(document.createElementNS("http://www.w3.org/1999/xhtml", "span"));
                var t,
                    n = [].slice;
                try {
                    1 == n.call(e.childNodes, 0)[0].nodeType &&
                        (t = function (e) {
                            return n.call(e, 0);
                        });
                } catch (e) {}
                t ||
                    (t = function (e) {
                        for (var t = [], n = 0, r = e.length; n < r; ++n) t[n] = e[n];
                        return t;
                    }),
                    (k.util.toArray = t);
            })();
        var P;
        t(document, "addEventListener")
            ? (P = function (e, t, n) {
                  e.addEventListener(t, n, !1);
              })
            : t(document, "attachEvent")
            ? (P = function (e, t, n) {
                  e.attachEvent("on" + t, n);
              })
            : c("Document does not have required addEventListener or attachEvent method"),
            (k.util.addListener = P);
        var N = [];
        (k.init = f),
            (k.addInitListener = function (e) {
                k.initialized ? e(k) : N.push(e);
            });
        var O = [];
        (k.addCreateMissingNativeApiListener = function (e) {
            O.push(e);
        }),
            (k.createMissingNativeApi = h),
            (p.prototype = {
                init: function (e) {
                    for (var t, n, r = this.dependencies || [], i = 0, o = r.length; i < o; ++i) {
                        if (((n = r[i]), (t = I[n]), !(t && t instanceof p))) throw new Error("required module '" + n + "' not found");
                        if ((t.init(), !t.supported)) throw new Error("required module '" + n + "' not supported");
                    }
                    this.initializer(this);
                },
                fail: function (e) {
                    throw ((this.initialized = !0), (this.supported = !1), new Error("Module '" + this.name + "' failed to load: " + e));
                },
                warn: function (e) {
                    k.warn("Module " + this.name + ": " + e);
                },
                deprecationNotice: function (e, t) {
                    k.warn("DEPRECATED: " + e + " in module " + this.name + "is deprecated. Please use " + t + " instead");
                },
                createError: function (e) {
                    return new Error("Error in Rangy " + this.name + " module: " + e);
                },
            }),
            (k.createModule = function (e) {
                var t, n;
                2 == arguments.length ? ((t = arguments[1]), (n = [])) : ((t = arguments[2]), (n = arguments[1])), g(!1, e, n, t);
            }),
            (k.createCoreModule = function (e, t, n) {
                g(!0, e, t, n);
            }),
            (k.RangePrototype = m),
            (k.rangePrototype = new m()),
            (k.selectionPrototype = new v());
        var A = !1,
            D = function (e) {
                A || ((A = !0), k.initialized || f());
            };
        return typeof window == _
            ? void c("No window found")
            : typeof document == _
            ? void c("No document found")
            : (t(document, "addEventListener") && document.addEventListener("DOMContentLoaded", D, !1), P(window, "load", D), void (e.rangy = k));
    })(this),
    rangy.createCoreModule("DomUtil", [], function (e, t) {
        function n(e) {
            var t;
            return typeof e.namespaceURI == k || null === (t = e.namespaceURI) || "http://www.w3.org/1999/xhtml" == t;
        }
        function r(e) {
            var t = e.parentNode;
            return 1 == t.nodeType ? t : null;
        }
        function i(e) {
            for (var t = 0; (e = e.previousSibling); ) ++t;
            return t;
        }
        function o(e) {
            switch (e.nodeType) {
                case 7:
                case 10:
                    return 0;
                case 3:
                case 8:
                    return e.length;
                default:
                    return e.childNodes.length;
            }
        }
        function a(e, t) {
            var n,
                r = [];
            for (n = e; n; n = n.parentNode) r.push(n);
            for (n = t; n; n = n.parentNode) if (A(r, n)) return n;
            return null;
        }
        function s(e, t, n) {
            for (var r = n ? t : t.parentNode; r; ) {
                if (r === e) return !0;
                r = r.parentNode;
            }
            return !1;
        }
        function l(e, t) {
            return s(e, t, !0);
        }
        function c(e, t, n) {
            for (var r, i = n ? e : e.parentNode; i; ) {
                if (((r = i.parentNode), r === t)) return i;
                i = r;
            }
            return null;
        }
        function u(e) {
            var t = e.nodeType;
            return 3 == t || 4 == t || 8 == t;
        }
        function d(e) {
            if (!e) return !1;
            var t = e.nodeType;
            return 3 == t || 8 == t;
        }
        function f(e, t) {
            var n = t.nextSibling,
                r = t.parentNode;
            return n ? r.insertBefore(e, n) : r.appendChild(e), e;
        }
        function h(e, t, n) {
            var r = e.cloneNode(!1);
            if ((r.deleteData(0, t), e.deleteData(t, e.length - t), f(r, e), n)) for (var o, a = 0; (o = n[a++]); ) o.node == e && o.offset > t ? ((o.node = r), (o.offset -= t)) : o.node == e.parentNode && o.offset > i(e) && ++o.offset;
            return r;
        }
        function p(e) {
            if (9 == e.nodeType) return e;
            if (typeof e.ownerDocument != k) return e.ownerDocument;
            if (typeof e.document != k) return e.document;
            if (e.parentNode) return p(e.parentNode);
            throw t.createError("getDocument: no document found for node");
        }
        function g(e) {
            var n = p(e);
            if (typeof n.defaultView != k) return n.defaultView;
            if (typeof n.parentWindow != k) return n.parentWindow;
            throw t.createError("Cannot get a window object for node");
        }
        function m(e) {
            if (typeof e.contentDocument != k) return e.contentDocument;
            if (typeof e.contentWindow != k) return e.contentWindow.document;
            throw t.createError("getIframeDocument: No Document object found for iframe element");
        }
        function v(e) {
            if (typeof e.contentWindow != k) return e.contentWindow;
            if (typeof e.contentDocument != k) return e.contentDocument.defaultView;
            throw t.createError("getIframeWindow: No Window object found for iframe element");
        }
        function b(e) {
            return e && P.isHostMethod(e, "setTimeout") && P.isHostObject(e, "document");
        }
        function y(e, t, n) {
            var r;
            if ((e ? (P.isHostProperty(e, "nodeType") ? (r = 1 == e.nodeType && "iframe" == e.tagName.toLowerCase() ? m(e) : p(e)) : b(e) && (r = e.document)) : (r = document), !r))
                throw t.createError(n + "(): Parameter must be a Window object or DOM node");
            return r;
        }
        function _(e) {
            for (var t; (t = e.parentNode); ) e = t;
            return e;
        }
        function w(e, n, r, o) {
            var s, l, u, d, f;
            if (e == r) return n === o ? 0 : n < o ? -1 : 1;
            if ((s = c(r, e, !0))) return n <= i(s) ? -1 : 1;
            if ((s = c(e, r, !0))) return i(s) < o ? -1 : 1;
            if (((l = a(e, r)), !l)) throw new Error("comparePoints error: nodes have no common ancestor");
            if (((u = e === l ? l : c(e, l, !0)), (d = r === l ? l : c(r, l, !0)), u === d)) throw t.createError("comparePoints got to case 4 and childA and childB are the same!");
            for (f = l.firstChild; f; ) {
                if (f === u) return -1;
                if (f === d) return 1;
                f = f.nextSibling;
            }
        }
        function x(e) {
            try {
                return e.parentNode, !1;
            } catch (e) {
                return !0;
            }
        }
        function E(e) {
            if (!e) return "[No node]";
            if (D && x(e)) return "[Broken node]";
            if (u(e)) return '"' + e.data + '"';
            if (1 == e.nodeType) {
                var t = e.id ? ' id="' + e.id + '"' : "";
                return "<" + e.nodeName + t + ">[" + i(e) + "][" + e.childNodes.length + "][" + (e.innerHTML || "[innerHTML not supported]").slice(0, 25) + "]";
            }
            return e.nodeName;
        }
        function C(e) {
            for (var t, n = p(e).createDocumentFragment(); (t = e.firstChild); ) n.appendChild(t);
            return n;
        }
        function T(e) {
            (this.root = e), (this._next = e);
        }
        function S(e) {
            return new T(e);
        }
        function R(e, t) {
            (this.node = e), (this.offset = t);
        }
        function I(e) {
            (this.code = this[e]), (this.codeName = e), (this.message = "DOMException: " + this.codeName);
        }
        var k = "undefined",
            P = e.util;
        P.areHostMethods(document, ["createDocumentFragment", "createElement", "createTextNode"]) || t.fail("document missing a Node creation method"),
            P.isHostMethod(document, "getElementsByTagName") || t.fail("document missing getElementsByTagName method");
        var N = document.createElementNS("http://www.w3.org/1999/xhtml", "div");
        P.areHostMethods(N, ["insertBefore", "appendChild", "cloneNode"] || !P.areHostObjects(N, ["previousSibling", "nextSibling", "childNodes", "parentNode"])) || t.fail("Incomplete Element implementation"),
            P.isHostProperty(N, "innerHTML") || t.fail("Element is missing innerHTML property");
        var O = document.createTextNode("test");
        P.areHostMethods(O, ["splitText", "deleteData", "insertData", "appendData", "cloneNode"] || !P.areHostObjects(N, ["previousSibling", "nextSibling", "childNodes", "parentNode"]) || !P.areHostProperties(O, ["data"])) ||
            t.fail("Incomplete Text Node implementation");
        var A = function (e, t) {
                for (var n = e.length; n--; ) if (e[n] === t) return !0;
                return !1;
            },
            D = !1;
        !(function () {
            var t = document.createElementNS("http://www.w3.org/1999/xhtml", "b");
            t.innerHTML = "1";
            var n = t.firstChild;
            (t.innerHTML = "<br>"), (D = x(n)), (e.features.crashyTextNodes = D);
        })();
        var M;
        typeof window.getComputedStyle != k
            ? (M = function (e, t) {
                  return g(e).getComputedStyle(e, null)[t];
              })
            : typeof document.documentElement.currentStyle != k
            ? (M = function (e, t) {
                  return e.currentStyle[t];
              })
            : t.fail("No means of obtaining computed style properties found"),
            (T.prototype = {
                _current: null,
                hasNext: function () {
                    return !!this._next;
                },
                next: function () {
                    var e,
                        t,
                        n = (this._current = this._next);
                    if (this._current)
                        if ((e = n.firstChild)) this._next = e;
                        else {
                            for (t = null; n !== this.root && !(t = n.nextSibling); ) n = n.parentNode;
                            this._next = t;
                        }
                    return this._current;
                },
                detach: function () {
                    this._current = this._next = this.root = null;
                },
            }),
            (R.prototype = {
                equals: function (e) {
                    return !!e && this.node === e.node && this.offset == e.offset;
                },
                inspect: function () {
                    return "[DomPosition(" + E(this.node) + ":" + this.offset + ")]";
                },
                toString: function () {
                    return this.inspect();
                },
            }),
            (I.prototype = { INDEX_SIZE_ERR: 1, HIERARCHY_REQUEST_ERR: 3, WRONG_DOCUMENT_ERR: 4, NO_MODIFICATION_ALLOWED_ERR: 7, NOT_FOUND_ERR: 8, NOT_SUPPORTED_ERR: 9, INVALID_STATE_ERR: 11 }),
            (I.prototype.toString = function () {
                return this.message;
            }),
            (e.dom = {
                arrayContains: A,
                isHtmlNamespace: n,
                parentElement: r,
                getNodeIndex: i,
                getNodeLength: o,
                getCommonAncestor: a,
                isAncestorOf: s,
                isOrIsAncestorOf: l,
                getClosestAncestorIn: c,
                isCharacterDataNode: u,
                isTextOrCommentNode: d,
                insertAfter: f,
                splitDataNode: h,
                getDocument: p,
                getWindow: g,
                getIframeWindow: v,
                getIframeDocument: m,
                getBody: P.getBody,
                isWindow: b,
                getContentDocument: y,
                getRootContainer: _,
                comparePoints: w,
                isBrokenNode: x,
                inspectNode: E,
                getComputedStyleProperty: M,
                fragmentFromNodeChildren: C,
                createIterator: S,
                DomPosition: R,
            }),
            (e.DOMException = I);
    }),
    rangy.createCoreModule("DomRange", ["DomUtil"], function (e, t) {
        function n(e, t) {
            return 3 != e.nodeType && (H(e, t.startContainer) || H(e, t.endContainer));
        }
        function r(e) {
            return e.document || $(e.startContainer);
        }
        function i(e) {
            return new B(e.parentNode, V(e));
        }
        function o(e) {
            return new B(e.parentNode, V(e) + 1);
        }
        function a(e, t, n) {
            var r = 11 == e.nodeType ? e.firstChild : e;
            return z(t) ? (n == t.length ? L.insertAfter(e, t) : t.parentNode.insertBefore(e, 0 == n ? t : q(t, n))) : n >= t.childNodes.length ? t.appendChild(e) : t.insertBefore(e, t.childNodes[n]), r;
        }
        function s(e, t, n) {
            if ((R(e), R(t), r(t) != r(e))) throw new j("WRONG_DOCUMENT_ERR");
            var i = W(e.startContainer, e.startOffset, t.endContainer, t.endOffset),
                o = W(e.endContainer, e.endOffset, t.startContainer, t.startOffset);
            return n ? i <= 0 && o >= 0 : i < 0 && o > 0;
        }
        function l(e) {
            for (var t, n, i, o = r(e.range).createDocumentFragment(); (n = e.next()); ) {
                if (((t = e.isPartiallySelectedSubtree()), (n = n.cloneNode(!t)), t && ((i = e.getSubtreeIterator()), n.appendChild(l(i)), i.detach(!0)), 10 == n.nodeType)) throw new j("HIERARCHY_REQUEST_ERR");
                o.appendChild(n);
            }
            return o;
        }
        function c(e, t, n) {
            var r, i;
            n = n || { stop: !1 };
            for (var o, a; (o = e.next()); )
                if (e.isPartiallySelectedSubtree()) {
                    if (t(o) === !1) return void (n.stop = !0);
                    if (((a = e.getSubtreeIterator()), c(a, t, n), a.detach(!0), n.stop)) return;
                } else for (r = L.createIterator(o); (i = r.next()); ) if (t(i) === !1) return void (n.stop = !0);
        }
        function u(e) {
            for (var t; e.next(); ) e.isPartiallySelectedSubtree() ? ((t = e.getSubtreeIterator()), u(t), t.detach(!0)) : e.remove();
        }
        function d(e) {
            for (var t, n, i = r(e.range).createDocumentFragment(); (t = e.next()); ) {
                if ((e.isPartiallySelectedSubtree() ? ((t = t.cloneNode(!1)), (n = e.getSubtreeIterator()), t.appendChild(d(n)), n.detach(!0)) : e.remove(), 10 == t.nodeType)) throw new j("HIERARCHY_REQUEST_ERR");
                i.appendChild(t);
            }
            return i;
        }
        function f(e, t, n) {
            var r,
                i = !(!t || !t.length),
                o = !!n;
            i && (r = new RegExp("^(" + t.join("|") + ")$"));
            var a = [];
            return (
                c(new p(e, !1), function (t) {
                    if ((!i || r.test(t.nodeType)) && (!o || n(t))) {
                        var s = e.startContainer;
                        if (t != s || !z(s) || e.startOffset != s.length) {
                            var l = e.endContainer;
                            (t == l && z(l) && 0 == e.endOffset) || a.push(t);
                        }
                    }
                }),
                a
            );
        }
        function h(e) {
            var t = "undefined" == typeof e.getName ? "Range" : e.getName();
            return "[" + t + "(" + L.inspectNode(e.startContainer) + ":" + e.startOffset + ", " + L.inspectNode(e.endContainer) + ":" + e.endOffset + ")]";
        }
        function p(e, t) {
            if (((this.range = e), (this.clonePartiallySelectedTextNodes = t), !e.collapsed)) {
                (this.sc = e.startContainer), (this.so = e.startOffset), (this.ec = e.endContainer), (this.eo = e.endOffset);
                var n = e.commonAncestorContainer;
                this.sc === this.ec && z(this.sc)
                    ? ((this.isSingleCharacterDataNode = !0), (this._first = this._last = this._next = this.sc))
                    : ((this._first = this._next = this.sc !== n || z(this.sc) ? G(this.sc, n, !0) : this.sc.childNodes[this.so]), (this._last = this.ec !== n || z(this.ec) ? G(this.ec, n, !0) : this.ec.childNodes[this.eo - 1]));
            }
        }
        function g(e) {
            (this.code = this[e]), (this.codeName = e), (this.message = "RangeException: " + this.codeName);
        }
        function m(e) {
            return function (t, n) {
                for (var r, i = n ? t : t.parentNode; i; ) {
                    if (((r = i.nodeType), K(e, r))) return i;
                    i = i.parentNode;
                }
                return null;
            };
        }
        function v(e, t) {
            if (oe(e, t)) throw new g("INVALID_NODE_TYPE_ERR");
        }
        function b(e) {
            if (!e.startContainer) throw new j("INVALID_STATE_ERR");
        }
        function y(e, t) {
            if (!K(t, e.nodeType)) throw new g("INVALID_NODE_TYPE_ERR");
        }
        function _(e, t) {
            if (t < 0 || t > (z(e) ? e.length : e.childNodes.length)) throw new j("INDEX_SIZE_ERR");
        }
        function w(e, t) {
            if (re(e, !0) !== re(t, !0)) throw new j("WRONG_DOCUMENT_ERR");
        }
        function x(e) {
            if (ie(e, !0)) throw new j("NO_MODIFICATION_ALLOWED_ERR");
        }
        function E(e, t) {
            if (!e) throw new j(t);
        }
        function C(e) {
            return (Q && L.isBrokenNode(e)) || (!K(Z, e.nodeType) && !re(e, !0));
        }
        function T(e, t) {
            return t <= (z(e) ? e.length : e.childNodes.length);
        }
        function S(e) {
            return !!e.startContainer && !!e.endContainer && !C(e.startContainer) && !C(e.endContainer) && T(e.startContainer, e.startOffset) && T(e.endContainer, e.endOffset);
        }
        function R(e) {
            if ((b(e), !S(e))) throw new Error("Range error: Range is no longer valid after DOM mutation (" + e.inspect() + ")");
        }
        function I(e, t) {
            R(e);
            var n = e.startContainer,
                r = e.startOffset,
                i = e.endContainer,
                o = e.endOffset,
                a = n === i;
            z(i) && o > 0 && o < i.length && q(i, o, t), z(n) && r > 0 && r < n.length && ((n = q(n, r, t)), a ? ((o -= r), (i = n)) : i == n.parentNode && o >= V(n) && o++, (r = 0)), e.setStartAndEnd(n, r, i, o);
        }
        function k(e) {
            (e.START_TO_START = ue), (e.START_TO_END = de), (e.END_TO_END = fe), (e.END_TO_START = he), (e.NODE_BEFORE = pe), (e.NODE_AFTER = ge), (e.NODE_BEFORE_AND_AFTER = me), (e.NODE_INSIDE = ve);
        }
        function P(e) {
            k(e), k(e.prototype);
        }
        function N(e, t) {
            return function () {
                R(this);
                var n,
                    r,
                    i = this.startContainer,
                    a = this.startOffset,
                    s = this.commonAncestorContainer,
                    l = new p(this, !0);
                i !== s && ((n = G(i, s, !0)), (r = o(n)), (i = r.node), (a = r.offset)), c(l, x), l.reset();
                var u = e(l);
                return l.detach(), t(this, i, a, i, a), u;
            };
        }
        function O(t, r, a) {
            function s(e, t) {
                return function (n) {
                    b(this), y(n, Y), y(X(n), Z);
                    var r = (e ? i : o)(n);
                    (t ? l : c)(this, r.node, r.offset);
                };
            }
            function l(e, t, n) {
                var i = e.endContainer,
                    o = e.endOffset;
                (t === e.startContainer && n === e.startOffset) || ((X(t) == X(i) && 1 != W(t, n, i, o)) || ((i = t), (o = n)), r(e, t, n, i, o));
            }
            function c(e, t, n) {
                var i = e.startContainer,
                    o = e.startOffset;
                (t === e.endContainer && n === e.endOffset) || ((X(t) == X(i) && W(t, n, i, o) != -1) || ((i = t), (o = n)), r(e, i, o, t, n));
            }
            var f = function () {};
            (f.prototype = e.rangePrototype),
                (t.prototype = new f()),
                U.extend(t.prototype, {
                    setStart: function (e, t) {
                        b(this), v(e, !0), _(e, t), l(this, e, t);
                    },
                    setEnd: function (e, t) {
                        b(this), v(e, !0), _(e, t), c(this, e, t);
                    },
                    setStartAndEnd: function () {
                        b(this);
                        var e = arguments,
                            t = e[0],
                            n = e[1],
                            i = t,
                            o = n;
                        switch (e.length) {
                            case 3:
                                o = e[2];
                                break;
                            case 4:
                                (i = e[2]), (o = e[3]);
                        }
                        r(this, t, n, i, o);
                    },
                    setBoundary: function (e, t, n) {
                        this["set" + (n ? "Start" : "End")](e, t);
                    },
                    setStartBefore: s(!0, !0),
                    setStartAfter: s(!1, !0),
                    setEndBefore: s(!0, !1),
                    setEndAfter: s(!1, !1),
                    collapse: function (e) {
                        R(this), e ? r(this, this.startContainer, this.startOffset, this.startContainer, this.startOffset) : r(this, this.endContainer, this.endOffset, this.endContainer, this.endOffset);
                    },
                    selectNodeContents: function (e) {
                        b(this), v(e, !0), r(this, e, 0, e, J(e));
                    },
                    selectNode: function (e) {
                        b(this), v(e, !1), y(e, Y);
                        var t = i(e),
                            n = o(e);
                        r(this, t.node, t.offset, n.node, n.offset);
                    },
                    extractContents: N(d, r),
                    deleteContents: N(u, r),
                    canSurroundContents: function () {
                        R(this), x(this.startContainer), x(this.endContainer);
                        var e = new p(this, !0),
                            t = (e._first && n(e._first, this)) || (e._last && n(e._last, this));
                        return e.detach(), !t;
                    },
                    detach: function () {
                        a(this);
                    },
                    splitBoundaries: function () {
                        I(this);
                    },
                    splitBoundariesPreservingPositions: function (e) {
                        I(this, e);
                    },
                    normalizeBoundaries: function () {
                        R(this);
                        var e = this.startContainer,
                            t = this.startOffset,
                            n = this.endContainer,
                            i = this.endOffset,
                            o = function (e) {
                                var t = e.nextSibling;
                                t && t.nodeType == e.nodeType && ((n = e), (i = e.length), e.appendData(t.data), t.parentNode.removeChild(t));
                            },
                            a = function (r) {
                                var o = r.previousSibling;
                                if (o && o.nodeType == r.nodeType) {
                                    e = r;
                                    var a = r.length;
                                    if (((t = o.length), r.insertData(0, o.data), o.parentNode.removeChild(o), e == n)) (i += t), (n = e);
                                    else if (n == r.parentNode) {
                                        var s = V(r);
                                        i == s ? ((n = r), (i = a)) : i > s && i--;
                                    }
                                }
                            },
                            s = !0;
                        if (z(n)) n.length == i && o(n);
                        else {
                            if (i > 0) {
                                var l = n.childNodes[i - 1];
                                l && z(l) && o(l);
                            }
                            s = !this.collapsed;
                        }
                        if (s) {
                            if (z(e)) 0 == t && a(e);
                            else if (t < e.childNodes.length) {
                                var c = e.childNodes[t];
                                c && z(c) && a(c);
                            }
                        } else (e = n), (t = i);
                        r(this, e, t, n, i);
                    },
                    collapseToPoint: function (e, t) {
                        b(this), v(e, !0), _(e, t), this.setStartAndEnd(e, t);
                    },
                }),
                P(t);
        }
        function A(e) {
            (e.collapsed = e.startContainer === e.endContainer && e.startOffset === e.endOffset), (e.commonAncestorContainer = e.collapsed ? e.startContainer : L.getCommonAncestor(e.startContainer, e.endContainer));
        }
        function D(e, t, n, r, i) {
            (e.startContainer = t), (e.startOffset = n), (e.endContainer = r), (e.endOffset = i), (e.document = L.getDocument(t)), A(e);
        }
        function M(e) {
            b(e), (e.startContainer = e.startOffset = e.endContainer = e.endOffset = e.document = null), (e.collapsed = e.commonAncestorContainer = null);
        }
        function F(e) {
            (this.startContainer = e), (this.startOffset = 0), (this.endContainer = e), (this.endOffset = 0), (this.document = e), A(this);
        }
        var L = e.dom,
            U = e.util,
            B = L.DomPosition,
            j = e.DOMException,
            z = L.isCharacterDataNode,
            V = L.getNodeIndex,
            H = L.isOrIsAncestorOf,
            $ = L.getDocument,
            W = L.comparePoints,
            q = L.splitDataNode,
            G = L.getClosestAncestorIn,
            J = L.getNodeLength,
            K = L.arrayContains,
            X = L.getRootContainer,
            Q = e.features.crashyTextNodes;
        (p.prototype = {
            _current: null,
            _next: null,
            _first: null,
            _last: null,
            isSingleCharacterDataNode: !1,
            reset: function () {
                (this._current = null), (this._next = this._first);
            },
            hasNext: function () {
                return !!this._next;
            },
            next: function () {
                var e = (this._current = this._next);
                return (
                    e &&
                        ((this._next = e !== this._last ? e.nextSibling : null),
                        z(e) && this.clonePartiallySelectedTextNodes && (e === this.ec && (e = e.cloneNode(!0)).deleteData(this.eo, e.length - this.eo), this._current === this.sc && (e = e.cloneNode(!0)).deleteData(0, this.so))),
                    e
                );
            },
            remove: function () {
                var e,
                    t,
                    n = this._current;
                !z(n) || (n !== this.sc && n !== this.ec) ? n.parentNode && n.parentNode.removeChild(n) : ((e = n === this.sc ? this.so : 0), (t = n === this.ec ? this.eo : n.length), e != t && n.deleteData(e, t - e));
            },
            isPartiallySelectedSubtree: function () {
                var e = this._current;
                return n(e, this.range);
            },
            getSubtreeIterator: function () {
                var e;
                if (this.isSingleCharacterDataNode) (e = this.range.cloneRange()), e.collapse(!1);
                else {
                    e = new F(r(this.range));
                    var t = this._current,
                        n = t,
                        i = 0,
                        o = t,
                        a = J(t);
                    H(t, this.sc) && ((n = this.sc), (i = this.so)), H(t, this.ec) && ((o = this.ec), (a = this.eo)), D(e, n, i, o, a);
                }
                return new p(e, this.clonePartiallySelectedTextNodes);
            },
            detach: function (e) {
                e && this.range.detach(), (this.range = this._current = this._next = this._first = this._last = this.sc = this.so = this.ec = this.eo = null);
            },
        }),
            (g.prototype = { BAD_BOUNDARYPOINTS_ERR: 1, INVALID_NODE_TYPE_ERR: 2 }),
            (g.prototype.toString = function () {
                return this.message;
            });
        var Y = [1, 3, 4, 5, 7, 8, 10],
            Z = [2, 9, 11],
            ee = [5, 6, 10, 12],
            te = [1, 3, 4, 5, 7, 8, 10, 11],
            ne = [1, 3, 4, 5, 7, 8],
            re = m([9, 11]),
            ie = m(ee),
            oe = m([6, 10, 12]),
            ae = document.createElementNS("http://www.w3.org/1999/xhtml", "style"),
            se = !1;
        try {
            (ae.innerHTML = "<b>x</b>"), (se = 3 == ae.firstChild.nodeType);
        } catch (e) {}
        e.features.htmlParsingConforms = se;
        var le = se
                ? function (e) {
                      var t = this.startContainer,
                          n = $(t);
                      if (!t) throw new j("INVALID_STATE_ERR");
                      var r = null;
                      return (
                          1 == t.nodeType ? (r = t) : z(t) && (r = L.parentElement(t)),
                          (r = null === r || ("HTML" == r.nodeName && L.isHtmlNamespace($(r).documentElement) && L.isHtmlNamespace(r)) ? n.createElementNS("http://www.w3.org/1999/xhtml", "body") : r.cloneNode(!1)),
                          (r.innerHTML = e),
                          L.fragmentFromNodeChildren(r)
                      );
                  }
                : function (e) {
                      b(this);
                      var t = r(this),
                          n = t.createElementNS("http://www.w3.org/1999/xhtml", "body");
                      return (n.innerHTML = e), L.fragmentFromNodeChildren(n);
                  },
            ce = ["startContainer", "startOffset", "endContainer", "endOffset", "collapsed", "commonAncestorContainer"],
            ue = 0,
            de = 1,
            fe = 2,
            he = 3,
            pe = 0,
            ge = 1,
            me = 2,
            ve = 3;
        U.extend(e.rangePrototype, {
            compareBoundaryPoints: function (e, t) {
                R(this), w(this.startContainer, t.startContainer);
                var n,
                    r,
                    i,
                    o,
                    a = e == he || e == ue ? "start" : "end",
                    s = e == de || e == ue ? "start" : "end";
                return (n = this[a + "Container"]), (r = this[a + "Offset"]), (i = t[s + "Container"]), (o = t[s + "Offset"]), W(n, r, i, o);
            },
            insertNode: function (e) {
                if ((R(this), y(e, te), x(this.startContainer), H(e, this.startContainer))) throw new j("HIERARCHY_REQUEST_ERR");
                var t = a(e, this.startContainer, this.startOffset);
                this.setStartBefore(t);
            },
            cloneContents: function () {
                R(this);
                var e, t;
                if (this.collapsed) return r(this).createDocumentFragment();
                if (this.startContainer === this.endContainer && z(this.startContainer))
                    return (e = this.startContainer.cloneNode(!0)), (e.data = e.data.slice(this.startOffset, this.endOffset)), (t = r(this).createDocumentFragment()), t.appendChild(e), t;
                var n = new p(this, !0);
                return (e = l(n)), n.detach(), e;
            },
            canSurroundContents: function () {
                R(this), x(this.startContainer), x(this.endContainer);
                var e = new p(this, !0),
                    t = (e._first && n(e._first, this)) || (e._last && n(e._last, this));
                return e.detach(), !t;
            },
            surroundContents: function (e) {
                if ((y(e, ne), !this.canSurroundContents())) throw new g("BAD_BOUNDARYPOINTS_ERR");
                var t = this.extractContents();
                if (e.hasChildNodes()) for (; e.lastChild; ) e.removeChild(e.lastChild);
                a(e, this.startContainer, this.startOffset), e.appendChild(t), this.selectNode(e);
            },
            cloneRange: function () {
                R(this);
                for (var e, t = new F(r(this)), n = ce.length; n--; ) (e = ce[n]), (t[e] = this[e]);
                return t;
            },
            toString: function () {
                R(this);
                var e = this.startContainer;
                if (e === this.endContainer && z(e)) return 3 == e.nodeType || 4 == e.nodeType ? e.data.slice(this.startOffset, this.endOffset) : "";
                var t = [],
                    n = new p(this, !0);
                return (
                    c(n, function (e) {
                        (3 != e.nodeType && 4 != e.nodeType) || t.push(e.data);
                    }),
                    n.detach(),
                    t.join("")
                );
            },
            compareNode: function (e) {
                R(this);
                var t = e.parentNode,
                    n = V(e);
                if (!t) throw new j("NOT_FOUND_ERR");
                var r = this.comparePoint(t, n),
                    i = this.comparePoint(t, n + 1);
                return r < 0 ? (i > 0 ? me : pe) : i > 0 ? ge : ve;
            },
            comparePoint: function (e, t) {
                return R(this), E(e, "HIERARCHY_REQUEST_ERR"), w(e, this.startContainer), W(e, t, this.startContainer, this.startOffset) < 0 ? -1 : W(e, t, this.endContainer, this.endOffset) > 0 ? 1 : 0;
            },
            createContextualFragment: le,
            toHtml: function () {
                R(this);
                var e = this.commonAncestorContainer.parentNode.cloneNode(!1);
                return e.appendChild(this.cloneContents()), e.innerHTML;
            },
            intersectsNode: function (e, t) {
                if ((R(this), E(e, "NOT_FOUND_ERR"), $(e) !== r(this))) return !1;
                var n = e.parentNode,
                    i = V(e);
                E(n, "NOT_FOUND_ERR");
                var o = W(n, i, this.endContainer, this.endOffset),
                    a = W(n, i + 1, this.startContainer, this.startOffset);
                return t ? o <= 0 && a >= 0 : o < 0 && a > 0;
            },
            isPointInRange: function (e, t) {
                return R(this), E(e, "HIERARCHY_REQUEST_ERR"), w(e, this.startContainer), W(e, t, this.startContainer, this.startOffset) >= 0 && W(e, t, this.endContainer, this.endOffset) <= 0;
            },
            intersectsRange: function (e) {
                return s(this, e, !1);
            },
            intersectsOrTouchesRange: function (e) {
                return s(this, e, !0);
            },
            intersection: function (e) {
                if (this.intersectsRange(e)) {
                    var t = W(this.startContainer, this.startOffset, e.startContainer, e.startOffset),
                        n = W(this.endContainer, this.endOffset, e.endContainer, e.endOffset),
                        r = this.cloneRange();
                    return t == -1 && r.setStart(e.startContainer, e.startOffset), 1 == n && r.setEnd(e.endContainer, e.endOffset), r;
                }
                return null;
            },
            union: function (e) {
                if (this.intersectsOrTouchesRange(e)) {
                    var t = this.cloneRange();
                    return (
                        W(e.startContainer, e.startOffset, this.startContainer, this.startOffset) == -1 && t.setStart(e.startContainer, e.startOffset),
                        1 == W(e.endContainer, e.endOffset, this.endContainer, this.endOffset) && t.setEnd(e.endContainer, e.endOffset),
                        t
                    );
                }
                throw new g("Ranges do not intersect");
            },
            containsNode: function (e, t) {
                return t ? this.intersectsNode(e, !1) : this.compareNode(e) == ve;
            },
            containsNodeContents: function (e) {
                return this.comparePoint(e, 0) >= 0 && this.comparePoint(e, J(e)) <= 0;
            },
            containsRange: function (e) {
                var t = this.intersection(e);
                return null !== t && e.equals(t);
            },
            containsNodeText: function (e) {
                var t = this.cloneRange();
                t.selectNode(e);
                var n = t.getNodes([3]);
                if (n.length > 0) {
                    t.setStart(n[0], 0);
                    var r = n.pop();
                    t.setEnd(r, r.length);
                    var i = this.containsRange(t);
                    return t.detach(), i;
                }
                return this.containsNodeContents(e);
            },
            getNodes: function (e, t) {
                return R(this), f(this, e, t);
            },
            getDocument: function () {
                return r(this);
            },
            collapseBefore: function (e) {
                b(this), this.setEndBefore(e), this.collapse(!1);
            },
            collapseAfter: function (e) {
                b(this), this.setStartAfter(e), this.collapse(!0);
            },
            getBookmark: function (t) {
                var n = r(this),
                    i = e.createRange(n);
                (t = t || L.getBody(n)), i.selectNodeContents(t);
                var o = this.intersection(i),
                    a = 0,
                    s = 0;
                return o && (i.setEnd(o.startContainer, o.startOffset), (a = i.toString().length), (s = a + o.toString().length), i.detach()), { start: a, end: s, containerNode: t };
            },
            moveToBookmark: function (e) {
                var t = e.containerNode,
                    n = 0;
                this.setStart(t, 0), this.collapse(!0);
                for (var r, i, o, a, s = [t], l = !1, c = !1; !c && (r = s.pop()); )
                    if (3 == r.nodeType) (i = n + r.length), !l && e.start >= n && e.start <= i && (this.setStart(r, e.start - n), (l = !0)), l && e.end >= n && e.end <= i && (this.setEnd(r, e.end - n), (c = !0)), (n = i);
                    else for (a = r.childNodes, o = a.length; o--; ) s.push(a[o]);
            },
            getName: function () {
                return "DomRange";
            },
            equals: function (e) {
                return F.rangesEqual(this, e);
            },
            isValid: function () {
                return S(this);
            },
            inspect: function () {
                return h(this);
            },
        }),
            O(F, D, M),
            U.extend(F, {
                rangeProperties: ce,
                RangeIterator: p,
                copyComparisonConstants: P,
                createPrototypeRange: O,
                inspect: h,
                getRangeDocument: r,
                rangesEqual: function (e, t) {
                    return e.startContainer === t.startContainer && e.startOffset === t.startOffset && e.endContainer === t.endContainer && e.endOffset === t.endOffset;
                },
            }),
            (e.DomRange = F),
            (e.RangeException = g);
    }),
    rangy.createCoreModule("WrappedRange", ["DomRange"], function (e, t) {
        var n,
            r,
            i = e.dom,
            o = e.util,
            a = i.DomPosition,
            s = e.DomRange,
            l = i.getBody,
            c = i.getContentDocument,
            u = i.isCharacterDataNode;
        if (
            (e.features.implementsDomRange &&
                !(function () {
                    function r(e) {
                        for (var t, n = h.length; n--; ) (t = h[n]), (e[t] = e.nativeRange[t]);
                        e.collapsed = e.startContainer === e.endContainer && e.startOffset === e.endOffset;
                    }
                    function a(e, t, n, r, i) {
                        var o = e.startContainer !== t || e.startOffset != n,
                            a = e.endContainer !== r || e.endOffset != i,
                            s = !e.equals(e.nativeRange);
                        (o || a || s) && (e.setEnd(r, i), e.setStart(t, n));
                    }
                    function u(e) {
                        e.nativeRange.detach(), (e.detached = !0);
                        for (var t = h.length; t--; ) e[h[t]] = null;
                    }
                    var d,
                        f,
                        h = s.rangeProperties;
                    (n = function (e) {
                        if (!e) throw t.createError("WrappedRange: Range must be specified");
                        (this.nativeRange = e), r(this);
                    }),
                        s.createPrototypeRange(n, a, u),
                        (d = n.prototype),
                        (d.selectNode = function (e) {
                            this.nativeRange.selectNode(e), r(this);
                        }),
                        (d.cloneContents = function () {
                            return this.nativeRange.cloneContents();
                        }),
                        (d.surroundContents = function (e) {
                            this.nativeRange.surroundContents(e), r(this);
                        }),
                        (d.collapse = function (e) {
                            this.nativeRange.collapse(e), r(this);
                        }),
                        (d.cloneRange = function () {
                            return new n(this.nativeRange.cloneRange());
                        }),
                        (d.refresh = function () {
                            r(this);
                        }),
                        (d.toString = function () {
                            return this.nativeRange.toString();
                        });
                    var p = document.createTextNode("test");
                    l(document).appendChild(p);
                    var g = document.createRange();
                    g.setStart(p, 0), g.setEnd(p, 0);
                    try {
                        g.setStart(p, 1),
                            (d.setStart = function (e, t) {
                                this.nativeRange.setStart(e, t), r(this);
                            }),
                            (d.setEnd = function (e, t) {
                                this.nativeRange.setEnd(e, t), r(this);
                            }),
                            (f = function (e) {
                                return function (t) {
                                    this.nativeRange[e](t), r(this);
                                };
                            });
                    } catch (e) {
                        (d.setStart = function (e, t) {
                            try {
                                this.nativeRange.setStart(e, t);
                            } catch (n) {
                                this.nativeRange.setEnd(e, t), this.nativeRange.setStart(e, t);
                            }
                            r(this);
                        }),
                            (d.setEnd = function (e, t) {
                                try {
                                    this.nativeRange.setEnd(e, t);
                                } catch (n) {
                                    this.nativeRange.setStart(e, t), this.nativeRange.setEnd(e, t);
                                }
                                r(this);
                            }),
                            (f = function (e, t) {
                                return function (n) {
                                    try {
                                        this.nativeRange[e](n);
                                    } catch (r) {
                                        this.nativeRange[t](n), this.nativeRange[e](n);
                                    }
                                    r(this);
                                };
                            });
                    }
                    (d.setStartBefore = f("setStartBefore", "setEndBefore")),
                        (d.setStartAfter = f("setStartAfter", "setEndAfter")),
                        (d.setEndBefore = f("setEndBefore", "setStartBefore")),
                        (d.setEndAfter = f("setEndAfter", "setStartAfter")),
                        (d.selectNodeContents = function (e) {
                            this.setStartAndEnd(e, 0, i.getNodeLength(e));
                        }),
                        g.selectNodeContents(p),
                        g.setEnd(p, 3);
                    var m = document.createRange();
                    m.selectNodeContents(p),
                        m.setEnd(p, 4),
                        m.setStart(p, 2),
                        g.compareBoundaryPoints(g.START_TO_END, m) == -1 && 1 == g.compareBoundaryPoints(g.END_TO_START, m)
                            ? (d.compareBoundaryPoints = function (e, t) {
                                  return (t = t.nativeRange || t), e == t.START_TO_END ? (e = t.END_TO_START) : e == t.END_TO_START && (e = t.START_TO_END), this.nativeRange.compareBoundaryPoints(e, t);
                              })
                            : (d.compareBoundaryPoints = function (e, t) {
                                  return this.nativeRange.compareBoundaryPoints(e, t.nativeRange || t);
                              });
                    var v = document.createElementNS("http://www.w3.org/1999/xhtml", "div");
                    v.innerHTML = "123";
                    var b = v.firstChild,
                        y = l(document);
                    y.appendChild(v),
                        g.setStart(b, 1),
                        g.setEnd(b, 2),
                        g.deleteContents(),
                        "13" == b.data &&
                            ((d.deleteContents = function () {
                                this.nativeRange.deleteContents(), r(this);
                            }),
                            (d.extractContents = function () {
                                var e = this.nativeRange.extractContents();
                                return r(this), e;
                            })),
                        y.removeChild(v),
                        (y = null),
                        o.isHostMethod(g, "createContextualFragment") &&
                            (d.createContextualFragment = function (e) {
                                return this.nativeRange.createContextualFragment(e);
                            }),
                        l(document).removeChild(p),
                        g.detach(),
                        m.detach(),
                        (d.getName = function () {
                            return "WrappedRange";
                        }),
                        (e.WrappedRange = n),
                        (e.createNativeRange = function (e) {
                            return (e = c(e, t, "createNativeRange")), e.createRange();
                        });
                })(),
            e.features.implementsTextRange)
        ) {
            var d = function (e) {
                    var t = e.parentElement(),
                        n = e.duplicate();
                    n.collapse(!0);
                    var r = n.parentElement();
                    (n = e.duplicate()), n.collapse(!1);
                    var o = n.parentElement(),
                        a = r == o ? r : i.getCommonAncestor(r, o);
                    return a == t ? a : i.getCommonAncestor(t, a);
                },
                f = function (e) {
                    return 0 == e.compareEndPoints("StartToEnd", e);
                },
                h = function (e, t, n, r, o) {
                    var s = e.duplicate();
                    s.collapse(n);
                    var l = s.parentElement();
                    if ((i.isOrIsAncestorOf(t, l) || (l = t), !l.canHaveHTML)) {
                        var c = new a(l.parentNode, i.getNodeIndex(l));
                        return { boundaryPosition: c, nodeInfo: { nodeIndex: c.offset, containerElement: c.node } };
                    }
                    var d = i.getDocument(l).createElementNS("http://www.w3.org/1999/xhtml", "span");
                    d.parentNode && d.parentNode.removeChild(d);
                    for (var f, h, p, g, m, v = n ? "StartToStart" : "StartToEnd", b = o && o.containerElement == l ? o.nodeIndex : 0, y = l.childNodes.length, _ = y, w = _; ; ) {
                        if ((w == y ? l.appendChild(d) : l.insertBefore(d, l.childNodes[w]), s.moveToElementText(d), (f = s.compareEndPoints(v, e)), 0 == f || b == _)) break;
                        if (f == -1) {
                            if (_ == b + 1) break;
                            b = w;
                        } else _ = _ == b + 1 ? b : w;
                        (w = Math.floor((b + _) / 2)), l.removeChild(d);
                    }
                    if (((m = d.nextSibling), f == -1 && m && u(m))) {
                        s.setEndPoint(n ? "EndToStart" : "EndToEnd", e);
                        var x;
                        if (/[\r\n]/.test(m.data)) {
                            var E = s.duplicate(),
                                C = E.text.replace(/\r\n/g, "\r").length;
                            for (x = E.moveStart("character", C); (f = E.compareEndPoints("StartToEnd", E)) == -1; ) x++, E.moveStart("character", 1);
                        } else x = s.text.length;
                        g = new a(m, x);
                    } else (h = (r || !n) && d.previousSibling), (p = (r || n) && d.nextSibling), (g = p && u(p) ? new a(p, 0) : h && u(h) ? new a(h, h.data.length) : new a(l, i.getNodeIndex(d)));
                    return d.parentNode.removeChild(d), { boundaryPosition: g, nodeInfo: { nodeIndex: w, containerElement: l } };
                },
                p = function (e, t) {
                    var n,
                        r,
                        o,
                        a,
                        s = e.offset,
                        c = i.getDocument(e.node),
                        d = l(c).createTextRange(),
                        f = u(e.node);
                    return (
                        f ? ((n = e.node), (r = n.parentNode)) : ((a = e.node.childNodes), (n = s < a.length ? a[s] : null), (r = e.node)),
                        (o = c.createElementNS("http://www.w3.org/1999/xhtml", "span")),
                        (o.innerHTML = "&#feff;"),
                        n ? r.insertBefore(o, n) : r.appendChild(o),
                        d.moveToElementText(o),
                        d.collapse(!t),
                        r.removeChild(o),
                        f && d[t ? "moveStart" : "moveEnd"]("character", s),
                        d
                    );
                };
            if (
                ((r = function (e) {
                    (this.textRange = e), this.refresh();
                }),
                (r.prototype = new s(document)),
                (r.prototype.refresh = function () {
                    var e,
                        t,
                        n,
                        r = d(this.textRange);
                    f(this.textRange) ? (t = e = h(this.textRange, r, !0, !0).boundaryPosition) : ((n = h(this.textRange, r, !0, !1)), (e = n.boundaryPosition), (t = h(this.textRange, r, !1, !1, n.nodeInfo).boundaryPosition)),
                        this.setStart(e.node, e.offset),
                        this.setEnd(t.node, t.offset);
                }),
                (r.prototype.getName = function () {
                    return "WrappedTextRange";
                }),
                s.copyComparisonConstants(r),
                (r.rangeToTextRange = function (e) {
                    if (e.collapsed) return p(new a(e.startContainer, e.startOffset), !0);
                    var t = p(new a(e.startContainer, e.startOffset), !0),
                        n = p(new a(e.endContainer, e.endOffset), !1),
                        r = l(s.getRangeDocument(e)).createTextRange();
                    return r.setEndPoint("StartToStart", t), r.setEndPoint("EndToEnd", n), r;
                }),
                (e.WrappedTextRange = r),
                !e.features.implementsDomRange || e.config.preferTextRange)
            ) {
                var g = (function () {
                    return this;
                })();
                "undefined" == typeof g.Range && (g.Range = r),
                    (e.createNativeRange = function (e) {
                        return (e = c(e, t, "createNativeRange")), l(e).createTextRange();
                    }),
                    (e.WrappedRange = r);
            }
        }
        (e.createRange = function (n) {
            return (n = c(n, t, "createRange")), new e.WrappedRange(e.createNativeRange(n));
        }),
            (e.createRangyRange = function (e) {
                return (e = c(e, t, "createRangyRange")), new s(e);
            }),
            (e.createIframeRange = function (n) {
                return t.deprecationNotice("createIframeRange()", "createRange(iframeEl)"), e.createRange(n);
            }),
            (e.createIframeRangyRange = function (n) {
                return t.deprecationNotice("createIframeRangyRange()", "createRangyRange(iframeEl)"), e.createRangyRange(n);
            }),
            e.addCreateMissingNativeApiListener(function (t) {
                var n = t.document;
                "undefined" == typeof n.createRange &&
                    (n.createRange = function () {
                        return e.createRange(n);
                    }),
                    (n = t = null);
            });
    }),
    rangy.createCoreModule("WrappedSelection", ["DomRange", "WrappedRange"], function (e, t) {
        function n(e) {
            return "string" == typeof e ? /^backward(s)?$/i.test(e) : !!e;
        }
        function r(e, n) {
            if (e) {
                if (I.isWindow(e)) return e;
                if (e instanceof v) return e.win;
                var r = I.getContentDocument(e, t, n);
                return I.getWindow(r);
            }
            return window;
        }
        function i(e) {
            return r(e, "getWinSelection").getSelection();
        }
        function o(e) {
            return r(e, "getDocSelection").document.selection;
        }
        function a(e) {
            var t = !1;
            return e.anchorNode && (t = 1 == I.comparePoints(e.anchorNode, e.anchorOffset, e.focusNode, e.focusOffset)), t;
        }
        function s(e, t, n) {
            var r = n ? "end" : "start",
                i = n ? "start" : "end";
            (e.anchorNode = t[r + "Container"]), (e.anchorOffset = t[r + "Offset"]), (e.focusNode = t[i + "Container"]), (e.focusOffset = t[i + "Offset"]);
        }
        function l(e) {
            var t = e.nativeSelection;
            (e.anchorNode = t.anchorNode), (e.anchorOffset = t.anchorOffset), (e.focusNode = t.focusNode), (e.focusOffset = t.focusOffset);
        }
        function c(e) {
            (e.anchorNode = e.focusNode = null), (e.anchorOffset = e.focusOffset = 0), (e.rangeCount = 0), (e.isCollapsed = !0), (e._ranges.length = 0);
        }
        function u(t) {
            var n;
            return (
                t instanceof N
                    ? ((n = e.createNativeRange(t.getDocument())), n.setEnd(t.endContainer, t.endOffset), n.setStart(t.startContainer, t.startOffset))
                    : t instanceof O
                    ? (n = t.nativeRange)
                    : M.implementsDomRange && t instanceof I.getWindow(t.startContainer).Range && (n = t),
                n
            );
        }
        function d(e) {
            if (!e.length || 1 != e[0].nodeType) return !1;
            for (var t = 1, n = e.length; t < n; ++t) if (!I.isAncestorOf(e[0], e[t])) return !1;
            return !0;
        }
        function f(e) {
            var n = e.getNodes();
            if (!d(n)) throw t.createError("getSingleElementFromRange: range " + e.inspect() + " did not consist of a single element");
            return n[0];
        }
        function h(e) {
            return !!e && "undefined" != typeof e.text;
        }
        function p(e, t) {
            var n = new O(t);
            (e._ranges = [n]), s(e, n, !1), (e.rangeCount = 1), (e.isCollapsed = n.collapsed);
        }
        function g(t) {
            if (((t._ranges.length = 0), "None" == t.docSelection.type)) c(t);
            else {
                var n = t.docSelection.createRange();
                if (h(n)) p(t, n);
                else {
                    t.rangeCount = n.length;
                    for (var r, i = L(n.item(0)), o = 0; o < t.rangeCount; ++o) (r = e.createRange(i)), r.selectNode(n.item(o)), t._ranges.push(r);
                    (t.isCollapsed = 1 == t.rangeCount && t._ranges[0].collapsed), s(t, t._ranges[t.rangeCount - 1], !1);
                }
            }
        }
        function m(e, n) {
            for (var r = e.docSelection.createRange(), i = f(n), o = L(r.item(0)), a = U(o).createControlRange(), s = 0, l = r.length; s < l; ++s) a.add(r.item(s));
            try {
                a.add(i);
            } catch (e) {
                throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");
            }
            a.select(), g(e);
        }
        function v(e, t, n) {
            (this.nativeSelection = e), (this.docSelection = t), (this._ranges = []), (this.win = n), this.refresh();
        }
        function b(e) {
            (e.win = e.anchorNode = e.focusNode = e._ranges = null), (e.rangeCount = e.anchorOffset = e.focusOffset = 0), (e.detached = !0);
        }
        function y(e, t) {
            for (var n, r, i = te.length; i--; )
                if (((n = te[i]), (r = n.selection), "deleteAll" == t)) b(r);
                else if (n.win == e) return "delete" == t ? (te.splice(i, 1), !0) : r;
            return "deleteAll" == t && (te.length = 0), null;
        }
        function _(e, n) {
            for (var r, i = L(n[0].startContainer), o = U(i).createControlRange(), a = 0, s = n.length; a < s; ++a) {
                r = f(n[a]);
                try {
                    o.add(r);
                } catch (e) {
                    throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)");
                }
            }
            o.select(), g(e);
        }
        function w(e, t) {
            if (e.win.document != L(t)) throw new A("WRONG_DOCUMENT_ERR");
        }
        function x(t) {
            return function (n, r) {
                var i;
                this.rangeCount ? ((i = this.getRangeAt(0)), i["set" + (t ? "Start" : "End")](n, r)) : ((i = e.createRange(this.win.document)), i.setStartAndEnd(n, r)), this.setSingleRange(i, this.isBackward());
            };
        }
        function E(e) {
            var t = [],
                n = new D(e.anchorNode, e.anchorOffset),
                r = new D(e.focusNode, e.focusOffset),
                i = "function" == typeof e.getName ? e.getName() : "Selection";
            if ("undefined" != typeof e.rangeCount) for (var o = 0, a = e.rangeCount; o < a; ++o) t[o] = N.inspect(e.getRangeAt(o));
            return "[" + i + "(Ranges: " + t.join(", ") + ")(anchor: " + n.inspect() + ", focus: " + r.inspect() + "]";
        }
        e.config.checkSelectionRanges = !0;
        var C,
            T,
            S = "boolean",
            R = "number",
            I = e.dom,
            k = e.util,
            P = k.isHostMethod,
            N = e.DomRange,
            O = e.WrappedRange,
            A = e.DOMException,
            D = I.DomPosition,
            M = e.features,
            F = "Control",
            L = I.getDocument,
            U = I.getBody,
            B = N.rangesEqual,
            j = P(window, "getSelection"),
            z = k.isHostObject(document, "selection");
        (M.implementsWinGetSelection = j), (M.implementsDocSelection = z);
        var V = z && (!j || e.config.preferTextRange);
        V
            ? ((C = o),
              (e.isSelectionValid = function (e) {
                  var t = r(e, "isSelectionValid").document,
                      n = t.selection;
                  return "None" != n.type || L(n.createRange().parentElement()) == t;
              }))
            : j
            ? ((C = i),
              (e.isSelectionValid = function () {
                  return !0;
              }))
            : t.fail("Neither document.selection or window.getSelection() detected."),
            (e.getNativeSelection = C);
        var H = C(),
            $ = e.createNativeRange(document),
            W = U(document),
            q = k.areHostProperties(H, ["anchorNode", "focusNode", "anchorOffset", "focusOffset"]);
        M.selectionHasAnchorAndFocus = q;
        var G = P(H, "extend");
        M.selectionHasExtend = G;
        var J = typeof H.rangeCount == R;
        M.selectionHasRangeCount = J;
        var K = !1,
            X = !0,
            Q = G
                ? function (t, n) {
                      var r = N.getRangeDocument(n),
                          i = e.createRange(r);
                      i.collapseToPoint(n.endContainer, n.endOffset), t.addRange(u(i)), t.extend(n.startContainer, n.startOffset);
                  }
                : null;
        k.areHostMethods(H, ["addRange", "getRangeAt", "removeAllRanges"]) &&
            typeof H.rangeCount == R &&
            M.implementsDomRange &&
            !(function () {
                var t = window.getSelection();
                if (t) {
                    for (var n = t.rangeCount, r = n > 1, i = [], o = a(t), s = 0; s < n; ++s) i[s] = t.getRangeAt(s);
                    var l = U(document),
                        c = l.appendChild(document.createElementNS("http://www.w3.org/1999/xhtml", "div"));
                    c.contentEditable = "false";
                    var u = c.appendChild(document.createTextNode("")),
                        d = document.createRange();
                    if ((d.setStart(u, 1), d.collapse(!0), t.addRange(d), (X = 1 == t.rangeCount), t.removeAllRanges(), !r)) {
                        var f = d.cloneRange();
                        d.setStart(u, 0), f.setEnd(u, 3), f.setStart(u, 2), t.addRange(d), t.addRange(f), (K = 2 == t.rangeCount), f.detach();
                    }
                    for (l.removeChild(c), t.removeAllRanges(), d.detach(), s = 0; s < n; ++s)
                        0 == s && o
                            ? Q
                                ? Q(t, i[s])
                                : (e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because browser does not support Selection.extend"), t.addRange(i[s]))
                            : t.addRange(i[s]);
                }
            })(),
            (M.selectionSupportsMultipleRanges = K),
            (M.collapsedNonEditableSelectionsSupported = X);
        var Y,
            Z = !1;
        W && P(W, "createControlRange") && ((Y = W.createControlRange()), k.areHostProperties(Y, ["item", "add"]) && (Z = !0)),
            (M.implementsControlRange = Z),
            (T = q
                ? function (e) {
                      return e.anchorNode === e.focusNode && e.anchorOffset === e.focusOffset;
                  }
                : function (e) {
                      return !!e.rangeCount && e.getRangeAt(e.rangeCount - 1).collapsed;
                  });
        var ee;
        P(H, "getRangeAt")
            ? (ee = function (e, t) {
                  try {
                      return e.getRangeAt(t);
                  } catch (e) {
                      return null;
                  }
              })
            : q &&
              (ee = function (t) {
                  var n = L(t.anchorNode),
                      r = e.createRange(n);
                  return r.setStartAndEnd(t.anchorNode, t.anchorOffset, t.focusNode, t.focusOffset), r.collapsed !== this.isCollapsed && r.setStartAndEnd(t.focusNode, t.focusOffset, t.anchorNode, t.anchorOffset), r;
              }),
            (v.prototype = e.selectionPrototype);
        var te = [],
            ne = function (e) {
                if (e && e instanceof v) return e.refresh(), e;
                e = r(e, "getNativeSelection");
                var t = y(e),
                    n = C(e),
                    i = z ? o(e) : null;
                return t ? ((t.nativeSelection = n), (t.docSelection = i), t.refresh()) : ((t = new v(n, i, e)), te.push({ win: e, selection: t })), t;
            };
        (e.getSelection = ne),
            (e.getIframeSelection = function (n) {
                return t.deprecationNotice("getIframeSelection()", "getSelection(iframeEl)"), e.getSelection(I.getIframeWindow(n));
            });
        var re = v.prototype;
        if (!V && q && k.areHostMethods(H, ["removeAllRanges", "addRange"])) {
            re.removeAllRanges = function () {
                this.nativeSelection.removeAllRanges(), c(this);
            };
            var ie = function (e, t) {
                Q(e.nativeSelection, t), e.refresh();
            };
            J
                ? (re.addRange = function (t, r) {
                      if (Z && z && this.docSelection.type == F) m(this, t);
                      else if (n(r) && G) ie(this, t);
                      else {
                          var i;
                          if ((K ? (i = this.rangeCount) : (this.removeAllRanges(), (i = 0)), this.nativeSelection.addRange(u(t).cloneRange()), (this.rangeCount = this.nativeSelection.rangeCount), this.rangeCount == i + 1)) {
                              if (e.config.checkSelectionRanges) {
                                  var o = ee(this.nativeSelection, this.rangeCount - 1);
                                  o && !B(o, t) && (t = new O(o));
                              }
                              (this._ranges[this.rangeCount - 1] = t), s(this, t, se(this.nativeSelection)), (this.isCollapsed = T(this));
                          } else this.refresh();
                      }
                  })
                : (re.addRange = function (e, t) {
                      n(t) && G ? ie(this, e) : (this.nativeSelection.addRange(u(e)), this.refresh());
                  }),
                (re.setRanges = function (e) {
                    if (Z && e.length > 1) _(this, e);
                    else {
                        this.removeAllRanges();
                        for (var t = 0, n = e.length; t < n; ++t) this.addRange(e[t]);
                    }
                });
        } else {
            if (!(P(H, "empty") && P($, "select") && Z && V)) return t.fail("No means of selecting a Range or TextRange was found"), !1;
            (re.removeAllRanges = function () {
                try {
                    if ((this.docSelection.empty(), "None" != this.docSelection.type)) {
                        var e;
                        if (this.anchorNode) e = L(this.anchorNode);
                        else if (this.docSelection.type == F) {
                            var t = this.docSelection.createRange();
                            t.length && (e = L(t.item(0)));
                        }
                        if (e) {
                            var n = U(e).createTextRange();
                            n.select(), this.docSelection.empty();
                        }
                    }
                } catch (e) {}
                c(this);
            }),
                (re.addRange = function (t) {
                    this.docSelection.type == F ? m(this, t) : (e.WrappedTextRange.rangeToTextRange(t).select(), (this._ranges[0] = t), (this.rangeCount = 1), (this.isCollapsed = this._ranges[0].collapsed), s(this, t, !1));
                }),
                (re.setRanges = function (e) {
                    this.removeAllRanges();
                    var t = e.length;
                    t > 1 ? _(this, e) : t && this.addRange(e[0]);
                });
        }
        re.getRangeAt = function (e) {
            if (e < 0 || e >= this.rangeCount) throw new A("INDEX_SIZE_ERR");
            return this._ranges[e].cloneRange();
        };
        var oe;
        if (V)
            oe = function (t) {
                var n;
                e.isSelectionValid(t.win) ? (n = t.docSelection.createRange()) : ((n = U(t.win.document).createTextRange()), n.collapse(!0)), t.docSelection.type == F ? g(t) : h(n) ? p(t, n) : c(t);
            };
        else if (P(H, "getRangeAt") && typeof H.rangeCount == R)
            oe = function (t) {
                if (Z && z && t.docSelection.type == F) g(t);
                else if (((t._ranges.length = t.rangeCount = t.nativeSelection.rangeCount), t.rangeCount)) {
                    for (var n = 0, r = t.rangeCount; n < r; ++n) t._ranges[n] = new e.WrappedRange(t.nativeSelection.getRangeAt(n));
                    s(t, t._ranges[t.rangeCount - 1], se(t.nativeSelection)), (t.isCollapsed = T(t));
                } else c(t);
            };
        else {
            if (!q || typeof H.isCollapsed != S || typeof $.collapsed != S || !M.implementsDomRange) return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"), !1;
            oe = function (e) {
                var t,
                    n = e.nativeSelection;
                n.anchorNode ? ((t = ee(n, 0)), (e._ranges = [t]), (e.rangeCount = 1), l(e), (e.isCollapsed = T(e))) : c(e);
            };
        }
        re.refresh = function (e) {
            var t = e ? this._ranges.slice(0) : null,
                n = this.anchorNode,
                r = this.anchorOffset;
            if ((oe(this), e)) {
                var i = t.length;
                if (i != this._ranges.length) return !0;
                if (this.anchorNode != n || this.anchorOffset != r) return !0;
                for (; i--; ) if (!B(t[i], this._ranges[i])) return !0;
                return !1;
            }
        };
        var ae = function (e, t) {
            var n = e.getAllRanges();
            e.removeAllRanges();
            for (var r = 0, i = n.length; r < i; ++r) B(t, n[r]) || e.addRange(n[r]);
            e.rangeCount || c(e);
        };
        Z
            ? (re.removeRange = function (e) {
                  if (this.docSelection.type == F) {
                      for (var t, n = this.docSelection.createRange(), r = f(e), i = L(n.item(0)), o = U(i).createControlRange(), a = !1, s = 0, l = n.length; s < l; ++s) (t = n.item(s)), t !== r || a ? o.add(n.item(s)) : (a = !0);
                      o.select(), g(this);
                  } else ae(this, e);
              })
            : (re.removeRange = function (e) {
                  ae(this, e);
              });
        var se;
        !V && q && M.implementsDomRange
            ? ((se = a),
              (re.isBackward = function () {
                  return se(this);
              }))
            : (se = re.isBackward = function () {
                  return !1;
              }),
            (re.isBackwards = re.isBackward),
            (re.toString = function () {
                for (var e = [], t = 0, n = this.rangeCount; t < n; ++t) e[t] = "" + this._ranges[t];
                return e.join("");
            }),
            (re.collapse = function (t, n) {
                w(this, t);
                var r = e.createRange(t);
                r.collapseToPoint(t, n), this.setSingleRange(r), (this.isCollapsed = !0);
            }),
            (re.collapseToStart = function () {
                if (!this.rangeCount) throw new A("INVALID_STATE_ERR");
                var e = this._ranges[0];
                this.collapse(e.startContainer, e.startOffset);
            }),
            (re.collapseToEnd = function () {
                if (!this.rangeCount) throw new A("INVALID_STATE_ERR");
                var e = this._ranges[this.rangeCount - 1];
                this.collapse(e.endContainer, e.endOffset);
            }),
            (re.selectAllChildren = function (t) {
                w(this, t);
                var n = e.createRange(t);
                n.selectNodeContents(t), this.setSingleRange(n);
            }),
            (re.deleteFromDocument = function () {
                if (Z && z && this.docSelection.type == F) {
                    for (var e, t = this.docSelection.createRange(); t.length; ) (e = t.item(0)), t.remove(e), e.parentNode.removeChild(e);
                    this.refresh();
                } else if (this.rangeCount) {
                    var n = this.getAllRanges();
                    if (n.length) {
                        this.removeAllRanges();
                        for (var r = 0, i = n.length; r < i; ++r) n[r].deleteContents();
                        this.addRange(n[i - 1]);
                    }
                }
            }),
            (re.eachRange = function (e, t) {
                for (var n = 0, r = this._ranges.length; n < r; ++n) if (e(this.getRangeAt(n))) return t;
            }),
            (re.getAllRanges = function () {
                var e = [];
                return (
                    this.eachRange(function (t) {
                        e.push(t);
                    }),
                    e
                );
            }),
            (re.setSingleRange = function (e, t) {
                this.removeAllRanges(), this.addRange(e, t);
            }),
            (re.callMethodOnEachRange = function (e, t) {
                var n = [];
                return (
                    this.eachRange(function (r) {
                        n.push(r[e].apply(r, t));
                    }),
                    n
                );
            }),
            (re.setStart = x(!0)),
            (re.setEnd = x(!1)),
            (e.rangePrototype.select = function (e) {
                ne(this.getDocument()).setSingleRange(this, e);
            }),
            (re.changeEachRange = function (e) {
                var t = [],
                    n = this.isBackward();
                this.eachRange(function (n) {
                    e(n), t.push(n);
                }),
                    this.removeAllRanges(),
                    n && 1 == t.length ? this.addRange(t[0], "backward") : this.setRanges(t);
            }),
            (re.containsNode = function (e, t) {
                return this.eachRange(function (n) {
                    return n.containsNode(e, t);
                }, !0);
            }),
            (re.getBookmark = function (e) {
                return { backward: this.isBackward(), rangeBookmarks: this.callMethodOnEachRange("getBookmark", [e]) };
            }),
            (re.moveToBookmark = function (t) {
                for (var n, r, i = [], o = 0; (n = t.rangeBookmarks[o++]); ) (r = e.createRange(this.win)), r.moveToBookmark(n), i.push(r);
                t.backward ? this.setSingleRange(i[0], "backward") : this.setRanges(i);
            }),
            (re.toHtml = function () {
                return this.callMethodOnEachRange("toHtml").join("");
            }),
            (re.getName = function () {
                return "WrappedSelection";
            }),
            (re.inspect = function () {
                return E(this);
            }),
            (re.detach = function () {
                y(this.win, "delete"), b(this);
            }),
            (v.detachAll = function () {
                y(null, "deleteAll");
            }),
            (v.inspect = E),
            (v.isDirectionBackward = n),
            (e.Selection = v),
            (e.selectionPrototype = re),
            e.addCreateMissingNativeApiListener(function (e) {
                "undefined" == typeof e.getSelection &&
                    (e.getSelection = function () {
                        return ne(e);
                    }),
                    (e = null);
            });
    }),
    define("rangy-core", ["domReady"], (function (e) {
        return function () {
            var t, n;
            return (
                (n = function (e) {
                    var t = this.rangy;
                    return (
                        e(function () {
                            t.init();
                        }),
                        this.rangy
                    );
                }),
                (t = n.apply(e, arguments)),
                t || e.rangy
            );
        };
    })(this)),
    rangy.createModule("Highlighter", ["ClassApplier"], function (e, t) {
        function n(e, t) {
            return e.characterRange.start - t.characterRange.start;
        }
        function r(e, t) {
            (this.type = e), (this.converterCreator = t);
        }
        function i(e, t) {
            p[e] = new r(e, t);
        }
        function o(e) {
            var t = p[e];
            if (t instanceof r) return t.create();
            throw new Error("Highlighter type '" + e + "' is not valid");
        }
        function a(e, t) {
            (this.start = e), (this.end = t);
        }
        function s(e, t, n, r, i, o) {
            i ? ((this.id = i), (h = Math.max(h, i + 1))) : (this.id = h++), (this.characterRange = t), (this.doc = e), (this.classApplier = n), (this.converter = r), (this.containerElementId = o || null), (this.applied = !1);
        }
        function l(e, t) {
            (t = t || "textContent"), (this.doc = e || document), (this.classAppliers = {}), (this.highlights = []), (this.converter = o(t));
        }
        var c = e.dom,
            u = c.arrayContains,
            d = c.getBody,
            f = [].forEach
                ? function (e, t) {
                      e.forEach(t);
                  }
                : function (e, t) {
                      for (var n = 0, r = e.length; n < r; ++n) t(e[n]);
                  },
            h = 1,
            p = {};
        (r.prototype.create = function () {
            var e = this.converterCreator();
            return (e.type = this.type), e;
        }),
            (e.registerHighlighterType = i),
            (a.prototype = {
                intersects: function (e) {
                    return this.start < e.end && this.end > e.start;
                },
                union: function (e) {
                    return new a(Math.min(this.start, e.start), Math.max(this.end, e.end));
                },
                intersection: function (e) {
                    return new a(Math.max(this.start, e.start), Math.min(this.end, e.end));
                },
                toString: function () {
                    return "[CharacterRange(" + this.start + ", " + this.end + ")]";
                },
            }),
            (a.fromCharacterRange = function (e) {
                return new a(e.start, e.end);
            });
        var g = {
            rangeToCharacterRange: function (e, t) {
                var n = e.getBookmark(t);
                return new a(n.start, n.end);
            },
            characterRangeToRange: function (t, n, r) {
                var i = e.createRange(t);
                return i.moveToBookmark({ start: n.start, end: n.end, containerNode: r }), i;
            },
            serializeSelection: function (e, t) {
                for (var n = e.getAllRanges(), r = n.length, i = [], o = 1 == r && e.isBackward(), a = 0, s = n.length; a < s; ++a) i[a] = { characterRange: this.rangeToCharacterRange(n[a], t), backward: o };
                return i;
            },
            restoreSelection: function (e, t, n) {
                e.removeAllRanges();
                for (var r, i, o, a = e.win.document, s = 0, l = t.length; s < l; ++s) (i = t[s]), (o = i.characterRange), (r = this.characterRangeToRange(a, i.characterRange, n)), e.addRange(r, i.backward);
            },
        };
        i("textContent", function () {
            return g;
        }),
            i(
                "TextRange",
                (function () {
                    var t;
                    return function () {
                        if (!t) {
                            var n = e.modules.TextRange;
                            if (!n) throw new Error("TextRange module is missing.");
                            if (!n.supported) throw new Error("TextRange module is present but not supported.");
                            t = {
                                rangeToCharacterRange: function (e, t) {
                                    return a.fromCharacterRange(e.toCharacterRange(t));
                                },
                                characterRangeToRange: function (t, n, r) {
                                    var i = e.createRange(t);
                                    return i.selectCharacters(r, n.start, n.end), i;
                                },
                                serializeSelection: function (e, t) {
                                    return e.saveCharacterRanges(t);
                                },
                                restoreSelection: function (e, t, n) {
                                    e.restoreCharacterRanges(n, t);
                                },
                            };
                        }
                        return t;
                    };
                })()
            ),
            (s.prototype = {
                getContainerElement: function () {
                    return this.containerElementId ? this.doc.getElementById(this.containerElementId) : d(this.doc);
                },
                getRange: function () {
                    return this.converter.characterRangeToRange(this.doc, this.characterRange, this.getContainerElement());
                },
                fromRange: function (e) {
                    this.characterRange = this.converter.rangeToCharacterRange(e, this.getContainerElement());
                },
                getText: function () {
                    return this.getRange().toString();
                },
                containsElement: function (e) {
                    return this.getRange().containsNodeContents(e.firstChild);
                },
                unapply: function () {
                    this.classApplier.undoToRange(this.getRange()), (this.applied = !1);
                },
                apply: function () {
                    this.classApplier.applyToRange(this.getRange()), (this.applied = !0);
                },
                getHighlightElements: function () {
                    return this.classApplier.getElementsWithClassIntersectingRange(this.getRange());
                },
                toString: function () {
                    return "[Highlight(ID: " + this.id + ", class: " + this.classApplier.cssClass + ", character range: " + this.characterRange.start + " - " + this.characterRange.end + ")]";
                },
            }),
            (l.prototype = {
                addClassApplier: function (e) {
                    this.classAppliers[e.cssClass] = e;
                },
                getHighlightForElement: function (e) {
                    for (var t = this.highlights, n = 0, r = t.length; n < r; ++n) if (t[n].containsElement(e)) return t[n];
                    return null;
                },
                removeHighlights: function (e) {
                    for (var t, n = 0, r = this.highlights.length; n < r; ++n) (t = this.highlights[n]), u(e, t) && (t.unapply(), this.highlights.splice(n--, 1));
                },
                removeAllHighlights: function () {
                    this.removeHighlights(this.highlights);
                },
                getIntersectingHighlights: function (e) {
                    var t = [],
                        n = this.highlights;
                    this.converter;
                    return (
                        f(e, function (e) {
                            f(n, function (n) {
                                e.intersectsRange(n.getRange()) && !u(t, n) && t.push(n);
                            });
                        }),
                        t
                    );
                },
                highlightCharacterRanges: function (t, n, r) {
                    var i,
                        o,
                        l,
                        c = this.highlights,
                        u = this.converter,
                        d = this.doc,
                        h = [],
                        p = this.classAppliers[t];
                    r = r || null;
                    var g, m, v;
                    r && ((g = this.doc.getElementById(r)), g && ((m = e.createRange(this.doc)), m.selectNodeContents(g), (v = new a(0, m.toString().length)), m.detach()));
                    var b, y, _;
                    for (i = 0, o = n.length; i < o; ++i) {
                        for (b = n[i], _ = !1, v && (b = b.intersection(v)), l = 0; l < c.length; ++l)
                            r == c[l].containerElementId && ((y = c[l].characterRange), y.intersects(b) && (h.push(c[l]), (c[l] = new s(d, y.union(b), p, u, null, r))));
                        _ || c.push(new s(d, b, p, u, null, r));
                    }
                    f(h, function (e) {
                        e.unapply();
                    });
                    var w = [];
                    return (
                        f(c, function (e) {
                            e.applied || (e.apply(), w.push(e));
                        }),
                        w
                    );
                },
                highlightRanges: function (t, n, r) {
                    var i,
                        o = [],
                        a = this.converter,
                        s = r ? r.id : null;
                    return (
                        r && ((i = e.createRange(r)), i.selectNodeContents(r)),
                        f(n, function (e) {
                            var t = r ? i.intersection(e) : e;
                            o.push(a.rangeToCharacterRange(t, r || d(e.getDocument())));
                        }),
                        this.highlightCharacterRanges(o, n, s)
                    );
                },
                highlightSelection: function (t, n, r) {
                    var i = this.converter;
                    n = n || e.getSelection();
                    var o = this.classAppliers[t],
                        s = n.win.document,
                        l = r ? s.getElementById(r) : d(s);
                    if (!o) throw new Error("No class applier found for class '" + t + "'");
                    var c = i.serializeSelection(n, l),
                        u = [];
                    f(c, function (e) {
                        u.push(a.fromCharacterRange(e.characterRange));
                    });
                    var h = this.highlightCharacterRanges(t, u, r);
                    return i.restoreSelection(n, c, l), h;
                },
                unhighlightSelection: function (t) {
                    t = t || e.getSelection();
                    var n = this.getIntersectingHighlights(t.getAllRanges());
                    return this.removeHighlights(n), t.removeAllRanges(), n;
                },
                getHighlightsInSelection: function (t) {
                    return (t = t || e.getSelection()), this.getIntersectingHighlights(t.getAllRanges());
                },
                selectionOverlapsHighlight: function (e) {
                    return this.getHighlightsInSelection(e).length > 0;
                },
                serialize: function (e) {
                    var t = this.highlights;
                    t.sort(n);
                    var r = ["type:" + this.converter.type];
                    return (
                        f(t, function (t) {
                            var n = t.characterRange,
                                i = [n.start, n.end, t.id, t.classApplier.cssClass, t.containerElementId];
                            e && e.serializeHighlightText && i.push(t.getText()), r.push(i.join("$"));
                        }),
                        r.join("|")
                    );
                },
                deserialize: function (e) {
                    var t,
                        n,
                        r,
                        i = e.split("|"),
                        l = [],
                        c = i[0],
                        u = !1;
                    if (!c || !(t = /^type:(\w+)$/.exec(c))) throw new Error("Serialized highlights are invalid.");
                    (n = t[1]), n != this.converter.type && ((r = o(n)), (u = !0)), i.shift();
                    for (var f, h, p, g, m, v, b = i.length; b-- > 0; )
                        (v = i[b].split("$")),
                            (p = new a(+v[0], +v[1])),
                            (g = v[4] || null),
                            (m = g ? this.doc.getElementById(g) : d(this.doc)),
                            u && (p = this.converter.rangeToCharacterRange(r.characterRangeToRange(this.doc, p, m), m)),
                            (f = this.classAppliers[v[3]]),
                            (h = new s(this.doc, p, f, this.converter, parseInt(v[2]), g)),
                            h.apply(),
                            l.push(h);
                    this.highlights = l;
                },
            }),
            (e.Highlighter = l),
            (e.createHighlighter = function (e, t) {
                return new l(e, t);
            });
    }),
    define("rangy-highlighter", ["rangy-core"], (function (e) {
        return function () {
            var t;
            return t || e.rangy.modules.Highlighter;
        };
    })(this)),
    rangy.createModule("ClassApplier", ["WrappedSelection"], function (e, t) {
        function n(e, t) {
            for (var n in e) if (e.hasOwnProperty(n) && t(n, e[n]) === !1) return !1;
            return !0;
        }
        function r(e) {
            return e.replace(/^\s\s*/, "").replace(/\s\s*$/, "");
        }
        function i(e, t) {
            return e.className && new RegExp("(?:^|\\s)" + t + "(?:\\s|$)").test(e.className);
        }
        function o(e, t) {
            e.className ? i(e, t) || (e.className += " " + t) : (e.className = t);
        }
        function a(e) {
            return e.split(/\s+/).sort().join(" ");
        }
        function s(e) {
            return a(e.className);
        }
        function l(e, t) {
            return s(e) == s(t);
        }
        function c(e, t, n, r, i) {
            var o = e.node,
                a = e.offset,
                s = o,
                l = a;
            o == r && a > i && ++l, o != t || (a != n && a != n + 1) || ((s = r), (l += i - n)), o == t && a > n + 1 && --l, (e.node = s), (e.offset = l);
        }
        function u(e, t, n) {
            e.node == t && e.offset > n && --e.offset;
        }
        function d(e, t, n, r) {
            n == -1 && (n = t.childNodes.length);
            for (var i, o = e.parentNode, a = A.getNodeIndex(e), s = 0; (i = r[s++]); ) c(i, o, a, t, n);
            t.childNodes.length == n ? t.appendChild(e) : t.insertBefore(e, t.childNodes[n]);
        }
        function f(e, t) {
            for (var n, r = e.parentNode, i = A.getNodeIndex(e), o = 0; (n = t[o++]); ) u(n, r, i);
            e.parentNode.removeChild(e);
        }
        function h(e, t, n, r, i) {
            for (var o, a = []; (o = e.firstChild); ) d(o, t, n++, i), a.push(o);
            return r && e.parentNode.removeChild(e), a;
        }
        function p(e, t) {
            return h(e, e.parentNode, A.getNodeIndex(e), !0, t);
        }
        function g(e, t) {
            var n = e.cloneRange();
            n.selectNodeContents(t);
            var r = n.intersection(e),
                i = r ? r.toString() : "";
            return n.detach(), "" != i;
        }
        function m(e) {
            for (var t, n = e.getNodes([3]), r = 0; (t = n[r]) && !g(e, t); ) ++r;
            for (var i = n.length - 1; (t = n[i]) && !g(e, t); ) --i;
            return n.slice(r, i + 1);
        }
        function v(e, t) {
            if (e.attributes.length != t.attributes.length) return !1;
            for (var n, r, i, o = 0, a = e.attributes.length; o < a; ++o)
                if (((n = e.attributes[o]), (i = n.name), "class" != i)) {
                    if (((r = t.attributes.getNamedItem(i)), (null === n) != (null === r))) return !1;
                    if (n.specified != r.specified) return !1;
                    if (n.specified && n.nodeValue !== r.nodeValue) return !1;
                }
            return !0;
        }
        function b(e, t) {
            for (var n, r = 0, i = e.attributes.length; r < i; ++r) if (((n = e.attributes[r].name), (!t || !M(t, n)) && e.attributes[r].specified && "class" != n)) return !0;
            return !1;
        }
        function y(e, t) {
            return (
                n(t, function (t, n) {
                    if ("object" == typeof n) {
                        if (!y(e[t], n)) return !1;
                    } else if (e[t] !== n) return !1;
                }),
                !0
            );
        }
        function _(e) {
            var t;
            return e && 1 == e.nodeType && (((t = e.parentNode) && 9 == t.nodeType && "on" == t.designMode) || (B(e) && !B(e.parentNode)));
        }
        function w(e) {
            return (B(e) || (1 != e.nodeType && B(e.parentNode))) && !_(e);
        }
        function x(e) {
            return e && 1 == e.nodeType && !j.test(U(e, "display"));
        }
        function E(e) {
            if (0 == e.data.length) return !0;
            if (z.test(e.data)) return !1;
            var t = U(e.parentNode, "whiteSpace");
            switch (t) {
                case "pre":
                case "pre-wrap":
                case "-moz-pre-wrap":
                    return !1;
                case "pre-line":
                    if (/[\r\n]/.test(e.data)) return !1;
            }
            return x(e.previousSibling) || x(e.nextSibling);
        }
        function C(e) {
            var t,
                n,
                r = [];
            for (t = 0; (n = e[t++]); ) r.push(new D(n.startContainer, n.startOffset), new D(n.endContainer, n.endOffset));
            return r;
        }
        function T(e, t) {
            for (var n, r, i, o = 0, a = e.length; o < a; ++o) (n = e[o]), (r = t[2 * o]), (i = t[2 * o + 1]), n.setStartAndEnd(r.node, r.offset, i.node, i.offset);
        }
        function S(e, t) {
            return A.isCharacterDataNode(e) ? (0 == t ? !!e.previousSibling : t != e.length || !!e.nextSibling) : t > 0 && t < e.childNodes.length;
        }
        function R(e, n, r, i) {
            var o,
                a,
                s = 0 == r;
            if (A.isAncestorOf(n, e)) return e;
            if (A.isCharacterDataNode(n)) {
                var l = A.getNodeIndex(n);
                if (0 == r) r = l;
                else {
                    if (r != n.length) throw t.createError("splitNodeAt() should not be called with offset in the middle of a data node (" + r + " in " + n.data);
                    r = l + 1;
                }
                n = n.parentNode;
            }
            if (S(n, r)) {
                (o = n.cloneNode(!1)), (a = n.parentNode), o.id && o.removeAttribute("id");
                for (var c, u = 0; (c = n.childNodes[r]); ) d(c, o, u++, i);
                return d(o, a, A.getNodeIndex(n) + 1, i), n == e ? o : R(e, a, A.getNodeIndex(o), i);
            }
            if (e != n) {
                o = n.parentNode;
                var f = A.getNodeIndex(n);
                return s || f++, R(e, o, f, i);
            }
            return e;
        }
        function I(e, t) {
            return e.tagName == t.tagName && l(e, t) && v(e, t) && "inline" == U(e, "display") && "inline" == U(t, "display");
        }
        function k(e) {
            var t = e ? "nextSibling" : "previousSibling";
            return function (n, r) {
                var i = n.parentNode,
                    o = n[t];
                if (o) {
                    if (o && 3 == o.nodeType) return o;
                } else if (r && ((o = i[t]), o && 1 == o.nodeType && I(i, o))) {
                    var a = o[e ? "firstChild" : "lastChild"];
                    if (a && 3 == a.nodeType) return a;
                }
                return null;
            };
        }
        function P(e) {
            (this.isElementMerge = 1 == e.nodeType), (this.textNodes = []);
            var t = this.isElementMerge ? e.lastChild : e;
            t && (this.textNodes[0] = t);
        }
        function N(e, t, i) {
            var o,
                a,
                s,
                l,
                c = this;
            c.cssClass = e;
            var u = null,
                d = {};
            if ("object" == typeof t && null !== t) {
                for (i = t.tagNames, u = t.elementProperties, d = t.elementAttributes, a = 0; (l = $[a++]); ) t.hasOwnProperty(l) && (c[l] = t[l]);
                o = t.normalize;
            } else o = t;
            (c.normalize = "undefined" == typeof o || o), (c.attrExceptions = []);
            var f = document.createElementNS("http://www.w3.org/1999/xhtml", c.elementTagName);
            (c.elementProperties = c.copyPropertiesToElement(u, f, !0)),
                n(d, function (e) {
                    c.attrExceptions.push(e);
                }),
                (c.elementAttributes = d),
                (c.elementSortedClassName = c.elementProperties.hasOwnProperty("className") ? c.elementProperties.className : e),
                (c.applyToAnyTagName = !1);
            var h = typeof i;
            if ("string" == h) "*" == i ? (c.applyToAnyTagName = !0) : (c.tagNames = r(i.toLowerCase()).split(/\s*,\s*/));
            else if ("object" == h && "number" == typeof i.length) for (c.tagNames = [], a = 0, s = i.length; a < s; ++a) "*" == i[a] ? (c.applyToAnyTagName = !0) : c.tagNames.push(i[a].toLowerCase());
            else c.tagNames = [c.elementTagName];
        }
        function O(e, t, n) {
            return new N(e, t, n);
        }
        var A = e.dom,
            D = A.DomPosition,
            M = A.arrayContains,
            F = "span",
            L = (function () {
                function e(e, t, n) {
                    return t && n ? " " : "";
                }
                return function (t, n) {
                    t.className && (t.className = t.className.replace(new RegExp("(^|\\s)" + n + "(\\s|$)"), e));
                };
            })(),
            U = A.getComputedStyleProperty,
            B = (function () {
                var e = document.createElementNS("http://www.w3.org/1999/xhtml", "div");
                return "boolean" == typeof e.isContentEditable
                    ? function (e) {
                          return e && 1 == e.nodeType && e.isContentEditable;
                      }
                    : function (e) {
                          return !(!e || 1 != e.nodeType || "false" == e.contentEditable) && ("true" == e.contentEditable || B(e.parentNode));
                      };
            })(),
            j = /^inline(-block|-table)?$/i,
            z = /[^\r\n\t\f \u200B]/,
            V = k(!1),
            H = k(!0);
        P.prototype = {
            doMerge: function (e) {
                var t = this.textNodes,
                    n = t[0];
                if (t.length > 1) {
                    for (var r, i, o, a, s = [], l = 0, c = 0, u = t.length; c < u; ++c) {
                        if (((r = t[c]), (i = r.parentNode), c > 0 && (i.removeChild(r), i.hasChildNodes() || i.parentNode.removeChild(i), e))) for (o = 0; (a = e[o++]); ) a.node == r && ((a.node = n), (a.offset += l));
                        (s[c] = r.data), (l += r.data.length);
                    }
                    n.data = s.join("");
                }
                return n.data;
            },
            getLength: function () {
                for (var e = this.textNodes.length, t = 0; e--; ) t += this.textNodes[e].length;
                return t;
            },
            toString: function () {
                for (var e = [], t = 0, n = this.textNodes.length; t < n; ++t) e[t] = "'" + this.textNodes[t].data + "'";
                return "[Merge(" + e.join(",") + ")]";
            },
        };
        var $ = ["elementTagName", "ignoreWhiteSpace", "applyToEditableOnly", "useExistingElements", "removeEmptyElements", "onElementCreate"],
            W = {};
        (N.prototype = {
            elementTagName: F,
            elementProperties: {},
            elementAttributes: {},
            ignoreWhiteSpace: !0,
            applyToEditableOnly: !1,
            useExistingElements: !0,
            removeEmptyElements: !0,
            onElementCreate: null,
            copyPropertiesToElement: function (e, t, n) {
                var r,
                    i,
                    s,
                    l,
                    c,
                    u,
                    d = {};
                for (var f in e)
                    if (e.hasOwnProperty(f))
                        if (((l = e[f]), (c = t[f]), "className" == f)) o(t, l), o(t, this.cssClass), (t[f] = a(t[f])), n && (d[f] = t[f]);
                        else if ("style" == f) {
                            (i = c), n && (d[f] = s = {});
                            for (r in e[f]) (i[r] = l[r]), n && (s[r] = i[r]);
                            this.attrExceptions.push(f);
                        } else (t[f] = l), n && ((d[f] = t[f]), (u = W.hasOwnProperty(f) ? W[f] : f), this.attrExceptions.push(u));
                return n ? d : "";
            },
            copyAttributesToElement: function (e, t) {
                for (var n in e) e.hasOwnProperty(n) && t.setAttribute(n, e[n]);
            },
            hasClass: function (e) {
                return 1 == e.nodeType && M(this.tagNames, e.tagName.toLowerCase()) && i(e, this.cssClass);
            },
            getSelfOrAncestorWithClass: function (e) {
                for (; e; ) {
                    if (this.hasClass(e)) return e;
                    e = e.parentNode;
                }
                return null;
            },
            isModifiable: function (e) {
                return !this.applyToEditableOnly || w(e);
            },
            isIgnorableWhiteSpaceNode: function (e) {
                return this.ignoreWhiteSpace && e && 3 == e.nodeType && E(e);
            },
            postApply: function (e, t, n, r) {
                for (var i, o, a, s = e[0], l = e[e.length - 1], c = [], u = s, d = l, f = 0, h = l.length, p = 0, g = e.length; p < g; ++p)
                    (o = e[p]), (a = V(o, !r)), a ? (i || ((i = new P(a)), c.push(i)), i.textNodes.push(o), o === s && ((u = i.textNodes[0]), (f = u.length)), o === l && ((d = i.textNodes[0]), (h = i.getLength()))) : (i = null);
                var m = H(l, !r);
                if ((m && (i || ((i = new P(l)), c.push(i)), i.textNodes.push(m)), c.length)) {
                    for (p = 0, g = c.length; p < g; ++p) c[p].doMerge(n);
                    t.setStartAndEnd(u, f, d, h);
                }
            },
            createContainer: function (e) {
                var t = e.createElementNS("http://www.w3.org/1999/xhtml", this.elementTagName);
                return this.copyPropertiesToElement(this.elementProperties, t, !1), this.copyAttributesToElement(this.elementAttributes, t), o(t, this.cssClass), this.onElementCreate && this.onElementCreate(t, this), t;
            },
            applyToTextNode: function (e, t) {
                var n = e.parentNode;
                if (1 == n.childNodes.length && this.useExistingElements && M(this.tagNames, n.tagName.toLowerCase()) && y(n, this.elementProperties)) o(n, this.cssClass);
                else {
                    var r = this.createContainer(A.getDocument(e));
                    e.parentNode.insertBefore(r, e), r.appendChild(e);
                }
            },
            isRemovable: function (e) {
                return e.tagName.toLowerCase() == this.elementTagName && s(e) == this.elementSortedClassName && y(e, this.elementProperties) && !b(e, this.attrExceptions) && this.isModifiable(e);
            },
            isEmptyContainer: function (e) {
                var t = e.childNodes.length;
                return 1 == e.nodeType && this.isRemovable(e) && (0 == t || (1 == t && this.isEmptyContainer(e.firstChild)));
            },
            removeEmptyContainers: function (e) {
                for (
                    var t,
                        n = this,
                        r = e.getNodes([1], function (e) {
                            return n.isEmptyContainer(e);
                        }),
                        i = [e],
                        o = C(i),
                        a = 0;
                    (t = r[a++]);

                )
                    f(t, o);
                T(i, o);
            },
            undoToTextNode: function (e, t, n, r) {
                if (!t.containsNode(n)) {
                    var i = t.cloneRange();
                    i.selectNode(n),
                        i.isPointInRange(t.endContainer, t.endOffset) && (R(n, t.endContainer, t.endOffset, r), t.setEndAfter(n)),
                        i.isPointInRange(t.startContainer, t.startOffset) && (n = R(n, t.startContainer, t.startOffset, r));
                }
                this.isRemovable(n) ? p(n, r) : L(n, this.cssClass);
            },
            applyToRange: function (e, t) {
                t = t || [];
                var n = C(t || []);
                e.splitBoundariesPreservingPositions(n), this.removeEmptyElements && this.removeEmptyContainers(e);
                var r = m(e);
                if (r.length) {
                    for (var i, o = 0; (i = r[o++]); ) this.isIgnorableWhiteSpaceNode(i) || this.getSelfOrAncestorWithClass(i) || !this.isModifiable(i) || this.applyToTextNode(i, n);
                    (i = r[r.length - 1]), e.setStartAndEnd(r[0], 0, i, i.length), this.normalize && this.postApply(r, e, n, !1), T(t, n);
                }
            },
            applyToRanges: function (e) {
                for (var t = e.length; t--; ) this.applyToRange(e[t], e);
                return e;
            },
            applyToSelection: function (t) {
                var n = e.getSelection(t);
                n.setRanges(this.applyToRanges(n.getAllRanges()));
            },
            undoToRange: function (e, t) {
                t = t || [];
                var n = C(t);
                e.splitBoundariesPreservingPositions(n), this.removeEmptyElements && this.removeEmptyContainers(e, n);
                var r,
                    i,
                    o = m(e),
                    a = o[o.length - 1];
                if (o.length) {
                    for (var s = 0, l = o.length; s < l; ++s) (r = o[s]), (i = this.getSelfOrAncestorWithClass(r)), i && this.isModifiable(r) && this.undoToTextNode(r, e, i, n), e.setStartAndEnd(o[0], 0, a, a.length);
                    this.normalize && this.postApply(o, e, n, !0), T(t, n);
                }
            },
            undoToRanges: function (e) {
                for (var t = e.length; t--; ) this.undoToRange(e[t], e);
                return e;
            },
            undoToSelection: function (t) {
                var n = e.getSelection(t),
                    r = e.getSelection(t).getAllRanges();
                this.undoToRanges(r), n.setRanges(r);
            },
            isAppliedToRange: function (e) {
                if (e.collapsed || "" == e.toString()) return !!this.getSelfOrAncestorWithClass(e.commonAncestorContainer);
                var t = e.getNodes([3]);
                if (t.length) for (var n, r = 0; (n = t[r++]); ) if (!this.isIgnorableWhiteSpaceNode(n) && g(e, n) && this.isModifiable(n) && !this.getSelfOrAncestorWithClass(n)) return !1;
                return !0;
            },
            isAppliedToRanges: function (e) {
                var t = e.length;
                if (0 == t) return !1;
                for (; t--; ) if (!this.isAppliedToRange(e[t])) return !1;
                return !0;
            },
            isAppliedToSelection: function (t) {
                var n = e.getSelection(t);
                return this.isAppliedToRanges(n.getAllRanges());
            },
            toggleRange: function (e) {
                this.isAppliedToRange(e) ? this.undoToRange(e) : this.applyToRange(e);
            },
            toggleSelection: function (e) {
                this.isAppliedToSelection(e) ? this.undoToSelection(e) : this.applyToSelection(e);
            },
            getElementsWithClassIntersectingRange: function (e) {
                var t = [],
                    n = this;
                return (
                    e.getNodes([3], function (e) {
                        var r = n.getSelfOrAncestorWithClass(e);
                        r && !M(t, r) && t.push(r);
                    }),
                    t
                );
            },
            detach: function () {},
        }),
            (N.util = {
                hasClass: i,
                addClass: o,
                removeClass: L,
                hasSameClasses: l,
                replaceWithOwnChildren: p,
                elementsHaveSameNonClassAttributes: v,
                elementHasNonClassAttributes: b,
                splitNodeAt: R,
                isEditableElement: B,
                isEditingHost: _,
                isEditable: w,
            }),
            (e.CssClassApplier = e.ClassApplier = N),
            (e.createCssClassApplier = e.createClassApplier = O);
    }),
    define("rangy-cssclassapplier", ["rangy-core"], (function (e) {
        return function () {
            var t;
            return t || e.rangy.modules.ClassApplier;
        };
    })(this)),
    rangy.createModule("TextRange", ["WrappedSelection"], function (e, t) {
        function n(e, t) {
            function n(t, n, r) {
                for (
                    var i = e.slice(t, n),
                        o = {
                            isWord: r,
                            chars: i,
                            toString: function () {
                                return i.join("");
                            },
                        },
                        a = 0,
                        l = i.length;
                    a < l;
                    ++a
                )
                    i[a].token = o;
                s.push(o);
            }
            for (var r, i, o, a = e.join(""), s = [], l = 0; (r = t.wordRegex.exec(a)); ) {
                if (((i = r.index), (o = i + r[0].length), i > l && n(l, i, !1), t.includeTrailingSpace)) for (; K.test(e[o]); ) ++o;
                n(i, o, !0), (l = o);
            }
            return l < e.length && n(l, e.length, !1), s;
        }
        function r(e, t) {
            if (e) {
                var n = {};
                return $(n, t), $(n, e), n;
            }
            return t;
        }
        function i(e) {
            var t, n;
            return e ? ((t = e.language || X), (n = {}), $(n, oe[t] || oe[X]), $(n, e), n) : oe[X];
        }
        function o(e) {
            return r(e, re);
        }
        function a(e) {
            return r(e, ie);
        }
        function s(e, t) {
            var n = ue(e, "display", t),
                r = e.tagName.toLowerCase();
            return "block" == n && ne && de.hasOwnProperty(r) ? de[r] : n;
        }
        function l(e) {
            for (var t = h(e), n = 0, r = t.length; n < r; ++n) if (1 == t[n].nodeType && "none" == s(t[n])) return !0;
            return !1;
        }
        function c(e) {
            var t;
            return 3 == e.nodeType && (t = e.parentNode) && "hidden" == ue(t, "visibility");
        }
        function u(e) {
            return e && ((1 == e.nodeType && !/^(inline(-block|-table)?|none)$/.test(s(e))) || 9 == e.nodeType || 11 == e.nodeType);
        }
        function d(e) {
            return V.isCharacterDataNode(e) || !/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(e.nodeName);
        }
        function f(e) {
            for (var t = []; e.parentNode; ) t.unshift(e.parentNode), (e = e.parentNode);
            return t;
        }
        function h(e) {
            return f(e).concat([e]);
        }
        function p(e) {
            for (; e && !e.nextSibling; ) e = e.parentNode;
            return e ? e.nextSibling : null;
        }
        function g(e, t) {
            return !t && e.hasChildNodes() ? e.firstChild : p(e);
        }
        function m(e) {
            var t = e.previousSibling;
            if (t) {
                for (e = t; e.hasChildNodes(); ) e = e.lastChild;
                return e;
            }
            var n = e.parentNode;
            return n && 1 == n.nodeType ? n : null;
        }
        function v(e) {
            if (!e || 3 != e.nodeType) return !1;
            var t = e.data;
            if ("" === t) return !0;
            var n = e.parentNode;
            if (!n || 1 != n.nodeType) return !1;
            var r = ue(e.parentNode, "whiteSpace");
            return (/^[\t\n\r ]+$/.test(t) && /^(normal|nowrap)$/.test(r)) || (/^[\t\r ]+$/.test(t) && "pre-line" == r);
        }
        function b(e) {
            if ("" === e.data) return !0;
            if (!v(e)) return !1;
            var t = e.parentNode;
            return !t || !!l(e);
        }
        function y(e) {
            var t = e.nodeType;
            return 7 == t || 8 == t || l(e) || /^(script|style)$/i.test(e.nodeName) || c(e) || b(e);
        }
        function _(e, t) {
            var n = e.nodeType;
            return 7 == n || 8 == n || (1 == n && "none" == s(e, t));
        }
        function w() {
            this.store = {};
        }
        function x(e, t, n) {
            return function (r) {
                var i = this.cache;
                if (i.hasOwnProperty(e)) return fe++, i[e];
                he++;
                var o = t.call(this, n ? this[n] : this, r);
                return (i[e] = o), o;
            };
        }
        function E(e, t) {
            (this.node = e), (this.session = t), (this.cache = new w()), (this.positions = new w());
        }
        function C(e, t) {
            (this.offset = t), (this.nodeWrapper = e), (this.node = e.node), (this.session = e.session), (this.cache = new w());
        }
        function T() {
            return "[Position(" + V.inspectNode(this.node) + ":" + this.offset + ")]";
        }
        function S() {
            return I(), (Te = new Se());
        }
        function R() {
            return Te || S();
        }
        function I() {
            Te && Te.detach(), (Te = null);
        }
        function k(e, n, r, i) {
            function o() {
                var e = null;
                return n ? ((e = s), l || ((s = s.previousVisible()), (l = !s || (r && s.equals(r))))) : l || ((e = s = s.nextVisible()), (l = !s || (r && s.equals(r)))), l && (s = null), e;
            }
            r && (n ? y(r.node) && (r = e.previousVisible()) : y(r.node) && (r = r.nextVisible()));
            var a,
                s = e,
                l = !1,
                c = !1;
            return {
                next: function () {
                    if (c) return (c = !1), a;
                    for (var e, t; (e = o()); ) if ((t = e.getCharacter(i))) return (a = e), e;
                    return null;
                },
                rewind: function () {
                    if (!a) throw t.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");
                    c = !0;
                },
                dispose: function () {
                    e = r = null;
                },
            };
        }
        function P(e, t, n) {
            function r(e) {
                for (var t, n, r = [], a = e ? i : o, s = !1, l = !1; (t = a.next()); ) {
                    if (((n = t.character), J.test(n))) l && ((l = !1), (s = !0));
                    else {
                        if (s) {
                            a.rewind();
                            break;
                        }
                        l = !0;
                    }
                    r.push(t);
                }
                return r;
            }
            var i = k(e, !1, null, t),
                o = k(e, !0, null, t),
                a = n.tokenizer,
                s = r(!0),
                l = r(!1).reverse(),
                c = a(l.concat(s), n),
                u = s.length ? c.slice(Re(c, s[0].token)) : [],
                d = l.length ? c.slice(0, Re(c, l.pop().token) + 1) : [];
            return {
                nextEndToken: function () {
                    for (var e, t; 1 == u.length && !(e = u[0]).isWord && (t = r(!0)).length > 0; ) u = a(e.chars.concat(t), n);
                    return u.shift();
                },
                previousStartToken: function () {
                    for (var e, t; 1 == d.length && !(e = d[0]).isWord && (t = r(!1)).length > 0; ) d = a(t.reverse().concat(e.chars), n);
                    return d.pop();
                },
                dispose: function () {
                    i.dispose(), o.dispose(), (u = d = null);
                },
            };
        }
        function N(e, t, n, r, i) {
            var o,
                a,
                s,
                l,
                c = 0,
                u = e,
                d = Math.abs(n);
            if (0 !== n) {
                var f = n < 0;
                switch (t) {
                    case j:
                        for (a = k(e, f, null, r); (o = a.next()) && c < d; ) ++c, (u = o);
                        (s = o), a.dispose();
                        break;
                    case z:
                        for (var h = P(e, r, i), p = f ? h.previousStartToken : h.nextEndToken; (l = p()) && c < d; ) l.isWord && (++c, (u = f ? l.chars[0] : l.chars[l.chars.length - 1]));
                        break;
                    default:
                        throw new Error("movePositionBy: unit '" + t + "' not implemented");
                }
                f ? ((u = u.previousVisible()), (c = -c)) : u && u.isLeadingSpace && (t == z && ((a = k(e, !1, null, r)), (s = a.next()), a.dispose()), s && (u = s.previousVisible()));
            }
            return { position: u, unitsMoved: c };
        }
        function O(e, t, n, r) {
            var i = e.getRangeBoundaryPosition(t, !0),
                o = e.getRangeBoundaryPosition(t, !1),
                a = r ? o : i,
                s = r ? i : o;
            return k(a, !!r, s, n);
        }
        function A(e, t, n) {
            for (var r, i = [], o = O(e, t, n); (r = o.next()); ) i.push(r);
            return o.dispose(), i;
        }
        function D(t, n, r) {
            var i = e.createRange(t.node);
            i.setStartAndEnd(t.node, t.offset, n.node, n.offset);
            var o = !i.expand("word", r);
            return i.detach(), o;
        }
        function M(e, t, n, r, i) {
            function o(e, t) {
                var n = g[e].previousVisible(),
                    r = g[t - 1],
                    o = !i.wholeWordsOnly || D(n, r, i.wordOptions);
                return { startPos: n, endPos: r, valid: o };
            }
            for (var a, s, l, c, u, d, f = Q(i.direction), h = k(e, f, e.session.getRangeBoundaryPosition(r, f), i), p = "", g = [], m = null; (a = h.next()); )
                if (((s = a.character), n || i.caseSensitive || (s = s.toLowerCase()), f ? (g.unshift(a), (p = s + p)) : (g.push(a), (p += s)), n)) {
                    if ((u = t.exec(p)))
                        if (d) {
                            if (((l = u.index), (c = l + u[0].length), (!f && c < p.length) || (f && l > 0))) {
                                m = o(l, c);
                                break;
                            }
                        } else d = !0;
                } else if ((l = p.indexOf(t)) != -1) {
                    m = o(l, l + t.length);
                    break;
                }
            return d && (m = o(l, c)), h.dispose(), m;
        }
        function F(e) {
            return function () {
                var t = !!Te,
                    n = R(),
                    r = [n].concat(H.toArray(arguments)),
                    i = e.apply(this, r);
                return t || I(), i;
            };
        }
        function L(e, t) {
            return F(function (n, a, s, l) {
                "undefined" == typeof s && ((s = a), (a = j)), (l = r(l, se));
                var c = o(l.characterOptions),
                    u = i(l.wordOptions),
                    d = e;
                t && ((d = s >= 0), this.collapse(!d));
                var f = N(n.getRangeBoundaryPosition(this, d), a, s, c, u),
                    h = f.position;
                return this[d ? "setStart" : "setEnd"](h.node, h.offset), f.unitsMoved;
            });
        }
        function U(e) {
            return F(function (t, n) {
                n = o(n);
                for (var r, i = O(t, this, n, !e), a = 0; (r = i.next()) && J.test(r.character); ) ++a;
                i.dispose();
                var s = a > 0;
                return s && this[e ? "moveStart" : "moveEnd"]("character", e ? a : -a, { characterOptions: n }), s;
            });
        }
        function B(e) {
            return F(function (t, n) {
                var r = !1;
                return (
                    this.changeEachRange(function (t) {
                        r = t[e](n) || r;
                    }),
                    r
                );
            });
        }
        var j = "character",
            z = "word",
            V = e.dom,
            H = e.util,
            $ = H.extend,
            W = V.getBody,
            q = /^[ \t\f\r\n]+$/,
            G = /^[ \t\f\r]+$/,
            J = /^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,
            K = /^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,
            X = "en",
            Q = e.Selection.isDirectionBackward,
            Y = !1,
            Z = !1,
            ee = !1,
            te = !0;
        !(function () {
            var t = document.createElementNS("http://www.w3.org/1999/xhtml", "div");
            (t.contentEditable = "true"), (t.innerHTML = "<p>1 </p><p></p>");
            var n = W(document),
                r = t.firstChild,
                i = e.getSelection();
            n.appendChild(t),
                i.collapse(r.lastChild, 2),
                i.setStart(r.firstChild, 0),
                (Y = 1 == ("" + i).length),
                (t.innerHTML = "1 <br>"),
                i.collapse(t, 2),
                i.setStart(t.firstChild, 0),
                (Z = 1 == ("" + i).length),
                (t.innerHTML = "1 <p>1</p>"),
                i.collapse(t, 2),
                i.setStart(t.firstChild, 0),
                (ee = 1 == ("" + i).length),
                n.removeChild(t),
                i.removeAllRanges();
        })();
        var ne,
            re = { includeBlockContentTrailingSpace: !0, includeSpaceBeforeBr: !0, includeSpaceBeforeBlock: !0, includePreLineTrailingSpace: !0 },
            ie = { includeBlockContentTrailingSpace: !te, includeSpaceBeforeBr: !Z, includeSpaceBeforeBlock: !ee, includePreLineTrailingSpace: !0 },
            oe = { en: { wordRegex: /[a-z0-9]+('[a-z0-9]+)*/gi, includeTrailingSpace: !1, tokenizer: n } },
            ae = { caseSensitive: !1, withinRange: null, wholeWordsOnly: !1, wrap: !1, direction: "forward", wordOptions: null, characterOptions: null },
            se = { wordOptions: null, characterOptions: null },
            le = { wordOptions: null, characterOptions: null, trim: !1, trimStart: !0, trimEnd: !0 },
            ce = { wordOptions: null, characterOptions: null, direction: "forward" },
            ue = V.getComputedStyleProperty;
        !(function () {
            var e = document.createElementNS("http://www.w3.org/1999/xhtml", "table"),
                t = W(document);
            t.appendChild(e), (ne = "block" == ue(e, "display")), t.removeChild(e);
        })(),
            (e.features.tableCssDisplayBlock = ne);
        var de = {
            table: "table",
            caption: "table-caption",
            colgroup: "table-column-group",
            col: "table-column",
            thead: "table-header-group",
            tbody: "table-row-group",
            tfoot: "table-footer-group",
            tr: "table-row",
            td: "table-cell",
            th: "table-cell",
        };
        w.prototype = {
            get: function (e) {
                return this.store.hasOwnProperty(e) ? this.store[e] : null;
            },
            set: function (e, t) {
                return (this.store[e] = t);
            },
        };
        var fe = 0,
            he = 0,
            pe = {
                getPosition: function (e) {
                    var t = this.positions;
                    return t.get(e) || t.set(e, new C(this, e));
                },
                toString: function () {
                    return "[NodeWrapper(" + V.inspectNode(this.node) + ")]";
                },
            };
        E.prototype = pe;
        var ge = "EMPTY",
            me = "NON_SPACE",
            ve = "UNCOLLAPSIBLE_SPACE",
            be = "COLLAPSIBLE_SPACE",
            ye = "TRAILING_SPACE_BEFORE_BLOCK",
            _e = "TRAILING_SPACE_IN_BLOCK",
            we = "TRAILING_SPACE_BEFORE_BR",
            xe = "PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK",
            Ee = "TRAILING_LINE_BREAK_AFTER_BR";
        $(pe, {
            isCharacterDataNode: x("isCharacterDataNode", V.isCharacterDataNode, "node"),
            getNodeIndex: x("nodeIndex", V.getNodeIndex, "node"),
            getLength: x("nodeLength", V.getNodeLength, "node"),
            containsPositions: x("containsPositions", d, "node"),
            isWhitespace: x("isWhitespace", v, "node"),
            isCollapsedWhitespace: x("isCollapsedWhitespace", b, "node"),
            getComputedDisplay: x("computedDisplay", s, "node"),
            isCollapsed: x("collapsed", y, "node"),
            isIgnored: x("ignored", _, "node"),
            next: x("nextPos", g, "node"),
            previous: x("previous", m, "node"),
            getTextNodeInfo: x(
                "textNodeInfo",
                function (e) {
                    var t = null,
                        n = !1,
                        r = ue(e.parentNode, "whiteSpace"),
                        i = "pre-line" == r;
                    return i ? ((t = G), (n = !0)) : ("normal" != r && "nowrap" != r) || ((t = q), (n = !0)), { node: e, text: e.data, spaceRegex: t, collapseSpaces: n, preLine: i };
                },
                "node"
            ),
            hasInnerText: x(
                "hasInnerText",
                function (e, t) {
                    for (var n = this.session, r = n.getPosition(e.parentNode, this.getNodeIndex() + 1), i = n.getPosition(e, 0), o = t ? r : i, a = t ? i : r; o !== a; ) {
                        if ((o.prepopulateChar(), o.isDefinitelyNonEmpty())) return !0;
                        o = t ? o.previousVisible() : o.nextVisible();
                    }
                    return !1;
                },
                "node"
            ),
            isRenderedBlock: x(
                "isRenderedBlock",
                function (e) {
                    for (var t = e.getElementsByTagName("br"), n = 0, r = t.length; n < r; ++n) if (!y(t[n])) return !0;
                    return this.hasInnerText();
                },
                "node"
            ),
            getTrailingSpace: x(
                "trailingSpace",
                function (e) {
                    if ("br" == e.tagName.toLowerCase()) return "";
                    switch (this.getComputedDisplay()) {
                        case "inline":
                            for (var t = e.lastChild; t; ) {
                                if (!_(t)) return 1 == t.nodeType ? this.session.getNodeWrapper(t).getTrailingSpace() : "";
                                t = t.previousSibling;
                            }
                            break;
                        case "inline-block":
                        case "inline-table":
                        case "none":
                        case "table-column":
                        case "table-column-group":
                            break;
                        case "table-cell":
                            return "\t";
                        default:
                            return this.isRenderedBlock(!0) ? "\n" : "";
                    }
                    return "";
                },
                "node"
            ),
            getLeadingSpace: x(
                "leadingSpace",
                function (e) {
                    switch (this.getComputedDisplay()) {
                        case "inline":
                        case "inline-block":
                        case "inline-table":
                        case "none":
                        case "table-column":
                        case "table-column-group":
                        case "table-cell":
                            break;
                        default:
                            return this.isRenderedBlock(!1) ? "\n" : "";
                    }
                    return "";
                },
                "node"
            ),
        });
        var Ce = {
            character: "",
            characterType: ge,
            isBr: !1,
            prepopulateChar: function () {
                var e = this;
                if (!e.prepopulatedChar) {
                    var t = e.node,
                        n = e.offset,
                        r = "",
                        i = ge,
                        o = !1;
                    if (n > 0)
                        if (3 == t.nodeType) {
                            var a = t.data,
                                s = a.charAt(n - 1),
                                l = e.nodeWrapper.getTextNodeInfo(),
                                c = l.spaceRegex;
                            l.collapseSpaces
                                ? c.test(s)
                                    ? (n > 1 && c.test(a.charAt(n - 2))) || (l.preLine && "\n" === a.charAt(n) ? ((r = " "), (i = xe)) : ((r = " "), (i = be)))
                                    : ((r = s), (i = me), (o = !0))
                                : ((r = s), (i = ve), (o = !0));
                        } else {
                            var u = t.childNodes[n - 1];
                            if ((u && 1 == u.nodeType && !y(u) && ("br" == u.tagName.toLowerCase() ? ((r = "\n"), (e.isBr = !0), (i = be), (o = !1)) : (e.checkForTrailingSpace = !0)), !r)) {
                                var d = t.childNodes[n];
                                d && 1 == d.nodeType && !y(d) && (e.checkForLeadingSpace = !0);
                            }
                        }
                    (e.prepopulatedChar = !0), (e.character = r), (e.characterType = i), (e.isCharInvariant = o);
                }
            },
            isDefinitelyNonEmpty: function () {
                var e = this.characterType;
                return e == me || e == ve;
            },
            resolveLeadingAndTrailingSpaces: function () {
                if ((this.prepopulatedChar || this.prepopulateChar(), this.checkForTrailingSpace)) {
                    var e = this.session.getNodeWrapper(this.node.childNodes[this.offset - 1]).getTrailingSpace();
                    e && ((this.isTrailingSpace = !0), (this.character = e), (this.characterType = be)), (this.checkForTrailingSpace = !1);
                }
                if (this.checkForLeadingSpace) {
                    var t = this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();
                    t && ((this.isLeadingSpace = !0), (this.character = t), (this.characterType = be)), (this.checkForLeadingSpace = !1);
                }
            },
            getPrecedingUncollapsedPosition: function (e) {
                for (var t, n = this; (n = n.previousVisible()); ) if (((t = n.getCharacter(e)), "" !== t)) return n;
                return null;
            },
            getCharacter: function (e) {
                function t() {
                    return l || ((o = c.getPrecedingUncollapsedPosition(e)), (l = !0)), o;
                }
                if ((this.resolveLeadingAndTrailingSpaces(), this.isCharInvariant)) return this.character;
                var n = ["character", e.includeSpaceBeforeBr, e.includeBlockContentTrailingSpace, e.includePreLineTrailingSpace].join("_"),
                    r = this.cache.get(n);
                if (null !== r) return r;
                var i,
                    o,
                    a = "",
                    s = this.characterType == be,
                    l = !1,
                    c = this;
                return (
                    s
                        ? (" " != this.character || (t() && !o.isTrailingSpace && "\n" != o.character)) &&
                          ("\n" == this.character && this.isLeadingSpace
                              ? t() && "\n" != o.character && (a = "\n")
                              : ((i = this.nextUncollapsed()),
                                i &&
                                    (i.isBr ? (this.type = we) : i.isTrailingSpace && "\n" == i.character ? (this.type = _e) : i.isLeadingSpace && "\n" == i.character && (this.type = ye),
                                    "\n" === i.character
                                        ? (this.type != we || e.includeSpaceBeforeBr) &&
                                          (this.type != ye || e.includeSpaceBeforeBlock) &&
                                          ((this.type == _e && i.isTrailingSpace && !e.includeBlockContentTrailingSpace) ||
                                              ((this.type != xe || i.type != me || e.includePreLineTrailingSpace) &&
                                                  ("\n" === this.character
                                                      ? i.isTrailingSpace
                                                          ? this.isTrailingSpace || (this.isBr && ((i.type = Ee), t() && o.isLeadingSpace && "\n" == o.character && (i.character = "")))
                                                          : (a = "\n")
                                                      : " " === this.character && (a = " "))))
                                        : (a = this.character))))
                        : "\n" === this.character && (!(i = this.nextUncollapsed()) || i.isTrailingSpace),
                    this.cache.set(n, a),
                    a
                );
            },
            equals: function (e) {
                return !!e && this.node === e.node && this.offset === e.offset;
            },
            inspect: T,
            toString: function () {
                return this.character;
            },
        };
        (C.prototype = Ce),
            $(Ce, {
                next: x("nextPos", function (e) {
                    var t = e.nodeWrapper,
                        n = e.node,
                        r = e.offset,
                        i = t.session;
                    if (!n) return null;
                    var o, a, s;
                    return (
                        r == t.getLength()
                            ? ((o = n.parentNode), (a = o ? t.getNodeIndex() + 1 : 0))
                            : t.isCharacterDataNode()
                            ? ((o = n), (a = r + 1))
                            : ((s = n.childNodes[r]), i.getNodeWrapper(s).containsPositions() ? ((o = s), (a = 0)) : ((o = n), (a = r + 1))),
                        o ? i.getPosition(o, a) : null
                    );
                }),
                previous: x("previous", function (e) {
                    var t,
                        n,
                        r,
                        i = e.nodeWrapper,
                        o = e.node,
                        a = e.offset,
                        s = i.session;
                    return (
                        0 == a
                            ? ((t = o.parentNode), (n = t ? i.getNodeIndex() : 0))
                            : i.isCharacterDataNode()
                            ? ((t = o), (n = a - 1))
                            : ((r = o.childNodes[a - 1]), s.getNodeWrapper(r).containsPositions() ? ((t = r), (n = V.getNodeLength(r))) : ((t = o), (n = a - 1))),
                        t ? s.getPosition(t, n) : null
                    );
                }),
                nextVisible: x("nextVisible", function (e) {
                    var t = e.next();
                    if (!t) return null;
                    var n = t.nodeWrapper,
                        r = t.node,
                        i = t;
                    return n.isCollapsed() && (i = n.session.getPosition(r.parentNode, n.getNodeIndex() + 1)), i;
                }),
                nextUncollapsed: x("nextUncollapsed", function (e) {
                    for (var t = e; (t = t.nextVisible()); ) if ((t.resolveLeadingAndTrailingSpaces(), "" !== t.character)) return t;
                    return null;
                }),
                previousVisible: x("previousVisible", function (e) {
                    var t = e.previous();
                    if (!t) return null;
                    var n = t.nodeWrapper,
                        r = t.node,
                        i = t;
                    return n.isCollapsed() && (i = n.session.getPosition(r.parentNode, n.getNodeIndex())), i;
                }),
            });
        var Te = null,
            Se = (function () {
                function e(e) {
                    var t = new w();
                    return {
                        get: function (n) {
                            var r = t.get(n[e]);
                            if (r) for (var i, o = 0; (i = r[o++]); ) if (i.node === n) return i;
                            return null;
                        },
                        set: function (n) {
                            var r = n.node[e],
                                i = t.get(r) || t.set(r, []);
                            i.push(n);
                        },
                    };
                }
                function t() {
                    this.initCaches();
                }
                var n = H.isHostProperty(document.documentElement, "uniqueID");
                return (
                    (t.prototype = {
                        initCaches: function () {
                            (this.elementCache = n
                                ? (function () {
                                      var e = new w();
                                      return {
                                          get: function (t) {
                                              return e.get(t.uniqueID);
                                          },
                                          set: function (t) {
                                              e.set(t.node.uniqueID, t);
                                          },
                                      };
                                  })()
                                : e("tagName")),
                                (this.textNodeCache = e("data")),
                                (this.otherNodeCache = e("nodeName"));
                        },
                        getNodeWrapper: function (e) {
                            var t;
                            switch (e.nodeType) {
                                case 1:
                                    t = this.elementCache;
                                    break;
                                case 3:
                                    t = this.textNodeCache;
                                    break;
                                default:
                                    t = this.otherNodeCache;
                            }
                            var n = t.get(e);
                            return n || ((n = new E(e, this)), t.set(n)), n;
                        },
                        getPosition: function (e, t) {
                            return this.getNodeWrapper(e).getPosition(t);
                        },
                        getRangeBoundaryPosition: function (e, t) {
                            var n = t ? "start" : "end";
                            return this.getPosition(e[n + "Container"], e[n + "Offset"]);
                        },
                        detach: function () {
                            this.elementCache = this.textNodeCache = this.otherNodeCache = null;
                        },
                    }),
                    t
                );
            })();
        $(V, { nextNode: g, previousNode: m });
        var Re = Array.prototype.indexOf
            ? function (e, t) {
                  return e.indexOf(t);
              }
            : function (e, t) {
                  for (var n = 0, r = e.length; n < r; ++n) if (e[n] === t) return n;
                  return -1;
              };
        $(e.rangePrototype, {
            moveStart: L(!0, !1),
            moveEnd: L(!1, !1),
            move: L(!0, !0),
            trimStart: U(!0),
            trimEnd: U(!1),
            trim: F(function (e, t) {
                var n = this.trimStart(t),
                    r = this.trimEnd(t);
                return n || r;
            }),
            expand: F(function (e, t, n) {
                var a = !1;
                n = r(n, le);
                var s = o(n.characterOptions);
                if ((t || (t = j), t == z)) {
                    var l,
                        c,
                        u = i(n.wordOptions),
                        d = e.getRangeBoundaryPosition(this, !0),
                        f = e.getRangeBoundaryPosition(this, !1),
                        h = P(d, s, u),
                        p = h.nextEndToken(),
                        g = p.chars[0].previousVisible();
                    if (this.collapsed) l = p;
                    else {
                        var m = P(f, s, u);
                        l = m.previousStartToken();
                    }
                    return (
                        (c = l.chars[l.chars.length - 1]),
                        g.equals(d) || (this.setStart(g.node, g.offset), (a = !0)),
                        c && !c.equals(f) && (this.setEnd(c.node, c.offset), (a = !0)),
                        n.trim && (n.trimStart && (a = this.trimStart(s) || a), n.trimEnd && (a = this.trimEnd(s) || a)),
                        a
                    );
                }
                return this.moveEnd(j, 1, n);
            }),
            text: F(function (e, t) {
                return this.collapsed ? "" : A(e, this, o(t)).join("");
            }),
            selectCharacters: F(function (e, t, n, r, i) {
                var o = { characterOptions: i };
                t || (t = W(this.getDocument())), this.selectNodeContents(t), this.collapse(!0), this.moveStart("character", n, o), this.collapse(!0), this.moveEnd("character", r - n, o);
            }),
            toCharacterRange: F(function (e, t, n) {
                t || (t = W(this.getDocument()));
                var r,
                    i,
                    o = t.parentNode,
                    a = V.getNodeIndex(t),
                    s = V.comparePoints(this.startContainer, this.endContainer, o, a) == -1,
                    l = this.cloneRange();
                return (
                    s ? (l.setStartAndEnd(this.startContainer, this.startOffset, o, a), (r = -l.text(n).length)) : (l.setStartAndEnd(o, a, this.startContainer, this.startOffset), (r = l.text(n).length)),
                    (i = r + this.text(n).length),
                    { start: r, end: i }
                );
            }),
            findText: F(function (t, n, o) {
                (o = r(o, ae)), o.wholeWordsOnly && ((o.wordOptions = i(o.wordOptions)), (o.wordOptions.includeTrailingSpace = !1));
                var a = Q(o.direction),
                    s = o.withinRange;
                s || ((s = e.createRange()), s.selectNodeContents(this.getDocument()));
                var l = n,
                    c = !1;
                "string" == typeof l ? o.caseSensitive || (l = l.toLowerCase()) : (c = !0);
                var u = t.getRangeBoundaryPosition(this, !a),
                    d = s.comparePoint(u.node, u.offset);
                d === -1 ? (u = t.getRangeBoundaryPosition(s, !0)) : 1 === d && (u = t.getRangeBoundaryPosition(s, !1));
                for (var f, h = u, p = !1; ; )
                    if ((f = M(h, l, c, s, o))) {
                        if (f.valid) return this.setStartAndEnd(f.startPos.node, f.startPos.offset, f.endPos.node, f.endPos.offset), !0;
                        h = a ? f.startPos : f.endPos;
                    } else {
                        if (!o.wrap || p) return !1;
                        (s = s.cloneRange()), (h = t.getRangeBoundaryPosition(s, !a)), s.setBoundary(u.node, u.offset, a), (p = !0);
                    }
            }),
            pasteHtml: function (e) {
                if ((this.deleteContents(), e)) {
                    var t = this.createContextualFragment(e),
                        n = t.lastChild;
                    this.insertNode(t), this.collapseAfter(n);
                }
            },
        }),
            $(e.selectionPrototype, {
                expand: F(function (e, t, n) {
                    this.changeEachRange(function (e) {
                        e.expand(t, n);
                    });
                }),
                move: F(function (e, t, n, r) {
                    var i = 0;
                    if (this.focusNode) {
                        this.collapse(this.focusNode, this.focusOffset);
                        var o = this.getRangeAt(0);
                        r || (r = {}), (r.characterOptions = a(r.characterOptions)), (i = o.move(t, n, r)), this.setSingleRange(o);
                    }
                    return i;
                }),
                trimStart: B("trimStart"),
                trimEnd: B("trimEnd"),
                trim: B("trim"),
                selectCharacters: F(function (t, n, r, i, o, a) {
                    var s = e.createRange(n);
                    s.selectCharacters(n, r, i, a), this.setSingleRange(s, o);
                }),
                saveCharacterRanges: F(function (e, t, n) {
                    for (var r = this.getAllRanges(), i = r.length, o = [], a = 1 == i && this.isBackward(), s = 0, l = r.length; s < l; ++s) o[s] = { characterRange: r[s].toCharacterRange(t, n), backward: a, characterOptions: n };
                    return o;
                }),
                restoreCharacterRanges: F(function (t, n, r) {
                    this.removeAllRanges();
                    for (var i, o, a, s = 0, l = r.length; s < l; ++s) (o = r[s]), (a = o.characterRange), (i = e.createRange(n)), i.selectCharacters(n, a.start, a.end, o.characterOptions), this.addRange(i, o.backward);
                }),
                text: F(function (e, t) {
                    for (var n = [], r = 0, i = this.rangeCount; r < i; ++r) n[r] = this.getRangeAt(r).text(t);
                    return n.join("");
                }),
            }),
            (e.innerText = function (t, n) {
                var r = e.createRange(t);
                r.selectNodeContents(t);
                var i = r.text(n);
                return r.detach(), i;
            }),
            (e.createWordIterator = function (e, t, n) {
                var a = R();
                n = r(n, ce);
                var s = o(n.characterOptions),
                    l = i(n.wordOptions),
                    c = a.getPosition(e, t),
                    u = P(c, s, l),
                    d = Q(n.direction);
                return {
                    next: function () {
                        return d ? u.previousStartToken() : u.nextEndToken();
                    },
                    dispose: function () {
                        u.dispose(), (this.next = function () {});
                    },
                };
            }),
            (e.noMutation = function (e) {
                var t = R();
                e(t), I();
            }),
            (e.noMutation.createEntryPointFunction = F),
            (e.textRange = {
                isBlockNode: u,
                isCollapsedWhitespaceNode: b,
                createPosition: F(function (e, t, n) {
                    return e.getPosition(t, n);
                }),
            });
    }),
    define("rangy-textrange", ["rangy-core"], (function (e) {
        return function () {
            var t;
            return t || e.rangy.modules.TextRange;
        };
    })(this)),
    rangy.createModule("Position", ["WrappedSelection"], function (e, t) {
        function n(e) {
            var t = 0,
                n = 0;
            if (typeof e.pageXOffset == w && typeof e.pageYOffset == w) (t = e.pageXOffset), (n = e.pageYOffset);
            else {
                var r = e.document,
                    i = r.documentElement,
                    o = r.compatMode,
                    a = "string" == typeof o && o.indexOf("CSS") >= 0 && i ? i : T.getBody(r);
                if (a && typeof a.scrollLeft == w && typeof a.scrollTop == w)
                    try {
                        (t = a.scrollLeft), (n = a.scrollTop);
                    } catch (e) {}
            }
            return { x: t, y: n };
        }
        function r(e, t) {
            for (t = t.toLowerCase(); e; ) {
                if (1 == e.nodeType && e.tagName.toLowerCase() == t) return e;
                e = e.parentNode;
            }
            return null;
        }
        function i(e, t, n, r) {
            (this.top = e), (this.right = t), (this.bottom = n), (this.left = r), (this.width = t - r), (this.height = n - e);
        }
        function o(e, t, n) {
            return new i(e.top + n, e.right + t, e.bottom + n, e.left + t);
        }
        function a(e, t) {
            var n = 0,
                r = 0,
                i = t.documentElement,
                a = T.getBody(t),
                s = 0 === i.clientWidth && typeof a.clientTop == w ? a : i,
                l = s.clientLeft,
                c = s.clientTop;
            return l && (n = -l), c && (r = -c), o(e, n, r);
        }
        function s(e) {
            for (var t, n = [], r = [], o = [], a = [], s = 0, l = e.length; s < l; ++s) (t = e[s]), t && (n.push(t.top), r.push(t.bottom), o.push(t.left), a.push(t.right));
            return new i(Math.min.apply(Math, n), Math.max.apply(Math, a), Math.max.apply(Math, r), Math.min.apply(Math, o));
        }
        function l(t, n, r) {
            var i = T.getBody(t).createTextRange();
            i.moveToPoint(n, r);
            var o = new e.WrappedTextRange(i);
            return new R(o.startContainer, o.startOffset);
        }
        function c(e, t, n) {
            var r = e.caretPositionFromPoint(t, n);
            return new R(r.offsetNode, r.offset);
        }
        function u(e, t, n) {
            var r = e.caretRangeFromPoint(t, n);
            return new R(r.startContainer, r.startOffset);
        }
        function d(e) {
            var t = (e.nativeRange || e).getClientRects();
            return t.length > 0 ? t[t.length - 1] : null;
        }
        function f(e, t, n) {
            return console.log("pointIsInOrAboveRect", e, t, Math.floor(n.top), Math.floor(n.right), Math.floor(n.bottom), Math.floor(n.left)), t < n.bottom && e >= n.left && e <= n.right;
        }
        function h(t, n, r, i) {
            var o = t.elementFromPoint(n, r);
            console.log("elementFromPoint is ", o);
            var a = e.createRange(t);
            a.selectNodeContents(o), a.collapse(!0);
            var s,
                l,
                c,
                u = o.firstChild;
            if (u) {
                e: for (; u; ) {
                    if ((console.log(u), 3 == u.nodeType)) {
                        for (s = 0, c = u.length; s <= c; ++s)
                            if ((a.setEnd(u, s), (l = d(a)), l && f(n, r, l))) {
                                l.right - n > n - l.left && --s;
                                break e;
                            }
                    } else if ((a.setEndAfter(u), (l = d(a)), l && f(n, r, l))) {
                        (s = T.getNodeIndex(u)), (u = o.parentNode), i || ++s;
                        break;
                    }
                    u = u.nextSibling;
                }
                u || ((u = o), (s = o.childNodes.length));
            } else (u = o.parentNode), (s = T.getNodeIndex(o)), i || ++s;
            return new R(u, s);
        }
        function p(n) {
            if (e.features.implementsTextRange) return l;
            if (typeof n.caretPositionFromPoint != x) return c;
            if (typeof n.caretRangeFromPoint != x) return u;
            if (typeof n.elementFromPoint != x && P) return h;
            throw t.createError("createCaretPositionFromPointGetter(): Browser does not provide a recognised method to create a selection from pixel coordinates");
        }
        function g(n, r, i, o, a) {
            a = T.getContentDocument(a, t, "createRangeFromPoints");
            var s = p(a),
                l = s(a, n, r, !1),
                c = s(a, i, o, !0);
            console.log(l.node, l.offset, c.node, c.offset);
            var u = e.createRange(a);
            return u.setStartAndEnd(l.node, l.offset, c.node, c.offset), u;
        }
        function m(e, t, n, r, i) {
            var o,
                a,
                s,
                l,
                c = r < t || (t == r && n < e);
            c ? ((o = n), (a = r), (s = e), (l = t)) : ((o = e), (a = t), (s = n), (l = r));
            var u = rangy.getSelection(i),
                d = g(o, a, s, l, i);
            return u.setSingleRange(d), u;
        }
        function v(e) {
            return function () {
                var t = this["get" + (e ? "Start" : "End") + "ClientPos"](),
                    r = n(T.getWindow(this.startContainer));
                return { x: t.x + r.x, y: t.y + r.y };
            };
        }
        function b(e, t) {
            return e.compareBoundaryPoints(t.START_TO_START, t);
        }
        function y(e) {
            return function () {
                for (var t = "getBounding" + (e ? "Document" : "Client") + "Rect", n = [], r = 0; r < this.rangeCount; ++r) n.push(this.getRangeAt(r)[t]());
                return s(n);
            };
        }
        function _(e, t) {
            return function () {
                if (0 == this.rangeCount) return null;
                var n = t ? "Document" : "Client",
                    r = this.getAllRanges();
                return r.length > 1 && r.sort(b), e ? r[0]["getStart" + n + "Pos"]() : r[r.length - 1]["getEnd" + n + "Pos"]();
            };
        }
        var w = "number",
            x = "undefined",
            E = e.WrappedRange,
            C = e.WrappedTextRange,
            T = e.dom,
            S = e.util,
            R = T.DomPosition,
            I = document.createElementNS("http://www.w3.org/1999/xhtml", "span"),
            k = S.isHostMethod(I, "getBoundingClientRect");
        I = null;
        var P = !1,
            N = !1;
        if (e.features.implementsDomRange) {
            var O = e.createNativeRange();
            (P = S.isHostMethod(O, "getClientRects")), (N = S.isHostMethod(O, "getBoundingClientRect")), O.detach();
        }
        S.extend(e.features, { rangeSupportsGetBoundingClientRect: N, rangeSupportsGetClientRects: P, elementSupportsGetBoundingClientRect: k });
        var A = function (e) {
                return function () {
                    var t = this.cloneRange();
                    t.collapse(e);
                    var n = t.getBoundingClientRect();
                    return { x: n[e ? "left" : "right"], y: n[e ? "top" : "bottom"] };
                };
            },
            D = e.rangePrototype;
        if (e.features.implementsTextRange && k)
            D.getBoundingClientRect = function () {
                var e,
                    t = C.rangeToTextRange(this),
                    n = this.getNodes([1], function (e) {
                        return /^t[dh]$/i.test(e.tagName);
                    }),
                    i = [];
                if (n.length > 0) {
                    for (var o, l, c, u, d = r(this.startContainer, "table"), f = 0; (o = n[f]); ++f)
                        (c = r(o, "table")),
                            (d && c == d) || ((u = this.cloneRange()), d && u.setStartAfter(d), u.setEndBefore(c), i.push(C.rangeToTextRange(u).getBoundingClientRect())),
                            this.containsNode(o)
                                ? i.push(o.getBoundingClientRect())
                                : ((l = t.duplicate()),
                                  l.moveToElementText(o),
                                  l.compareEndPoints("StartToStart", t) == -1 ? l.setEndPoint("StartToStart", t) : 1 == l.compareEndPoints("EndToEnd", t) && l.setEndPoint("EndToEnd", t),
                                  i.push(l.getBoundingClientRect())),
                            (d = c);
                    var h = r(this.endContainer, "table");
                    !h && d && ((u = this.cloneRange()), u.setStartAfter(d), i.push(C.rangeToTextRange(u).getBoundingClientRect())), (e = s(i));
                } else e = t.getBoundingClientRect();
                return a(e, T.getDocument(this.startContainer));
            };
        else if (e.features.implementsDomRange) {
            var M = function (e) {
                return e instanceof E ? e : new E(e);
            };
            if (N) {
                if (
                    ((D.getBoundingClientRect = function () {
                        var e = M(this).nativeRange,
                            t = e.getBoundingClientRect() || e.getClientRects()[0];
                        return a(t, T.getDocument(this.startContainer));
                    }),
                    P)
                ) {
                    A = function (e) {
                        return function () {
                            var n,
                                r = M(this).nativeRange,
                                i = r.getClientRects();
                            if (0 == i.length && k && (console.log(r, r.getClientRects(), r.getBoundingClientRect()), this.collapsed && 1 == this.startContainer.nodeType && this.startOffset < this.startContainer.childNodes.length)) {
                                var o = this.startContainer.childNodes[this.startOffset];
                                o.getClientRects && console.log(o, o.getClientRects(), this.startContainer.getClientRects());
                            }
                            if (i.length > 0) return e ? ((n = i[0]), { x: n.left, y: n.top }) : ((n = i[i.length - 1]), { x: n.right, y: n.bottom });
                            throw t.createError("Cannot get position for range " + this.inspect());
                        };
                    };
                }
            } else {
                var F = k
                        ? function (e) {
                              return a(e.getBoundingClientRect(), T.getDocument(e));
                          }
                        : function (e) {
                              for (var t = 0, n = 0, r = e, o = e.offsetWidth, s = e.offsetHeight; r; ) (t += r.offsetLeft), (n += r.offsetTop), (r = r.offsetParent);
                              return a(new i(n, t + o, n + s, t), T.getDocument(e));
                          },
                    L = function (e) {
                        var t;
                        e.splitBoundaries();
                        var n = document.createElementNS("http://www.w3.org/1999/xhtml", "span");
                        if (e.collapsed) e.insertNode(n), (t = F(n)), n.parentNode.removeChild(n);
                        else {
                            var r = e.cloneRange();
                            r.collapse(!0), r.insertNode(n);
                            var i = F(n);
                            n.parentNode.removeChild(n), r.collapseToPoint(e.endContainer, e.endOffset), r.insertNode(n);
                            var o = F(n);
                            n.parentNode.removeChild(n);
                            for (
                                var a = [i, o],
                                    l = e.getNodes([1], function (t) {
                                        return e.containsNode(t);
                                    }),
                                    c = 0,
                                    u = l.length;
                                c < u;
                                ++c
                            )
                                a.push(F(l[c]));
                            t = s(a);
                        }
                        return e.normalizeBoundaries(), t;
                    };
                D.getBoundingClientRect = function (e) {
                    return L(M(e));
                };
            }
        }
        S.extend(D, {
            getBoundingDocumentRect: function () {
                var e = n(T.getWindow(this.startContainer));
                return o(this.getBoundingClientRect(), e.x, e.y);
            },
            getStartClientPos: A(!0),
            getEndClientPos: A(!1),
            getStartDocumentPos: v(!0),
            getEndDocumentPos: v(!1),
        }),
            S.extend(e.selectionPrototype, { getBoundingClientRect: y(!1), getBoundingDocumentRect: y(!0), getStartClientPos: _(!0, !1), getEndClientPos: _(!1, !1), getStartDocumentPos: _(!0, !0), getEndDocumentPos: _(!1, !0) }),
            (e.positionFromPoint = function (e, n, r) {
                return (r = T.getContentDocument(r, t, "positionFromPoint")), p(r)(r, e, n);
            }),
            (e.createRangeFromPoints = g),
            (e.moveSelectionToPoints = m);
    }),
    define("rangy-position", ["rangy-core"], (function (e) {
        return function () {
            var t;
            return t || e.rangy.modules.Position;
        };
    })(this)),
    define("rangy", ["rangy-core", "rangy-highlighter", "rangy-cssclassapplier", "rangy-textrange", "rangy-position"], function (e, t, n, r, i) {
        return e;
    }),
    define("readium_shared_js/views/media_overlay_data_injector", ["jquery", "underscore", "../helpers", "../models/smil_iterator", "rangy", "readium_cfi_js"], function (e, t, n, r, i, o) {
        var a = function (o, a) {
            this.attachMediaOverlayData = function (s, l, c) {
                var u = s[0].contentDocument.documentElement;
                if (l.media_overlay_id || 0 !== o.smil_models.length) {
                    var d = e("body", u);
                    if (0 == d.length) console.error("! BODY ???");
                    else {
                        var f = d.data("mediaOverlayClick");
                        if (f) console.error("[WARN] already mediaOverlayClick");
                        else {
                            d.data("mediaOverlayClick", { ping: "pong" });
                            var h = function (t) {
                                    var n = e(this)[0];
                                    if (((n = t.target), !n)) return a.touchInit(), !0;
                                    var r = void 0,
                                        o = n,
                                        s = !1;
                                    for ("a" === o.nodeName.toLowerCase() && (s = !0); !(r = e(o).data("mediaOverlayData")) && ("a" === o.nodeName.toLowerCase() && (s = !0), (o = o.parentNode)); );
                                    if (r && (r.par || r.pars)) {
                                        if (!c.mediaOverlaysEnableClick) return console.log("MO CLICK DISABLED"), a.touchInit(), !0;
                                        if (s) return console.log("MO CLICKED LINK"), a.touchInit(), !0;
                                        var l = r.par ? r.par : r.pars[0];
                                        if (r.pars && "undefined" != typeof i) {
                                            var u = !1;
                                            a.isPlayingCfi() && ((u = !0), a.pause());
                                            try {
                                                var d = i.positionFromPoint(t.pageX, t.pageY, n.ownerDocument);
                                                l = void 0;
                                                for (var f = 0; f < r.pars.length; f++) {
                                                    var h = r.pars[f],
                                                        p = "epubcfi(" + h.cfi.partialStartCfi + ")",
                                                        g = EPUBcfi.getTextTerminusInfoWithPartialCFI(p, n.ownerDocument, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]),
                                                        m = "epubcfi(" + h.cfi.partialEndCfi + ")",
                                                        v = EPUBcfi.getTextTerminusInfoWithPartialCFI(m, n.ownerDocument, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]),
                                                        b = i.createRange(n.ownerDocument);
                                                    if ((b.setStartAndEnd(g.textNode, g.textOffset, v.textNode, v.textOffset), b.isPointInRange(d.node, d.offset))) {
                                                        l = h;
                                                        break;
                                                    }
                                                }
                                            } catch (e) {
                                                console.error(e);
                                            }
                                            if (!l) return u && a.toggleMediaOverlay(), !0;
                                        }
                                        return o && o != n && "body" === o.nodeName.toLowerCase() && l && !l.getSmil().id ? (a.touchInit(), !0) : (a.playUserPar(l), !0);
                                    }
                                    var y = e(n).attr("ibooks:readaloud");
                                    if ((y || (y = e(n).attr("epub:readaloud")), y)) {
                                        console.debug("MO readaloud attr: " + y);
                                        var _ = a.isPlaying();
                                        if (("start" === y && !_) || ("stop" === y && _) || "startstop" === y) return a.toggleMediaOverlay(), !0;
                                    }
                                    return a.touchInit(), !0;
                                },
                                p = t.debounce(h, 200);
                            "ontouchstart" in document.documentElement && d[0].addEventListener("touchstart", p, !1), d[0].addEventListener("mousedown", p, !1);
                        }
                    }
                    var g = o.getSmilBySpineItem(l);
                    if (!g) return void console.error("NO SMIL?? " + l.idref + " /// " + l.media_overlay_id);
                    var m = function (e) {
                        if (e) {
                            if (e.nodeType && "seq" === e.nodeType && e.textref) {
                                var t = e.textref.split("#"),
                                    r = t[0],
                                    i = 2 === t.length ? t[1] : "";
                                if (r && i) {
                                    var o = n.ResolveContentRef(r, g.href),
                                        a = o === l.href;
                                    a && ((e.element = s[0].contentDocument.getElementById(i)), e.element || console.error("seq.textref !element? " + e.textref));
                                }
                            }
                            if (e.children && e.children.length)
                                for (var c = 0; c < e.children.length; c++) {
                                    var u = e.children[c];
                                    m(u);
                                }
                        }
                    };
                    m(g);
                    for (var v = new r(g), b = "/99!", y = "epubcfi"; v.currentPar; ) {
                        (v.currentPar.element = void 0), (v.currentPar.cfi = void 0);
                        var _ = n.ResolveContentRef(v.currentPar.text.srcFile, v.smil.href),
                            w = _ === l.href;
                        if (w) {
                            var x = !v.currentPar.text.srcFragmentId || 0 == v.currentPar.text.srcFragmentId.length,
                                E = 0 == v.currentPar.text.srcFragmentId.indexOf(y) ? void 0 : v.currentPar.text.srcFragmentId,
                                C = void 0,
                                T = !1;
                            if (x || E) C = x ? d : e(s[0].contentDocument.getElementById(E));
                            else if (0 === v.currentPar.text.srcFragmentId.indexOf(y)) {
                                var S = v.currentPar.text.srcFragmentId.substr(y.length + 1, v.currentPar.text.srcFragmentId.length - y.length - 2);
                                0 === S.indexOf(b) && (S = S.substr(b.length, S.length - b.length));
                                var R = S.split(",");
                                if (R && 3 === R.length)
                                    try {
                                        var I = R[0] + R[1],
                                            k = "epubcfi(" + I + ")",
                                            P = EPUBcfi.getTextTerminusInfoWithPartialCFI(k, s[0].contentDocument, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]),
                                            N = R[0] + R[2],
                                            O = "epubcfi(" + N + ")",
                                            A = (EPUBcfi.getTextTerminusInfoWithPartialCFI(O, s[0].contentDocument, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]), P.textNode.parentNode);
                                        (v.currentPar.cfi = { smilTextSrcCfi: v.currentPar.text.srcFragmentId, partialRangeCfi: S, partialStartCfi: I, partialEndCfi: N, cfiTextParent: A }), (T = !0), (C = e(A));
                                        var D = C.data("mediaOverlayData");
                                        if (D) {
                                            D.par && (console.error("[WARN] non-CFI MO DATA already exists!"), (D.par = void 0));
                                            var M = !1;
                                            if (D.pars)
                                                for (var F = 0; F < D.pars.length; F++) {
                                                    var L = D.pars[F];
                                                    L === v.currentPar && ((M = !0), console.error("[WARN] mediaOverlayData CFI PAR already registered!"));
                                                }
                                            else D.pars = [];
                                            M || D.pars.push(v.currentPar);
                                        } else (D = { pars: [v.currentPar] }), C.data("mediaOverlayData", D);
                                    } catch (e) {
                                        console.error(e);
                                    }
                                else
                                    try {
                                        var U = "epubcfi(" + S + ")";
                                        C = EPUBcfi.getTargetElementWithPartialCFI(U, s[0].contentDocument, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]);
                                    } catch (e) {
                                        console.error(e);
                                    }
                            } else console.error("SMIL text@src CFI fragment identifier scheme not supported: " + v.currentPar.text.srcFragmentId);
                            if (C && C.length > 0) {
                                if (!T) {
                                    v.currentPar.element && v.currentPar.element !== C[0] && console.error("DIFFERENT ELEMENTS??! " + v.currentPar.text.srcFragmentId + " /// " + v.currentPar.element.id);
                                    var B = C[0].nodeName ? C[0].nodeName.toLowerCase() : void 0;
                                    ("audio" !== B && "video" !== B) || C.attr("preload", "auto"), (v.currentPar.element = C[0]);
                                    var D = C.data("mediaOverlayData");
                                    D && (console.error("[WARN] MO DATA already exists."), D.par && D.par !== v.currentPar && console.error("DIFFERENT PARS??!")), C.data("mediaOverlayData", { par: v.currentPar });
                                }
                            } else console.error("!! CANNOT FIND ELEMENT: " + v.currentPar.text.srcFragmentId + " == " + v.currentPar.text.srcFile + " /// " + l.href);
                        }
                        v.next();
                    }
                }
            };
        };
        return a;
    }),
    define("readium_shared_js/views/audio_player", ["jquery"], function (e) {
        var t = function (t, n, r, i, o) {
            function a() {
                t({ isPlaying: !0 }), i();
            }
            function s() {
                o(), t({ isPlaying: !1 });
            }
            function l() {
                return b.moSeeking ? void (v && console.debug("onEnded() skipped (still seeking...)")) : (u(), r(), void t({ isPlaying: !1 }));
            }
            function c() {
                T ||
                    (T = setInterval(function () {
                        if (b.moSeeking) return C++, void (C > 1e3 && ((C = 0), u()));
                        var e = void 0;
                        try {
                            e = b.currentTime;
                        } catch (e) {
                            console.error(e.message);
                        }
                        e && n(e, 1);
                    }, 20));
            }
            function u() {
                T && clearInterval(T), (T = void 0);
            }
            function d(e) {
                v && console.debug("onReadyToSeek #" + e.data.playId), h(e.data.seekBegin, e.data.playId, !0);
            }
            function f(t) {
                e(b).off(N, f),
                    m
                        ? (v && console.debug("onReadyToSeek ANDROID ... waiting a bit ... #" + t.data.playId),
                          k(),
                          setTimeout(function () {
                              d(t);
                          }, 1e3))
                        : d(t);
            }
            function h(t, n, r) {
                if ((v && console.debug("playSeekCurrentTime() #" + n), 0 == t && (t = 0.01), Math.abs(t - b.currentTime) < 0.3)) return v && console.debug("playSeekCurrentTime() CONTINUE"), (b.moSeeking = void 0), void y.play();
                var i = r ? A : D;
                v && console.debug("playSeekCurrentTime() NEED SEEK, EV: " + i), y.pause(), e(b).on(i, { newCurrentTime: t, playId: n, isNewSrc: r }, p);
                try {
                    b.currentTime = t;
                } catch (e) {
                    console.error(e.message),
                        setTimeout(function () {
                            try {
                                b.currentTime = t;
                            } catch (e) {
                                console.error(e.message);
                            }
                        }, 5);
                }
            }
            function p(t) {
                var n = t.data.isNewSrc ? A : D,
                    r = void 0 == t.data.seekRetries;
                (r || t.data.seekRetries == O) && e(b).off(n, p), v && console.debug("onSeeked() #" + t.data.playId + " FIRST? " + r + " EV: " + n);
                var i = b.currentTime,
                    o = Math.abs(t.data.newCurrentTime - i);
                if ((r || t.data.seekRetries >= 0) && o >= 1)
                    v && console.debug("onSeeked() time diff: " + t.data.newCurrentTime + " vs. " + i + " (" + o + ")"),
                        r && ((t.data.seekRetries = O), (t.data.isNewSrc = !1)),
                        t.data.seekRetries--,
                        v && console.debug("onSeeked() FAIL => retry again (timeout)"),
                        setTimeout(
                            function () {
                                p(t);
                            },
                            m ? 1e3 : 200
                        ),
                        setTimeout(function () {
                            b.pause();
                            try {
                                b.currentTime = t.data.newCurrentTime;
                            } catch (e) {
                                console.error(e.message),
                                    setTimeout(function () {
                                        try {
                                            b.currentTime = t.data.newCurrentTime;
                                        } catch (e) {
                                            console.error(e.message);
                                        }
                                    }, 4);
                            }
                        }, 5);
                else {
                    if ((v && (console.debug("onSeeked() STATE:"), console.debug(r), console.debug(t.data.seekRetries), console.debug(o)), o >= 1)) {
                        v && console.debug("onSeeked() ABORT, TRY AGAIN FROM SCRATCH!");
                        var a = w,
                            s = _,
                            l = t.data.newCurrentTime;
                        return (
                            y.reset(),
                            void setTimeout(function () {
                                y.playFile(a, s, l);
                            }, 10)
                        );
                    }
                    v && console.debug("onSeeked() OKAY => play!"), (t.data.seekRetries = void 0), y.play(), (b.moSeeking = void 0);
                }
            }
            var g = !!navigator.userAgent.match(/(iPad|iPhone|iPod)/g),
                m = navigator.userAgent.toLowerCase().indexOf("android") > -1,
                v = !1,
                b = new Audio();
            v &&
                (b.addEventListener("load", function () {
                    console.debug("0) load");
                }),
                b.addEventListener("loadstart", function () {
                    console.debug("1) loadstart");
                }),
                b.addEventListener("durationchange", function () {
                    console.debug("2) durationchange");
                }),
                b.addEventListener("loadedmetadata", function () {
                    console.debug("3) loadedmetadata");
                }),
                b.addEventListener("loadeddata", function () {
                    console.debug("4) loadeddata");
                }),
                b.addEventListener("progress", function () {
                    console.debug("5) progress");
                }),
                b.addEventListener("canplay", function () {
                    console.debug("6) canplay");
                }),
                b.addEventListener("canplaythrough", function () {
                    console.debug("7) canplaythrough");
                }),
                b.addEventListener("play", function () {
                    console.debug("8) play");
                }),
                b.addEventListener("pause", function () {
                    console.debug("9) pause");
                }),
                b.addEventListener("ended", function () {
                    console.debug("10) ended");
                }),
                b.addEventListener("seeked", function () {
                    console.debug("X) seeked");
                }),
                b.addEventListener("timeupdate", function () {
                    console.debug("Y) timeupdate");
                }),
                b.addEventListener("seeking", function () {
                    console.debug("Z) seeking");
                }));
            var y = this,
                _ = void 0,
                w = void 0;
            this.currentSmilSrc = function () {
                return w;
            };
            var x = 1;
            (this.setRate = function (e) {
                (x = e), x < 0.5 && (x = 0.5), x > 4 && (x = 4), (b.playbackRate = x);
            }),
                y.setRate(x),
                (this.getRate = function () {
                    return x;
                });
            var E = 1;
            (this.setVolume = function (e) {
                (E = e), E < 0 && (E = 0), E > 1 && (E = 1), (b.volume = E);
            }),
                y.setVolume(E),
                (this.getVolume = function () {
                    return E;
                }),
                (this.play = function () {
                    return v && console.error("this.play()"), !!_ && (c(), y.setVolume(E), y.setRate(x), b.play(), !0);
                }),
                (this.pause = function () {
                    v && console.error("this.pause()"), u(), b.pause();
                }),
                b.addEventListener("play", a, !1),
                b.addEventListener("pause", s, !1),
                b.addEventListener("ended", l, !1);
            var C = 0,
                T = void 0;
            (this.isPlaying = function () {
                return void 0 !== T;
            }),
                (this.reset = function () {
                    v && console.error("this.reset()"),
                        this.pause(),
                        (b.moSeeking = void 0),
                        (w = void 0),
                        (_ = void 0),
                        setTimeout(function () {
                            b.setAttribute("src", "");
                        }, 1);
                }),
                b.addEventListener("loadstart", function () {
                    S = !0;
                });
            var S = !1;
            this.touchInit = function () {
                return !!g && !S && ((S = !0), b.setAttribute("src", "touch/init/html5/audio.mp3"), b.load(), !0);
            };
            var R = 0,
                I = 0;
            this.playFile = function (t, n, r) {
                R++, R > 99999 && (R = 0);
                var i = R;
                if (b.moSeeking)
                    return (
                        I++,
                        I > O
                            ? void (I = 0)
                            : (v && console.debug("this.playFile(" + n + ") @" + r + " (POSTPONE, SEEKING...)"),
                              void setTimeout(function () {
                                  y.playFile(t, n, r);
                              }, 20))
                    );
                (b.moSeeking = {}), v && console.debug("this.playFile(" + n + ") @" + r + " #" + i);
                var o = !_ || _ !== n;
                return o
                    ? (v && (console.debug("this.playFile() NEW SRC"), console.debug("_currentEpubSrc: " + _), console.debug("epubSrc: " + n)),
                      this.reset(),
                      (b.moSeeking = {}),
                      (w = t),
                      (_ = n),
                      m || b.addEventListener("play", P, !1),
                      e(b).on(N, { seekBegin: r, playId: i }, f),
                      void setTimeout(function () {
                          b.setAttribute("src", _), b.load(), m || k();
                      }, 1))
                    : (v && console.debug("this.playFile() SAME SRC"), this.pause(), (w = t), (_ = n), void h(r, i, !1));
            };
            var k = function () {
                    v && console.debug("playToForcePreload");
                    var e = E;
                    (E = 0), y.play(), (E = e);
                },
                P = function () {
                    b.removeEventListener("play", P, !1), v && console.debug("onPlayToForcePreload"), b.pause();
                },
                N = m ? "canplaythrough" : "canplay",
                O = 10,
                A = g ? "canplaythrough" : "seeked",
                D = g ? "timeupdate" : "seeked";
        };
        return t;
    }),
    define("readium_shared_js/views/media_overlay_element_highlighter", ["jquery", "rangy", "readium_cfi_js"], function (e, t, n) {
        var r = function (n) {
            function r(t, n, r) {
                if (g)
                    try {
                        if (g[0].ownerDocument === t[0].ownerDocument) return;
                    } catch (e) {}
                ($head = e("head", t[0].ownerDocument.documentElement)), (g = e("<style type='text/css'> </style>")), g.append("." + i + " {");
                var o = "background-color: yellow !important; color: black !important; border-radius: 0.4em;",
                    a = r;
                if (a) {
                    var s = !1;
                    for (var l in a.declarations) a.declarations.hasOwnProperty(l) && ((s = !0), g.append(l + ": " + a.declarations[l] + "; "));
                    s || n || g.append(o);
                } else n || g.append(o);
                g.append("}"), g.appendTo($head);
            }
            this.includeParWhenAdjustingToSeqSyncGranularity = !0;
            var i = "mo-active-default",
                o = "mo-sub-sync",
                a = void 0;
            this.isElementHighlighted = function (e) {
                return a && e === a;
            };
            var s = void 0;
            this.isCfiHighlighted = function (e) {
                return s && e === s;
            };
            var l = "",
                c = "",
                u = n,
                d = "undefined" != typeof t,
                f = void 0,
                h = void 0,
                p = "MO_SPEAK",
                g = void 0;
            (this.reDo = function () {
                g && g.remove(), (g = void 0);
                var e = a,
                    t = s,
                    n = l,
                    r = c;
                a ? (this.reset(), this.highlightElement(e, n, r)) : s && (this.reset(), this.highlightCfi(t, n, r));
            }),
                (this.highlightElement = function (t, n, d) {
                    if (t && t !== a) {
                        this.reset(), (a = t), (s = void 0), (l = n), (c = d);
                        var f = this.adjustParToSeqSyncGranularity(a),
                            h = f.element;
                        c && "" !== c && e(h.ownerDocument.documentElement).addClass(c);
                        var p = e(h),
                            g = l && "" !== l,
                            m = u.userStyles().findStyle("." + i);
                        r(p, g, m), m || !g ? (g && p.addClass(l), p.addClass(i)) : p.addClass(l), (this.includeParWhenAdjustingToSeqSyncGranularity || a !== f) && e(a.element).addClass(o);
                    }
                }),
                (this.highlightCfi = function (n, o, g) {
                    if (n && n !== s) {
                        this.reset(), (a = void 0), (s = n), (l = o), (c = g);
                        var m = e(s.cfi.cfiTextParent),
                            v = l && "" !== l,
                            b = u.userStyles().findStyle("." + i);
                        r(m, v, b);
                        var y = b || !v ? (v ? l + " " : "") + i : l;
                        if (d) {
                            var _ = s.cfi.cfiTextParent.ownerDocument;
                            h = t.createRange(_);
                            var w = "epubcfi(" + s.cfi.partialStartCfi + ")",
                                x = EPUBcfi.getTextTerminusInfoWithPartialCFI(w, _, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]),
                                E = "epubcfi(" + s.cfi.partialEndCfi + ")",
                                C = EPUBcfi.getTextTerminusInfoWithPartialCFI(E, _, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]);
                            h.setStartAndEnd(x.textNode, x.textOffset, C.textNode, C.textOffset);
                            (h.MO_createCssClassApplier = !0),
                                (f && f.cssClass === y) ||
                                    (f = t.createCssClassApplier(y, { elementTagName: "span", elementProperties: { className: "mo-cfi-highlight" }, ignoreWhiteSpace: !0, applyToEditableOnly: !1, normalize: !0 }, ["span"])),
                                f.applyToRange(h);
                        } else if (u.plugins.highlights)
                            try {
                                var T = n.getSmil().spineItemId;
                                u.plugins.highlights.addHighlight(T, n.cfi.partialRangeCfi, p, "highlight", void 0);
                            } catch (e) {
                                console.error(e);
                            }
                        else if (u.plugins.annotations)
                            try {
                                var T = n.getSmil().spineItemId;
                                u.plugins.annotations.addHighlight(T, n.cfi.partialRangeCfi, p, "highlight", void 0);
                            } catch (e) {
                                console.error(e);
                            }
                    }
                }),
                (this.reset = function () {
                    if (s) {
                        var t = s.cfi.cfiTextParent.ownerDocument;
                        if (d) {
                            if (f && h.MO_createCssClassApplier) f.undoToRange(h);
                            else
                                for (var n = void 0; null !== (n = t.getElementById(p)); ) {
                                    var r = n.textContent,
                                        g = t.createTextNode(r);
                                    n.parentNode.replaceChild(g, n), g.parentNode.normalize();
                                }
                            h = void 0;
                        } else if (u.plugins.highlights)
                            try {
                                u.plugins.highlights.removeHighlight(p);
                                for (var n = void 0; null !== (n = t.getElementById("start-" + p)); ) console.log("toRemove START"), console.log(n), n.parentNode.removeChild(n);
                                for (; null !== (n = t.getElementById("end-" + p)); ) console.log("toRemove END"), console.log(n), n.parentNode.removeChild(n);
                            } catch (e) {
                                console.error(e);
                            }
                        else if (u.plugins.annotations)
                            try {
                                u.plugins.annotations.removeHighlight(p);
                                for (var n = void 0; null !== (n = t.getElementById("start-" + p)); ) console.log("toRemove START"), console.log(n), n.parentNode.removeChild(n);
                                for (; null !== (n = t.getElementById("end-" + p)); ) console.log("toRemove END"), console.log(n), n.parentNode.removeChild(n);
                            } catch (e) {
                                console.error(e);
                            }
                        s = void 0;
                    }
                    if (a) {
                        var m = this.adjustParToSeqSyncGranularity(a),
                            v = m.element;
                        (this.includeParWhenAdjustingToSeqSyncGranularity || a !== m) && e(a.element).removeClass(o),
                            c && "" !== c && e(v.ownerDocument.documentElement).removeClass(c),
                            l && "" !== l && e(v).removeClass(l),
                            e(v).removeClass(i),
                            (a = void 0);
                    }
                    (l = ""), (c = "");
                }),
                (this.adjustParToSeqSyncGranularity = function (e) {
                    if (e) {
                        var t = u.viewerSettings().mediaOverlaysSynchronizationGranularity;
                        if (t && t.length > 0) {
                            var n = e.element || (e.cfi ? e.cfi.cfiTextParent : void 0);
                            if (!n) return console.error("adjustParToSeqSyncGranularity !element ???"), e;
                            var r = e.getFirstSeqAncestorWithEpubType(t, this.includeParWhenAdjustingToSeqSyncGranularity);
                            if (r && r.element) return r;
                        }
                        return e;
                    }
                });
        };
        return r;
    }),
    define("readium_shared_js/views/scroll_view", [
        "../globals",
        "jquery",
        "underscore",
        "eventEmitter",
        "../models/bookmark_data",
        "../models/current_pages_info",
        "../helpers",
        "./one_page_view",
        "../models/page_open_request",
        "../models/viewer_settings",
    ], function (e, t, n, r, i, o, a, s, l, c) {
        var u = function (i, u, d) {
            function f(e, t) {
                if (de) return void e();
                var n = I();
                if (!n) return void e();
                var r = H(0),
                    i = z(n);
                if (r.top - i.bottom > oe) {
                    var o = M();
                    E(n), v(o - (i.bottom - i.top), void 0), t("updateLoadedViewsTop 1"), f(e, t);
                } else
                    r.top - i.top < oe
                        ? y(n, function (n) {
                              n ? (t("updateLoadedViewsTop 2"), f(e, t)) : e();
                          })
                        : e();
            }
            function h(e, t) {
                if (de) return void e();
                var n = k();
                if (!n) return void e();
                var r = H(0),
                    i = z(n);
                i.top - r.bottom > oe
                    ? (E(n), t("updateLoadedViewsBottom 1"), h(e, t))
                    : i.bottom - r.bottom < oe
                    ? w(n, function (n) {
                          t("updateLoadedViewsBottom 2"), n ? h(e, t) : e();
                      })
                    : e();
            }
            function p(e) {
                if (u) {
                    var t = void 0;
                    if (Q && e) {
                        var n = e.offset();
                        n && (t = n.top);
                    }
                    var r = function (n) {
                        if (Q) {
                            if (!t) return;
                            var r = void 0,
                                i = e.offset();
                            if ((i && (r = i.top), !r)) return;
                            var o = r - t;
                            Math.abs(o) > 1 && console.debug("@@@@@@@@@@@@@@@ SCROLL ADJUST (" + n + ") " + o + " -- " + e.currentSpineItem().href);
                        }
                    };
                    (fe = !0),
                        h(function () {
                            f(function () {
                                setTimeout(function () {
                                    fe = !1;
                                }, ae + 100);
                            }, r);
                        }, r);
                }
            }
            function g(e) {
                var t = d.viewerSettings();
                t.mediaOverlaysPreservePlaybackWhenScroll || (!ge && d.isMediaOverlayAvailable() && ((ge = d.isPlayingMediaOverlay()), ge && d.pauseMediaOverlay()));
            }
            function m(e) {
                if (!fe && !he && !pe) {
                    se.resetCurrentPosition(),
                        p(),
                        D(se),
                        n.defer(function () {
                            te || se.saveCurrentPosition();
                        });
                    var t = d.viewerSettings();
                    t.mediaOverlaysPreservePlaybackWhenScroll ||
                        (ge &&
                            setTimeout(function () {
                                d.playMediaOverlay(), (ge = !1);
                            }, 100));
                }
            }
            function v(e, t) {
                (ne[0].scrollTop = e), t && D(t.initiator, t.spineItem, t.elementId);
            }
            function b(e) {
                var t = M(),
                    n = z(e);
                _(e);
                var r = z(e),
                    i = r.bottom - r.top,
                    o = n.bottom - n.top,
                    a = i - o;
                Math.abs(a) > 0 && (Q && console.debug("IMMEDIATE SCROLL ADJUST: " + e.currentSpineItem().href + " == " + a), v(t + a));
            }
            function y(e, t) {
                var n = ce.prevItem(e.currentSpineItem(), !0);
                if (!n) return void t(!1);
                var r = T(!0),
                    i = k();
                r.element().insertAfter(i.element()),
                    r.loadSpineItem(n, function (i, o, a, s, l) {
                        if (i) {
                            _(r);
                            var c = z(r);
                            E(r);
                            var u = M(),
                                d = T(),
                                f = c.bottom - c.top;
                            d.setHeight(f),
                                d.element().insertBefore(e.element()),
                                (u += f),
                                v(u, void 0),
                                d.loadSpineItem(n, function (e, r, i, o, a) {
                                    e ? (b(d), P(d, e, r, i, o, a), t(e)) : (console.error("Unable to open 2 " + n.href), E(d), t(!1));
                                });
                        } else console.error("Unable to open 1 " + n.href), E(r), t(!1);
                    });
            }
            function _(e) {
                e.currentSpineItem().isFixedLayout() ? e.scaleToWidth(ne.width()) : e.resizeIFrameToContent();
            }
            function w(e, t) {
                var n = ce.nextItem(e.currentSpineItem(), !0);
                if (!n) return void t(!1);
                var r = (M(), T());
                r.element().insertAfter(e.element()),
                    r.loadSpineItem(n, function (e, i, o, a, s) {
                        e ? (_(r), P(r, e, i, o, a, s), t(e)) : (console.error("Unable to load " + n.href), t(!1));
                    });
            }
            function x() {
                var e = [];
                R(function (t) {
                    e.push(t);
                }, !1);
                for (var t = 0, n = e.length; t < n; t++) E(e[t]);
            }
            function E(e) {
                e.onUnload(), e.element().remove();
            }
            function C(e) {
                ne.css("left", e.left), ne.css("top", e.top), ne.css("right", e.right), ne.css("bottom", e.bottom);
            }
            function T(t) {
                function r() {
                    _(o), D(se), p(), te && !ee && se.restoreCurrentPosition();
                }
                i.disablePageTransitions = !0;
                var o = new s(i, ["content-doc-frame"], !0, d);
                o.on(s.Events.SPINE_ITEM_OPEN_START, function (t, n) {
                    e.logEvent("OnePageView.Events.SPINE_ITEM_OPEN_START", "ON", "scroll_view.js [ " + n.href + " ]"),
                        e.logEvent("CONTENT_DOCUMENT_LOAD_START", "EMIT", "scroll_view.js [ " + n.href + " ]"),
                        se.emit(e.Events.CONTENT_DOCUMENT_LOAD_START, t, n);
                }),
                    o.on(e.Events.CONTENT_DOCUMENT_UNLOADED, function (t, n) {
                        e.logEvent("CONTENT_DOCUMENT_UNLOADED", "ON", "scroll_view.js [ " + n.href + " ]"), se.emit(e.Events.CONTENT_DOCUMENT_UNLOADED, t, n);
                    });
                var a = n.debounce(r, 100);
                return (
                    o.on(s.Events.CONTENT_SIZE_CHANGED, function (t, n) {
                        e.logEvent("OnePageView.Events.CONTENT_SIZE_CHANGED", "ON", "scroll_view.js [ " + n.href + " ]"), a();
                    }),
                    o.render(),
                    me && o.setViewSettings(me),
                    t || o.element().data("pageView", o),
                    u && o.decorateIframe(),
                    o
                );
            }
            function S(e, t) {
                var n = void 0;
                return (
                    R(function (t) {
                        return t.currentSpineItem() != e || ((n = t), !1);
                    }, t),
                    n
                );
            }
            function R(e, t) {
                for (
                    var n = ne.children(),
                        r = n.length,
                        i = t
                            ? function (e) {
                                  return e - 1;
                              }
                            : function (e) {
                                  return e + 1;
                              },
                        o = t
                            ? function (e) {
                                  return e >= 0;
                              }
                            : function (e) {
                                  return e < r;
                              },
                        a = t ? r - 1 : 0,
                        s = a;
                    o(s);
                    s = i(s)
                ) {
                    var l = n.eq(s),
                        c = l.data("pageView");
                    if (c && e(c) === !1) return;
                }
            }
            function I() {
                var e = void 0;
                return (
                    R(function (t) {
                        return (e = t), !1;
                    }, !1),
                    e
                );
            }
            function k() {
                var e = void 0;
                return (
                    R(function (t) {
                        return (e = t), !1;
                    }, !0),
                    e
                );
            }
            function P(t, n, r, i, o, a) {
                n && o && (e.logEvent("CONTENT_DOCUMENT_LOADED", "EMIT", "scroll_view.js [ " + i.href + " ]"), se.emit(e.Events.CONTENT_DOCUMENT_LOADED, r, i));
            }
            function N(e, t) {
                x();
                var n = (M(), T());
                ne.append(n.element()),
                    n.loadSpineItem(e, function (e, r, i, o, a) {
                        e ? (_(n), P(n, e, r, i, o, a)) : (console.error("Unable to load " + i.href), E(n), (n = void 0)), t(n);
                    });
            }
            function O(e, t) {
                var n,
                    r,
                    i,
                    o,
                    a = 0;
                if (void 0 !== t.scrollTop) a = t.scrollTop;
                else if (void 0 !== t.spineItemPageIndex) {
                    var s;
                    (n = A()), (s = t.spineItemPageIndex < 0 ? 0 : t.spineItemPageIndex >= n ? n - 1 : t.spineItemPageIndex), (a = s * L());
                } else if (e && t.elementId) {
                    if (((o = z(e)), (i = e.getNavigator()), (r = i.getElementById(t.elementId)), !r || !r.length)) return void console.warn("Element id=" + t.elementId + " not found!");
                    if (q(e, r, 60)) return void D(t.initiator, t.spineItem, t.elementId);
                    var l = J(e, r);
                    a = l.top + o.top;
                } else if (e && t.elementCfi) {
                    (o = z(e)), (i = e.getNavigator());
                    var c = i.getDomRangeFromRangeCfi(t.elementCfi);
                    if (!c) return void console.warn("Range for cfi=" + t.elementCfi + " not found!");
                    var u = K(e, c);
                    if (G(e, u, 60)) return void D(t.initiator, t.spineItem, t.elementId);
                    a = u.top;
                } else if (t.firstPage) a = 0;
                else if (t.lastPage) {
                    if (((n = A()), 0 === n)) return;
                    a = U() - L() - 5;
                } else e ? ((o = z(e)), (a = o.top)) : (a = 0);
                M() != a
                    ? ((he = !0),
                      v(a, t),
                      setTimeout(function () {
                          he = !1;
                      }, ae + 100))
                    : D(t.initiator, t.spineItem, t.elementId);
            }
            function A() {
                return Math.ceil(U() / L());
            }
            function D(t, n, r) {
                e.logEvent("InternalEvents.CURRENT_VIEW_PAGINATION_CHANGED", "EMIT", "scroll_view.js"),
                    se.emit(e.InternalEvents.CURRENT_VIEW_PAGINATION_CHANGED, { paginationInfo: se.getPaginationInfo(), initiator: t, spineItem: n, elementId: r });
            }
            function M() {
                return ne[0].scrollTop;
            }
            function F() {
                return U() - (M() + L());
            }
            function L() {
                return ne.height();
            }
            function U() {
                return ne[0].scrollHeight;
            }
            function B() {
                var e = [],
                    t = H(-ie);
                return (
                    R(function (n) {
                        if (j(n, t)) e.push(n);
                        else if (e.length > 0) return !1;
                        return !0;
                    }, !1),
                    e
                );
            }
            function j(e, t) {
                var n = z(e);
                return W($(n, t)) > 0;
            }
            function z(e) {
                var t = { top: 0, bottom: 0 },
                    n = e.element(),
                    r = n.position();
                if (Y) {
                    var i = n.offsetParent();
                    (r.top -= i.scrollTop()), (r.left -= i.scrollLeft());
                }
                return (t.top = r.top + M()), (t.bottom = t.top + e.getCalculatedPageHeight()), t;
            }
            function V(e) {
                var t,
                    n = H(),
                    r = void 0,
                    i = { top: 0, bottom: 0 },
                    o = !1;
                return (
                    R(function (a) {
                        if (((t = z(a)), (i.top = Math.max(t.top, n.top) - t.top), (i.bottom = Math.min(t.bottom, n.bottom) - t.top), W(i) > 0)) {
                            if (((o = !0), (r = e(a, i)))) return !1;
                        } else if (o) return !1;
                        return !0;
                    }, !1),
                    r
                );
            }
            function H(e) {
                0 === e || e || (e = 0);
                var t = { top: M() - e, bottom: M() + L() + e };
                return t.top < 0 && (t.top = 0), t.bottom > U() && (t.bottom = U()), t;
            }
            function $(e, t) {
                return { top: Math.max(e.top, t.top), bottom: Math.min(e.bottom, t.bottom) };
            }
            function W(e) {
                return e.bottom < e.top ? 0 : e.bottom - e.top;
            }
            function q(e, t, n) {
                var r = J(e, t);
                return G(r, n);
            }
            function G(e, t) {
                var n = H(),
                    r = Math.min(W(n), W(e));
                0 === r && (r = 5);
                var i = $(n, e),
                    o = (W(i) / r) * 100;
                return o >= t;
            }
            function J(e, t) {
                var n = z(e),
                    r = { top: 0, bottom: 0 };
                return (r.top = t.offset().top + n.top), (r.bottom = r.top + t.height()), r;
            }
            function K(e, t) {
                var n = z(e),
                    r = { top: 0, bottom: 0 },
                    i = t.getBoundingClientRect();
                return (r.top = i.top + n.top), (r.bottom = r.top + i.height), r;
            }
            function X(e) {
                var t,
                    n,
                    r = B(),
                    i = e(r),
                    o = i.element().position().top,
                    a = [
                        function () {
                            t = { top: o, left: 0 };
                        },
                        function () {
                            var e = i.element().height();
                            o >= 0 && (e = L() - o), (n = { width: i.element().width(), height: e }), (t = { top: 0, left: 0 });
                        },
                    ];
                e(a)();
                var s = [i.getFirstVisibleCfi, i.getLastVisibleCfi];
                return e(s)(t, n);
            }
            var Q = !1,
                Y = !1;
            try {
                var Z = t.fn.jquery.split(".");
                2 == parseInt(Z[0]) && 2 == parseInt(Z[1]) && 0 == parseInt(Z[2]) && (Y = !0);
            } catch (e) {
                console.error(e);
            }
            t.extend(this, new r());
            var ee,
                te,
                ne,
                re,
                ie = 5,
                oe = 2e3,
                ae = 300,
                se = this,
                le = i.$viewport,
                ce = i.spine,
                ue = i.userStyles,
                de = !1,
                fe = !1,
                he = !1,
                pe = !1;
            (this.isContinuousScroll = function () {
                return u;
            }),
                (this.render = function () {
                    var e = a.loadTemplate("scrolled_book_frame", {});
                    (re = t(e)),
                        le.append(re),
                        (ne = t("#scrolled-content-frame", re)),
                        ne.css("overflow", ""),
                        ne.css("overflow-y", "auto"),
                        ne.css("overflow-x", "hidden"),
                        ne.css("-webkit-overflow-scrolling", "touch"),
                        ne.css("width", "100%"),
                        ne.css("height", "100%"),
                        ne.css("position", "relative");
                    var r = d.viewerSettings();
                    (r && "undefined" != typeof r.enableGPUHardwareAccelerationCSS3D) || (r = new c({})), r.enableGPUHardwareAccelerationCSS3D && ne.css("transform", "translateZ(0)"), se.applyStyles();
                    var i = n.debounce(m, ae);
                    return (
                        ne.on("scroll", function (e) {
                            i(e), g();
                        }),
                        se
                    );
                });
            var ge = !1;
            (this.remove = function () {
                re.remove();
            }),
                (this.onViewportResize = function () {}),
                (this.resetCurrentPosition = function () {
                    te = void 0;
                }),
                (this.saveCurrentPosition = function () {
                    if (!ee) {
                        var e = se.getFirstVisibleCfi(),
                            t = ce.getItemById(e.idref);
                        t && ((te = new l(t, se)), te.setElementCfi(e.contentCFI));
                    }
                }),
                (this.restoreCurrentPosition = function () {
                    te && this.openPageInternal(te);
                });
            var me = void 0;
            (this.setViewSettings = function (e) {
                (me = e),
                    R(function (t) {
                        t.setViewSettings(e);
                    }, !1);
            }),
                (this.applyStyles = function () {
                    a.setStyles(ue.getStyles(), re.parent());
                    var e = a.Margins.fromElement(re);
                    C(e.padding);
                }),
                (this.applyBookStyles = function () {
                    R(function (e) {
                        e.applyBookStyles();
                    }, !1);
                }),
                (this.openPageInternal = function (e) {
                    de = !0;
                    var t = function (e, t) {
                        (ee = void 0), O(e, t), (de = !1), p(e);
                    };
                    if (e.spineItem) {
                        var n = S(e.spineItem);
                        n
                            ? t(n, e)
                            : ((ee = e),
                              (pe = !0),
                              N(e.spineItem, function (n) {
                                  setTimeout(function () {
                                      pe = !1;
                                  }, ae + 100),
                                      n && ee ? (n.currentSpineItem() === ee.spineItem ? t(n, ee) : se.openPage(ee)) : D(e.initiator, e.spineItem, e.elementId);
                              }));
                    } else t(void 0, e);
                }),
                (this.openPage = function (e) {
                    this.resetCurrentPosition(), (te = e), this.openPageInternal(e);
                }),
                (this.openPageNext = function (e) {
                    var t;
                    F() > 0 && ((t = new l(void 0, e)), (t.scrollTop = M() + Math.min(F(), L() - ie)), O(void 0, t));
                }),
                (this.openPagePrev = function (e) {
                    var t;
                    M() > 0 && ((t = new l(void 0, e)), (t.scrollTop = M() - (L() - ie)), t.scrollTop < 0 && (t.scrollTop = 0), O(void 0, t));
                }),
                (this.getPaginationInfo = function () {
                    for (var e, t, n, r, i, a, s, l, c = H(), u = c.bottom - c.top, d = new o(ce, !1), f = B(), h = 0, p = f.length; h < p; h++)
                        (n = f[h]),
                            (e = n.currentSpineItem()),
                            (r = z(n)),
                            (i = Math.max(c.top - r.top, 0)),
                            (a = Math.max(r.bottom - c.bottom, 0)),
                            (s = Math.ceil(i / u)),
                            (l = Math.ceil(a / u)),
                            (t = s + l + 1),
                            d.addOpenPage(s, t, e.idref, e.index);
                    return d;
                }),
                (this.bookmarkCurrentPage = function () {
                    return se.getFirstVisibleCfi();
                }),
                (this.getLoadedSpineItems = function () {
                    var e = [];
                    return (
                        R(function (t) {
                            e.push(t.currentSpineItem());
                        }, !1),
                        e
                    );
                }),
                (this.getElement = function (e, t) {
                    var n = void 0;
                    return (
                        R(function (r) {
                            return r.currentSpineItem().idref != e || ((n = r.getNavigator().getElement(t)), !1);
                        }, !1),
                        n
                    );
                }),
                (this.getElementById = function (e, t) {
                    var n = void 0;
                    return (
                        R(function (r) {
                            return r.currentSpineItem().idref != e || ((n = r.getNavigator().getElementById(t)), !1);
                        }, !1),
                        n ? n : void console.error("spine item is not loaded")
                    );
                }),
                (this.getElementByCfi = function (e, t, n, r, i) {
                    var o = void 0;
                    return (
                        R(function (a) {
                            return a.currentSpineItem().idref != e || ((o = a.getNavigator().getElementByCfi(t, n, r, i)), !1);
                        }, !1),
                        o ? o : void console.error("spine item is not loaded")
                    );
                }),
                (this.getFirstVisibleMediaOverlayElement = function () {
                    return V(function (e, t) {
                        return e.getNavigator().getFirstVisibleMediaOverlayElement(t);
                    });
                }),
                (this.insureElementVisibility = function (e, n, r) {
                    var i = void 0;
                    if (
                        (R(function (t) {
                            return t.currentSpineItem().idref !== e || ((i = t), !1);
                        }, !1),
                        !i)
                    )
                        return void console.warn("Page for element " + n + " not found");
                    var o = t(n),
                        a = J(i, o);
                    if (!G(a, 60)) {
                        var s = ce.getItemById(e),
                            c = new l(s, r);
                        (c.scrollTop = a.top), se.openPage(c);
                    }
                }),
                (this.getVisibleElements = function (e, t) {
                    var r = [];
                    return (
                        R(function (i) {
                            t ? r.push({ elements: i.getVisibleElements(e), spineItem: i.currentSpineItem() }) : (r = n.flatten([r, i.getVisibleElements(e)], !0));
                        }),
                        r
                    );
                }),
                (this.getVisibleElementsWithFilter = function (e) {
                    console.warn("getVisibleElementsWithFilter: Not implemented yet for scroll_view");
                }),
                (this.isElementVisible = function (e) {
                    console.warn("isElementVisible: Not implemented yet for scroll_view");
                }),
                (this.getElements = function (e, t) {
                    var n = S(e);
                    if (n) return n.getElements(e, t);
                }),
                (this.isNodeFromRangeCfiVisible = function (e, t) {
                    var n = S(spineIdRef);
                    if (n) return n.isNodeFromRangeCfiVisible(spineIdRef, t);
                }),
                (this.isVisibleSpineItemElementCfi = function (e, t) {
                    var n = S(e);
                    if (n) return n.isVisibleSpineItemElementCfi(e, t);
                }),
                (this.getNodeRangeInfoFromCfi = function (e, t) {
                    var n = S(e);
                    if (n) return n.isVisibleSpineItemElementCfi(e, t);
                }),
                (this.getFirstVisibleCfi = function () {
                    return X(n.first);
                }),
                (this.getLastVisibleCfi = function () {
                    return X(n.last);
                }),
                (this.getDomRangeFromRangeCfi = function (e, t, n) {
                    return t && e.idref !== t.idref
                        ? void console.error("getDomRangeFromRangeCfi: both CFIs must be scoped under the same spineitem idref")
                        : ((e = e || {}),
                          (t = t || {}),
                          V(function (r) {
                              if (r.currentSpineItem().idref === e.idref) return r.getDomRangeFromRangeCfi(e.contentCFI, t.contentCFI, n);
                          }));
                }),
                (this.getRangeCfiFromDomRange = function (e) {
                    return V(function (t) {
                        return t.getRangeCfiFromDomRange(e);
                    });
                }),
                (this.getVisibleCfiFromPoint = function (e, t, n) {
                    return V(function (r) {
                        return createBookmark(r.currentSpineItem(), r.getVisibleCfiFromPoint(e, t, n));
                    });
                }),
                (this.getRangeCfiFromPoints = function (e, t, n, r) {
                    return V(function (i) {
                        return createBookmark(i.currentSpineItem(), i.getRangeCfiFromPoints(e, t, n, r));
                    });
                }),
                (this.getCfiForElement = function (e) {
                    return V(function (t) {
                        return createBookmark(t.currentSpineItem(), t.getCfiForElement(e));
                    });
                }),
                (this.getElementFromPoint = function (e, t) {
                    return V(function (n) {
                        return n.getElementFromPoint(e, t);
                    });
                });
        };
        return u;
    }),
    define("readium_shared_js/views/media_overlay_player", ["../globals", "jquery", "../helpers", "./audio_player", "./media_overlay_element_highlighter", "../models/smil_iterator", "rangy", "readium_cfi_js", "./scroll_view"], function (
        e,
        t,
        n,
        r,
        i,
        o,
        a,
        s,
        l
    ) {
        var c = function (s, c) {
            function u(e) {
                var t = e.getSmil();
                return _ && _.smil == t ? _.reset() : (_ = new o(t)), _.goToPar(e), _.currentPar ? void f() : void console.error("playPar !_smilIterator.currentPar");
            }
            function d() {
                N.resetBlankPage(),
                    (F = setTimeout(function () {
                        if (F) {
                            if ((N.resetBlankPage(), !_ || !_.currentPar)) return void N.reset();
                            (U = 0), p(_.currentPar.audio.clipEnd + 0.1, 2);
                        }
                    }, 2e3)),
                    c({ isPlaying: !0 });
            }
            function f() {
                if (((W = !1), !_ || !_.currentPar)) return void console.error("playCurrentPar !_smilIterator || !_smilIterator.currentPar ???");
                if (!_.smil.id)
                    return (
                        w.reset(),
                        N.resetTTS(),
                        N.resetEmbedded(),
                        void setTimeout(function () {
                            d();
                        }, 100)
                    );
                if (_.currentPar.audio.src) {
                    N.resetTTS(), N.resetEmbedded(), N.resetBlankPage();
                    var e = _.currentPar.audio.clipEnd - _.currentPar.audio.clipBegin;
                    (e <= 0 || M > e) && (console.error("### MO XXX PAR OFFSET: " + M + " / " + e), (M = 0));
                    var r = n.ResolveContentRef(_.currentPar.audio.src, _.smil.href),
                        i = k.resolveRelativeUrlMO(r),
                        o = _.currentPar.audio.clipBegin + M;
                    w.playFile(_.currentPar.audio.src, i, o);
                } else {
                    (M = 0), w.reset();
                    var s = _.currentPar.element;
                    if (s) {
                        U = 0;
                        var l = s.nodeName ? s.nodeName.toLowerCase() : void 0;
                        "audio" === l || "video" === l
                            ? (N.resetTTS(),
                              N.resetBlankPage(),
                              I && N.resetEmbedded(),
                              (I = s),
                              I.pause(),
                              (I.currentTime = 0),
                              I.play(),
                              t(I).on("ended", N.onEmbeddedEnd),
                              (R = !0),
                              setTimeout(function () {
                                  c({ isPlaying: !0 });
                              }, 80))
                            : (N.resetEmbedded(), N.resetBlankPage(), (E = s.textContent), E && "" != E ? V(E) : (E = void 0));
                    }
                    var u = _.currentPar.cfi;
                    if (u) {
                        (U = 0), N.resetEmbedded(), N.resetBlankPage(), O.reset();
                        var f = u.cfiTextParent.ownerDocument,
                            h = "epubcfi(" + u.partialStartCfi + ")",
                            p = EPUBcfi.getTextTerminusInfoWithPartialCFI(h, f, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]),
                            g = "epubcfi(" + u.partialEndCfi + ")",
                            m = EPUBcfi.getTextTerminusInfoWithPartialCFI(g, f, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]);
                        if (a) {
                            var v = a.createRange(f);
                            v.setStartAndEnd(p.textNode, p.textOffset, m.textNode, m.textOffset), (E = v.toString());
                        } else E = void 0;
                        E && "" != E ? V(E) : (E = void 0);
                    }
                }
                (M = 0), y();
            }
            function h(e) {
                N.pause();
                var t = e ? k.media_overlay.getNextSmil(_.smil) : k.media_overlay.getPreviousSmil(_.smil);
                if (t) {
                    if (((_ = new o(t)), _.currentPar)) {
                        if (!e) for (; !_.isLast(); ) _.next();
                        s.openContentUrl(_.currentPar.text.src, _.smil.href, N);
                    }
                } else console.log("No more SMIL"), N.reset();
            }
            function p(e, t, n) {
                if (((U = e), (L = !1), _ && _.currentPar)) {
                    var r = _.currentPar,
                        i = _.currentPar.audio;
                    if (!(e > B && e <= i.clipEnd)) {
                        L = !0;
                        var o = w.isPlaying();
                        o && 6 === t && console.debug("from userNav _audioPlayer.isPlaying() ???");
                        var a = e > i.clipEnd,
                            s = !G && 6 !== t && a,
                            l = _ && _.smil && _.smil.spineItemId ? _.smil.spineItemId : D && D.spineItem && D.spineItem.idref ? D.spineItem.idref : void 0;
                        if (s && l && D && D.paginationInfo && D.paginationInfo.openPages && D.paginationInfo.openPages.length > 1) {
                            var c = 0,
                                u = D.paginationInfo.openPages[c];
                            l === u.idref && (s = !1);
                        }
                        if ((a ? _.next() : _.previous(), !_.currentPar)) return void (s ? ((q = !0), N.reset()) : h(a));
                        if (!_.currentPar.audio) return void N.pause();
                        if (P.mediaOverlaysSkipSkippables) {
                            for (var d = !1, g = _.currentPar; g; ) {
                                if (g.isSkippable && g.isSkippable(P.mediaOverlaysSkippables)) {
                                    d = !0;
                                    break;
                                }
                                g = g.parent;
                            }
                            if (d) {
                                console.log("MO SKIP: " + g.epubtype), N.pause();
                                var m = a ? _.currentPar.audio.clipEnd + 0.1 : B - 1;
                                return void p(m, t, !0);
                            }
                        }
                        if (!o && (_.currentPar.element || (_.currentPar.cfi && _.currentPar.cfi.cfiTextParent))) {
                            var v = O.adjustParToSeqSyncGranularity(_.currentPar);
                            if (v && v !== _.currentPar) {
                                var b = O.adjustParToSeqSyncGranularity(r);
                                if (b && (b === v || !a)) {
                                    if (b === v) {
                                        do a ? _.next() : _.previous();
                                        while (_.currentPar && _.currentPar.hasAncestor(b));
                                        if (!_.currentPar) return void (s ? ((q = !0), N.reset()) : h(a));
                                    }
                                    if (!a) {
                                        var x = O.adjustParToSeqSyncGranularity(_.currentPar);
                                        if (x && x !== _.currentPar) {
                                            var E = _.currentPar,
                                                C = void 0;
                                            do (C = _.currentPar), _.previous();
                                            while (_.currentPar && _.currentPar.hasAncestor(x));
                                            _.currentPar
                                                ? (_.next(), _.currentPar.hasAncestor(x) || console.error("adjustParToSeqSyncGranularity !_smilIterator.currentPar.hasAncestor(landed) ???"))
                                                : (_.reset(), _.currentPar !== C && console.error("adjustParToSeqSyncGranularity _smilIterator.currentPar !=== innerPar???")),
                                                _.currentPar || (console.error("adjustParToSeqSyncGranularity !_smilIterator.currentPar ?????"), _.goToPar(E));
                                        }
                                    }
                                }
                            }
                        }
                        return w.isPlaying() && _.currentPar.audio.src && _.currentPar.audio.src == w.currentSmilSrc() && e >= _.currentPar.audio.clipBegin && e <= _.currentPar.audio.clipEnd ? void y() : void f();
                    }
                }
            }
            function g(e) {
                if (!z || z[0].ownerDocument !== e[0].ownerDocument) {
                    var n = ".tts_on{background-color:red;color:white;} .tts_off{}";
                    ($head = t("head", e[0].ownerDocument.documentElement)), (z = t("<style type='text/css'> </style>").appendTo($head)), z.append(n);
                }
            }
            function m() {
                v();
                var e = function () {
                    if (_ && _.currentPar) {
                        var e = _.smil;
                        if (e.mo) {
                            var t = U - _.currentPar.audio.clipBegin;
                            if (!(t <= 0)) {
                                for (var n = e.mo.smil_models.indexOf(e), r = new o(e), i = -1; r.currentPar && (i++, r.currentPar != _.currentPar); ) r.next();
                                c({ playPosition: t, smilIndex: n, parIndex: i });
                            }
                        }
                    }
                };
                setTimeout(e, 500), ($ = setInterval(e, 1500));
            }
            function v() {
                (U = 0), void 0 !== $ && clearInterval($), ($ = void 0);
            }
            function b() {
                return v(), L ? void (L = !1) : _ && _.currentPar ? void p(_.currentPar.audio.clipEnd + 0.1, 5) : void N.reset();
            }
            function y() {
                if (_ && _.currentPar) {
                    if (_.currentPar.text.srcFragmentId && _.currentPar.text.srcFragmentId.length > 0) {
                        if (_.currentPar.element)
                            return void (
                                O.isElementHighlighted(_.currentPar) ||
                                (O.highlightElement(_.currentPar, k.media_overlay.activeClass, k.media_overlay.playbackActiveClass), W || s.insureElementVisibility(_.currentPar.getSmil().spineItemId, _.currentPar.element, N))
                            );
                        if (_.currentPar.cfi)
                            return void (
                                O.isCfiHighlighted(_.currentPar) ||
                                (O.highlightCfi(_.currentPar, k.media_overlay.activeClass, k.media_overlay.playbackActiveClass), W || s.insureElementVisibility(_.currentPar.getSmil().spineItemId, _.currentPar.cfi.cfiTextParent, N))
                            );
                    }
                    if (!_.currentPar.element) {
                        var e = _.currentPar.text.src,
                            t = _.smil.href;
                        (_ = void 0), s.openContentUrl(e, t, N);
                    }
                }
            }
            var _ = void 0,
                w = new r(c, p, b, m, v),
                x = !1,
                E = void 0,
                C = "undefined" != typeof window.speechSynthesis && null != speechSynthesis,
                T = void 0,
                S = !1,
                R = !1,
                I = void 0;
            this.isPlaying = function () {
                return w.isPlaying() || x || R || F;
            };
            var k = s.package(),
                P = s.viewerSettings(),
                N = this,
                O = new i(s);
            s.on(e.Events.READER_VIEW_DESTROYED, function () {
                e.logEvent("READER_VIEW_DESTROYED", "ON", "media_overlay_player.js"), N.reset();
            }),
                (this.applyStyles = function () {
                    O.reDo();
                }),
                (this.onSettingsApplied = function () {
                    w.setRate(P.mediaOverlaysRate), w.setVolume(P.mediaOverlaysVolume / 100);
                }),
                N.onSettingsApplied(),
                s.on(
                    e.Events.SETTINGS_APPLIED,
                    function () {
                        e.logEvent("SETTINGS_APPLIED", "ON", "media_overlay_player.js"), this.onSettingsApplied();
                    },
                    this
                );
            var A = !1;
            this.onDocLoadStart = function () {
                var e = N.isPlaying();
                e && ((A = !0), N.pause());
            };
            var D = void 0;
            this.onPageChanged = function (e) {
                D = e;
                var n = q;
                q = !1;
                var r = A;
                if (((A = !1), !e)) return void N.reset();
                var i = void 0,
                    o = "/99!",
                    a = "epubcfi";
                if (e.elementId || e.initiator == N) {
                    for (var l = s.getLoadedSpineItems(), c = s.spine().isRightToLeft(), d = c ? l.length - 1 : 0; (c && d >= 0) || (!c && d < l.length); d += c ? -1 : 1) {
                        var h = l[d];
                        if (!e.spineItem || e.spineItem == h) {
                            if (e.elementId && 0 === e.elementId.indexOf(a)) {
                                O.reset();
                                var p = e.elementId.substr(a.length + 1, e.elementId.length - a.length - 2);
                                0 === p.indexOf(o) && (p = p.substr(o.length, p.length - o.length));
                                var g = p.split(",");
                                if (g && 3 === g.length)
                                    try {
                                        var m = g[0] + g[1],
                                            v = s.getElementByCfi(h.idref, m, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]);
                                        if ((i = v && v.length > 0 ? v[0] : void 0)) {
                                            i.nodeType === Node.TEXT_NODE && (i = i.parentNode);
                                            break;
                                        }
                                    } catch (e) {
                                        console.error(e);
                                    }
                                else
                                    try {
                                        var v = s.getElementByCfi(h.idref, p, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"]);
                                        if ((i = v && v.length > 0 ? v[0] : void 0)) {
                                            i.nodeType === Node.TEXT_NODE && (i = i.parentNode);
                                            break;
                                        }
                                    } catch (e) {
                                        console.error(e);
                                    }
                            }
                            if (!i) {
                                if (e.initiator != N || e.elementId) {
                                    var v = s.getElementById(h.idref, e.elementId);
                                    i = v && v.length > 0 ? v[0] : void 0;
                                } else {
                                    var v = s.getElement(h.idref, "body");
                                    i = v && v.length > 0 ? v[0] : void 0;
                                }
                                if (i) break;
                            }
                        }
                    }
                    i || console.error("paginationData.elementId BUT !element: " + e.elementId);
                }
                var b = N.isPlaying() || r;
                if (!_ || !_.currentPar) {
                    if (e.initiator !== N) return (M = 0), N.reset(), void (e.elementId && i ? (b || n) && ((e.elementIdResolved = i), N.toggleMediaOverlayRefresh(e)) : (b || n) && N.toggleMediaOverlay());
                    if (!i) return console.error("!element: " + e.elementId), void (M = 0);
                    var w = t(i).data("mediaOverlayData");
                    if (!w) return console.error("!moData: " + e.elementId), void (M = 0);
                    var x = w.par ? w.par : w.pars[0];
                    if (w.pars)
                        for (var E = 0; E < w.pars.length; E++) {
                            var C = w.pars[E];
                            if (e.elementId === C.cfi.smilTextSrcCfi) {
                                x = C;
                                break;
                            }
                        }
                    return void u(x);
                }
                var T = !_.currentPar.element && !_.currentPar.cfi;
                if ((T && console.error("!! _smilIterator.currentPar.element ??"), e.initiator == N)) {
                    var S = e.elementId && e.elementId !== _.currentPar.text.srcFragmentId;
                    if ((S && console.error("!! paginationData.elementId !== _smilIterator.currentPar.text.srcFragmentId"), S || T)) return void (M = 0);
                    b ? y() : f();
                } else {
                    if (!b && !n) return void N.reset();
                    if ((!e.elementId, e.elementId && !i)) return;
                    e.elementId && (e.elementIdResolved = i), N.toggleMediaOverlayRefresh(e);
                }
            };
            var M = 0,
                F = void 0,
                L = !1,
                U = 0,
                B = -999;
            this.touchInit = function () {
                var e = w.touchInit();
                e && C && V("o", 0);
            };
            var j = function (e) {
                    var t = ["p", "div", "pagenum", "td", "table", "li", "ul", "ol"],
                        n = [",", ";", ".", "-", "??", "??", "?", "!"],
                        r = function (e, t) {
                            if (!(e.word.length <= 0)) {
                                var n = e.text.length;
                                (t.spanMap[n] = e.counter),
                                    (e.text += e.word),
                                    (e.markup += e.html.substring(0, e.wordStart) + '<span class="tts_off" id="tts_' + e.counter + '">' + e.html.substring(e.wordStart, e.wordEnd) + "</span>" + e.html.substring(e.wordEnd, e.html.length)),
                                    (e.word = ""),
                                    (e.html = ""),
                                    (e.wordStart = -1),
                                    (e.wordEnd = -1),
                                    e.counter++;
                            }
                        },
                        i = { element: e, innerHTML_tts: "", spanMap: {}, text: "", lastCharIndex: void 0 };
                    i.element.innerHTML_original = e.innerHTML;
                    for (var o = { inTag: !1, counter: 0, wordStart: -1, wordEnd: -1, text: "", markup: "", word: "", html: "" }, a = i.element.innerHTML_original.length, s = 0; s <= a; ) {
                        if (o.inTag) {
                            if (((o.html += i.element.innerHTML_original[s]), ">" == i.element.innerHTML_original[s])) {
                                o.inTag = !1;
                                var l = o.html.match(/<\/(.*?)>$/);
                                l && t.indexOf(l[1]) > -1 && (r(o, i), (o.text += " "));
                            }
                        } else
                            s == a || i.element.innerHTML_original[s].match(/\s/)
                                ? (r(o, i), s < a && ((o.text += i.element.innerHTML_original[s]), (o.markup += i.element.innerHTML_original[s])))
                                : n.indexOf(i.element.innerHTML_original[s]) > -1
                                ? (r(o, i), (o.wordStart = o.html.length), (o.wordEnd = o.html.length + 1), (o.word += i.element.innerHTML_original[s]), (o.html += i.element.innerHTML_original[s]), r(o, i))
                                : "<" == i.element.innerHTML_original[s]
                                ? ((o.inTag = !0), (o.html += i.element.innerHTML_original[s]))
                                : (0 == o.word.length && (o.wordStart = o.html.length), (o.wordEnd = o.html.length + 1), (o.word += i.element.innerHTML_original[s]), (o.html += i.element.innerHTML_original[s]));
                        s++;
                    }
                    return (i.text = o.text), (i.innerHTML_tts = o.markup), (i.element.innerHTML = i.innerHTML_tts), i;
                },
                z = void 0,
                V = function (n, r) {
                    function i(e) {
                        e || window.speechSynthesis.pending
                            ? (console.debug("TTS cancel before speak"),
                              window.speechSynthesis.cancel(),
                              setTimeout(function () {
                                  i(!1);
                              }, 5))
                            : o();
                    }
                    function o() {
                        (T = new SpeechSynthesisUtterance()),
                            S &&
                                a &&
                                ((T.tokenData = a),
                                (T.onboundary = function (e) {
                                    if (T) {
                                        console.debug("TTS boundary: " + e.name + " / " + e.charIndex);
                                        var t = e.target.tokenData;
                                        if (t && t.spanMap.hasOwnProperty(e.charIndex)) {
                                            var n;
                                            [].forEach.call(t.element.querySelectorAll(".tts_on"), function (e) {
                                                console.debug("TTS OFF " + e.id), (e.className = "tts_off");
                                            });
                                            var n = "tts_" + t.spanMap[e.charIndex];
                                            console.debug("TTS charIndex ID: " + n);
                                            var r = t.element.querySelector("#" + n);
                                            r && (console.debug("TTS ON"), (r.className = "tts_on")), (t.lastCharIndex = e.charIndex);
                                        }
                                    }
                                })),
                            (T.onend = function (e) {
                                if (T)
                                    if ((console.debug("TTS ended"), S)) {
                                        var t = e.target.tokenData,
                                            n = !e.forceSkipEnd && T === e.target && (!t || t.element.innerHTML_original);
                                        t &&
                                            (t.element.innerHTML_original
                                                ? (t.element.innerHTML = t.element.innerHTML_original)
                                                : [].forEach.call(t.element.querySelectorAll(".tts_on"), function (e) {
                                                      console.debug("TTS OFF (end)" + e.id), (e.className = "tts_off");
                                                  }),
                                            (t.element.innerHTML_original = void 0)),
                                            n ? N.onTTSEnd() : console.debug("TTS end SKIPPED");
                                    } else N.onTTSEnd();
                            }),
                            (T.onerror = function (e) {
                                if (T && (console.error("TTS error"), console.debug(T.text), console.debug(window.speechSynthesis.paused), console.debug(window.speechSynthesis.pending), console.debug(window.speechSynthesis.speaking), S)) {
                                    var t = e.target.tokenData;
                                    t &&
                                        (t.element.innerHTML_original
                                            ? (t.element.innerHTML = t.element.innerHTML_original)
                                            : [].forEach.call(t.element.ownerDocument.querySelectorAll(".tts_on"), function (e) {
                                                  console.debug("TTS OFF (error)" + e.id), (e.className = "tts_off");
                                              }),
                                        (t.element.innerHTML_original = void 0));
                                }
                            });
                        var e = r || w.getVolume();
                        (T.volume = e), (T.rate = w.getRate()), (T.pitch = 1), (T.text = f), window.speechSynthesis.speak(T), window.speechSynthesis.paused && (console.debug("TTS resume"), window.speechSynthesis.resume());
                    }
                    var a = void 0,
                        l = _ && _.currentPar ? _.currentPar : void 0,
                        u = l ? l.element : void 0;
                    l ? l.cfi : void 0;
                    if (
                        (!r || r > 0) &&
                        (setTimeout(function () {
                            c({ isPlaying: !0 });
                        }, 80),
                        (x = !0),
                        S && u)
                    ) {
                        var d = t(u);
                        g(d), u.innerHTML_original && ((u.innerHTML = u.innerHTML_original), (u.innerHTML_original = void 0)), (a = j(u));
                    }
                    if (!C) return e.logEvent("MEDIA_OVERLAY_TTS_SPEAK", "EMIT", "media_overlay_player.js"), void s.emit(e.Events.MEDIA_OVERLAY_TTS_SPEAK, { tts: n });
                    if (!n && window.speechSynthesis.paused) return void window.speechSynthesis.resume();
                    var f = n || E;
                    f &&
                        (T && (S && (T.onend && T.onend({ forceSkipEnd: !0, target: T }), (T.tokenData = void 0), (T.onboundary = void 0)), (T.onend = void 0), (T.onerror = void 0), (T = void 0)),
                        console.debug("paused: " + window.speechSynthesis.paused),
                        console.debug("speaking: " + window.speechSynthesis.speaking),
                        console.debug("pending: " + window.speechSynthesis.pending),
                        i(!0));
                },
                H = function () {
                    var t = x;
                    return (
                        t && c({ isPlaying: !1 }), (x = !1), C ? void window.speechSynthesis.pause() : void (t && (e.logEvent("MEDIA_OVERLAY_TTS_STOP", "EMIT", "media_overlay_player.js"), s.emit(e.Events.MEDIA_OVERLAY_TTS_STOP, void 0)))
                    );
                },
                $ = void 0;
            (this.onEmbeddedEnd = function () {
                return (U = 0), (R = !1), _ && _.currentPar ? void p(_.currentPar.audio.clipEnd + 0.1, 3) : void N.reset();
            }),
                (this.onTTSEnd = function () {
                    return (U = 0), (x = !1), _ && _.currentPar ? void p(_.currentPar.audio.clipEnd + 0.1, 4) : void N.reset();
                }),
                (this.escape = function () {
                    if (!_ || !_.currentPar) return void this.toggleMediaOverlay();
                    if (!N.isPlaying()) return void N.play();
                    if (P.mediaOverlaysEscapeEscapables)
                        for (var e = _.currentPar; e; ) {
                            if (e.isEscapable && e.isEscapable(P.mediaOverlaysEscapables)) {
                                do _.next();
                                while (_.currentPar && _.currentPar.hasAncestor(e));
                                return _.currentPar ? void f() : void h(!0);
                            }
                            e = e.parent;
                        }
                    this.nextMediaOverlay(!0);
                }),
                (this.playUserPar = function (e) {
                    if ((N.isPlaying() && N.pause(), e.element || (e.cfi && e.cfi.cfiTextParent))) {
                        var t = O.adjustParToSeqSyncGranularity(e);
                        if (t && t !== e) {
                            var n = function (e) {
                                    if (e.nodeType && "par" === e.nodeType) return e;
                                    if (e.children && !(e.children.length <= 0))
                                        for (var t = 0; t < e.children.length; t++) {
                                            var r = e.children[t],
                                                i = n(r);
                                            if (i) return i;
                                        }
                                },
                                r = n(t);
                            r && (e = r);
                        }
                    }
                    u(e);
                }),
                (this.resetTTS = function () {
                    (E = void 0), H();
                }),
                (this.resetBlankPage = function () {
                    var e = !1;
                    if (F) {
                        e = !0;
                        var t = F;
                        (F = void 0), clearTimeout(t);
                    }
                    (F = void 0), e && c({ isPlaying: !1 });
                }),
                (this.resetEmbedded = function () {
                    var e = R;
                    I && (t(I).off("ended", N.onEmbeddedEnd), I.pause()), (I = void 0), e && c({ isPlaying: !1 }), (R = !1);
                }),
                (this.reset = function () {
                    (M = 0), w.reset(), N.resetTTS(), N.resetEmbedded(), N.resetBlankPage(), O.reset(), (_ = void 0), (L = !1);
                }),
                (this.play = function () {
                    if (_ && _.smil && !_.smil.id) return void d();
                    if (I) (R = !0), I.play(), c({ isPlaying: !0 });
                    else if (E) V(void 0);
                    else if (!w.play()) return console.log("Audio player was dead, reactivating..."), this.reset(), void this.toggleMediaOverlay();
                    y();
                }),
                (this.pause = function () {
                    (W = !1), F ? this.resetBlankPage() : R ? ((R = !1), I && I.pause(), c({ isPlaying: !1 })) : x ? H() : w.pause(), O.reset();
                }),
                (this.isMediaOverlayAvailable = function () {
                    var e = s.getFirstVisibleMediaOverlayElement();
                    return "undefined" != typeof e;
                }),
                (this.nextOrPreviousMediaOverlay = function (e) {
                    if (N.isPlaying()) N.pause();
                    else if (_ && _.currentPar) return void N.play();
                    if (!_) return void this.toggleMediaOverlay();
                    var t = e ? B - 1 : _.currentPar.audio.clipEnd + 0.1;
                    p(t, 6);
                }),
                (this.nextMediaOverlay = function () {
                    this.nextOrPreviousMediaOverlay(!1);
                }),
                (this.previousMediaOverlay = function () {
                    this.nextOrPreviousMediaOverlay(!0);
                }),
                (this.mediaOverlaysOpenContentUrl = function (e, t, n) {
                    (M = n), (_ = void 0), s.openContentUrl(e, t, N);
                }),
                (this.toggleMediaOverlay = function () {
                    return N.isPlaying() ? void N.pause() : _ ? void N.play() : void this.toggleMediaOverlayRefresh(void 0);
                });
            var W = !1;
            (this.toggleMediaOverlayRefresh = function (e) {
                var n = s.getLoadedSpineItems(),
                    r = s.spine().isRightToLeft(),
                    i = void 0,
                    a = N.isPlaying();
                if (a && _) {
                    var c = e.initiator && e.initiator instanceof l;
                    if (c && P.mediaOverlaysPreservePlaybackWhenScroll) return void (W = !0);
                    (i = _.currentPar), N.pause();
                }
                W = !1;
                var u = e && e.elementIdResolved ? e.elementIdResolved : void 0,
                    d = e && e.elementId ? e.elementId : void 0;
                if (!u) {
                    d && console.error("[WARN] id did not resolve to element?");
                    for (var h = r ? n.length - 1 : 0; (r && h >= 0) || (!r && h < n.length); h += r ? -1 : 1) {
                        var p = n[h];
                        if (p) {
                            if (!e || !e.spineItem || e.spineItem == p) {
                                if (d) {
                                    var g = s.getElementById(p.idref, d);
                                    u = g && g.length > 0 ? g[0] : void 0;
                                } else if (p.isFixedLayout() && e && e.paginationInfo && e.paginationInfo.openPages) {
                                    var m = 0;
                                    if (e.paginationInfo.openPages[m] && e.paginationInfo.openPages[m].idref && e.paginationInfo.openPages[m].idref === p.idref) {
                                        var g = s.getElement(p.idref, "body");
                                        u = g && g.length > 0 ? g[0] : void 0;
                                    }
                                }
                                if (u) break;
                            }
                        } else console.error("spineItems[i] is undefined??");
                    }
                }
                if ((u || (u = s.getFirstVisibleMediaOverlayElement()), !u)) return void N.reset();
                var v = t(u).data("mediaOverlayData");
                if (!v) {
                    for (
                        var b = !1,
                            y = function (e) {
                                if (!e) return !1;
                                for (var n = 0; n < e.length; n++) {
                                    if ((u === e[n] && (b = !0), b)) {
                                        var r = t(e[n]).data("mediaOverlayData");
                                        if (r) return (v = r), !0;
                                    }
                                    var i = y(e[n].children);
                                    if (i) return !0;
                                }
                                return !1;
                            },
                            w = u;
                        w && "body" !== w.nodeName.toLowerCase();

                    )
                        w = w.parentNode;
                    if (!w) return void N.reset();
                    y([w]);
                }
                if (!v) return void N.reset();
                var x = v.par ? v.par : v.pars[0],
                    E = x.getSmil();
                return _ && _.smil == E ? _.reset() : (_ = new o(E)), _.goToPar(x), !_.currentPar && d && (_.reset(), _.findTextId(d)), _.currentPar ? void (a && i && i === _.currentPar ? N.play() : f()) : void N.reset();
            }),
                (this.isPlayingCfi = function () {
                    return _ && _.currentPar && _.currentPar.cfi;
                });
            var q = !1,
                G = !0;
            this.setAutomaticNextSmil = function (e) {
                G = e;
            };
        };
        return c;
    }),
    define("readium_shared_js/models/spine", ["./spine_item", "../helpers", "URIjs"], function (e, t, n) {
        var r = function (t, r) {
            function i(e) {
                return !u || "no" !== e.linear;
            }
            function o(e) {
                return e >= 0 && e < c.items.length;
            }
            function a(e) {
                if (o(e)) {
                    var t = c.items[e];
                    return i(t) ? t : a(t.index - 1);
                }
            }
            function s(e) {
                if (o(e)) {
                    var t = c.items[e];
                    return i(t) ? t : s(t.index + 1);
                }
            }
            function l() {
                for (var t = c.items.length, n = !1, r = c.isLeftToRight() ? e.SPREAD_LEFT : e.SPREAD_RIGHT, i = 0; i < t; i++) {
                    var o = c.items[i];
                    if (!o.page_spread) {
                        var a = o.isRenditionSpreadAllowed() ? (n ? r : e.alternateSpread(r)) : e.SPREAD_CENTER;
                        o.setSpread(a);
                    }
                    n = !o.isRenditionSpreadAllowed() || o.page_spread != r;
                }
            }
            var c = this;
            (this.items = []), (this.direction = "ltr"), (this.package = t);
            var u = !1;
            if (
                ((this.handleLinear = function (e) {
                    u = e;
                }),
                (this.isValidLinearItem = function (e) {
                    if (o(e)) return i(this.item(e));
                }),
                (this.isRightToLeft = function () {
                    return "rtl" == c.direction;
                }),
                (this.isLeftToRight = function () {
                    return !c.isRightToLeft();
                }),
                (this.prevItem = function (e) {
                    return a(e.index - 1);
                }),
                (this.nextItem = function (e) {
                    return s(e.index + 1);
                }),
                (this.getItemUrl = function (e) {
                    return c.package.resolveRelativeUrl(e.href);
                }),
                (this.first = function () {
                    return s(0);
                }),
                (this.last = function () {
                    return a(this.items.length - 1);
                }),
                (this.isFirstItem = function (e) {
                    return c.first() === e;
                }),
                (this.isLastItem = function (e) {
                    return c.last() === e;
                }),
                (this.item = function (e) {
                    if (o(e)) return c.items[e];
                }),
                (this.getItemById = function (e) {
                    for (var t = c.items.length, n = 0; n < t; n++) if (c.items[n].idref == e) return c.items[n];
                }),
                (this.getItemByHref = function (e) {
                    for (var t = new n(c.package.resolveRelativeUrl(e)).normalizePathname().pathname(), r = c.items.length, i = 0; i < r; i++) {
                        var o = new n(c.package.resolveRelativeUrl(c.items[i].href)).normalizePathname().pathname();
                        if (t == o) return c.items[i];
                    }
                }),
                r)
            ) {
                r.direction && (this.direction = r.direction);
                for (var d = r.items.length, f = 0; f < d; f++) {
                    var h = new e(r.items[f], f, this);
                    this.items.push(h);
                }
                l();
            }
        };
        return r;
    }),
    define("readium_shared_js/models/smil_model", ["../helpers"], function (e) {
        var t = {};
        (t.SmilNode = function (e) {
            (this.parent = e),
                (this.id = ""),
                (this.getSmil = function () {
                    for (var e = this; e.parent; ) e = e.parent;
                    return e;
                }),
                (this.hasAncestor = function (e) {
                    for (var t = this.parent; t; ) {
                        if (t == e) return !0;
                        t = t.parent;
                    }
                    return !1;
                });
        }),
            (t.TimeContainerNode = function (e) {
                (this.parent = e),
                    (this.children = void 0),
                    (this.index = void 0),
                    (this.epubtype = ""),
                    (this.isEscapable = function (e) {
                        if ("" === this.epubtype) return !1;
                        var t = this.getSmil();
                        if (!t.mo) return !1;
                        var n = t.mo.escapables;
                        e.length > 0 && (n = e);
                        for (var r = 0; r < n.length; r++) if (this.epubtype.indexOf(n[r]) >= 0) return !0;
                        return !1;
                    }),
                    (this.isSkippable = function (e) {
                        if ("" === this.epubtype) return !1;
                        var t = this.getSmil();
                        if (!t.mo) return !1;
                        var n = t.mo.skippables;
                        e.length > 0 && (n = e);
                        for (var r = 0; r < n.length; r++) if (this.epubtype.indexOf(n[r]) >= 0) return !0;
                        return !1;
                    });
            }),
            (t.TimeContainerNode.prototype = new t.SmilNode()),
            (t.MediaNode = function (e) {
                (this.parent = e), (this.src = "");
            }),
            (t.MediaNode.prototype = new t.SmilNode()),
            (t.SeqNode = function (e) {
                (this.parent = e),
                    (this.children = []),
                    (this.nodeType = "seq"),
                    (this.textref = ""),
                    (this.durationMilliseconds = function () {
                        for (var e = this.getSmil(), t = 0, n = 0; n < this.children.length; n++) {
                            var r = this.children[n];
                            if ("par" === r.nodeType) {
                                if (!r.audio) continue;
                                if (r.text && (!r.text.manifestItemId || r.text.manifestItemId != e.spineItemId)) continue;
                                var i = r.audio.clipDurationMilliseconds();
                                t += i;
                            } else "seq" === r.nodeType && (t += r.durationMilliseconds());
                        }
                        return t;
                    }),
                    (this.clipOffset = function (e, t) {
                        for (var n = this.getSmil(), r = 0; r < this.children.length; r++) {
                            var i = this.children[r];
                            if ("par" === i.nodeType) {
                                if (i == t) return !0;
                                if (!i.audio) continue;
                                if (i.text && (!i.text.manifestItemId || i.text.manifestItemId != n.spineItemId)) continue;
                                var o = i.audio.clipDurationMilliseconds();
                                e.offset += o;
                            } else if ("seq" === i.nodeType) {
                                var a = i.clipOffset(e, t);
                                if (a) return !0;
                            }
                        }
                        return !1;
                    }),
                    (this.parallelAt = function (e) {
                        for (var t = this.getSmil(), n = 0, r = 0; r < this.children.length; r++) {
                            var i = e - n,
                                o = this.children[r];
                            if ("par" === o.nodeType) {
                                if (!o.audio) continue;
                                if (o.text && (!o.text.manifestItemId || o.text.manifestItemId != t.spineItemId)) continue;
                                var a = o.audio.clipDurationMilliseconds();
                                if (a > 0 && i <= a) return o;
                                n += a;
                            } else if ("seq" === o.nodeType) {
                                var s = o.parallelAt(i);
                                if (s) return s;
                                n += o.durationMilliseconds();
                            }
                        }
                    }),
                    (this.nthParallel = function (e, t) {
                        for (var n = 0; n < this.children.length; n++) {
                            var r = this.children[n];
                            if ("par" === r.nodeType) {
                                if ((t.count++, t.count == e)) return r;
                            } else if ("seq" === r.nodeType) {
                                var i = r.nthParallel(e, t);
                                if (i) return i;
                            }
                        }
                    });
            }),
            (t.SeqNode.prototype = new t.TimeContainerNode()),
            (t.ParNode = function (e) {
                (this.parent = e),
                    (this.children = []),
                    (this.nodeType = "par"),
                    (this.text = void 0),
                    (this.audio = void 0),
                    (this.element = void 0),
                    (this.getFirstSeqAncestorWithEpubType = function (e, t) {
                        if (e)
                            for (var n = t ? this : this.parent; n; ) {
                                if (n.epubtype && n.epubtype.indexOf(e) >= 0) return n;
                                n = n.parent;
                            }
                    });
            }),
            (t.ParNode.prototype = new t.TimeContainerNode()),
            (t.TextNode = function (t) {
                (this.parent = t),
                    (this.nodeType = "text"),
                    (this.srcFile = ""),
                    (this.srcFragmentId = ""),
                    (this.manifestItemId = void 0),
                    (this.updateMediaManifestItemId = function () {
                        var t = this.getSmil();
                        if (t.href && t.href.length) {
                            for (var n = this.srcFile ? this.srcFile : this.src, r = e.ResolveContentRef(n, t.href), i = t.mo.package.resolveRelativeUrlMO(r), o = 0; o < t.mo.package.spine.items.length; o++) {
                                var a = t.mo.package.spine.items[o],
                                    s = t.mo.package.resolveRelativeUrl(a.href);
                                if (s === i) return void (this.manifestItemId = a.idref);
                            }
                            console.error("Cannot set the Media ManifestItemId? " + this.src + " && " + t.href);
                        }
                    });
            }),
            (t.TextNode.prototype = new t.MediaNode()),
            (t.AudioNode = function (e) {
                (this.parent = e),
                    (this.nodeType = "audio"),
                    (this.clipBegin = 0),
                    (this.MAX = 1234567890.1),
                    (this.clipEnd = this.MAX),
                    (this.clipDurationMilliseconds = function () {
                        var e = 1e3 * this.clipBegin,
                            t = 1e3 * this.clipEnd;
                        return this.clipEnd >= this.MAX || t <= e ? 0 : t - e;
                    });
            }),
            (t.AudioNode.prototype = new t.MediaNode());
        var n = function () {
            (this.parent = void 0),
                (this.children = []),
                (this.id = void 0),
                (this.href = void 0),
                (this.duration = void 0),
                (this.mo = void 0),
                (this.parallelAt = function (e) {
                    return this.children[0].parallelAt(e);
                }),
                (this.nthParallel = function (e) {
                    var t = { count: -1 };
                    return this.children[0].nthParallel(e, t);
                }),
                (this.clipOffset = function (e) {
                    var t = { offset: 0 };
                    return this.children[0].clipOffset(t, e) ? t.offset : 0;
                }),
                (this.durationMilliseconds_Calculated = function () {
                    return this.children[0].durationMilliseconds();
                });
            var e = [];
            (this.hasSync = function (t) {
                for (var n = 0; n < e.length; n++) if (e[n] === t) return !0;
                return !1;
            }),
                (this.addSync = function (t) {
                    if (t)
                        for (var n = t.split(" "), r = 0; r < n.length; r++) {
                            var i = n[r].trim();
                            i.length > 0 && !this.hasSync(i) && e.push(i);
                        }
                });
        };
        return (
            (n.fromSmilDTO = function (e, r) {
                r.DEBUG && console.debug("Media Overlay DTO import...");
                var i = 0,
                    o = function () {
                        for (var e = "", t = 0; t < i; t++) e += "   ";
                        return e;
                    },
                    a = new n();
                (a.id = e.id),
                    (a.spineItemId = e.spineItemId),
                    (a.href = e.href),
                    (a.smilVersion = e.smilVersion),
                    (a.duration = e.duration),
                    a.duration && a.duration.length && a.duration.length > 0 && (console.error("SMIL duration is string, parsing float... (" + a.duration + ")"), (a.duration = parseFloat(a.duration))),
                    (a.mo = r),
                    a.mo.DEBUG &&
                        (console.log("JS MO smilVersion=" + a.smilVersion),
                        console.log("JS MO id=" + a.id),
                        console.log("JS MO spineItemId=" + a.spineItemId),
                        console.log("JS MO href=" + a.href),
                        console.log("JS MO duration=" + a.duration));
                var s = function (e, t, n, r) {
                        e in t
                            ? (e in n || console.debug("property " + e + " not declared in smil node " + n.nodeType), (n[e] = t[e]), a.mo.DEBUG && console.log(o() + "JS MO: [" + e + "=" + n[e] + "]"))
                            : r && console.log("Required property " + e + " not found in smil node " + t.nodeType);
                    },
                    l = function (e, n) {
                        var r;
                        if ("seq" == e.nodeType)
                            a.mo.DEBUG && console.log(o() + "JS MO seq"), (r = new t.SeqNode(n)), s("textref", e, r, !(!n || !n.parent)), s("id", e, r), s("epubtype", e, r), r.epubtype && r.getSmil().addSync(r.epubtype), i++, c(e, r), i--;
                        else if ("par" == e.nodeType) {
                            a.mo.DEBUG && console.log(o() + "JS MO par"), (r = new t.ParNode(n)), s("id", e, r), s("epubtype", e, r), r.epubtype && r.getSmil().addSync(r.epubtype), i++, c(e, r), i--;
                            for (var l = 0, u = r.children.length; l < u; l++) {
                                var d = r.children[l];
                                "text" == d.nodeType ? (r.text = d) : "audio" == d.nodeType ? (r.audio = d) : console.error("Unexpected smil node type: " + d.nodeType);
                            }
                            var f = !1;
                            if (f || !r.audio) {
                                var h = new t.AudioNode(r);
                                (h.clipBegin = 0), (h.clipEnd = h.MAX), (h.src = void 0), (r.audio = h);
                            }
                        } else if ("text" == e.nodeType)
                            a.mo.DEBUG && console.log(o() + "JS MO text"), (r = new t.TextNode(n)), s("src", e, r, !0), s("srcFile", e, r, !0), s("srcFragmentId", e, r, !1), s("id", e, r), r.updateMediaManifestItemId();
                        else {
                            if ("audio" != e.nodeType) return void console.error("Unexpected smil node type: " + e.nodeType);
                            a.mo.DEBUG && console.log(o() + "JS MO audio"),
                                (r = new t.AudioNode(n)),
                                s("src", e, r, !0),
                                s("id", e, r),
                                s("clipBegin", e, r),
                                r.clipBegin && r.clipBegin.length && r.clipBegin.length > 0 && (console.error("SMIL clipBegin is string, parsing float... (" + r.clipBegin + ")"), (r.clipBegin = parseFloat(r.clipBegin))),
                                r.clipBegin < 0 && (a.mo.DEBUG && console.log(o() + "JS MO clipBegin adjusted to ZERO"), (r.clipBegin = 0)),
                                s("clipEnd", e, r),
                                r.clipEnd && r.clipEnd.length && r.clipEnd.length > 0 && (console.error("SMIL clipEnd is string, parsing float... (" + r.clipEnd + ")"), (r.clipEnd = parseFloat(r.clipEnd))),
                                r.clipEnd <= r.clipBegin && (a.mo.DEBUG && console.log(o() + "JS MO clipEnd adjusted to MAX"), (r.clipEnd = r.MAX));
                        }
                        return r;
                    },
                    c = function (e, t) {
                        for (var n = e.children.length, r = 0; r < n; r++) {
                            var i = l(e.children[r], t);
                            (i.index = r), t.children.push(i);
                        }
                    };
                return c(e, a), a;
            }),
            n
        );
    }),
    define("readium_shared_js/models/media_overlay", ["./smil_model"], function (e) {
        var t = function (e) {
            (this.package = e),
                (this.parallelAt = function (e) {
                    for (var t = 0, n = 0; n < this.smil_models.length; n++) {
                        var r = this.smil_models[n],
                            i = e - t,
                            o = r.parallelAt(i);
                        if (o) return o;
                        t += r.durationMilliseconds_Calculated();
                    }
                }),
                (this.percentToPosition = function (e, t, n, r) {
                    (e < 0 || e > 100) && (e = 0);
                    var i = this.durationMilliseconds_Calculated(),
                        o = i * (e / 100);
                    if (((n.par = this.parallelAt(o)), n.par)) {
                        var a = n.par.getSmil();
                        if (a) {
                            for (var s = 0, l = 0; l < this.smil_models.length && ((t.smilData = this.smil_models[l]), t.smilData != a); l++) s += t.smilData.durationMilliseconds_Calculated();
                            r.milliseconds = o - (s + t.smilData.clipOffset(n.par));
                        }
                    }
                }),
                (this.durationMilliseconds_Calculated = function () {
                    for (var e = 0, t = 0; t < this.smil_models.length; t++) {
                        var n = this.smil_models[t];
                        e += n.durationMilliseconds_Calculated();
                    }
                    return e;
                }),
                (this.smilAt = function (e) {
                    if (!(e < 0 || e >= this.smil_models.length)) return this.smil_models[e];
                }),
                (this.positionToPercent = function (e, t, n) {
                    if (e >= this.smil_models.length) return -1;
                    for (var r = 0, i = 0; i < e; i++) {
                        var o = this.smil_models[i];
                        r += o.durationMilliseconds_Calculated();
                    }
                    var a = this.smil_models[e],
                        s = a.nthParallel(t);
                    if (!s) return -1;
                    var l = r + a.clipOffset(s) + n,
                        c = this.durationMilliseconds_Calculated(),
                        u = (l / c) * 100;
                    return u;
                }),
                (this.smil_models = []),
                (this.skippables = []),
                (this.escapables = []),
                (this.duration = void 0),
                (this.narrator = void 0),
                (this.activeClass = void 0),
                (this.playbackActiveClass = void 0),
                (this.DEBUG = !1),
                (this.getSmilBySpineItem = function (e) {
                    if (e)
                        for (var t = 0, n = this.smil_models.length; t < n; t++) {
                            var r = this.smil_models[t];
                            if (r.spineItemId === e.idref) return e.media_overlay_id !== r.id && console.error("SMIL INCORRECT ID?? " + e.media_overlay_id + " /// " + r.id), r;
                        }
                }),
                (this.getNextSmil = function (e) {
                    var t = this.smil_models.indexOf(e);
                    if (t != -1 && t != this.smil_models.length - 1) return this.smil_models[t + 1];
                }),
                (this.getPreviousSmil = function (e) {
                    var t = this.smil_models.indexOf(e);
                    if (t != -1 && 0 != t) return this.smil_models[t - 1];
                });
        };
        return (
            (t.fromDTO = function (n, r) {
                var i = new t(r);
                if (!n) return i;
                (i.duration = n.duration),
                    i.duration && i.duration.length && i.duration.length > 0 && (console.error("SMIL total duration is string, parsing float... (" + i.duration + ")"), (i.duration = parseFloat(i.duration))),
                    i.DEBUG && console.debug("Media Overlay Duration (TOTAL): " + i.duration),
                    (i.narrator = n.narrator),
                    i.DEBUG && console.debug("Media Overlay Narrator: " + i.narrator),
                    (i.activeClass = n.activeClass),
                    i.DEBUG && console.debug("Media Overlay Active-Class: " + i.activeClass),
                    (i.playbackActiveClass = n.playbackActiveClass),
                    i.DEBUG && console.debug("Media Overlay Playback-Active-Class: " + i.playbackActiveClass);
                var o = n.smil_models.length;
                i.DEBUG && console.debug("Media Overlay SMIL count: " + o);
                for (var a = 0; a < o; a++) {
                    var s = e.fromSmilDTO(n.smil_models[a], i);
                    i.smil_models.push(s), i.DEBUG && console.debug("Media Overlay Duration (SPINE ITEM): " + s.duration);
                }
                (o = n.skippables.length), i.DEBUG && console.debug("Media Overlay SKIPPABLES count: " + o);
                for (var a = 0; a < o; a++) i.skippables.push(n.skippables[a]);
                (o = n.escapables.length), i.DEBUG && console.debug("Media Overlay ESCAPABLES count: " + o);
                for (var a = 0; a < o; a++) i.escapables.push(n.escapables[a]);
                return i;
            }),
            t
        );
    }),
    define("readium_shared_js/models/package_data", [], function () {
        var e = { rootUrl: "", rootUrlMO: "", rendering_layout: "", spine: { direction: "ltr", items: [{ href: "", idref: "", page_spread: "", rendering_layout: "" }] } };
        return e;
    }),
    define("readium_shared_js/models/package", ["../helpers", "./spine_item", "./spine", "./media_overlay", "./package_data", "URIjs"], function (e, t, n, r, i, o) {
        var a = function (i) {
            var a = this;
            (this.spine = void 0),
                (this.rootUrl = void 0),
                (this.rootUrlMO = void 0),
                (this.media_overlay = void 0),
                (this.rendition_viewport = void 0),
                (this.rendition_flow = void 0),
                (this.rendition_layout = void 0),
                (this.rendition_spread = void 0),
                (this.rendition_orientation = void 0),
                (this.resolveRelativeUrlMO = function (t) {
                    var n = void 0;
                    try {
                        n = new o(t);
                    } catch (e) {
                        console.error(e), console.log(t);
                    }
                    if (n && n.is("absolute")) return t;
                    if (a.rootUrlMO && a.rootUrlMO.length > 0) {
                        var r = a.rootUrlMO;
                        try {
                            r = new o(r).search("").hash("").toString();
                        } catch (e) {
                            console.error(e), console.log(r);
                        }
                        return e.EndsWith(r, "/") ? r + t : r + "/" + t;
                    }
                    return a.resolveRelativeUrl(t);
                }),
                (this.resolveRelativeUrl = function (t) {
                    var n = void 0;
                    try {
                        n = new o(t);
                    } catch (e) {
                        console.error(e), console.log(t);
                    }
                    if (n && n.is("absolute")) return t;
                    if (a.rootUrl) {
                        var r = a.rootUrl;
                        try {
                            r = new o(r).search("").hash("").toString();
                        } catch (e) {
                            console.error(e), console.log(r);
                        }
                        return e.EndsWith(r, "/") ? r + t : r + "/" + t;
                    }
                    return t;
                }),
                (this.isFixedLayout = function () {
                    return a.rendition_layout === t.RENDITION_LAYOUT_PREPAGINATED;
                }),
                (this.isReflowable = function () {
                    return !a.isFixedLayout();
                }),
                i &&
                    ((this.rootUrl = i.rootUrl),
                    (this.rootUrlMO = i.rootUrlMO),
                    (this.rendition_viewport = i.rendition_viewport),
                    (this.rendition_layout = i.rendition_layout),
                    (this.rendition_flow = i.rendition_flow),
                    (this.rendition_orientation = i.rendition_orientation),
                    (this.rendition_spread = i.rendition_spread),
                    (this.spine = new n(this, i.spine)),
                    (this.media_overlay = r.fromDTO(i.media_overlay, this)));
        };
        return a;
    }),
    define("readium_shared_js/views/reflowable_view", [
        "../globals",
        "jquery",
        "underscore",
        "eventEmitter",
        "../models/bookmark_data",
        "./cfi_navigation_logic",
        "../models/current_pages_info",
        "../helpers",
        "../models/page_open_request",
        "../models/viewer_settings",
        "ResizeSensor",
    ], function (e, t, n, r, i, o, a, s, l, c, u) {
        var d = function (d, f) {
            function h(e) {
                O.css("left", e.left + "px"), O.css("top", e.top + "px"), O.css("right", e.right + "px"), O.css("bottom", e.bottom + "px");
            }
            function p() {
                return { width: M[0].clientWidth, height: M[0].clientHeight };
            }
            function g() {
                O && O.remove();
                var e = s.loadTemplate("reflowable_book_page_frame", {}),
                    n = t(e);
                (n = D.append(n)),
                    (O = t("#reflowable-content-frame", n)),
                    (M = t("#epubContentIframe", n)),
                    M.css("left", ""),
                    M.css("right", ""),
                    M.css("position", "relative"),
                    M.css("overflow", "hidden"),
                    (A = new o({ $iframe: M, frameDimensions: p, paginationInfo: te, classBlacklist: X, elementBlacklist: Q, idBlacklist: Y }));
            }
            function m(t) {
                if (P != t) {
                    g(),
                        P && (e.logEvent("CONTENT_DOCUMENT_UNLOADED", "EMIT", "reflowable_view.js [ " + P.href + " ]"), z.emit(e.Events.CONTENT_DOCUMENT_UNLOADED, M, P)),
                        z.resetCurrentPosition(),
                        (te.pageOffset = 0),
                        (te.currentSpreadIndex = 0),
                        (P = t),
                        (P.paginationInfo = te),
                        (G = !0);
                    var n = H.package.resolveRelativeUrl(t.href);
                    e.logEvent("CONTENT_DOCUMENT_LOAD_START", "EMIT", "reflowable_view.js [ " + t.href + " -- " + n + " ]"),
                        z.emit(e.Events.CONTENT_DOCUMENT_LOAD_START, M, t),
                        M.css("opacity", "0.01"),
                        q.loadIframe(M[0], n, y, z, { spineItem: t });
                }
            }
            function v() {
                F && s.UpdateHtmlFontSize(F, J);
            }
            function b() {
                F && F.css("column-gap", te.columnGap + "px");
            }
            function y(n) {
                if (((G = !1), N && N.spineItem != P)) return void m(N.spineItem);
                if (!n) return M.css("opacity", "1"), void (N = void 0);
                e.logEvent("CONTENT_DOCUMENT_LOADED", "EMIT", "reflowable_view.js [ " + P.href + " ]"), z.emit(e.Events.CONTENT_DOCUMENT_LOADED, M, P);
                var r = M[0].contentDocument;
                (F = t("html", r)), (L = t("body", F)), (U = !1), (B = !0), (j = void 0);
                var i = M[0].contentDocument.defaultView || M[0].contentWindow,
                    o = i.getComputedStyle(L[0], null);
                if (o) {
                    B = "ltr" === o.direction;
                    var a = void 0;
                    (a = o.getPropertyValue
                        ? o.getPropertyValue("-webkit-writing-mode") ||
                          o.getPropertyValue("-moz-writing-mode") ||
                          o.getPropertyValue("-ms-writing-mode") ||
                          o.getPropertyValue("-o-writing-mode") ||
                          o.getPropertyValue("-epub-writing-mode") ||
                          o.getPropertyValue("writing-mode")
                        : o.webkitWritingMode || o.mozWritingMode || o.msWritingMode || o.oWritingMode || o.epubWritingMode || o.writingMode),
                        a && ((j = a.indexOf("-lr") >= 0), (a.indexOf("vertical") >= 0 || a.indexOf("tb-") >= 0 || a.indexOf("bt-") >= 0) && (U = !0));
                }
                B && (("rtl" !== L[0].getAttribute("dir") && "rtl" !== F[0].getAttribute("dir")) || (B = !1)),
                    H.isLeftToRight() || !B || U || (L[0].setAttribute("dir", "rtl"), (B = !1), (j = !1)),
                    (te.isVerticalWritingMode = U),
                    T(),
                    M.css("opacity", "1"),
                    x(),
                    F.css("height", ee.height + "px"),
                    F.css("position", "relative"),
                    F.css("margin", "0"),
                    F.css("padding", "0"),
                    F.css("column-axis", U ? "vertical" : "horizontal"),
                    z.applyBookStyles(),
                    I(),
                    v(),
                    b();
                var s = L[0];
                (s.resizeSensor = new u(s, function () {
                    console.debug("ReflowableView content resized", t(s).width(), t(s).height()), C();
                })),
                    z.applyStyles();
            }
            function _() {
                if (N) {
                    var e = N;
                    (N = void 0), z.openPage(e);
                }
            }
            function w() {
                var e = -te.pageOffset + "px";
                if (U) F.css("top", e);
                else {
                    var t = B || j;
                    F.css("left", t ? e : ""), F.css("right", t ? "" : e);
                }
                S();
            }
            function x() {
                var e = O.width();
                e -= e % 2;
                var t = O.height();
                return (ee.width !== e || ee.height !== t) && ((ee.width = e), (ee.height = t), !0);
            }
            function E(t, r, i) {
                (te.pageOffset = (te.columnWidth + te.columnGap) * te.visibleColumnCount * te.currentSpreadIndex),
                    w(),
                    n.defer(function () {
                        void 0 == K && z.saveCurrentPosition(),
                            e.logEvent("InternalEvents.CURRENT_VIEW_PAGINATION_CHANGED", "EMIT", "reflowable_view.js"),
                            z.emit(e.InternalEvents.CURRENT_VIEW_PAGINATION_CHANGED, { paginationInfo: z.getPaginationInfo(), initiator: t, spineItem: r, elementId: i });
                    });
            }
            function C() {
                var e = te.columnMaxWidth,
                    t = te.columnMinWidth,
                    n = s.deduceSyntheticSpread(V, P, ne),
                    r = n === !1 || n === !0;
                if ((0 === n && (n = 1), (te.visibleColumnCount = n ? 2 : 1), U && ((e *= 2), (n = !1), (r = !0), (te.visibleColumnCount = 1)), F)) {
                    T();
                    var i = parseInt(V.css("border-left-width")),
                        o = te.columnGap / 2;
                    o = Math.max(0, o - i);
                    var a = parseInt(V.css("border-right-width")),
                        l = te.columnGap / 2;
                    l = Math.max(0, l - a);
                    var c = V.width(),
                        u = c - o - l;
                    n && (u = 0.5 * (u - te.columnGap));
                    var d = 0;
                    if (u > e) {
                        var f = u - e;
                        d = Math.floor(f * (n ? 1 : 0.5));
                    } else !r && u < t && n && ((n = !1), (te.visibleColumnCount = 1), (u = c - o - l), u > e && (d = Math.floor(0.5 * (u - e))));
                    D.css({ left: d + o + "px", right: d + l + "px" }), x();
                    var h = D.width();
                    n && (h = (h - te.columnGap) / 2),
                        (h = Math.floor(h)),
                        h - 1 > e && console.debug("resultingColumnWidth > MAXW ! " + h + " > " + e),
                        M.css("width", ee.width + "px"),
                        M.css("height", ee.height + "px"),
                        F.css("height", ee.height + "px"),
                        F.css("min-height", ee.height + "px"),
                        F.css("max-height", ee.height + "px"),
                        F.css("margin", 0),
                        F.css("padding", 0),
                        F.css("border", 0),
                        L.css("margin", 0),
                        L.css("padding", 0),
                        (te.rightToLeft = H.isRightToLeft()),
                        (te.columnWidth = Math.round(((U ? ee.height : ee.width) - te.columnGap * (te.visibleColumnCount - 1)) / te.visibleColumnCount));
                    var p = te.visibleColumnCount > 1;
                    p
                        ? (F.css("width", ee.width + "px"), F.css("column-width", "auto"), F.css("column-count", te.visibleColumnCount))
                        : (F.css("width", (U ? ee.width : te.columnWidth) + "px"), F.css("column-count", "auto"), F.css("column-width", te.columnWidth + "px")),
                        F.css("column-fill", "auto"),
                        F.css({ left: "0", right: "0", top: "0" }),
                        s.triggerLayout(M),
                        (te.columnCount = ((U ? F[0].scrollHeight : F[0].scrollWidth) + te.columnGap) / (te.columnWidth + te.columnGap)),
                        (te.columnCount = Math.round(te.columnCount));
                    var g = (te.columnCount - 1) * te.columnGap,
                        m = ((U ? F[0].scrollHeight : F[0].scrollWidth) - g) / te.columnCount;
                    (m = Math.round(m)),
                        m > te.columnWidth && (console.debug("ADJUST COLUMN"), console.log(te.columnWidth), console.log(m), (te.columnWidth = m)),
                        (te.spreadCount = Math.ceil(te.columnCount / te.visibleColumnCount)),
                        te.currentSpreadIndex >= te.spreadCount && (te.currentSpreadIndex = te.spreadCount - 1),
                        N ? _() : K ? z.restoreCurrentPosition() : re(z);
                }
            }
            function T() {
                Z == -1 && ((Z = F[0].style.opacity), F.css("opacity", "0"));
            }
            function S() {
                Z != -1 && F.css("opacity", Z), (Z = -1);
            }
            function R() {
                for (var e = [], t = te.currentSpreadIndex * te.visibleColumnCount, n = 0; n < te.visibleColumnCount && t + n < te.columnCount; n++) e.push(t + n);
                return e;
            }
            function I() {
                if (F) {
                    var e;
                    t("img, svg", F).each(function () {
                        (e = t(this)), e.css("max-width", "98%"), e.css("max-height", "98%"), e.css("height") || e.css("height", "auto"), e.css("width") || e.css("width", "auto");
                    });
                }
            }
            function k(e) {
                var t = null;
                try {
                    t = new i(P.idref, e);
                } catch (e) {
                    console.log(e.message);
                }
                return t;
            }
            t.extend(this, new r());
            var P,
                N,
                O,
                A,
                D,
                M,
                F,
                L,
                U,
                B,
                j,
                z = this,
                V = d.$viewport,
                H = d.spine,
                $ = d.userStyles,
                W = d.bookStyles,
                q = d.iframeLoader,
                G = !1,
                J = 100,
                K = void 0,
                X = ["cfi-marker", "mo-cfi-highlight", "resize-sensor", "resize-sensor-expand", "resize-sensor-shrink", "resize-sensor-inner"],
                Q = [],
                Y = ["MathJax_Message", "MathJax_SVG_Hidden"],
                Z = -1,
                ee = { width: void 0, height: void 0 },
                te = { visibleColumnCount: 2, columnGap: 20, columnMaxWidth: 550, columnMinWidth: 400, spreadCount: 0, currentSpreadIndex: 0, columnWidth: void 0, pageOffset: 0, columnCount: 0 };
            (this.render = function () {
                var e = s.loadTemplate("reflowable_book_frame", {});
                (D = t(e)), V.append(D);
                var n = f.viewerSettings();
                return (n && "undefined" != typeof n.enableGPUHardwareAccelerationCSS3D) || (n = new c({})), n.enableGPUHardwareAccelerationCSS3D && D.css("transform", "translateZ(0)"), g(), z;
            }),
                (this.remove = function () {
                    D.remove();
                }),
                (this.isReflowable = function () {
                    return !0;
                }),
                (this.onViewportResize = function () {
                    x() && C();
                });
            var ne = void 0;
            (this.setViewSettings = function (e) {
                (ne = e), (te.columnGap = e.columnGap), (te.columnMaxWidth = e.columnMaxWidth), (te.columnMinWidth = e.columnMinWidth), (J = e.fontSize), v(), b(), x(), C();
            }),
                (this.applyStyles = function () {
                    s.setStyles($.getStyles(), D.parent());
                    var e = s.Margins.fromElement(D);
                    h(e.padding), x(), C();
                }),
                (this.applyBookStyles = function () {
                    F && s.setStyles(W.getStyles(), F);
                }),
                (this.openPageInternal = function (e) {
                    if (G) return void (N = e);
                    if (e.spineItem && e.spineItem != P) return (N = e), void m(e.spineItem);
                    var t = void 0;
                    if (void 0 !== e.spineItemPageIndex) t = e.spineItemPageIndex;
                    else if (e.elementId) (t = A.getPageForElementId(e.elementId)), t < 0 && (t = 0);
                    else if (e.firstVisibleCfi && e.lastVisibleCfi) {
                        var n, r;
                        try {
                            (n = A.getPageForElementCfi(e.firstVisibleCfi, X, Q, Y)), n < 0 && (n = 0);
                        } catch (e) {
                            (n = 0), console.error(e);
                        }
                        try {
                            (r = A.getPageForElementCfi(e.lastVisibleCfi, X, Q, Y)), r < 0 && (r = 0);
                        } catch (e) {
                            (r = 0), console.error(e);
                        }
                        t = Math.round((n + r) / 2);
                    } else if (e.elementCfi)
                        try {
                            (t = A.getPageForElementCfi(e.elementCfi, X, Q, Y)), t < 0 && (t = 0);
                        } catch (e) {
                            (t = 0), console.error(e);
                        }
                    else e.firstPage ? (t = 0) : e.lastPage ? (t = te.columnCount - 1) : (console.debug("No criteria in pageRequest"), (t = 0));
                    t >= 0 && t < te.columnCount
                        ? ((te.currentSpreadIndex = Math.floor(t / te.visibleColumnCount)), re(e.initiator, e.spineItem, e.elementId))
                        : console.log("Illegal pageIndex value: ", t, "column count is ", te.columnCount);
                }),
                (this.openPage = function (e) {
                    this.openPageInternal(e), (K = e);
                }),
                (this.resetCurrentPosition = function () {
                    K = void 0;
                }),
                (this.saveCurrentPosition = function () {
                    if (!N) {
                        var e = z.getFirstVisibleCfi(),
                            t = z.getLastVisibleCfi();
                        (K = new l(P, z)), K.setFirstAndLastVisibleCfi(e.contentCFI, t.contentCFI);
                    }
                }),
                (this.restoreCurrentPosition = function () {
                    K && this.openPageInternal(K);
                });
            var re = n.debounce(E, 100);
            (this.openPagePrev = function (e) {
                if (P)
                    if (te.currentSpreadIndex > 0) this.resetCurrentPosition(), te.currentSpreadIndex--, re(e);
                    else {
                        var t = H.prevItem(P, !0);
                        if (t) {
                            var n = new l(t, e);
                            n.setLastPage(), z.openPage(n);
                        }
                    }
            }),
                (this.openPageNext = function (e) {
                    if (P)
                        if (te.currentSpreadIndex < te.spreadCount - 1) this.resetCurrentPosition(), te.currentSpreadIndex++, re(e);
                        else {
                            var t = H.nextItem(P, !0);
                            if (t) {
                                var n = new l(t, e);
                                n.setFirstPage(), z.openPage(n);
                            }
                        }
                }),
                (this.getPaginationInfo = function () {
                    var e = new a(H, !1);
                    if (!P) return e;
                    for (var t = R(), n = 0, r = t.length; n < r; n++) e.addOpenPage(t[n], te.columnCount, P.idref, P.index);
                    return e;
                }),
                (this.bookmarkCurrentPage = function () {
                    if (P) return z.getFirstVisibleCfi();
                }),
                (this.getLoadedSpineItems = function () {
                    return [P];
                }),
                (this.getElementByCfi = function (e, t, n, r, i) {
                    return e != P.idref ? void console.warn("spine item is not loaded") : A.getElementByCfi(t, n, r, i);
                }),
                (this.getElementById = function (e, t) {
                    return e != P.idref ? void console.error("spine item is not loaded") : A.getElementById(t);
                }),
                (this.getElement = function (e, t) {
                    return e != P.idref ? void console.warn("spine item is not loaded") : A.getElement(t);
                }),
                (this.getFirstVisibleMediaOverlayElement = function () {
                    return A.getFirstVisibleMediaOverlayElement();
                }),
                (this.insureElementVisibility = function (e, n, r) {
                    var i = t(n);
                    if (!A.isElementVisible(i)) {
                        var o = A.getPageForElement(i);
                        if (o != -1) {
                            var a = new l(P, r);
                            a.setPageIndex(o);
                            var s = n.id;
                            s || (s = n.getAttribute("id")), s && a.setElementId(s), z.openPage(a);
                        }
                    }
                }),
                (this.getVisibleElementsWithFilter = function (e, t) {
                    var n = A.getVisibleElementsWithFilter(null, e);
                    return t ? [{ elements: n, spineItem: P }] : n;
                }),
                (this.getVisibleElements = function (e, t) {
                    var n = A.getAllVisibleElementsWithSelector(e);
                    return t ? [{ elements: n, spineItem: P }] : n;
                }),
                (this.isElementVisible = function (e) {
                    return A.isElementVisible(e);
                }),
                (this.getElements = function (e, t) {
                    return e != P.idref ? void console.warn("spine item is not loaded") : A.getElements(t);
                }),
                (this.isNodeFromRangeCfiVisible = function (e, t) {
                    if (P.idref === e) return A.isNodeFromRangeCfiVisible(t);
                }),
                (this.isVisibleSpineItemElementCfi = function (e, t) {
                    if (A.isRangeCfi(t)) return this.isNodeFromRangeCfiVisible(e, t);
                    var n = this.getElementByCfi(e, t);
                    return n && this.isElementVisible(n);
                }),
                (this.getNodeRangeInfoFromCfi = function (e, t) {
                    return e != P.idref ? void console.warn("spine item is not loaded") : A.getNodeRangeInfoFromCfi(t);
                }),
                (this.getFirstVisibleCfi = function () {
                    return k(A.getFirstVisibleCfi());
                }),
                (this.getLastVisibleCfi = function () {
                    return k(A.getLastVisibleCfi());
                }),
                (this.getDomRangeFromRangeCfi = function (e, t, n) {
                    return t && e.idref !== t.idref ? void console.error("getDomRangeFromRangeCfi: both CFIs must be scoped under the same spineitem idref") : A.getDomRangeFromRangeCfi(e.contentCFI, t ? t.contentCFI : null, n);
                }),
                (this.getRangeCfiFromDomRange = function (e) {
                    return k(A.getRangeCfiFromDomRange(e));
                }),
                (this.getVisibleCfiFromPoint = function (e, t, n) {
                    return k(A.getVisibleCfiFromPoint(e, t, n));
                }),
                (this.getRangeCfiFromPoints = function (e, t, n, r) {
                    return k(A.getRangeCfiFromPoints(e, t, n, r));
                }),
                (this.getCfiForElement = function (e) {
                    return k(A.getCfiForElement(e));
                }),
                (this.getElementFromPoint = function (e, t) {
                    return A.getElementFromPoint(e, t);
                });
        };
        return d;
    }),
    define("readium_shared_js/models/style", [], function () {
        var e = function (e, t) {
            (this.selector = e),
                (this.declarations = t),
                (this.setDeclarations = function (e) {
                    for (var t in e) e.hasOwnProperty(t) && (this.declarations[t] = e[t]);
                });
        };
        return e;
    }),
    define("readium_shared_js/models/style_collection", ["./style"], function (e) {
        var t = function () {
            var t = [];
            (this.clear = function () {
                t.length = 0;
            }),
                (this.findStyle = function (e) {
                    for (var n = t.length, r = 0; r < n; r++) if (t[r].selector === e) return t[r];
                }),
                (this.addStyle = function (n, r) {
                    var i = this.findStyle(n);
                    return i ? i.setDeclarations(r) : ((i = new e(n, r)), t.push(i)), i;
                }),
                (this.removeStyle = function (e) {
                    for (var n = t.length, r = 0; r < n; r++) if (t[r].selector === e) return void t.splice(r, 1);
                }),
                (this.getStyles = function () {
                    return t;
                }),
                (this.resetStyleValues = function () {
                    for (var e = t.length, n = 0; n < e; n++) {
                        var r = t[n],
                            i = r.declarations;
                        for (var o in i) i.hasOwnProperty(o) && (i[o] = "");
                    }
                });
        };
        return t;
    }),
    define("readium_shared_js/models/switches", ["jquery", "underscore"], function (e, t) {
        var n = function () {};
        return (
            (n.apply = function (n) {
                function r(e) {
                    var n = e.attributes["required-namespace"];
                    if (!n) return console.log("Encountered a case statement with no required-namespace"), !1;
                    var r = ["http://www.w3.org/1998/Math/MathML"];
                    return t.include(r, n.value);
                }
                var i =
                    window.navigator.userAgent.indexOf("Trident") > 0 || window.navigator.userAgent.indexOf("Edge") > 0
                        ? function (e) {
                              return "epub\\:" + e;
                          }
                        : function (e) {
                              return e;
                          };
                t.each(n.querySelectorAll(i("switch")), function (n) {
                    var o = !1;
                    t.each(n.querySelectorAll(i("case")), function (t) {
                        !o && r(t) ? (o = !0) : e(t).remove();
                    }),
                        o &&
                            t.each(n.querySelectorAll(i("default")), function (t) {
                                e(t).remove();
                            });
                });
            }),
            n
        );
    }),
    define("readium_shared_js/models/trigger", ["jquery", "../helpers"], function (e, t) {
        var n = function (t) {
            var n = e(t);
            (this.action = n.attr("action")), (this.ref = n.attr("ref")), (this.event = n.attr("ev:event")), (this.observer = n.attr("ev:observer")), (this.ref = n.attr("ref"));
        };
        return (
            (n.register = function (t) {
                e("trigger", t).each(function () {
                    var e = new n(this);
                    e.subscribe(t);
                });
            }),
            (n.prototype.subscribe = function (t) {
                var n = "#" + this.observer,
                    r = this;
                e(n, t).on(this.event, function () {
                    r.execute(t);
                });
            }),
            (n.prototype.execute = function (n) {
                var r = e("#" + t.escapeJQuerySelector(this.ref), n);
                switch (this.action) {
                    case "show":
                        r.css("visibility", "visible");
                        break;
                    case "hide":
                        r.css("visibility", "hidden");
                        break;
                    case "play":
                        (r[0].currentTime = 0), r[0].play();
                        break;
                    case "pause":
                        r[0].pause();
                        break;
                    case "resume":
                        r[0].play();
                        break;
                    case "mute":
                        r[0].muted = !0;
                        break;
                    case "unmute":
                        r[0].muted = !1;
                        break;
                    default:
                        console.log("do not no how to handle trigger " + this.action);
                }
            }),
            n
        );
    }),
    define("readium_shared_js/models/node_range_info", [], function () {
        var e = function (e, t) {
                (this.node = e), (this.offset = t);
            },
            t = function (t, n, r) {
                var i = this;
                (this.clientRect = t),
                    (this.startInfo = n),
                    (this.endInfo = r),
                    (this.setStartInfo = function (t) {
                        return (i.startInfo = new e(t)), i;
                    }),
                    (this.setEndInfo = function (t) {
                        return (i.endInfo = new e(t)), i;
                    });
            };
        return t;
    }),
    define("readium_shared_js/views/reader_view", [
        "../globals",
        "jquery",
        "underscore",
        "eventEmitter",
        "./fixed_view",
        "../helpers",
        "./iframe_loader",
        "./internal_links_support",
        "./media_overlay_data_injector",
        "./media_overlay_player",
        "../models/package",
        "../models/page_open_request",
        "./reflowable_view",
        "./scroll_view",
        "../models/style_collection",
        "../models/switches",
        "../models/trigger",
        "../models/viewer_settings",
        "../models/bookmark_data",
        "../models/node_range_info",
    ], function (e, t, n, r, i, o, a, s, l, c, u, d, f, h, p, g, m, v, b, y) {
        var _ = function (b) {
            function w(e) {
                return "scroll-doc" == B.scroll
                    ? _.VIEW_TYPE_SCROLLED_DOC
                    : "scroll-continuous" == B.scroll
                    ? _.VIEW_TYPE_SCROLLED_CONTINUOUS
                    : e.isFixedLayout()
                    ? _.VIEW_TYPE_FIXED
                    : e.isFlowScrolledDoc()
                    ? _.VIEW_TYPE_SCROLLED_DOC
                    : e.isFlowScrolledContinuous()
                    ? _.VIEW_TYPE_SCROLLED_CONTINUOUS
                    : _.VIEW_TYPE_COLUMNIZED;
            }
            function x(t, r) {
                var i = w(t);
                if (F) {
                    if (M.getCurrentViewType() == i) return void r(!1);
                    E();
                }
                var a = { $viewport: D, spine: U, userStyles: j, bookStyles: z, iframeLoader: A };
                (F = M.createViewForType(i, a)),
                    e.logEvent("READER_VIEW_CREATED", "EMIT", "reader_view.js"),
                    M.emit(e.Events.READER_VIEW_CREATED, i),
                    F.on(e.Events.CONTENT_DOCUMENT_LOADED, function (t, n) {
                        if ((e.logEvent("CONTENT_DOCUMENT_LOADED", "ON", "reader_view.js (current view) [ " + n.href + " ]"), o.isIframeAlive(t[0]))) {
                            O.attachMediaOverlayData(t, n, B), V.processLinkElements(t, n);
                            var r = t[0].contentDocument;
                            m.register(r), g.apply(r), e.logEvent("CONTENT_DOCUMENT_LOADED", "EMIT", "reader_view.js [ " + n.href + " ]"), M.emit(e.Events.CONTENT_DOCUMENT_LOADED, t, n);
                        }
                    }),
                    F.on(e.Events.CONTENT_DOCUMENT_LOAD_START, function (t, n) {
                        e.logEvent("CONTENT_DOCUMENT_LOAD_START", "EMIT", "reader_view.js [ " + n.href + " ]"), M.emit(e.Events.CONTENT_DOCUMENT_LOAD_START, t, n);
                    }),
                    F.on(e.Events.CONTENT_DOCUMENT_UNLOADED, function (t, n) {
                        e.logEvent("CONTENT_DOCUMENT_UNLOADED", "EMIT", "reader_view.js [ " + n.href + " ]"), M.emit(e.Events.CONTENT_DOCUMENT_UNLOADED, t, n);
                    }),
                    F.on(e.InternalEvents.CURRENT_VIEW_PAGINATION_CHANGED, function (t) {
                        e.logEvent("InternalEvents.CURRENT_VIEW_PAGINATION_CHANGED", "ON", "reader_view.js"),
                            N.onPageChanged(t),
                            n.defer(function () {
                                e.logEvent("PAGINATION_CHANGED", "EMIT", "reader_view.js"), M.emit(e.Events.PAGINATION_CHANGED, t);
                            });
                    }),
                    F.on(e.Events.FXL_VIEW_RESIZED, function () {
                        e.logEvent("FXL_VIEW_RESIZED", "EMIT", "reader_view.js"), M.emit(e.Events.FXL_VIEW_RESIZED);
                    }),
                    F.render(),
                    F.setViewSettings(B),
                    setTimeout(function () {
                        r(!0);
                    }, 50);
            }
            function E() {
                F &&
                    (e.logEvent("READER_VIEW_DESTROYED", "EMIT", "reader_view.js"),
                    M.emit(e.Events.READER_VIEW_DESTROYED),
                    e.logEvent("InternalEvents.CURRENT_VIEW_PAGINATION_CHANGED", "OFF", "reader_view.js"),
                    F.off(e.InternalEvents.CURRENT_VIEW_PAGINATION_CHANGED),
                    F.remove(),
                    (F = void 0));
            }
            function C(t) {
                e.logEvent("MEDIA_OVERLAY_STATUS_CHANGED", "EMIT", "reader_view.js (via MediaOverlayPlayer + AudioPlayer)"), M.emit(e.Events.MEDIA_OVERLAY_STATUS_CHANGED, t);
            }
            function T(e) {
                if (!e) return void console.log("idref parameter value missing!");
                var t = U.getItemById(e);
                return t ? t : void console.log("Spine item with id " + e + " not found!");
            }
            function S(e, t) {
                x(e.spineItem, function (n) {
                    n || F.setViewSettings(B), F.openPage(e, t);
                });
            }
            function R(e) {
                o.setStyles(j.getStyles(), D), N && N.applyStyles(), e || (F && F.applyStyles());
            }
            function I() {
                ($ = null), (W = !1), F && (F.isReflowable && F.isReflowable() && ((W = M.isPlayingMediaOverlay()), W && M.pauseMediaOverlay()), ($ = F.bookmarkCurrentPage()));
            }
            function k() {
                F && M.handleViewportResize($);
            }
            function P() {
                k(), W && M.playMediaOverlay();
            }
            t.extend(this, new r());
            var N,
                O,
                A,
                D,
                M = this,
                F = void 0,
                L = void 0,
                U = void 0,
                B = new v({}),
                j = new p(),
                z = new p(),
                V = new s(this),
                H = o.extendedThrottle(I, k, P, 250, 1e3, M);
            t(window).on("resize.ReadiumSDK.readerView", H),
                b.el instanceof t ? ((D = b.el), console.log("** EL is a jQuery selector:" + b.el.attr("id"))) : ((D = t(b.el)), console.log("** EL is a string:" + D.attr("id"))),
                (A = b.iframeLoader ? b.iframeLoader : new a({ mathJaxUrl: b.mathJaxUrl })),
                (_needsFixedLayoutScalerWorkAround = b.needsFixedLayoutScalerWorkAround),
                (this.needsFixedLayoutScalerWorkAround = function () {
                    return _needsFixedLayoutScalerWorkAround;
                }),
                (this.createViewForType = function (e, t) {
                    var n;
                    switch ((D.css("overflow", "hidden"), e)) {
                        case _.VIEW_TYPE_FIXED:
                            D.css("overflow", "auto"), (n = new i(t, M));
                            break;
                        case _.VIEW_TYPE_SCROLLED_DOC:
                            n = new h(t, !1, M);
                            break;
                        case _.VIEW_TYPE_SCROLLED_CONTINUOUS:
                            n = new h(t, !0, M);
                            break;
                        default:
                            n = new f(t, M);
                    }
                    return n;
                }),
                (this.getCurrentViewType = function () {
                    if (F)
                        return F instanceof f
                            ? _.VIEW_TYPE_COLUMNIZED
                            : F instanceof i
                            ? _.VIEW_TYPE_FIXED
                            : F instanceof h
                            ? F.isContinuousScroll()
                                ? _.VIEW_TYPE_SCROLLED_CONTINUOUS
                                : _.VIEW_TYPE_SCROLLED_DOC
                            : void console.error("Unrecognized view type");
                }),
                (this.getCurrentView = function () {
                    return F;
                }),
                (this.getLoadedSpineItems = function () {
                    return F ? F.getLoadedSpineItems() : [];
                }),
                (this.viewerSettings = function () {
                    return B;
                }),
                (this.package = function () {
                    return L;
                }),
                (this.spine = function () {
                    return U;
                }),
                (this.userStyles = function () {
                    return j;
                }),
                (this.openBook = function (e) {
                    var n = e.package ? e.package : e;
                    (L = new u(n)),
                        (U = L.spine),
                        U.handleLinear(!0),
                        N && N.reset(),
                        (N = new c(M, t.proxy(C, M))),
                        N.setAutomaticNextSmil(!!B.mediaOverlaysAutomaticPageTurn),
                        (O = new l(L.media_overlay, N)),
                        E(),
                        e.settings && M.updateSettings(e.settings),
                        e.styles && M.setStyles(e.styles);
                    var r = void 0;
                    e.openPageRequest && (e.openPageRequest.idref || (e.openPageRequest.contentRefUrl && e.openPageRequest.sourceFileHref) ? (r = e.openPageRequest) : console.log("Invalid page request data: idref required!"));
                    var i = !1;
                    if (r) {
                        r = e.openPageRequest;
                        try {
                            i = r.idref
                                ? r.spineItemPageIndex
                                    ? !M.openSpineItemPage(r.idref, r.spineItemPageIndex, M)
                                    : r.elementCfi
                                    ? !M.openSpineItemElementCfi(r.idref, r.elementCfi, M)
                                    : !M.openSpineItemPage(r.idref, 0, M)
                                : !M.openContentUrl(r.contentRefUrl, r.sourceFileHref, M);
                        } catch (e) {
                            console.error("openPageRequest fail: fallback to first page!"), console.log(e), (i = !0);
                        }
                    } else i = !0;
                    if (i) {
                        var o = U.first();
                        if (o) {
                            var a = new d(o, M);
                            a.setFirstPage(), S(a, 0);
                        }
                    }
                }),
                (this.openPageLeft = function () {
                    L.spine.isLeftToRight() ? M.openPagePrev() : M.openPageNext();
                }),
                (this.openPageRight = function () {
                    L.spine.isLeftToRight() ? M.openPageNext() : M.openPagePrev();
                }),
                (this.isCurrentViewFixedLayout = function () {
                    return F instanceof i;
                }),
                (this.setZoom = function (e) {
                    M.isCurrentViewFixedLayout() && F.setZoom(e);
                }),
                (this.getViewScale = function () {
                    return M.isCurrentViewFixedLayout() ? 100 * F.getViewScale() : 100;
                }),
                (this.updateSettings = function (t) {
                    if ((B.update(t), N && N.setAutomaticNextSmil(!!B.mediaOverlaysAutomaticPageTurn), F && !t.doNotUpdateView)) {
                        var n = F.bookmarkCurrentPage();
                        if (n && n.idref) {
                            var r = !1;
                            F.isReflowable && F.isReflowable() && ((r = M.isPlayingMediaOverlay()), r && M.pauseMediaOverlay());
                            var i = U.getItemById(n.idref);
                            return void x(i, function (t) {
                                t || F.setViewSettings(B),
                                    M.openSpineItemElementCfi(n.idref, n.contentCFI, M),
                                    r && M.playMediaOverlay(),
                                    e.logEvent("SETTINGS_APPLIED 1 (view update)", "EMIT", "reader_view.js"),
                                    M.emit(e.Events.SETTINGS_APPLIED);
                            });
                        }
                    }
                    e.logEvent("SETTINGS_APPLIED 2 (no view update)", "EMIT", "reader_view.js"), M.emit(e.Events.SETTINGS_APPLIED);
                }),
                (this.openPageNext = function () {
                    if (M.getCurrentViewType() === _.VIEW_TYPE_SCROLLED_CONTINUOUS) return void F.openPageNext(M);
                    var e = F.getPaginationInfo();
                    if (0 != e.openPages.length) {
                        var n = e.openPages[e.openPages.length - 1];
                        if (n.spineItemPageIndex < n.spineItemPageCount - 1) return void F.openPageNext(M);
                        var r = U.getItemById(n.idref),
                            i = U.nextItem(r);
                        if (i) {
                            var o = new d(i, M);
                            t(document).trigger("loadNextChapter", i), o.setFirstPage(), S(o, 2);
                        }
                    }
                }),
                (this.openPagePrev = function () {
                    if (M.getCurrentViewType() === _.VIEW_TYPE_SCROLLED_CONTINUOUS) return void F.openPagePrev(M);
                    var e = F.getPaginationInfo();
                    if (0 != e.openPages.length) {
                        var n = e.openPages[0];
                        if (n.spineItemPageIndex > 0) return void F.openPagePrev(M);
                        var r = U.getItemById(n.idref),
                            i = U.prevItem(r);
                        if (i) {
                            var o = new d(i, M);
                            t(document).trigger("loadPrevChapter", i), o.setLastPage(), S(o, 1);
                        }
                    }
                }),
                (this.openSpineItemElementCfi = function (e, t, n) {
                    var r = T(e);
                    if (!r) return !1;
                    var i = new d(r, n);
                    return t && i.setElementCfi(t), S(i, 0), !0;
                }),
                (this.openPageIndex = function (e, t) {
                    if (!F) return !1;
                    var n;
                    if (L.isFixedLayout()) {
                        var r = U.items[e];
                        if (!r) return !1;
                        (n = new d(r, t)), n.setPageIndex(0);
                    } else {
                        var i = this.getLoadedSpineItems();
                        i.length > 0 && ((n = new d(i[0], t)), n.setPageIndex(e));
                    }
                    return S(n, 0), !0;
                }),
                (this.openSpineItemPage = function (e, t, n) {
                    var r = T(e);
                    if (!r) return !1;
                    var i = new d(r, n);
                    return t && i.setPageIndex(t), S(i, 0), !0;
                }),
                (this.setStyles = function (e, t) {
                    for (var n = e.length, r = 0; r < n; r++) e[r].declarations ? j.addStyle(e[r].selector, e[r].declarations) : j.removeStyle(e[r].selector);
                    R(t);
                }),
                (this.setBookStyles = function (e) {
                    for (var t = e.length, n = 0; n < t; n++) z.addStyle(e[n].selector, e[n].declarations);
                    F && F.applyBookStyles();
                }),
                (this.getElement = function (e, t) {
                    if (F) return F.getElement(e, t);
                }),
                (this.getElementById = function (e, t) {
                    if (F) return F.getElementById(e, t);
                }),
                (this.getElementByCfi = function (e, t, n, r, i) {
                    if (F) return F.getElementByCfi(e, t, n, r, i);
                }),
                (this.mediaOverlaysOpenContentUrl = function (e, t, n) {
                    N.mediaOverlaysOpenContentUrl(e, t, n);
                }),
                (this.openContentUrl = function (e, n, r) {
                    var i,
                        a,
                        s = o.ResolveContentRef(e, n),
                        l = s.indexOf("#");
                    l >= 0 ? ((i = s.substr(0, l)), (a = s.substr(l + 1))) : ((i = s), (a = void 0));
                    var c = U.getItemByHref(i);
                    if (!c) {
                        console.warn("spineItem " + i + " not found");
                        var u = decodeURIComponent(i);
                        if (((c = U.getItemByHref(u)), !c)) return console.warn("decoded spineItem " + u + " missing as well"), !1;
                    }
                    var d = {};
                    return (d.contentRefUrl = e), (d.sourceFileHref = n), (d.idref = c.idref), (d.elementId = a), t(document).trigger("loadChapterFromUrl", d), M.openSpineItemElementId(c.idref, a, r);
                }),
                (this.openSpineItemElementId = function (e, t, n) {
                    var r = U.getItemById(e);
                    if (!r) return !1;
                    var i = new d(r, n);
                    return t && i.setElementId(t), S(i, 0), !0;
                }),
                (this.bookmarkCurrentPage = function () {
                    var e = F.bookmarkCurrentPage();
                    return e ? e.toString() : null;
                }),
                (this.clearStyles = function () {
                    j.resetStyleValues(), R(), j.clear();
                }),
                (this.clearBookStyles = function () {
                    F && (z.resetStyleValues(), F.applyBookStyles()), z.clear();
                }),
                (this.isMediaOverlayAvailable = function () {
                    return !!N && N.isMediaOverlayAvailable();
                }),
                (this.toggleMediaOverlay = function () {
                    N.toggleMediaOverlay();
                }),
                (this.nextMediaOverlay = function () {
                    N.nextMediaOverlay();
                }),
                (this.previousMediaOverlay = function () {
                    N.previousMediaOverlay();
                }),
                (this.escapeMediaOverlay = function () {
                    N.escape();
                }),
                (this.ttsEndedMediaOverlay = function () {
                    N.onTTSEnd();
                }),
                (this.pauseMediaOverlay = function () {
                    N.pause();
                }),
                (this.playMediaOverlay = function () {
                    N.play();
                }),
                (this.isPlayingMediaOverlay = function () {
                    return N.isPlaying();
                }),
                (this.getFirstVisibleMediaOverlayElement = function () {
                    if (F) return F.getFirstVisibleMediaOverlayElement();
                }),
                (this.insureElementVisibility = function (e, t, n) {
                    F && F.insureElementVisibility(e, t, n);
                });
            var $ = null,
                W = !1;
            (this.handleViewportResize = function (e) {
                F && F.onViewportResize();
            }),
                (this.addIFrameEventListener = function (e, t, n) {
                    A.addIFrameEventListener(e, t, n);
                });
            var q = function (n) {
                var r = {},
                    i = !1,
                    o = void 0;
                this.setCallback_PlayPause = function (e) {
                    o = e;
                };
                var a = void 0;
                (this.setCallback_IsAvailable = function (e) {
                    a = e;
                }),
                    (this.playPause = function (e) {
                        s(e);
                    });
                var s = function (e) {
                    o && o(e);
                    try {
                        var n = void 0;
                        for (var i in r)
                            if (r.hasOwnProperty(i)) {
                                var a = r[i];
                                if (a && a.active && (n && console.error("More than one active iframe?? (pagination)"), (n = a.$iframe))) {
                                    var s = t("audio", n[0].contentDocument);
                                    t.each(s, function () {
                                        var t = this.getAttribute("epub:type") || this.getAttribute("type");
                                        return !t || (t.indexOf("ibooks:soundtrack") < 0 && t.indexOf("media:soundtrack") < 0 && t.indexOf("media:background") < 0) || (e && this.play ? this.play() : this.pause && this.pause(), !0);
                                    });
                                }
                            }
                    } catch (e) {
                        console.error(e);
                    }
                };
                (this.setPlayState = function (e) {
                    i = e;
                }),
                    n.on(e.Events.CONTENT_DOCUMENT_LOADED, function (t, n) {
                        e.logEvent("CONTENT_DOCUMENT_LOADED", "ON", "reader_view.js (via BackgroundAudioTrackManager) [ " + n.href + " ]");
                        try {
                            n && n.idref && t && t[0] && (r[n.idref] = { $iframe: t, href: n.href });
                        } catch (e) {
                            console.error(e);
                        }
                    }),
                    n.on(e.Events.PAGINATION_CHANGED, function (n) {
                        e.logEvent("PAGINATION_CHANGED", "ON", "reader_view.js (via BackgroundAudioTrackManager)");
                        var o = !1;
                        try {
                            for (var l in r)
                                if (r.hasOwnProperty(l)) {
                                    var c = n.spineItem && n.spineItem.idref === l,
                                        u = !1;
                                    if (n.paginationInfo && n.paginationInfo.openPages.length) {
                                        for (var d = !0, f = 0; f < n.paginationInfo.openPages.length; f++) n.paginationInfo.openPages[f].idref === l ? (u = !0) : (d = !1);
                                        !c && d && (c = !0);
                                    }
                                    if (c || u) {
                                        var h = r[l];
                                        if (!h) continue;
                                        r[l].active = c;
                                        var p = h.$iframe,
                                            g = (h.href, t("audio", p[0].contentDocument));
                                        t.each(g, function () {
                                            var e = this.getAttribute("epub:type") || this.getAttribute("type");
                                            return (
                                                !e ||
                                                (e.indexOf("ibooks:soundtrack") < 0 && e.indexOf("media:soundtrack") < 0 && e.indexOf("media:background") < 0) ||
                                                (this.setAttribute("loop", "loop"), this.removeAttribute("autoplay"), c || (this.pause && this.pause()), (o = !0), !0)
                                            );
                                        });
                                    } else r[l] && (r[l].$iframe = void 0), (r[l] = void 0);
                                }
                        } catch (e) {
                            console.error(e);
                        }
                        a && a(o), s(o ? (i ? !0 : !1) : !1);
                    }),
                    n.on(e.Events.MEDIA_OVERLAY_STATUS_CHANGED, function (t) {
                        if ((e.logEvent("MEDIA_OVERLAY_STATUS_CHANGED", "ON", "reader_view.js (via BackgroundAudioTrackManager)"), t.smilIndex)) {
                            var o = n.package(),
                                a = o.media_overlay.smilAt(t.smilIndex);
                            if (a && a.spineItemId) {
                                var l = !1;
                                for (var c in r)
                                    if (r.hasOwnProperty(c)) {
                                        var u = r[c];
                                        u && u.active && c !== a.spineItemId && (s(!1), (u.active = !1), (l = !0));
                                    }
                                if (l) {
                                    for (var c in r)
                                        if (r.hasOwnProperty(c)) {
                                            var u = r[c];
                                            u && (u.active || (c === a.spineItemId && (u.active = !0)));
                                        }
                                    i && s(!0);
                                }
                            }
                        }
                    });
            };
            (this.backgroundAudioTrackManager = new q(M)),
                (this.isVisibleSpineItemElementCfi = function (e, t) {
                    var n = T(e);
                    if (!n) return !1;
                    if (F) {
                        if (!t || (t && "" === t)) for (var r = F.getLoadedSpineItems(), i = 0, o = r.length; i < o; i++) if (r[i].idref == e) return !0;
                        return F.isVisibleSpineItemElementCfi(e, t);
                    }
                    return !1;
                }),
                (this.getElements = function (e, t) {
                    if (F) return F.getElements(e, t);
                }),
                (this.isElementVisible = function (e) {
                    return F.isElementVisible(t(e));
                }),
                (this.getNodeRangeInfoFromCfi = function (e, t) {
                    if (F && e && t) {
                        var n = F.getNodeRangeInfoFromCfi(e, t);
                        if (n) return new y(n.clientRect).setStartInfo(n.startInfo).setEndInfo(n.endInfo);
                    }
                }),
                (this.getPaginationInfo = function () {
                    return F.getPaginationInfo();
                }),
                (this.getFirstVisibleCfi = function () {
                    if (F) return F.getFirstVisibleCfi();
                }),
                (this.getLastVisibleCfi = function () {
                    if (F) return F.getLastVisibleCfi();
                }),
                (this.getDomRangesFromRangeCfi = function (e, t, n) {
                    if (F) return F.getDomRangesFromRangeCfi ? F.getDomRangesFromRangeCfi(e, t, n) : [F.getDomRangeFromRangeCfi(e, t, n)];
                }),
                (this.getDomRangesFromRangeCfi = function (e, t, n) {
                    if (F) return F.getDomRangesFromRangeCfi ? F.getDomRangesFromRangeCfi(e, t, n) : [F.getDomRangeFromRangeCfi(e, t, n)];
                }),
                (this.getDomRangeFromRangeCfi = function (e, t, n) {
                    if (F) return F.getDomRangeFromRangeCfi(e, t, n);
                }),
                (this.getRangeCfiFromDomRange = function (e) {
                    if (F) return F.getRangeCfiFromDomRange(e);
                }),
                (this.getVisibleCfiFromPoint = function (e, t, n, r) {
                    if (F) return F.getVisibleCfiFromPoint(e, t, n, r);
                }),
                (this.getRangeCfiFromPoints = function (e, t, n, r, i) {
                    if (F) return F.getRangeCfiFromPoints(e, t, n, r, i);
                }),
                (this.getCfiForElement = function (e) {
                    if (F) return F.getCfiForElement(e);
                });
        };
        return (_.VIEW_TYPE_COLUMNIZED = 1), (_.VIEW_TYPE_FIXED = 2), (_.VIEW_TYPE_SCROLLED_DOC = 3), (_.VIEW_TYPE_SCROLLED_CONTINUOUS = 4), _;
    }),
    define("text", {
        load: function (e) {
            throw new Error("Dynamic load not allowed: " + e);
        },
    }),
    define("text!version.json", [], function () {
        return '{"readiumJsViewer":{"sha":"0ab3f61c3b5111f39f226bf955963f1ba14f04a5","clean":false,"version":"0.25.0-alpha","chromeVersion":"2.25.0-alpha","tag":"0.25.0-alpha-0-g0ab3f61","branch":"develop","release":false,"timestamp":1527836274330},"readiumJs":{"sha":"e658d23035d4d51a40a8546c940f4a5326da249c","clean":false,"version":"0.25.0-alpha","tag":"0.24.0-13-ge658d23","branch":"develop","release":false,"timestamp":1527836274842},"readiumSharedJs":{"sha":"7041cf7befda7925e9f61fb1b9e967916eae758c","clean":false,"version":"0.25.0-alpha","tag":"0.24.0-42-g7041cf7","branch":"develop","release":false,"timestamp":1527836275494},"readiumCfiJs":{"sha":"6deaa0341a311e3e8a8cb083e6c54d6b3ae18df1","clean":true,"version":"0.25.0-alpha","tag":"0.24.0-4-g6deaa03","branch":"develop","release":false,"timestamp":1527836275907}}';
    }),
    define("readium_js/epub-fetch/markup_parser", [], function () {
        var e = function () {
            var e = this;
            (this.parseXml = function (t) {
                return e.parseMarkup(t, "text/xml");
            }),
                (this.parseMarkup = function (e, t) {
                    var n = new window.DOMParser();
                    return n.parseFromString(e, t);
                });
        };
        return e;
    }),
    define("readium_js/epub-fetch/discover_content_type", ["jquery", "URIjs"], function (e, t) {
        var n = void 0,
            r = function () {
                var n = this;
                (r.suffixContentTypeMap = {
                    css: "text/css",
                    epub: "application/epub+zip",
                    gif: "image/gif",
                    html: "text/html",
                    jpg: "image/jpeg",
                    jpeg: "image/jpeg",
                    ncx: "application/x-dtbncx+xml",
                    opf: "application/oebps-package+xml",
                    png: "image/png",
                    svg: "image/svg+xml",
                    xhtml: "application/xhtml+xml",
                }),
                    (this.identifyContentTypeFromFileName = function (e) {
                        var n = t(e).suffix(),
                            i = "application/octet-stream";
                        return "undefined" != typeof r.suffixContentTypeMap[n] && (i = r.suffixContentTypeMap[n]), i;
                    }),
                    (this.identifyContentType = function (t) {
                        var r = e.ajax({ type: "HEAD", url: t, async: !1 }).getResponseHeader("Content-Type");
                        return null === r && ((r = n.identifyContentTypeFromFileName(t)), console.log("guessed contentType [" + r + "] from URI [" + t + "]. Configuring the web server to provide the content type is recommended.")), r;
                    });
            };
        return n || (n = new r()), n;
    }),
    define("readium_js/epub-fetch/plain_resource_fetcher", ["jquery", "URIjs", "./discover_content_type"], function (e, t, n) {
        var r = function (r) {
            function i(e, t, n) {
                var r = a.resolveURI(e);
                if ("undefined" == typeof e) throw "Fetched file relative path is undefined!";
                var i = new XMLHttpRequest();
                i.open("GET", r, !0),
                    (i.responseType = "arraybuffer"),
                    (i.onerror = n),
                    (i.onload = function (e) {
                        t(i.response);
                    }),
                    i.send();
            }
            var o = (r.getEbookURL(), r.getEbookURL_FilePath()),
                a = this;
            (this.resolveURI = function (e) {
                var n = void 0;
                try {
                    n = new t(e);
                } catch (t) {
                    console.error(t), console.log(e);
                }
                if (n && n.is("absolute")) return e;
                var r = o;
                try {
                    r = new t(r).search("").hash("").toString();
                } catch (e) {
                    console.error(e), console.log(r);
                }
                return r + ("/" == r.charAt(r.length - 1) ? "" : "/") + e;
            }),
                (this.fetchFileContentsText = function (t, n, r) {
                    var i = a.resolveURI(t);
                    if ("undefined" == typeof i) throw "Fetched file URL is undefined!";
                    e.ajax({
                        isLocal: 0 !== i.indexOf("http"),
                        url: i,
                        dataType: "text",
                        async: !0,
                        success: function (e) {
                            n(e);
                        },
                        error: function (e, t, n) {
                            r(new Error(n));
                        },
                    });
                }),
                (this.fetchFileContentsBlob = function (e, t, o) {
                    var a = r.getDecryptionFunctionForRelativePath(e);
                    if (a) {
                        var s = t;
                        t = function (e) {
                            a(e, function (e) {
                                s(e);
                            });
                        };
                    }
                    i(
                        e,
                        function (r) {
                            var i = new Blob([r], { type: n.identifyContentTypeFromFileName(e) });
                            t(i);
                        },
                        o
                    );
                });
        };
        return r;
    }),
    (function (e) {
        "use strict";
        function t() {
            this.crc = -1;
        }
        function n() {}
        function r(e, t, n) {
            if (t < 0 || n < 0 || t + n > e.size) throw new RangeError("offset:" + t + ", length:" + n + ", size:" + e.size);
            return e.slice ? e.slice(t, t + n) : e.webkitSlice ? e.webkitSlice(t, t + n) : e.mozSlice ? e.mozSlice(t, t + n) : e.msSlice ? e.msSlice(t, t + n) : void 0;
        }
        function i(e, t) {
            var n, r;
            return (n = new ArrayBuffer(e)), (r = new Uint8Array(n)), t && r.set(t, 0), { buffer: n, array: r, view: new DataView(n) };
        }
        function o() {}
        function a(e) {
            function t(t, n) {
                var o = new Blob([e], { type: z });
                (r = new l(o)),
                    r.init(function () {
                        (i.size = r.size), t();
                    }, n);
            }
            function n(e, t, n, i) {
                r.readUint8Array(e, t, n, i);
            }
            var r,
                i = this;
            (i.size = 0), (i.init = t), (i.readUint8Array = n);
        }
        function s(t) {
            function n(e) {
                for (var n = t.length; "=" == t.charAt(n - 1); ) n--;
                (o = t.indexOf(",") + 1), (a.size = Math.floor(0.75 * (n - o))), e();
            }
            function r(n, r, a) {
                var s,
                    l = i(r),
                    c = 4 * Math.floor(n / 3),
                    u = 4 * Math.ceil((n + r) / 3),
                    d = e.atob(t.substring(c + o, u + o)),
                    f = n - 3 * Math.floor(c / 4);
                for (s = f; s < f + r; s++) l.array[s - f] = d.charCodeAt(s);
                a(l.array);
            }
            var o,
                a = this;
            (a.size = 0), (a.init = n), (a.readUint8Array = r);
        }
        function l(e) {
            function t(t) {
                (i.size = e.size), t();
            }
            function n(t, n, i, o) {
                var a = new FileReader();
                (a.onload = function (e) {
                    i(new Uint8Array(e.target.result));
                }),
                    (a.onerror = o);
                try {
                    a.readAsArrayBuffer(r(e, t, n));
                } catch (e) {
                    o(e);
                }
            }
            var i = this;
            (i.size = 0), (i.init = t), (i.readUint8Array = n);
        }
        function c() {}
        function u(e) {
            function t(e) {
                (i = new Blob([], { type: z })), e();
            }
            function n(e, t) {
                (i = new Blob([i, P ? e : e.buffer], { type: z })), t();
            }
            function r(t, n) {
                var r = new FileReader();
                (r.onload = function (e) {
                    t(e.target.result);
                }),
                    (r.onerror = n),
                    r.readAsText(i, e);
            }
            var i,
                o = this;
            (o.init = t), (o.writeUint8Array = n), (o.getData = r);
        }
        function d(t) {
            function n(e) {
                (a += "data:" + (t || "") + ";base64,"), e();
            }
            function r(t, n) {
                var r,
                    i = s.length,
                    o = s;
                for (s = "", r = 0; r < 3 * Math.floor((i + t.length) / 3) - i; r++) o += String.fromCharCode(t[r]);
                for (; r < t.length; r++) s += String.fromCharCode(t[r]);
                o.length > 2 ? (a += e.btoa(o)) : (s = o), n();
            }
            function i(t) {
                t(a + e.btoa(s));
            }
            var o = this,
                a = "",
                s = "";
            (o.init = n), (o.writeUint8Array = r), (o.getData = i);
        }
        function f(e) {
            function t(e) {
                e();
            }
            function n(e, t) {
                i.push(P ? e : e.buffer), t();
            }
            function r(t) {
                t(new Blob(i, { type: e }));
            }
            var i = [],
                o = this;
            (o.init = t), (o.writeUint8Array = n), (o.getData = r);
        }
        function h(e, t, n, r, i, o, a, s, l, c) {
            function u() {
                e.removeEventListener("message", d, !1), s(p, g);
            }
            function d(t) {
                var n = t.data,
                    i = n.data,
                    s = n.error;
                if (s)
                    return (
                        (s.toString = function () {
                            return "Error: " + this.message;
                        }),
                        void l(s)
                    );
                if (n.sn === v)
                    switch (("number" == typeof n.codecTime && (e.codecTime += n.codecTime), "number" == typeof n.crcTime && (e.crcTime += n.crcTime), n.type)) {
                        case "append":
                            i
                                ? ((p += i.length),
                                  r.writeUint8Array(
                                      i,
                                      function () {
                                          f();
                                      },
                                      c
                                  ))
                                : f();
                            break;
                        case "flush":
                            (g = n.crc),
                                i
                                    ? ((p += i.length),
                                      r.writeUint8Array(
                                          i,
                                          function () {
                                              u();
                                          },
                                          c
                                      ))
                                    : u();
                            break;
                        case "progress":
                            a && a(h + n.loaded, o);
                            break;
                        case "importScripts":
                        case "newTask":
                        case "echo":
                            break;
                        default:
                            console.warn("zip.js:launchWorkerProcess: unknown message: ", n);
                    }
            }
            function f() {
                (h = m * j),
                    h <= o
                        ? n.readUint8Array(
                              i + h,
                              Math.min(j, o - h),
                              function (n) {
                                  a && a(h, o);
                                  var r = 0 === h ? t : { sn: v };
                                  (r.type = "append"), (r.data = n);
                                  try {
                                      e.postMessage(r, [n.buffer]);
                                  } catch (t) {
                                      e.postMessage(r);
                                  }
                                  m++;
                              },
                              l
                          )
                        : e.postMessage({ sn: v, type: "flush" });
            }
            var h,
                p,
                g,
                m = 0,
                v = t.sn;
            (p = 0), e.addEventListener("message", d, !1), f();
        }
        function p(e, n, r, i, o, a, s, l, c, u) {
            function d() {
                var t;
                if (((f = h * j), f < o))
                    n.readUint8Array(
                        i + f,
                        Math.min(j, o - f),
                        function (t) {
                            var n;
                            try {
                                n = e.append(t, function (e) {
                                    s && s(f + e, o);
                                });
                            } catch (e) {
                                return void c(e);
                            }
                            n
                                ? ((p += n.length),
                                  r.writeUint8Array(
                                      n,
                                      function () {
                                          h++, setTimeout(d, 1);
                                      },
                                      u
                                  ),
                                  m && v.append(n))
                                : (h++, setTimeout(d, 1)),
                                g && v.append(t),
                                s && s(f, o);
                        },
                        c
                    );
                else {
                    try {
                        t = e.flush();
                    } catch (e) {
                        return void c(e);
                    }
                    t
                        ? (m && v.append(t),
                          (p += t.length),
                          r.writeUint8Array(
                              t,
                              function () {
                                  l(p, v.get());
                              },
                              u
                          ))
                        : l(p, v.get());
                }
            }
            var f,
                h = 0,
                p = 0,
                g = "input" === a,
                m = "output" === a,
                v = new t();
            d();
        }
        function g(t, n, r, i, o, a, s, l, c, u, d) {
            var f = s ? "output" : "none";
            if (e.zip.useWebWorkers) {
                var g = { sn: n, codecClass: "Inflater", crcType: f };
                h(t, g, r, i, o, a, c, l, u, d);
            } else p(new e.zip.Inflater(), r, i, o, a, f, c, l, u, d);
        }
        function m(t, n, r, i, o, a, s, l, c) {
            var u = "input";
            if (e.zip.useWebWorkers) {
                var d = { sn: n, options: { level: o }, codecClass: "Deflater", crcType: u };
                h(t, d, r, i, 0, r.size, s, a, l, c);
            } else p(new e.zip.Deflater(), r, i, 0, r.size, u, s, a, l, c);
        }
        function v(t, r, i, o, a, s, l, c, u, d, f) {
            var g = "input";
            if (e.zip.useWebWorkers && l) {
                var m = { sn: r, codecClass: "NOOP", crcType: g };
                h(t, m, i, o, a, s, u, c, d, f);
            } else p(new n(), i, o, a, s, g, u, c, d, f);
        }
        function b(e) {
            var t,
                n,
                r = "",
                i = [
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "_",
                    "_",
                    "_",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "+",
                    "+",
                    "",
                    "",
                    "+",
                    "+",
                    "-",
                    "-",
                    "+",
                    "-",
                    "+",
                    "",
                    "",
                    "+",
                    "+",
                    "-",
                    "-",
                    "",
                    "-",
                    "+",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "i",
                    "",
                    "",
                    "",
                    "+",
                    "+",
                    "_",
                    "_",
                    "",
                    "",
                    "_",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "_",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "_",
                    " ",
                ];
            for (t = 0; t < e.length; t++) (n = 255 & e.charCodeAt(t)), (r += n > 127 ? i[n - 128] : String.fromCharCode(n));
            return r;
        }
        function y(e) {
            return decodeURIComponent(escape(e));
        }
        function _(e) {
            var t,
                n = "";
            for (t = 0; t < e.length; t++) n += String.fromCharCode(e[t]);
            return n;
        }
        function w(e) {
            var t = (4294901760 & e) >> 16,
                n = 65535 & e;
            try {
                return new Date(1980 + ((65024 & t) >> 9), ((480 & t) >> 5) - 1, 31 & t, (63488 & n) >> 11, (2016 & n) >> 5, 2 * (31 & n), 0);
            } catch (e) {}
        }
        function x(e, t, n, r, i) {
            return (
                (e.version = t.view.getUint16(n, !0)),
                (e.bitFlag = t.view.getUint16(n + 2, !0)),
                (e.compressionMethod = t.view.getUint16(n + 4, !0)),
                (e.lastModDateRaw = t.view.getUint32(n + 6, !0)),
                (e.lastModDate = w(e.lastModDateRaw)),
                1 === (1 & e.bitFlag)
                    ? void i(A)
                    : ((r || 8 != (8 & e.bitFlag)) && ((e.crc32 = t.view.getUint32(n + 10, !0)), (e.compressedSize = t.view.getUint32(n + 14, !0)), (e.uncompressedSize = t.view.getUint32(n + 18, !0))),
                      4294967295 === e.compressedSize || 4294967295 === e.uncompressedSize ? void i(D) : ((e.filenameLength = t.view.getUint16(n + 22, !0)), void (e.extraFieldLength = t.view.getUint16(n + 24, !0))))
            );
        }
        function E(t, n, r) {
            function o() {}
            function a(e) {
                function n(n, o) {
                    t.readUint8Array(
                        t.size - n,
                        n,
                        function (t) {
                            for (var n = t.length - i; n >= 0; n--) if (80 === t[n] && 75 === t[n + 1] && 5 === t[n + 2] && 6 === t[n + 3]) return void e(new DataView(t.buffer, n, i));
                            o();
                        },
                        function () {
                            r(M);
                        }
                    );
                }
                var i = 22;
                if (t.size < i) return void r(N);
                var o = 65536,
                    a = i + o;
                n(i, function () {
                    n(Math.min(a, t.size), function () {
                        r(N);
                    });
                });
            }
            var s = 0;
            o.prototype.getData = function (e, n, o, a) {
                function l(e) {
                    var t = i(4);
                    return t.view.setUint32(0, e), f.crc32 == t.view.getUint32(0);
                }
                function c(t, i) {
                    a && !l(i)
                        ? r(O)
                        : e.getData(function (e) {
                              n(e);
                          });
                }
                function u(e) {
                    r(e || U);
                }
                function d(e) {
                    r(e || L);
                }
                var f = this;
                t.readUint8Array(
                    f.offset,
                    30,
                    function (n) {
                        var l,
                            h = i(n.length, n);
                        return 1347093252 != h.view.getUint32(0)
                            ? void r(N)
                            : (x(f, h, 4, !1, r),
                              (l = f.offset + 30 + f.filenameLength + f.extraFieldLength),
                              void e.init(function () {
                                  0 === f.compressionMethod ? v(f._worker, s++, t, e, l, f.compressedSize, a, c, o, u, d) : g(f._worker, s++, t, e, l, f.compressedSize, a, c, o, u, d);
                              }, d));
                    },
                    u
                );
            };
            var l = {
                getEntries: function (e) {
                    var n = this._worker;
                    a(function (a) {
                        var s, l;
                        return (
                            (s = a.getUint32(16, !0)),
                            (l = a.getUint16(8, !0)),
                            s < 0 || s >= t.size
                                ? void r(N)
                                : void t.readUint8Array(
                                      s,
                                      t.size - s,
                                      function (t) {
                                          var a,
                                              s,
                                              c,
                                              u,
                                              d = 0,
                                              f = [],
                                              h = i(t.length, t);
                                          for (a = 0; a < l; a++) {
                                              if (((s = new o()), (s._worker = n), 1347092738 != h.view.getUint32(d))) return void r(N);
                                              x(s, h, d + 6, !0, r),
                                                  (s.commentLength = h.view.getUint16(d + 32, !0)),
                                                  (s.directory = 16 == (16 & h.view.getUint8(d + 38))),
                                                  (s.offset = h.view.getUint32(d + 42, !0)),
                                                  (c = _(h.array.subarray(d + 46, d + 46 + s.filenameLength))),
                                                  (s.filename = 2048 === (2048 & s.bitFlag) ? y(c) : b(c)),
                                                  s.directory || "/" != s.filename.charAt(s.filename.length - 1) || (s.directory = !0),
                                                  (u = _(h.array.subarray(d + 46 + s.filenameLength + s.extraFieldLength, d + 46 + s.filenameLength + s.extraFieldLength + s.commentLength))),
                                                  (s.comment = 2048 === (2048 & s.bitFlag) ? y(u) : b(u)),
                                                  f.push(s),
                                                  (d += 46 + s.filenameLength + s.extraFieldLength + s.commentLength);
                                          }
                                          e(f);
                                      },
                                      function () {
                                          r(M);
                                      }
                                  )
                        );
                    });
                },
                close: function (e) {
                    this._worker && (this._worker.terminate(), (this._worker = null)), e && e();
                },
                _worker: null,
            };
            e.zip.useWebWorkers
                ? I(
                      "inflater",
                      function (e) {
                          (l._worker = e), n(l);
                      },
                      function (e) {
                          r(e);
                      }
                  )
                : n(l);
        }
        function C(e) {
            return unescape(encodeURIComponent(e));
        }
        function T(e) {
            var t,
                n = [];
            for (t = 0; t < e.length; t++) n.push(e.charCodeAt(t));
            return n;
        }
        function S(t, n, r, o) {
            function a(e) {
                r(e || F);
            }
            function s(e) {
                r(e || U);
            }
            var l = {},
                c = [],
                u = 0,
                d = 0,
                f = {
                    add: function (e, n, f, h, p) {
                        function g(n) {
                            var r;
                            (x = p.lastModDate || new Date()),
                                (_ = i(26)),
                                (l[e] = { headerArray: _.array, directory: p.directory, filename: w, offset: u, comment: T(C(p.comment || "")) }),
                                _.view.setUint32(0, 335546376),
                                p.version && _.view.setUint8(0, p.version),
                                o || 0 === p.level || p.directory || _.view.setUint16(4, 2048),
                                _.view.setUint16(6, (((x.getHours() << 6) | x.getMinutes()) << 5) | (x.getSeconds() / 2), !0),
                                _.view.setUint16(8, ((((x.getFullYear() - 1980) << 4) | (x.getMonth() + 1)) << 5) | x.getDate(), !0),
                                _.view.setUint16(22, w.length, !0),
                                (r = i(30 + w.length)),
                                r.view.setUint32(0, 1347093252),
                                r.array.set(_.array, 4),
                                r.array.set(w, 30),
                                (u += r.array.length),
                                t.writeUint8Array(r.array, n, a);
                        }
                        function b(e, r) {
                            var o = i(16);
                            (u += e || 0),
                                o.view.setUint32(0, 1347094280),
                                "undefined" != typeof r && (_.view.setUint32(10, r, !0), o.view.setUint32(4, r, !0)),
                                n && (o.view.setUint32(8, e, !0), _.view.setUint32(14, e, !0), o.view.setUint32(12, n.size, !0), _.view.setUint32(18, n.size, !0)),
                                t.writeUint8Array(
                                    o.array,
                                    function () {
                                        (u += 16), f();
                                    },
                                    a
                                );
                        }
                        function y() {
                            return (
                                (p = p || {}),
                                (e = e.trim()),
                                p.directory && "/" != e.charAt(e.length - 1) && (e += "/"),
                                l.hasOwnProperty(e)
                                    ? void r(B)
                                    : ((w = T(C(e))),
                                      c.push(e),
                                      void g(function () {
                                          n ? (o || 0 === p.level ? v(E, d++, n, t, 0, n.size, !0, b, h, s, a) : m(E, d++, n, t, p.level, b, h, s, a)) : b();
                                      }, a))
                            );
                        }
                        var _,
                            w,
                            x,
                            E = this._worker;
                        n ? n.init(y, s) : y();
                    },
                    close: function (e) {
                        this._worker && (this._worker.terminate(), (this._worker = null));
                        var n,
                            r,
                            o,
                            s = 0,
                            d = 0;
                        for (r = 0; r < c.length; r++) (o = l[c[r]]), (s += 46 + o.filename.length + o.comment.length);
                        for (n = i(s + 22), r = 0; r < c.length; r++)
                            (o = l[c[r]]),
                                n.view.setUint32(d, 1347092738),
                                n.view.setUint16(d + 4, 5120),
                                n.array.set(o.headerArray, d + 6),
                                n.view.setUint16(d + 32, o.comment.length, !0),
                                o.directory && n.view.setUint8(d + 38, 16),
                                n.view.setUint32(d + 42, o.offset, !0),
                                n.array.set(o.filename, d + 46),
                                n.array.set(o.comment, d + 46 + o.filename.length),
                                (d += 46 + o.filename.length + o.comment.length);
                        n.view.setUint32(d, 1347093766),
                            n.view.setUint16(d + 8, c.length, !0),
                            n.view.setUint16(d + 10, c.length, !0),
                            n.view.setUint32(d + 12, s, !0),
                            n.view.setUint32(d + 16, u, !0),
                            t.writeUint8Array(
                                n.array,
                                function () {
                                    t.getData(e);
                                },
                                a
                            );
                    },
                    _worker: null,
                };
            e.zip.useWebWorkers
                ? I(
                      "deflater",
                      function (e) {
                          (f._worker = e), n(f);
                      },
                      function (e) {
                          r(e);
                      }
                  )
                : n(f);
        }
        function R(e) {
            var t = document.createElement("a");
            return e.map(function (e) {
                return (t.href = e), t.href;
            });
        }
        function I(t, n, r) {
            function i(e) {
                var t = e.data;
                return t.error ? (s.terminate(), void r(t.error)) : void ("importScripts" === t.type && (s.removeEventListener("message", i), s.removeEventListener("error", o), n(s)));
            }
            function o(e) {
                s.terminate(), r(e);
            }
            if (null !== e.zip.workerScripts && null !== e.zip.workerScriptsPath) return void r(new Error("Either zip.workerScripts or zip.workerScriptsPath may be set, not both."));
            var a;
            if (e.zip.workerScripts) {
                if (((a = e.zip.workerScripts[t]), !Array.isArray(a))) return void r(new Error("zip.workerScripts." + t + " is not an array!"));
                a = R(a);
            } else (a = V[t].slice(0)), (a[0] = (e.zip.workerScriptsPath || "") + a[0]);
            var s = new Worker(a[0]);
            (s.codecTime = s.crcTime = 0), s.postMessage({ type: "importScripts", scripts: a.slice(1) }), s.addEventListener("message", i), s.addEventListener("error", o);
        }
        function k(e) {
            console.error(e);
        }
        var P,
            N = "File format is not recognized.",
            O = "CRC failed.",
            A = "File contains encrypted entry.",
            D = "File is using Zip64 (4gb+ file size).",
            M = "Error while reading zip file.",
            F = "Error while writing zip file.",
            L = "Error while writing file data.",
            U = "Error while reading file data.",
            B = "File already exists.",
            j = 524288,
            z = "text/plain";
        try {
            P = 0 === new Blob([new DataView(new ArrayBuffer(0))]).size;
        } catch (e) {}
        (t.prototype.append = function (e) {
            for (var t = 0 | this.crc, n = this.table, r = 0, i = 0 | e.length; r < i; r++) t = (t >>> 8) ^ n[255 & (t ^ e[r])];
            this.crc = t;
        }),
            (t.prototype.get = function () {
                return ~this.crc;
            }),
            (t.prototype.table = (function () {
                var e,
                    t,
                    n,
                    r = [];
                for (e = 0; e < 256; e++) {
                    for (n = e, t = 0; t < 8; t++) 1 & n ? (n = (n >>> 1) ^ 3988292384) : (n >>>= 1);
                    r[e] = n;
                }
                return r;
            })()),
            (n.prototype.append = function (e, t) {
                return e;
            }),
            (n.prototype.flush = function () {}),
            (a.prototype = new o()),
            (a.prototype.constructor = a),
            (s.prototype = new o()),
            (s.prototype.constructor = s),
            (l.prototype = new o()),
            (l.prototype.constructor = l),
            (c.prototype.getData = function (e) {
                e(this.data);
            }),
            (u.prototype = new c()),
            (u.prototype.constructor = u),
            (d.prototype = new c()),
            (d.prototype.constructor = d),
            (f.prototype = new c()),
            (f.prototype.constructor = f);
        var V = { deflater: ["z-worker.js", "deflate.js"], inflater: ["z-worker.js", "inflate.js"] };
        e.zip = {
            Reader: o,
            Writer: c,
            BlobReader: l,
            Data64URIReader: s,
            TextReader: a,
            BlobWriter: f,
            Data64URIWriter: d,
            TextWriter: u,
            createReader: function (e, t, n) {
                (n = n || k),
                    e.init(function () {
                        E(e, t, n);
                    }, n);
            },
            createWriter: function (e, t, n, r) {
                (n = n || k),
                    (r = !!r),
                    e.init(function () {
                        S(e, t, n, r);
                    }, n);
            },
            useWebWorkers: !0,
            workerScriptsPath: null,
            workerScripts: null,
        };
    })(this),
    define("zip", (function (e) {
        return function () {
            var t;
            return t || e.zip;
        };
    })(this)),
    (function () {
        "use strict";
        var e = {
                application: {
                    "andrew-inset": "ez",
                    annodex: "anx",
                    "atom+xml": "atom",
                    "atomcat+xml": "atomcat",
                    "atomserv+xml": "atomsrv",
                    bbolin: "lin",
                    cap: ["cap", "pcap"],
                    "cu-seeme": "cu",
                    "davmount+xml": "davmount",
                    dsptype: "tsp",
                    ecmascript: ["es", "ecma"],
                    futuresplash: "spl",
                    hta: "hta",
                    "java-archive": "jar",
                    "java-serialized-object": "ser",
                    "java-vm": "class",
                    javascript: "js",
                    m3g: "m3g",
                    "mac-binhex40": "hqx",
                    mathematica: ["nb", "ma", "mb"],
                    msaccess: "mdb",
                    msword: ["doc", "dot"],
                    mxf: "mxf",
                    oda: "oda",
                    ogg: "ogx",
                    pdf: "pdf",
                    "pgp-keys": "key",
                    "pgp-signature": ["asc", "sig"],
                    "pics-rules": "prf",
                    postscript: ["ps", "ai", "eps", "epsi", "epsf", "eps2", "eps3"],
                    rar: "rar",
                    "rdf+xml": "rdf",
                    "rss+xml": "rss",
                    rtf: "rtf",
                    smil: ["smi", "smil"],
                    "xhtml+xml": ["xhtml", "xht"],
                    xml: ["xml", "xsl", "xsd"],
                    "xspf+xml": "xspf",
                    zip: "zip",
                    "vnd.android.package-archive": "apk",
                    "vnd.cinderella": "cdy",
                    "vnd.google-earth.kml+xml": "kml",
                    "vnd.google-earth.kmz": "kmz",
                    "vnd.mozilla.xul+xml": "xul",
                    "vnd.ms-excel": ["xls", "xlb", "xlt", "xlm", "xla", "xlc", "xlw"],
                    "vnd.ms-pki.seccat": "cat",
                    "vnd.ms-pki.stl": "stl",
                    "vnd.ms-powerpoint": ["ppt", "pps", "pot"],
                    "vnd.oasis.opendocument.chart": "odc",
                    "vnd.oasis.opendocument.database": "odb",
                    "vnd.oasis.opendocument.formula": "odf",
                    "vnd.oasis.opendocument.graphics": "odg",
                    "vnd.oasis.opendocument.graphics-template": "otg",
                    "vnd.oasis.opendocument.image": "odi",
                    "vnd.oasis.opendocument.presentation": "odp",
                    "vnd.oasis.opendocument.presentation-template": "otp",
                    "vnd.oasis.opendocument.spreadsheet": "ods",
                    "vnd.oasis.opendocument.spreadsheet-template": "ots",
                    "vnd.oasis.opendocument.text": "odt",
                    "vnd.oasis.opendocument.text-master": "odm",
                    "vnd.oasis.opendocument.text-template": "ott",
                    "vnd.oasis.opendocument.text-web": "oth",
                    "vnd.openxmlformats-officedocument.spreadsheetml.sheet": "xlsx",
                    "vnd.openxmlformats-officedocument.spreadsheetml.template": "xltx",
                    "vnd.openxmlformats-officedocument.presentationml.presentation": "pptx",
                    "vnd.openxmlformats-officedocument.presentationml.slideshow": "ppsx",
                    "vnd.openxmlformats-officedocument.presentationml.template": "potx",
                    "vnd.openxmlformats-officedocument.wordprocessingml.document": "docx",
                    "vnd.openxmlformats-officedocument.wordprocessingml.template": "dotx",
                    "vnd.smaf": "mmf",
                    "vnd.stardivision.calc": "sdc",
                    "vnd.stardivision.chart": "sds",
                    "vnd.stardivision.draw": "sda",
                    "vnd.stardivision.impress": "sdd",
                    "vnd.stardivision.math": ["sdf", "smf"],
                    "vnd.stardivision.writer": ["sdw", "vor"],
                    "vnd.stardivision.writer-global": "sgl",
                    "vnd.sun.xml.calc": "sxc",
                    "vnd.sun.xml.calc.template": "stc",
                    "vnd.sun.xml.draw": "sxd",
                    "vnd.sun.xml.draw.template": "std",
                    "vnd.sun.xml.impress": "sxi",
                    "vnd.sun.xml.impress.template": "sti",
                    "vnd.sun.xml.math": "sxm",
                    "vnd.sun.xml.writer": "sxw",
                    "vnd.sun.xml.writer.global": "sxg",
                    "vnd.sun.xml.writer.template": "stw",
                    "vnd.symbian.install": ["sis", "sisx"],
                    "vnd.visio": ["vsd", "vst", "vss", "vsw"],
                    "vnd.wap.wbxml": "wbxml",
                    "vnd.wap.wmlc": "wmlc",
                    "vnd.wap.wmlscriptc": "wmlsc",
                    "vnd.wordperfect": "wpd",
                    "vnd.wordperfect5.1": "wp5",
                    "x-123": "wk",
                    "x-7z-compressed": "7z",
                    "x-abiword": "abw",
                    "x-apple-diskimage": "dmg",
                    "x-bcpio": "bcpio",
                    "x-bittorrent": "torrent",
                    "x-cbr": ["cbr", "cba", "cbt", "cb7"],
                    "x-cbz": "cbz",
                    "x-cdf": ["cdf", "cda"],
                    "x-cdlink": "vcd",
                    "x-chess-pgn": "pgn",
                    "x-cpio": "cpio",
                    "x-csh": "csh",
                    "x-debian-package": ["deb", "udeb"],
                    "x-director": ["dcr", "dir", "dxr", "cst", "cct", "cxt", "w3d", "fgd", "swa"],
                    "x-dms": "dms",
                    "x-doom": "wad",
                    "x-dvi": "dvi",
                    "x-httpd-eruby": "rhtml",
                    "x-font": "pcf.Z",
                    "x-freemind": "mm",
                    "x-gnumeric": "gnumeric",
                    "x-go-sgf": "sgf",
                    "x-graphing-calculator": "gcf",
                    "x-gtar": ["gtar", "taz"],
                    "x-hdf": "hdf",
                    "x-httpd-php": ["phtml", "pht", "php"],
                    "x-httpd-php-source": "phps",
                    "x-httpd-php3": "php3",
                    "x-httpd-php3-preprocessed": "php3p",
                    "x-httpd-php4": "php4",
                    "x-httpd-php5": "php5",
                    "x-ica": "ica",
                    "x-info": "info",
                    "x-internet-signup": ["ins", "isp"],
                    "x-iphone": "iii",
                    "x-iso9660-image": "iso",
                    "x-java-jnlp-file": "jnlp",
                    "x-jmol": "jmz",
                    "x-killustrator": "kil",
                    "x-koan": ["skp", "skd", "skt", "skm"],
                    "x-kpresenter": ["kpr", "kpt"],
                    "x-kword": ["kwd", "kwt"],
                    "x-latex": "latex",
                    "x-lha": "lha",
                    "x-lyx": "lyx",
                    "x-lzh": "lzh",
                    "x-lzx": "lzx",
                    "x-maker": ["frm", "maker", "frame", "fm", "fb", "book", "fbdoc"],
                    "x-ms-wmd": "wmd",
                    "x-ms-wmz": "wmz",
                    "x-msdos-program": ["com", "exe", "bat", "dll"],
                    "x-msi": "msi",
                    "x-netcdf": ["nc", "cdf"],
                    "x-ns-proxy-autoconfig": ["pac", "dat"],
                    "x-nwc": "nwc",
                    "x-object": "o",
                    "x-oz-application": "oza",
                    "x-pkcs7-certreqresp": "p7r",
                    "x-python-code": ["pyc", "pyo"],
                    "x-qgis": ["qgs", "shp", "shx"],
                    "x-quicktimeplayer": "qtl",
                    "x-redhat-package-manager": "rpm",
                    "x-ruby": "rb",
                    "x-sh": "sh",
                    "x-shar": "shar",
                    "x-shockwave-flash": ["swf", "swfl"],
                    "x-silverlight": "scr",
                    "x-stuffit": "sit",
                    "x-sv4cpio": "sv4cpio",
                    "x-sv4crc": "sv4crc",
                    "x-tar": "tar",
                    "x-tcl": "tcl",
                    "x-tex-gf": "gf",
                    "x-tex-pk": "pk",
                    "x-texinfo": ["texinfo", "texi"],
                    "x-trash": ["~", "%", "bak", "old", "sik"],
                    "x-troff": ["t", "tr", "roff"],
                    "x-troff-man": "man",
                    "x-troff-me": "me",
                    "x-troff-ms": "ms",
                    "x-ustar": "ustar",
                    "x-wais-source": "src",
                    "x-wingz": "wz",
                    "x-x509-ca-cert": ["crt", "der", "cer"],
                    "x-xcf": "xcf",
                    "x-xfig": "fig",
                    "x-xpinstall": "xpi",
                    applixware: "aw",
                    "atomsvc+xml": "atomsvc",
                    "ccxml+xml": "ccxml",
                    "cdmi-capability": "cdmia",
                    "cdmi-container": "cdmic",
                    "cdmi-domain": "cdmid",
                    "cdmi-object": "cdmio",
                    "cdmi-queue": "cdmiq",
                    "docbook+xml": "dbk",
                    "dssc+der": "dssc",
                    "dssc+xml": "xdssc",
                    "emma+xml": "emma",
                    "epub+zip": "epub",
                    exi: "exi",
                    "font-tdpfr": "pfr",
                    "gml+xml": "gml",
                    "gpx+xml": "gpx",
                    gxf: "gxf",
                    hyperstudio: "stk",
                    "inkml+xml": ["ink", "inkml"],
                    ipfix: "ipfix",
                    json: "json",
                    "jsonml+json": "jsonml",
                    "lost+xml": "lostxml",
                    "mads+xml": "mads",
                    marc: "mrc",
                    "marcxml+xml": "mrcx",
                    "mathml+xml": "mathml",
                    mbox: "mbox",
                    "mediaservercontrol+xml": "mscml",
                    "metalink+xml": "metalink",
                    "metalink4+xml": "meta4",
                    "mets+xml": "mets",
                    "mods+xml": "mods",
                    mp21: ["m21", "mp21"],
                    mp4: "mp4s",
                    "oebps-package+xml": "opf",
                    "omdoc+xml": "omdoc",
                    onenote: ["onetoc", "onetoc2", "onetmp", "onepkg"],
                    oxps: "oxps",
                    "patch-ops-error+xml": "xer",
                    "pgp-encrypted": "pgp",
                    pkcs10: "p10",
                    "pkcs7-mime": ["p7m", "p7c"],
                    "pkcs7-signature": "p7s",
                    pkcs8: "p8",
                    "pkix-attr-cert": "ac",
                    "pkix-crl": "crl",
                    "pkix-pkipath": "pkipath",
                    pkixcmp: "pki",
                    "pls+xml": "pls",
                    "prs.cww": "cww",
                    "pskc+xml": "pskcxml",
                    "reginfo+xml": "rif",
                    "relax-ng-compact-syntax": "rnc",
                    "resource-lists+xml": "rl",
                    "resource-lists-diff+xml": "rld",
                    "rls-services+xml": "rs",
                    "rpki-ghostbusters": "gbr",
                    "rpki-manifest": "mft",
                    "rpki-roa": "roa",
                    "rsd+xml": "rsd",
                    "sbml+xml": "sbml",
                    "scvp-cv-request": "scq",
                    "scvp-cv-response": "scs",
                    "scvp-vp-request": "spq",
                    "scvp-vp-response": "spp",
                    sdp: "sdp",
                    "set-payment-initiation": "setpay",
                    "set-registration-initiation": "setreg",
                    "shf+xml": "shf",
                    "sparql-query": "rq",
                    "sparql-results+xml": "srx",
                    srgs: "gram",
                    "srgs+xml": "grxml",
                    "sru+xml": "sru",
                    "ssdl+xml": "ssdl",
                    "ssml+xml": "ssml",
                    "tei+xml": ["tei", "teicorpus"],
                    "thraud+xml": "tfi",
                    "timestamped-data": "tsd",
                    "vnd.3gpp.pic-bw-large": "plb",
                    "vnd.3gpp.pic-bw-small": "psb",
                    "vnd.3gpp.pic-bw-var": "pvb",
                    "vnd.3gpp2.tcap": "tcap",
                    "vnd.3m.post-it-notes": "pwn",
                    "vnd.accpac.simply.aso": "aso",
                    "vnd.accpac.simply.imp": "imp",
                    "vnd.acucobol": "acu",
                    "vnd.acucorp": ["atc", "acutc"],
                    "vnd.adobe.air-application-installer-package+zip": "air",
                    "vnd.adobe.formscentral.fcdt": "fcdt",
                    "vnd.adobe.fxp": ["fxp", "fxpl"],
                    "vnd.adobe.xdp+xml": "xdp",
                    "vnd.adobe.xfdf": "xfdf",
                    "vnd.ahead.space": "ahead",
                    "vnd.airzip.filesecure.azf": "azf",
                    "vnd.airzip.filesecure.azs": "azs",
                    "vnd.amazon.ebook": "azw",
                    "vnd.americandynamics.acc": "acc",
                    "vnd.amiga.ami": "ami",
                    "vnd.anser-web-certificate-issue-initiation": "cii",
                    "vnd.anser-web-funds-transfer-initiation": "fti",
                    "vnd.antix.game-component": "atx",
                    "vnd.apple.installer+xml": "mpkg",
                    "vnd.apple.mpegurl": "m3u8",
                    "vnd.aristanetworks.swi": "swi",
                    "vnd.astraea-software.iota": "iota",
                    "vnd.audiograph": "aep",
                    "vnd.blueice.multipass": "mpm",
                    "vnd.bmi": "bmi",
                    "vnd.businessobjects": "rep",
                    "vnd.chemdraw+xml": "cdxml",
                    "vnd.chipnuts.karaoke-mmd": "mmd",
                    "vnd.claymore": "cla",
                    "vnd.cloanto.rp9": "rp9",
                    "vnd.clonk.c4group": ["c4g", "c4d", "c4f", "c4p", "c4u"],
                    "vnd.cluetrust.cartomobile-config": "c11amc",
                    "vnd.cluetrust.cartomobile-config-pkg": "c11amz",
                    "vnd.commonspace": "csp",
                    "vnd.contact.cmsg": "cdbcmsg",
                    "vnd.cosmocaller": "cmc",
                    "vnd.crick.clicker": "clkx",
                    "vnd.crick.clicker.keyboard": "clkk",
                    "vnd.crick.clicker.palette": "clkp",
                    "vnd.crick.clicker.template": "clkt",
                    "vnd.crick.clicker.wordbank": "clkw",
                    "vnd.criticaltools.wbs+xml": "wbs",
                    "vnd.ctc-posml": "pml",
                    "vnd.cups-ppd": "ppd",
                    "vnd.curl.car": "car",
                    "vnd.curl.pcurl": "pcurl",
                    "vnd.dart": "dart",
                    "vnd.data-vision.rdz": "rdz",
                    "vnd.dece.data": ["uvf", "uvvf", "uvd", "uvvd"],
                    "vnd.dece.ttml+xml": ["uvt", "uvvt"],
                    "vnd.dece.unspecified": ["uvx", "uvvx"],
                    "vnd.dece.zip": ["uvz", "uvvz"],
                    "vnd.denovo.fcselayout-link": "fe_launch",
                    "vnd.dna": "dna",
                    "vnd.dolby.mlp": "mlp",
                    "vnd.dpgraph": "dpg",
                    "vnd.dreamfactory": "dfac",
                    "vnd.ds-keypoint": "kpxx",
                    "vnd.dvb.ait": "ait",
                    "vnd.dvb.service": "svc",
                    "vnd.dynageo": "geo",
                    "vnd.ecowin.chart": "mag",
                    "vnd.enliven": "nml",
                    "vnd.epson.esf": "esf",
                    "vnd.epson.msf": "msf",
                    "vnd.epson.quickanime": "qam",
                    "vnd.epson.salt": "slt",
                    "vnd.epson.ssf": "ssf",
                    "vnd.eszigno3+xml": ["es3", "et3"],
                    "vnd.ezpix-album": "ez2",
                    "vnd.ezpix-package": "ez3",
                    "vnd.fdf": "fdf",
                    "vnd.fdsn.mseed": "mseed",
                    "vnd.fdsn.seed": ["seed", "dataless"],
                    "vnd.flographit": "gph",
                    "vnd.fluxtime.clip": "ftc",
                    "vnd.framemaker": ["fm", "frame", "maker", "book"],
                    "vnd.frogans.fnc": "fnc",
                    "vnd.frogans.ltf": "ltf",
                    "vnd.fsc.weblaunch": "fsc",
                    "vnd.fujitsu.oasys": "oas",
                    "vnd.fujitsu.oasys2": "oa2",
                    "vnd.fujitsu.oasys3": "oa3",
                    "vnd.fujitsu.oasysgp": "fg5",
                    "vnd.fujitsu.oasysprs": "bh2",
                    "vnd.fujixerox.ddd": "ddd",
                    "vnd.fujixerox.docuworks": "xdw",
                    "vnd.fujixerox.docuworks.binder": "xbd",
                    "vnd.fuzzysheet": "fzs",
                    "vnd.genomatix.tuxedo": "txd",
                    "vnd.geogebra.file": "ggb",
                    "vnd.geogebra.tool": "ggt",
                    "vnd.geometry-explorer": ["gex", "gre"],
                    "vnd.geonext": "gxt",
                    "vnd.geoplan": "g2w",
                    "vnd.geospace": "g3w",
                    "vnd.gmx": "gmx",
                    "vnd.grafeq": ["gqf", "gqs"],
                    "vnd.groove-account": "gac",
                    "vnd.groove-help": "ghf",
                    "vnd.groove-identity-message": "gim",
                    "vnd.groove-injector": "grv",
                    "vnd.groove-tool-message": "gtm",
                    "vnd.groove-tool-template": "tpl",
                    "vnd.groove-vcard": "vcg",
                    "vnd.hal+xml": "hal",
                    "vnd.handheld-entertainment+xml": "zmm",
                    "vnd.hbci": "hbci",
                    "vnd.hhe.lesson-player": "les",
                    "vnd.hp-hpgl": "hpgl",
                    "vnd.hp-hpid": "hpid",
                    "vnd.hp-hps": "hps",
                    "vnd.hp-jlyt": "jlt",
                    "vnd.hp-pcl": "pcl",
                    "vnd.hp-pclxl": "pclxl",
                    "vnd.hydrostatix.sof-data": "sfd-hdstx",
                    "vnd.ibm.minipay": "mpy",
                    "vnd.ibm.modcap": ["afp", "listafp", "list3820"],
                    "vnd.ibm.rights-management": "irm",
                    "vnd.ibm.secure-container": "sc",
                    "vnd.iccprofile": ["icc", "icm"],
                    "vnd.igloader": "igl",
                    "vnd.immervision-ivp": "ivp",
                    "vnd.immervision-ivu": "ivu",
                    "vnd.insors.igm": "igm",
                    "vnd.intercon.formnet": ["xpw", "xpx"],
                    "vnd.intergeo": "i2g",
                    "vnd.intu.qbo": "qbo",
                    "vnd.intu.qfx": "qfx",
                    "vnd.ipunplugged.rcprofile": "rcprofile",
                    "vnd.irepository.package+xml": "irp",
                    "vnd.is-xpr": "xpr",
                    "vnd.isac.fcs": "fcs",
                    "vnd.jam": "jam",
                    "vnd.jcp.javame.midlet-rms": "rms",
                    "vnd.jisp": "jisp",
                    "vnd.joost.joda-archive": "joda",
                    "vnd.kahootz": ["ktz", "ktr"],
                    "vnd.kde.karbon": "karbon",
                    "vnd.kde.kchart": "chrt",
                    "vnd.kde.kformula": "kfo",
                    "vnd.kde.kivio": "flw",
                    "vnd.kde.kontour": "kon",
                    "vnd.kde.kpresenter": ["kpr", "kpt"],
                    "vnd.kde.kspread": "ksp",
                    "vnd.kde.kword": ["kwd", "kwt"],
                    "vnd.kenameaapp": "htke",
                    "vnd.kidspiration": "kia",
                    "vnd.kinar": ["kne", "knp"],
                    "vnd.koan": ["skp", "skd", "skt", "skm"],
                    "vnd.kodak-descriptor": "sse",
                    "vnd.las.las+xml": "lasxml",
                    "vnd.llamagraphics.life-balance.desktop": "lbd",
                    "vnd.llamagraphics.life-balance.exchange+xml": "lbe",
                    "vnd.lotus-1-2-3": "123",
                    "vnd.lotus-approach": "apr",
                    "vnd.lotus-freelance": "pre",
                    "vnd.lotus-notes": "nsf",
                    "vnd.lotus-organizer": "org",
                    "vnd.lotus-screencam": "scm",
                    "vnd.lotus-wordpro": "lwp",
                    "vnd.macports.portpkg": "portpkg",
                    "vnd.mcd": "mcd",
                    "vnd.medcalcdata": "mc1",
                    "vnd.mediastation.cdkey": "cdkey",
                    "vnd.mfer": "mwf",
                    "vnd.mfmp": "mfm",
                    "vnd.micrografx.flo": "flo",
                    "vnd.micrografx.igx": "igx",
                    "vnd.mif": "mif",
                    "vnd.mobius.daf": "daf",
                    "vnd.mobius.dis": "dis",
                    "vnd.mobius.mbk": "mbk",
                    "vnd.mobius.mqy": "mqy",
                    "vnd.mobius.msl": "msl",
                    "vnd.mobius.plc": "plc",
                    "vnd.mobius.txf": "txf",
                    "vnd.mophun.application": "mpn",
                    "vnd.mophun.certificate": "mpc",
                    "vnd.ms-artgalry": "cil",
                    "vnd.ms-cab-compressed": "cab",
                    "vnd.ms-excel.addin.macroenabled.12": "xlam",
                    "vnd.ms-excel.sheet.binary.macroenabled.12": "xlsb",
                    "vnd.ms-excel.sheet.macroenabled.12": "xlsm",
                    "vnd.ms-excel.template.macroenabled.12": "xltm",
                    "vnd.ms-fontobject": "eot",
                    "vnd.ms-htmlhelp": "chm",
                    "vnd.ms-ims": "ims",
                    "vnd.ms-lrm": "lrm",
                    "vnd.ms-officetheme": "thmx",
                    "vnd.ms-powerpoint.addin.macroenabled.12": "ppam",
                    "vnd.ms-powerpoint.presentation.macroenabled.12": "pptm",
                    "vnd.ms-powerpoint.slide.macroenabled.12": "sldm",
                    "vnd.ms-powerpoint.slideshow.macroenabled.12": "ppsm",
                    "vnd.ms-powerpoint.template.macroenabled.12": "potm",
                    "vnd.ms-project": ["mpp", "mpt"],
                    "vnd.ms-word.document.macroenabled.12": "docm",
                    "vnd.ms-word.template.macroenabled.12": "dotm",
                    "vnd.ms-works": ["wps", "wks", "wcm", "wdb"],
                    "vnd.ms-wpl": "wpl",
                    "vnd.ms-xpsdocument": "xps",
                    "vnd.mseq": "mseq",
                    "vnd.musician": "mus",
                    "vnd.muvee.style": "msty",
                    "vnd.mynfc": "taglet",
                    "vnd.neurolanguage.nlu": "nlu",
                    "vnd.nitf": ["ntf", "nitf"],
                    "vnd.noblenet-directory": "nnd",
                    "vnd.noblenet-sealer": "nns",
                    "vnd.noblenet-web": "nnw",
                    "vnd.nokia.n-gage.data": "ngdat",
                    "vnd.nokia.n-gage.symbian.install": "n-gage",
                    "vnd.nokia.radio-preset": "rpst",
                    "vnd.nokia.radio-presets": "rpss",
                    "vnd.novadigm.edm": "edm",
                    "vnd.novadigm.edx": "edx",
                    "vnd.novadigm.ext": "ext",
                    "vnd.oasis.opendocument.chart-template": "otc",
                    "vnd.oasis.opendocument.formula-template": "odft",
                    "vnd.oasis.opendocument.image-template": "oti",
                    "vnd.olpc-sugar": "xo",
                    "vnd.oma.dd2+xml": "dd2",
                    "vnd.openofficeorg.extension": "oxt",
                    "vnd.openxmlformats-officedocument.presentationml.slide": "sldx",
                    "vnd.osgeo.mapguide.package": "mgp",
                    "vnd.osgi.dp": "dp",
                    "vnd.osgi.subsystem": "esa",
                    "vnd.palm": ["pdb", "pqa", "oprc"],
                    "vnd.pawaafile": "paw",
                    "vnd.pg.format": "str",
                    "vnd.pg.osasli": "ei6",
                    "vnd.picsel": "efif",
                    "vnd.pmi.widget": "wg",
                    "vnd.pocketlearn": "plf",
                    "vnd.powerbuilder6": "pbd",
                    "vnd.previewsystems.box": "box",
                    "vnd.proteus.magazine": "mgz",
                    "vnd.publishare-delta-tree": "qps",
                    "vnd.pvi.ptid1": "ptid",
                    "vnd.quark.quarkxpress": ["qxd", "qxt", "qwd", "qwt", "qxl", "qxb"],
                    "vnd.realvnc.bed": "bed",
                    "vnd.recordare.musicxml": "mxl",
                    "vnd.recordare.musicxml+xml": "musicxml",
                    "vnd.rig.cryptonote": "cryptonote",
                    "vnd.rn-realmedia": "rm",
                    "vnd.rn-realmedia-vbr": "rmvb",
                    "vnd.route66.link66+xml": "link66",
                    "vnd.sailingtracker.track": "st",
                    "vnd.seemail": "see",
                    "vnd.sema": "sema",
                    "vnd.semd": "semd",
                    "vnd.semf": "semf",
                    "vnd.shana.informed.formdata": "ifm",
                    "vnd.shana.informed.formtemplate": "itp",
                    "vnd.shana.informed.interchange": "iif",
                    "vnd.shana.informed.package": "ipk",
                    "vnd.simtech-mindmapper": ["twd", "twds"],
                    "vnd.smart.teacher": "teacher",
                    "vnd.solent.sdkm+xml": ["sdkm", "sdkd"],
                    "vnd.spotfire.dxp": "dxp",
                    "vnd.spotfire.sfs": "sfs",
                    "vnd.stepmania.package": "smzip",
                    "vnd.stepmania.stepchart": "sm",
                    "vnd.sus-calendar": ["sus", "susp"],
                    "vnd.svd": "svd",
                    "vnd.syncml+xml": "xsm",
                    "vnd.syncml.dm+wbxml": "bdm",
                    "vnd.syncml.dm+xml": "xdm",
                    "vnd.tao.intent-module-archive": "tao",
                    "vnd.tcpdump.pcap": ["pcap", "cap", "dmp"],
                    "vnd.tmobile-livetv": "tmo",
                    "vnd.trid.tpt": "tpt",
                    "vnd.triscape.mxs": "mxs",
                    "vnd.trueapp": "tra",
                    "vnd.ufdl": ["ufd", "ufdl"],
                    "vnd.uiq.theme": "utz",
                    "vnd.umajin": "umj",
                    "vnd.unity": "unityweb",
                    "vnd.uoml+xml": "uoml",
                    "vnd.vcx": "vcx",
                    "vnd.visionary": "vis",
                    "vnd.vsf": "vsf",
                    "vnd.webturbo": "wtb",
                    "vnd.wolfram.player": "nbp",
                    "vnd.wqd": "wqd",
                    "vnd.wt.stf": "stf",
                    "vnd.xara": "xar",
                    "vnd.xfdl": "xfdl",
                    "vnd.yamaha.hv-dic": "hvd",
                    "vnd.yamaha.hv-script": "hvs",
                    "vnd.yamaha.hv-voice": "hvp",
                    "vnd.yamaha.openscoreformat": "osf",
                    "vnd.yamaha.openscoreformat.osfpvg+xml": "osfpvg",
                    "vnd.yamaha.smaf-audio": "saf",
                    "vnd.yamaha.smaf-phrase": "spf",
                    "vnd.yellowriver-custom-menu": "cmp",
                    "vnd.zul": ["zir", "zirz"],
                    "vnd.zzazz.deck+xml": "zaz",
                    "voicexml+xml": "vxml",
                    widget: "wgt",
                    winhlp: "hlp",
                    "wsdl+xml": "wsdl",
                    "wspolicy+xml": "wspolicy",
                    "x-ace-compressed": "ace",
                    "x-authorware-bin": ["aab", "x32", "u32", "vox"],
                    "x-authorware-map": "aam",
                    "x-authorware-seg": "aas",
                    "x-blorb": ["blb", "blorb"],
                    "x-bzip": "bz",
                    "x-bzip2": ["bz2", "boz"],
                    "x-cfs-compressed": "cfs",
                    "x-chat": "chat",
                    "x-conference": "nsc",
                    "x-dgc-compressed": "dgc",
                    "x-dtbncx+xml": "ncx",
                    "x-dtbook+xml": "dtb",
                    "x-dtbresource+xml": "res",
                    "x-eva": "eva",
                    "x-font-bdf": "bdf",
                    "x-font-ghostscript": "gsf",
                    "x-font-linux-psf": "psf",
                    "x-font-otf": "otf",
                    "x-font-pcf": "pcf",
                    "x-font-snf": "snf",
                    "x-font-ttf": ["ttf", "ttc"],
                    "x-font-type1": ["pfa", "pfb", "pfm", "afm"],
                    "x-font-woff": "woff",
                    "x-freearc": "arc",
                    "x-gca-compressed": "gca",
                    "x-glulx": "ulx",
                    "x-gramps-xml": "gramps",
                    "x-install-instructions": "install",
                    "x-lzh-compressed": ["lzh", "lha"],
                    "x-mie": "mie",
                    "x-mobipocket-ebook": ["prc", "mobi"],
                    "x-ms-application": "application",
                    "x-ms-shortcut": "lnk",
                    "x-ms-xbap": "xbap",
                    "x-msbinder": "obd",
                    "x-mscardfile": "crd",
                    "x-msclip": "clp",
                    "x-msdownload": ["exe", "dll", "com", "bat", "msi"],
                    "x-msmediaview": ["mvb", "m13", "m14"],
                    "x-msmetafile": ["wmf", "wmz", "emf", "emz"],
                    "x-msmoney": "mny",
                    "x-mspublisher": "pub",
                    "x-msschedule": "scd",
                    "x-msterminal": "trm",
                    "x-mswrite": "wri",
                    "x-nzb": "nzb",
                    "x-pkcs12": ["p12", "pfx"],
                    "x-pkcs7-certificates": ["p7b", "spc"],
                    "x-research-info-systems": "ris",
                    "x-silverlight-app": "xap",
                    "x-sql": "sql",
                    "x-stuffitx": "sitx",
                    "x-subrip": "srt",
                    "x-t3vm-image": "t3",
                    "x-tads": "gam",
                    "x-tex": "tex",
                    "x-tex-tfm": "tfm",
                    "x-tgif": "obj",
                    "x-xliff+xml": "xlf",
                    "x-xz": "xz",
                    "x-zmachine": ["z1", "z2", "z3", "z4", "z5", "z6", "z7", "z8"],
                    "xaml+xml": "xaml",
                    "xcap-diff+xml": "xdf",
                    "xenc+xml": "xenc",
                    "xml-dtd": "dtd",
                    "xop+xml": "xop",
                    "xproc+xml": "xpl",
                    "xslt+xml": "xslt",
                    "xv+xml": ["mxml", "xhvml", "xvml", "xvm"],
                    yang: "yang",
                    "yin+xml": "yin",
                    envoy: "evy",
                    fractals: "fif",
                    "internet-property-stream": "acx",
                    olescript: "axs",
                    "vnd.ms-outlook": "msg",
                    "vnd.ms-pkicertstore": "sst",
                    "x-compress": "z",
                    "x-compressed": "tgz",
                    "x-gzip": "gz",
                    "x-perfmon": ["pma", "pmc", "pml", "pmr", "pmw"],
                    "x-pkcs7-mime": ["p7c", "p7m"],
                    "ynd.ms-pkipko": "pko",
                },
                audio: {
                    amr: "amr",
                    "amr-wb": "awb",
                    annodex: "axa",
                    basic: ["au", "snd"],
                    flac: "flac",
                    midi: ["mid", "midi", "kar", "rmi"],
                    mpeg: ["mpga", "mpega", "mp2", "mp3", "m4a", "mp2a", "m2a", "m3a"],
                    mpegurl: "m3u",
                    ogg: ["oga", "ogg", "spx"],
                    "prs.sid": "sid",
                    "x-aiff": ["aif", "aiff", "aifc"],
                    "x-gsm": "gsm",
                    "x-ms-wma": "wma",
                    "x-ms-wax": "wax",
                    "x-pn-realaudio": "ram",
                    "x-realaudio": "ra",
                    "x-sd2": "sd2",
                    "x-wav": "wav",
                    adpcm: "adp",
                    mp4: "mp4a",
                    s3m: "s3m",
                    silk: "sil",
                    "vnd.dece.audio": ["uva", "uvva"],
                    "vnd.digital-winds": "eol",
                    "vnd.dra": "dra",
                    "vnd.dts": "dts",
                    "vnd.dts.hd": "dtshd",
                    "vnd.lucent.voice": "lvp",
                    "vnd.ms-playready.media.pya": "pya",
                    "vnd.nuera.ecelp4800": "ecelp4800",
                    "vnd.nuera.ecelp7470": "ecelp7470",
                    "vnd.nuera.ecelp9600": "ecelp9600",
                    "vnd.rip": "rip",
                    webm: "weba",
                    "x-aac": "aac",
                    "x-caf": "caf",
                    "x-matroska": "mka",
                    "x-pn-realaudio-plugin": "rmp",
                    xm: "xm",
                    mid: ["mid", "rmi"],
                },
                chemical: {
                    "x-alchemy": "alc",
                    "x-cache": ["cac", "cache"],
                    "x-cache-csf": "csf",
                    "x-cactvs-binary": ["cbin", "cascii", "ctab"],
                    "x-cdx": "cdx",
                    "x-chem3d": "c3d",
                    "x-cif": "cif",
                    "x-cmdf": "cmdf",
                    "x-cml": "cml",
                    "x-compass": "cpa",
                    "x-crossfire": "bsd",
                    "x-csml": ["csml", "csm"],
                    "x-ctx": "ctx",
                    "x-cxf": ["cxf", "cef"],
                    "x-embl-dl-nucleotide": ["emb", "embl"],
                    "x-gamess-input": ["inp", "gam", "gamin"],
                    "x-gaussian-checkpoint": ["fch", "fchk"],
                    "x-gaussian-cube": "cub",
                    "x-gaussian-input": ["gau", "gjc", "gjf"],
                    "x-gaussian-log": "gal",
                    "x-gcg8-sequence": "gcg",
                    "x-genbank": "gen",
                    "x-hin": "hin",
                    "x-isostar": ["istr", "ist"],
                    "x-jcamp-dx": ["jdx", "dx"],
                    "x-kinemage": "kin",
                    "x-macmolecule": "mcm",
                    "x-macromodel-input": ["mmd", "mmod"],
                    "x-mdl-molfile": "mol",
                    "x-mdl-rdfile": "rd",
                    "x-mdl-rxnfile": "rxn",
                    "x-mdl-sdfile": ["sd", "sdf"],
                    "x-mdl-tgf": "tgf",
                    "x-mmcif": "mcif",
                    "x-mol2": "mol2",
                    "x-molconn-Z": "b",
                    "x-mopac-graph": "gpt",
                    "x-mopac-input": ["mop", "mopcrt", "mpc", "zmt"],
                    "x-mopac-out": "moo",
                    "x-ncbi-asn1": "asn",
                    "x-ncbi-asn1-ascii": ["prt", "ent"],
                    "x-ncbi-asn1-binary": ["val", "aso"],
                    "x-pdb": ["pdb", "ent"],
                    "x-rosdal": "ros",
                    "x-swissprot": "sw",
                    "x-vamas-iso14976": "vms",
                    "x-vmd": "vmd",
                    "x-xtel": "xtel",
                    "x-xyz": "xyz",
                },
                image: {
                    gif: "gif",
                    ief: "ief",
                    jpeg: ["jpeg", "jpg", "jpe"],
                    pcx: "pcx",
                    png: "png",
                    "svg+xml": ["svg", "svgz"],
                    tiff: ["tiff", "tif"],
                    "vnd.djvu": ["djvu", "djv"],
                    "vnd.wap.wbmp": "wbmp",
                    "x-canon-cr2": "cr2",
                    "x-canon-crw": "crw",
                    "x-cmu-raster": "ras",
                    "x-coreldraw": "cdr",
                    "x-coreldrawpattern": "pat",
                    "x-coreldrawtemplate": "cdt",
                    "x-corelphotopaint": "cpt",
                    "x-epson-erf": "erf",
                    "x-icon": "ico",
                    "x-jg": "art",
                    "x-jng": "jng",
                    "x-nikon-nef": "nef",
                    "x-olympus-orf": "orf",
                    "x-photoshop": "psd",
                    "x-portable-anymap": "pnm",
                    "x-portable-bitmap": "pbm",
                    "x-portable-graymap": "pgm",
                    "x-portable-pixmap": "ppm",
                    "x-rgb": "rgb",
                    "x-xbitmap": "xbm",
                    "x-xpixmap": "xpm",
                    "x-xwindowdump": "xwd",
                    bmp: "bmp",
                    cgm: "cgm",
                    g3fax: "g3",
                    ktx: "ktx",
                    "prs.btif": "btif",
                    sgi: "sgi",
                    "vnd.dece.graphic": ["uvi", "uvvi", "uvg", "uvvg"],
                    "vnd.dwg": "dwg",
                    "vnd.dxf": "dxf",
                    "vnd.fastbidsheet": "fbs",
                    "vnd.fpx": "fpx",
                    "vnd.fst": "fst",
                    "vnd.fujixerox.edmics-mmr": "mmr",
                    "vnd.fujixerox.edmics-rlc": "rlc",
                    "vnd.ms-modi": "mdi",
                    "vnd.ms-photo": "wdp",
                    "vnd.net-fpx": "npx",
                    "vnd.xiff": "xif",
                    webp: "webp",
                    "x-3ds": "3ds",
                    "x-cmx": "cmx",
                    "x-freehand": ["fh", "fhc", "fh4", "fh5", "fh7"],
                    "x-pict": ["pic", "pct"],
                    "x-tga": "tga",
                    "cis-cod": "cod",
                    pipeg: "jfif",
                },
                message: { rfc822: ["eml", "mime", "mht", "mhtml", "nws"] },
                model: {
                    iges: ["igs", "iges"],
                    mesh: ["msh", "mesh", "silo"],
                    vrml: ["wrl", "vrml"],
                    "x3d+vrml": ["x3dv", "x3dvz"],
                    "x3d+xml": ["x3d", "x3dz"],
                    "x3d+binary": ["x3db", "x3dbz"],
                    "vnd.collada+xml": "dae",
                    "vnd.dwf": "dwf",
                    "vnd.gdl": "gdl",
                    "vnd.gtw": "gtw",
                    "vnd.mts": "mts",
                    "vnd.vtu": "vtu",
                },
                text: {
                    "cache-manifest": ["manifest", "appcache"],
                    calendar: ["ics", "icz", "ifb"],
                    css: "css",
                    csv: "csv",
                    h323: "323",
                    html: ["html", "htm", "shtml", "stm"],
                    iuls: "uls",
                    mathml: "mml",
                    plain: ["txt", "text", "brf", "conf", "def", "list", "log", "in", "bas"],
                    richtext: "rtx",
                    scriptlet: ["sct", "wsc"],
                    texmacs: ["tm", "ts"],
                    "tab-separated-values": "tsv",
                    "vnd.sun.j2me.app-descriptor": "jad",
                    "vnd.wap.wml": "wml",
                    "vnd.wap.wmlscript": "wmls",
                    "x-bibtex": "bib",
                    "x-boo": "boo",
                    "x-c++hdr": ["h++", "hpp", "hxx", "hh"],
                    "x-c++src": ["c++", "cpp", "cxx", "cc"],
                    "x-component": "htc",
                    "x-dsrc": "d",
                    "x-diff": ["diff", "patch"],
                    "x-haskell": "hs",
                    "x-java": "java",
                    "x-literate-haskell": "lhs",
                    "x-moc": "moc",
                    "x-pascal": ["p", "pas"],
                    "x-pcs-gcd": "gcd",
                    "x-perl": ["pl", "pm"],
                    "x-python": "py",
                    "x-scala": "scala",
                    "x-setext": "etx",
                    "x-tcl": ["tcl", "tk"],
                    "x-tex": ["tex", "ltx", "sty", "cls"],
                    "x-vcalendar": "vcs",
                    "x-vcard": "vcf",
                    n3: "n3",
                    "prs.lines.tag": "dsc",
                    sgml: ["sgml", "sgm"],
                    troff: ["t", "tr", "roff", "man", "me", "ms"],
                    turtle: "ttl",
                    "uri-list": ["uri", "uris", "urls"],
                    vcard: "vcard",
                    "vnd.curl": "curl",
                    "vnd.curl.dcurl": "dcurl",
                    "vnd.curl.scurl": "scurl",
                    "vnd.curl.mcurl": "mcurl",
                    "vnd.dvb.subtitle": "sub",
                    "vnd.fly": "fly",
                    "vnd.fmi.flexstor": "flx",
                    "vnd.graphviz": "gv",
                    "vnd.in3d.3dml": "3dml",
                    "vnd.in3d.spot": "spot",
                    "x-asm": ["s", "asm"],
                    "x-c": ["c", "cc", "cxx", "cpp", "h", "hh", "dic"],
                    "x-fortran": ["f", "for", "f77", "f90"],
                    "x-opml": "opml",
                    "x-nfo": "nfo",
                    "x-sfv": "sfv",
                    "x-uuencode": "uu",
                    webviewhtml: "htt",
                },
                video: {
                    "3gpp": "3gp",
                    annodex: "axv",
                    dl: "dl",
                    dv: ["dif", "dv"],
                    fli: "fli",
                    gl: "gl",
                    mpeg: ["mpeg", "mpg", "mpe", "m1v", "m2v", "mp2", "mpa", "mpv2"],
                    mp4: ["mp4", "mp4v", "mpg4"],
                    quicktime: ["qt", "mov"],
                    ogg: "ogv",
                    "vnd.mpegurl": ["mxu", "m4u"],
                    "x-flv": "flv",
                    "x-la-asf": ["lsf", "lsx"],
                    "x-mng": "mng",
                    "x-ms-asf": ["asf", "asx", "asr"],
                    "x-ms-wm": "wm",
                    "x-ms-wmv": "wmv",
                    "x-ms-wmx": "wmx",
                    "x-ms-wvx": "wvx",
                    "x-msvideo": "avi",
                    "x-sgi-movie": "movie",
                    "x-matroska": ["mpv", "mkv", "mk3d", "mks"],
                    "3gpp2": "3g2",
                    h261: "h261",
                    h263: "h263",
                    h264: "h264",
                    jpeg: "jpgv",
                    jpm: ["jpm", "jpgm"],
                    mj2: ["mj2", "mjp2"],
                    "vnd.dece.hd": ["uvh", "uvvh"],
                    "vnd.dece.mobile": ["uvm", "uvvm"],
                    "vnd.dece.pd": ["uvp", "uvvp"],
                    "vnd.dece.sd": ["uvs", "uvvs"],
                    "vnd.dece.video": ["uvv", "uvvv"],
                    "vnd.dvb.file": "dvb",
                    "vnd.fvt": "fvt",
                    "vnd.ms-playready.media.pyv": "pyv",
                    "vnd.uvvu.mp4": ["uvu", "uvvu"],
                    "vnd.vivo": "viv",
                    webm: "webm",
                    "x-f4v": "f4v",
                    "x-m4v": "m4v",
                    "x-ms-vob": "vob",
                    "x-smv": "smv",
                },
                "x-conference": { "x-cooltalk": "ice" },
                "x-world": { "x-vrml": ["vrm", "vrml", "wrl", "flr", "wrz", "xaf", "xof"] },
            },
            t = (function () {
                var t,
                    n,
                    r,
                    i,
                    o = {};
                for (t in e)
                    if (e.hasOwnProperty(t))
                        for (n in e[t])
                            if (e[t].hasOwnProperty(n))
                                if (((r = e[t][n]), "string" == typeof r)) o[r] = t + "/" + n;
                                else for (i = 0; i < r.length; i++) o[r[i]] = t + "/" + n;
                return o;
            })();
        zip.getMimeType = function (e) {
            var n = "application/octet-stream";
            return (e && t[e.split(".").pop().toLowerCase()]) || n;
        };
    })(),
    define("mime-types", ["zip"], (function (e) {
        return function () {
            var t;
            return t || e.zip;
        };
    })(this)),
    (function () {
        "use strict";
        function e(e) {
            function t(t) {
                (o.size = e.uncompressedSize), t();
            }
            function n(t) {
                o.data
                    ? t()
                    : e.getData(
                          new m(),
                          function (e) {
                              (o.data = e), (i = new _(e)), t();
                          },
                          null,
                          o.checkCrc32
                      );
            }
            function r(e, t, r, o) {
                n(function () {
                    i.readUint8Array(e, t, r, o);
                }, o);
            }
            var i,
                o = this;
            (o.size = 0), (o.init = t), (o.readUint8Array = r);
        }
        function t(e) {
            function t(e) {
                (n += e.uncompressedSize || 0), e.children.forEach(t);
            }
            var n = 0;
            return t(e), n;
        }
        function n(e, t, r) {
            function i() {
                a++, a < e.children.length ? o(e.children[a]) : t();
            }
            function o(e) {
                e.directory
                    ? n(e, i, r)
                    : ((e.reader = new e.Reader(e.data, r)),
                      e.reader.init(function () {
                          (e.uncompressedSize = e.reader.size), i();
                      }));
            }
            var a = 0;
            e.children.length ? o(e.children[a]) : t();
        }
        function r(e) {
            var t = e.parent.children;
            t.forEach(function (n, r) {
                n.id == e.id && t.splice(r, 1);
            });
        }
        function i(e, t, n, r, i) {
            function o(e, t, n, r, i) {
                function s() {
                    var c = t.children[l];
                    c
                        ? e.add(
                              c.getFullname(),
                              c.reader,
                              function () {
                                  (a += c.uncompressedSize || 0),
                                      o(
                                          e,
                                          c,
                                          function () {
                                              l++, s();
                                          },
                                          r,
                                          i
                                      );
                              },
                              function (e) {
                                  r && r(a + e, i);
                              },
                              { directory: c.directory, version: c.zipVersion }
                          )
                        : n();
                }
                var l = 0;
                s();
            }
            var a = 0;
            o(e, t, n, r, i);
        }
        function o(e, t, n, r) {
            function i(e, t) {
                e.isDirectory && e.createReader().readEntries(t), e.isFile && t([]);
            }
            function o(e, t, n) {
                i(t, function (t) {
                    function i(t) {
                        function n(e) {
                            o(e, t, function () {
                                s++, a();
                            });
                        }
                        t.isDirectory && n(e.addDirectory(t.name)),
                            t.isFile &&
                                t.file(function (r) {
                                    var i = e.addBlob(t.name, r);
                                    (i.uncompressedSize = r.size), n(i);
                                }, r);
                    }
                    function a() {
                        var e = t[s];
                        e ? i(e) : n();
                    }
                    var s = 0;
                    a();
                });
            }
            t.isDirectory
                ? o(e, t, n)
                : t.file(function (r) {
                      e.addBlob(t.name, r), n();
                  }, r);
        }
        function a(e, t, n, r, i, o, a) {
            function s(e, t, n, r, i, o) {
                function c(t) {
                    function n(e) {
                        (l += t.uncompressedSize || 0),
                            s(
                                e,
                                t,
                                function () {
                                    d++, u();
                                },
                                r,
                                i,
                                o
                            );
                    }
                    t.directory
                        ? e.getDirectory(t.name, { create: !0 }, n, i)
                        : e.getFile(
                              t.name,
                              { create: !0 },
                              function (e) {
                                  t.getData(
                                      new zip.FileWriter(e, zip.getMimeType(t.name)),
                                      n,
                                      function (e) {
                                          r && r(l + e, o);
                                      },
                                      a
                                  );
                              },
                              i
                          );
                }
                function u() {
                    var e = t.children[d];
                    e ? c(e) : n();
                }
                var d = 0;
                u();
            }
            var l = 0;
            t.directory ? s(e, t, n, r, i, o) : t.getData(new zip.FileWriter(e, zip.getMimeType(t.name)), n, r, a);
        }
        function s(e) {
            (e.entries = []), (e.root = new f(e));
        }
        function l(e, t, n, r, i) {
            function o() {
                var s = a * p;
                r && r(s, e.size),
                    s < e.size
                        ? e.readUint8Array(
                              s,
                              Math.min(p, e.size - s),
                              function (e) {
                                  t.writeUint8Array(new Uint8Array(e), function () {
                                      a++, o();
                                  });
                              },
                              i
                          )
                        : t.getData(n);
            }
            var a = 0;
            o();
        }
        function c(e, t, n, r) {
            if (e.directory) return r ? new f(e.fs, t, n, e) : new d(e.fs, t, n, e);
            throw "Parent entry is not a directory.";
        }
        function u() {}
        function d(e, t, n, r) {
            var i = this;
            u.prototype.init.call(i, e, t, n, r), (i.Reader = n.Reader), (i.Writer = n.Writer), (i.data = n.data), n.getData && (i.getData = n.getData);
        }
        function f(e, t, n, r) {
            var i = this;
            u.prototype.init.call(i, e, t, n, r), (i.directory = !0);
        }
        function h() {
            s(this);
        }
        var p = 524288,
            g = zip.TextWriter,
            m = zip.BlobWriter,
            v = zip.Data64URIWriter,
            b = zip.Reader,
            y = zip.TextReader,
            _ = zip.BlobReader,
            w = zip.Data64URIReader,
            x = zip.createReader,
            E = zip.createWriter;
        (e.prototype = new b()),
            (e.prototype.constructor = e),
            (e.prototype.checkCrc32 = !1),
            (u.prototype = {
                init: function (e, t, n, r) {
                    var i = this;
                    if (e.root && r && r.getChildByName(t)) throw "Entry filename already exists.";
                    n || (n = {}), (i.fs = e), (i.name = t), (i.id = e.entries.length), (i.parent = r), (i.children = []), (i.zipVersion = n.zipVersion || 20), (i.uncompressedSize = 0), e.entries.push(i), r && i.parent.children.push(i);
                },
                getFileEntry: function (e, r, i, o, s) {
                    var l = this;
                    n(
                        l,
                        function () {
                            a(e, l, r, i, o, t(l), s);
                        },
                        o
                    );
                },
                moveTo: function (e) {
                    var t = this;
                    if (!e.directory) throw "Target entry is not a directory.";
                    if (e.isDescendantOf(t)) throw "Entry is a ancestor of target entry.";
                    if (t != e) {
                        if (e.getChildByName(t.name)) throw "Entry filename already exists.";
                        r(t), (t.parent = e), e.children.push(t);
                    }
                },
                getFullname: function () {
                    for (var e = this, t = e.name, n = e.parent; n; ) (t = (n.name ? n.name + "/" : "") + t), (n = n.parent);
                    return t;
                },
                isDescendantOf: function (e) {
                    for (var t = this.parent; t && t.id != e.id; ) t = t.parent;
                    return !!t;
                },
            }),
            (u.prototype.constructor = u);
        var C;
        (d.prototype = C = new u()),
            (C.constructor = d),
            (C.getData = function (e, t, n, r) {
                var i = this;
                !e || (e.constructor == i.Writer && i.data)
                    ? t(i.data)
                    : (i.reader || (i.reader = new i.Reader(i.data, r)),
                      i.reader.init(function () {
                          e.init(function () {
                              l(i.reader, e, t, n, r);
                          }, r);
                      }));
            }),
            (C.getText = function (e, t, n, r) {
                this.getData(new g(r), e, t, n);
            }),
            (C.getBlob = function (e, t, n, r) {
                this.getData(new m(e), t, n, r);
            }),
            (C.getData64URI = function (e, t, n, r) {
                this.getData(new v(e), t, n, r);
            });
        var T;
        (f.prototype = T = new u()),
            (T.constructor = f),
            (T.addDirectory = function (e) {
                return c(this, e, null, !0);
            }),
            (T.addText = function (e, t) {
                return c(this, e, { data: t, Reader: y, Writer: g });
            }),
            (T.addBlob = function (e, t) {
                return c(this, e, { data: t, Reader: _, Writer: m });
            }),
            (T.addData64URI = function (e, t) {
                return c(this, e, { data: t, Reader: w, Writer: v });
            }),
            (T.addFileEntry = function (e, t, n) {
                o(this, e, t, n);
            }),
            (T.addData = function (e, t) {
                return c(this, e, t);
            }),
            (T.importBlob = function (e, t, n) {
                this.importZip(new _(e), t, n);
            }),
            (T.importText = function (e, t, n) {
                this.importZip(new y(e), t, n);
            }),
            (T.importData64URI = function (e, t, n) {
                this.importZip(new w(e), t, n);
            }),
            (T.exportBlob = function (e, t, n) {
                this.exportZip(new m("application/zip"), e, t, n);
            }),
            (T.exportText = function (e, t, n) {
                this.exportZip(new g(), e, t, n);
            }),
            (T.exportFileEntry = function (e, t, n, r) {
                this.exportZip(new zip.FileWriter(e, "application/zip"), t, n, r);
            }),
            (T.exportData64URI = function (e, t, n) {
                this.exportZip(new v("application/zip"), e, t, n);
            }),
            (T.importZip = function (t, n, r) {
                var i = this;
                x(
                    t,
                    function (t) {
                        t.getEntries(function (t) {
                            t.forEach(function (t) {
                                var n = i,
                                    r = t.filename.split("/"),
                                    o = r.pop();
                                r.forEach(function (e) {
                                    n = n.getChildByName(e) || new f(i.fs, e, null, n);
                                }),
                                    t.directory || c(n, o, { data: t, Reader: e });
                            }),
                                n();
                        });
                    },
                    r
                );
            }),
            (T.exportZip = function (e, r, o, a) {
                var s = this;
                n(
                    s,
                    function () {
                        E(
                            e,
                            function (e) {
                                i(
                                    e,
                                    s,
                                    function () {
                                        e.close(r);
                                    },
                                    o,
                                    t(s)
                                );
                            },
                            a
                        );
                    },
                    a
                );
            }),
            (T.getChildByName = function (e) {
                var t,
                    n,
                    r = this;
                for (t = 0; t < r.children.length; t++) if (((n = r.children[t]), n.name == e)) return n;
            }),
            (h.prototype = {
                remove: function (e) {
                    r(e), (this.entries[e.id] = null);
                },
                find: function (e) {
                    var t,
                        n = e.split("/"),
                        r = this.root;
                    for (t = 0; r && t < n.length; t++) r = r.getChildByName(n[t]);
                    return r;
                },
                getById: function (e) {
                    return this.entries[e];
                },
                importBlob: function (e, t, n) {
                    s(this), this.root.importBlob(e, t, n);
                },
                importText: function (e, t, n) {
                    s(this), this.root.importText(e, t, n);
                },
                importData64URI: function (e, t, n) {
                    s(this), this.root.importData64URI(e, t, n);
                },
                exportBlob: function (e, t, n) {
                    this.root.exportBlob(e, t, n);
                },
                exportText: function (e, t, n) {
                    this.root.exportText(e, t, n);
                },
                exportFileEntry: function (e, t, n, r) {
                    this.root.exportFileEntry(e, t, n, r);
                },
                exportData64URI: function (e, t, n) {
                    this.root.exportData64URI(e, t, n);
                },
            }),
            (zip.fs = { FS: h, ZipDirectoryEntry: f, ZipFileEntry: d }),
            (zip.getMimeType = function () {
                return "application/octet-stream";
            });
    })(),
    define("zip-fs", ["mime-types"], (function (e) {
        return function () {
            var t;
            return t || e.zip;
        };
    })(this)),
    (function () {
        "use strict";
        function e(e) {
            function t(t, n) {
                var r;
                i.data
                    ? t()
                    : ((r = new XMLHttpRequest()),
                      r.addEventListener(
                          "load",
                          function () {
                              i.size || (i.size = Number(r.getResponseHeader("Content-Length"))), (i.data = new Uint8Array(r.response)), t();
                          },
                          !1
                      ),
                      r.addEventListener("error", n, !1),
                      r.open("GET", e),
                      (r.responseType = "arraybuffer"),
                      r.send());
            }
            function n(t, n) {
                var r = new XMLHttpRequest();
                r.addEventListener(
                    "load",
                    function () {
                        (i.size = Number(r.getResponseHeader("Content-Length"))), t();
                    },
                    !1
                ),
                    r.addEventListener("error", n, !1),
                    r.open("HEAD", e),
                    r.send();
            }
            function r(e, n, r, o) {
                t(function () {
                    r(new Uint8Array(i.data.subarray(e, e + n)));
                }, o);
            }
            var i = this;
            (i.size = 0), (i.init = n), (i.readUint8Array = r);
        }
        function t(e) {
            function t(t, n) {
                var r = new XMLHttpRequest();
                r.addEventListener(
                    "load",
                    function () {
                        (i.size = Number(r.getResponseHeader("Content-Length"))), t();
                    },
                    !1
                ),
                    r.addEventListener("error", n, !1),
                    r.open("HEAD", e),
                    r.send();
            }
            function n(t, n, r, i) {
                var o = new XMLHttpRequest();
                o.open("GET", e),
                    (o.responseType = "arraybuffer"),
                    o.setRequestHeader("Range", "bytes=" + t + "-" + (t + n - 1)),
                    o.addEventListener(
                        "load",
                        function () {
                            r(o.response);
                        },
                        !1
                    ),
                    o.addEventListener("error", i, !1),
                    o.send();
            }
            function r(e, t, r, i) {
                n(
                    e,
                    t,
                    function (e) {
                        r(new Uint8Array(e));
                    },
                    i
                );
            }
            var i = this;
            (i.size = 0), (i.init = t), (i.readUint8Array = r);
        }
        function n(e) {
            function t(t, n) {
                (r.size = e.byteLength), t();
            }
            function n(t, n, r, i) {
                r(new Uint8Array(e.slice(t, t + n)));
            }
            var r = this;
            (r.size = 0), (r.init = t), (r.readUint8Array = n);
        }
        function r() {
            function e(e, t) {
                (r = new Uint8Array()), e();
            }
            function t(e, t, n) {
                var i = new Uint8Array(r.length + e.length);
                i.set(r), i.set(e, r.length), (r = i), t();
            }
            function n(e) {
                e(r.buffer);
            }
            var r,
                i = this;
            (i.init = e), (i.writeUint8Array = t), (i.getData = n);
        }
        function i(e, t) {
            function n(t, n) {
                e.createWriter(function (e) {
                    (o = e), t();
                }, n);
            }
            function r(e, n, r) {
                var i = new Blob([a ? e : e.buffer], { type: t });
                (o.onwrite = function () {
                    (o.onwrite = null), n();
                }),
                    (o.onerror = r),
                    o.write(i);
            }
            function i(t) {
                e.file(t);
            }
            var o,
                s = this;
            (s.init = n), (s.writeUint8Array = r), (s.getData = i);
        }
        var o,
            a,
            s = zip.Reader,
            l = zip.Writer;
        try {
            a = 0 === new Blob([new DataView(new ArrayBuffer(0))]).size;
        } catch (e) {}
        (e.prototype = new s()),
            (e.prototype.constructor = e),
            (t.prototype = new s()),
            (t.prototype.constructor = t),
            (n.prototype = new s()),
            (n.prototype.constructor = n),
            (r.prototype = new l()),
            (r.prototype.constructor = r),
            (i.prototype = new l()),
            (i.prototype.constructor = i),
            (zip.FileWriter = i),
            (zip.HttpReader = e),
            (zip.HttpRangeReader = t),
            (zip.ArrayBufferReader = n),
            (zip.ArrayBufferWriter = r),
            zip.fs &&
                ((o = zip.fs.ZipDirectoryEntry),
                (o.prototype.addHttpContent = function (n, r, i) {
                    function a(e, t, n, r) {
                        if (e.directory) return r ? new o(e.fs, t, n, e) : new zip.fs.ZipFileEntry(e.fs, t, n, e);
                        throw "Parent entry is not a directory.";
                    }
                    return a(this, n, { data: r, Reader: i ? t : e });
                }),
                (o.prototype.importHttpContent = function (n, r, i, o) {
                    this.importZip(r ? new t(n) : new e(n), i, o);
                }),
                (zip.fs.FS.prototype.importHttpContent = function (e, t, n, r) {
                    (this.entries = []), (this.root = new o(this)), this.root.importHttpContent(e, t, n, r);
                }));
    })(),
    define("zip-ext", ["zip-fs"], (function (e) {
        return function () {
            var t;
            return t || e.zip;
        };
    })(this)),
    define("readium_js/epub-fetch/zip_resource_fetcher", ["jquery", "URIjs", "./discover_content_type", "zip-ext", "readium_shared_js/helpers"], function (e, t, n, r, i) {
        var o = function (e, i) {
            function o(e, t) {
                s
                    ? e(s, t)
                    : (i ? ((r.useWebWorkers = !0), (r.workerScriptsPath = i)) : (r.useWebWorkers = !1),
                      (s = new r.fs.FS()),
                      l instanceof Blob || l instanceof File
                          ? s.importBlob(
                                l,
                                function () {
                                    e(s, t);
                                },
                                function () {
                                    console.error("ZIP ERROR"), t.apply(this, arguments);
                                }
                            )
                          : s.importHttpContent(
                                l,
                                !0,
                                function () {
                                    e(s, t);
                                },
                                function () {
                                    console.error("ZIP ERROR"), t.apply(this, arguments);
                                }
                            ));
            }
            function a(e, t, n) {
                if ("undefined" == typeof e) throw "Fetched file relative path is undefined!";
                o(
                    function (n, r) {
                        var i = n.find(e);
                        "undefined" == typeof i || null === i ? r(new Error(d + "Entry " + e + " not found in zip " + c)) : i.directory ? r(new Error(d + "Entry " + e + " is a directory while a file has been expected")) : t(i);
                    },
                    function () {
                        var r = arguments ? (arguments.length && arguments[0] instanceof Error ? arguments[0] : arguments instanceof Error ? arguments : void 0) : void 0,
                            i = !!r && 0 == r.message.indexOf(d);
                        if (i || l instanceof Blob || l instanceof File) n.apply(this, arguments);
                        else {
                            console.log("Zip lib failed to load zipped EPUB via HTTP, trying alternative HTTP fetch... (" + l + ")");
                            var o = new XMLHttpRequest();
                            (o.onreadystatechange = function () {
                                if (4 == this.readyState) {
                                    var r = (o.status >= 200 && o.status < 300) || 304 === o.status;
                                    return r ? ((l = this.response), (s = void 0), void (l instanceof Blob || l instanceof File ? a(e, t, n) : n(new Error("XMLHttpRequest response not Blob!?")))) : void n(o.statusText);
                                }
                            }),
                                o.open("GET", l, !0),
                                (o.responseType = "blob"),
                                o.send(null);
                        }
                    }
                );
            }
            var s,
                l = e.getEbookURL(),
                c = e.getEbookURL_FilePath(),
                u = !1,
                d = "READIUM -- ";
            (this.resolveURI = function (e) {
                var n = void 0;
                try {
                    n = new t(e);
                } catch (t) {
                    console.error(t), console.log(e);
                }
                if (n && n.is("absolute")) return e;
                var r = c;
                try {
                    r = new t(r).search("").hash("").toString();
                } catch (e) {
                    console.error(e), console.log(r);
                }
                return r + ("/" == r.charAt(r.length - 1) ? "" : "/") + e;
            }),
                (this.fetchFileContentsText = function (e, t, n) {
                    a(
                        e,
                        function (e) {
                            e.getText(t, void 0, u);
                        },
                        n
                    );
                }),
                (this.fetchFileContentsData64Uri = function (e, t, r) {
                    a(
                        e,
                        function (r) {
                            r.getData64URI(n.identifyContentTypeFromFileName(e), t, void 0, u);
                        },
                        r
                    );
                }),
                (this.fetchFileContentsBlob = function (t, r, i) {
                    var o = e.getDecryptionFunctionForRelativePath(t);
                    if (o) {
                        var s = r;
                        r = function (e) {
                            o(e, function (e) {
                                s(e);
                            });
                        };
                    }
                    a(
                        t,
                        function (e) {
                            e.getBlob(n.identifyContentTypeFromFileName(t), r, void 0, u);
                        },
                        i
                    );
                });
        };
        return o;
    }),
    define("readium_js/epub-fetch/content_document_fetcher", ["jquery", "underscore", "URIjs", "./discover_content_type"], function (e, t, n, r) {
        var i = function (i, o, a, s, l) {
            function c(e, t) {
                var n = e.getElementsByTagName("base")[0];
                if (!n) {
                    n = e.createElement("base");
                    var r = e.getElementsByTagName("head")[0];
                    r && r.insertBefore(n, r.childNodes[0]);
                }
                n.setAttribute("href", t);
            }
            function u(t, i, o, a, s, l, c) {
                function u(n) {
                    e(t).attr("data-epubZipOrigHref", i), e(t).attr(o, n);
                }
                var d = new n(i);
                if ("" !== d.scheme()) return void console.log("HTTP / absolute scheme res: " + i);
                if (0 == i.indexOf("/")) {
                    console.log("Absolute path res: " + i);
                    var f = window.location ? window.location.protocol + "//" + window.location.hostname + (window.location.port ? ":" + window.location.port : "") : "";
                    return void u(f + i);
                }
                var h = C.convertPathRelativeToPackageToRelativeToBase(E),
                    p = "/" + new n(i).absoluteTo(h).toString(),
                    g = S.getResourceURL(p);
                if (g) u(g);
                else {
                    var m = e.Deferred();
                    s.push(m),
                        C.relativeToPackageFetchFileContents(
                            p,
                            a,
                            function (n) {
                                var i = function (n) {
                                    if ("text" === a) {
                                        var i = r.identifyContentTypeFromFileName(p),
                                            o = e(t).attr("type");
                                        o && (i = o), (n = new Blob([n], { type: i }));
                                    }
                                    var s = window.URL.createObjectURL(n);
                                    S.putResource(p, s, n), u(s), m.resolve();
                                };
                                c ? c(n, p, i) : i(n);
                            },
                            function () {
                                m.resolve(), l.apply(this, arguments);
                            }
                        );
                }
            }
            function d(r, i, o, a, s) {
                var l = r[0],
                    c = r.slice(2),
                    u = t.find(c, function (e) {
                        return "undefined" != typeof e;
                    }),
                    d = new n(u),
                    h = "" === d.scheme();
                if (h) {
                    var p = C.convertPathRelativeToPackageToRelativeToBase(o);
                    "/" === p.charAt(0) && (p = p.substr(1));
                    var g = "/" + new n(u).absoluteTo(p).toString(),
                        m = S.getResourceURL(g);
                    if (m) a[l] = { isStyleSheetResource: s, resourceObjectURL: m };
                    else {
                        var v = e.Deferred();
                        i.push(v);
                        var b,
                            y,
                            _ = function (e) {
                                var t = window.URL.createObjectURL(e);
                                (a[l] = { isStyleSheetResource: s, resourceObjectURL: t }), S.putResource(g, t, e), v.resolve();
                            },
                            w = function (e) {
                                v.resolve();
                            };
                        s
                            ? ((b = "text"),
                              (y = function (e) {
                                  f(e, g, function (e) {
                                      var t = new Blob([e], { type: "text/css" });
                                      _(t);
                                  });
                              }))
                            : ((b = "blob"), (y = _)),
                            C.relativeToPackageFetchFileContents(g, b, y, w);
                    }
                }
            }
            function f(t, n, r) {
                var i = /[Uu][Rr][Ll]\(\s*([']([^']+)[']|["]([^"]+)["]|([^)]+))\s*\)/g,
                    o = /@[Ii][Mm][Pp][Oo][Rr][Tt]\s*('([^']+)'|"([^"]+)")/g,
                    a = {},
                    s = [];
                [o, i].forEach(function (e) {
                    for (var r = e.exec(t); null != r; ) {
                        var i = !1;
                        e == o && (i = !0), d(r, s, n, a, i), (r = e.exec(t));
                    }
                }),
                    s.length > 0
                        ? e.when.apply(e, s).done(function () {
                              for (var e in a) {
                                  var n,
                                      i = a[e];
                                  n = i.isStyleSheetResource ? '@import "' + i.resourceObjectURL + '"' : "url('" + i.resourceObjectURL + "')";
                                  var o = e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&"),
                                      s = new RegExp(o, "g");
                                  t = t.replace(s, n, "g");
                              }
                              r(t);
                          })
                        : r(t);
            }
            function h(t, n, r, i, o, a) {
                var s = e(t + "[" + n.replace(":", "\\:") + "]", w);
                s.each(function (t, s) {
                    var l = e(s).attr(n);
                    u(s, l, n, r, i, o, a);
                });
            }
            function p(e, t) {
                h("img", "src", "blob", e, t), h("image", "xlink:href", "blob", e, t);
            }
            function g(e, t) {
                h("audio", "src", "blob", e, t);
            }
            function m(e, t) {
                h("video", "src", "blob", e, t), h("video", "poster", "blob", e, t);
            }
            function v(e, t) {
                h("script", "src", "blob", e, t);
            }
            function b(e, t) {
                h("link", "href", "text", e, t, f);
            }
            function y(t, n) {
                var r = e("style", w);
                r.each(function (n, r) {
                    var i = e.Deferred();
                    t.push(i);
                    var o = e(r).text();
                    f(o, E, function (t) {
                        e(r).text(t), i.resolve();
                    });
                });
            }
            var _,
                w,
                x = this,
                E = o.href,
                C = i,
                T = o.media_type,
                S = s,
                R = l;
            (this.fetchContentDocumentAndResolveDom = function (e, t) {
                C.relativeToPackageFetchFileContents(
                    E,
                    "text",
                    function (n) {
                        (_ = n), R && (_ = R(a, _)), x.resolveInternalPackageResources(e, t);
                    },
                    t
                );
            }),
                (this.resolveInternalPackageResources = function (t, n) {
                    (w = C.markupParser.parseMarkup(_, T)), c(w, a);
                    var r = [];
                    C.shouldFetchMediaAssetsProgrammatically() && (console.log("fetchMediaAssetsProgrammatically ..."), p(r, n), g(r, n), m(r, n), h("source", "src", "blob", r, n), h("object", "data", "blob", r, n)),
                        v(r, n),
                        b(r, n),
                        y(r, n),
                        e.when.apply(e, r).done(function () {
                            console.log("DOM BLOB URi DONE: " + a), t(w);
                        });
                });
        };
        return i;
    }),
    define("readium_js/epub-fetch/resource_cache", ["underscore"], function (e) {
        var t = function (t, n) {
            function r() {
                return new Date().getTime();
            }
            function i() {
                return window.performance && window.performance.memory && window.performance.memory.jsHeapSizeLimit ? window.performance.memory.jsHeapSizeLimit : null;
            }
            function o() {
                if (n) return n;
                var e = i();
                return e && e / 10 > d ? e / 10 : d;
            }
            function a(e) {
                if ("undefined" != typeof e.orderingByLastUseTimestampIdx) {
                    var t = e.orderingByLastUseTimestampIdx;
                    c.splice(t, 1);
                    for (var n = t; n < c.length; n++) {
                        var r = c[n];
                        r.orderingByLastUseTimestampIdx - 1 != n && console.error("algorithm incorrect: downshiftedEntry.orderingByLastUseTimestampIdx: " + r.orderingByLastUseTimestampIdx + ", i: " + n + " -- " + e.absoluteHref),
                            (r.orderingByLastUseTimestampIdx = n);
                    }
                }
            }
            function s(t) {
                a(t);
                var n = e.sortedIndex(c, t, "lastUseTimestamp");
                c.splice(n, 0, t), (t.orderingByLastUseTimestampIdx = n);
            }
            var l = {},
                c = [],
                u = 0,
                d = 1e8,
                f = o();
            (this.getResourceURL = function (e) {
                var t = null,
                    n = l[e];
                return n && ((t = n.url), (n.lastUseTimestamp = r()), s(n)), t;
            }),
                (this.putResource = function (e, t, n) {
                    this.trimCache();
                    var i = r(),
                        o = { url: t, absoluteHref: e, blob: n, blobSize: n.size, creationTimestamp: i, lastUseTimestamp: i, pinned: !0 };
                    (l[e] = o), s(o), (u += n.size);
                }),
                (this.evictResource = function (e) {
                    var n = l[e];
                    n && (t.URL.revokeObjectURL(n.url), (u -= n.blobSize), a(n), delete l[e]);
                }),
                (this.flushCache = function () {
                    for (var e in l) this.evictResource(e);
                    0 != u && (console.error("cacheSize accounting error! cacheSize: " + u + ", _resourcesHash:"), console.error(l)), (c = []);
                }),
                (this.unPinResources = function () {
                    for (var e in l) {
                        var t = l[e];
                        t.pinned = !1;
                    }
                }),
                (this.trimCache = function () {
                    if (!(u < f)) {
                        console.log("Trimming cache. Current cache size: " + u);
                        for (var e = 0; e < c.length && !(u < f); e++) {
                            var t = c[e];
                            if (!t.pinned) {
                                var n = t.absoluteHref;
                                this.evictResource(n), e--;
                            }
                        }
                        console.log("Cache size after trimming: " + u);
                    }
                });
        };
        return t;
    }),
    (function (e, t) {
        "object" == typeof exports ? (module.exports = exports = t()) : "function" == typeof define && define.amd ? define("cryptoJs/core", [], t) : (e.CryptoJS = t());
    })(this, function () {
        var e =
            e ||
            (function (e, t) {
                var n =
                        Object.create ||
                        (function () {
                            function e() {}
                            return function (t) {
                                var n;
                                return (e.prototype = t), (n = new e()), (e.prototype = null), n;
                            };
                        })(),
                    r = {},
                    i = (r.lib = {}),
                    o = (i.Base = (function () {
                        return {
                            extend: function (e) {
                                var t = n(this);
                                return (
                                    e && t.mixIn(e),
                                    (t.hasOwnProperty("init") && this.init !== t.init) ||
                                        (t.init = function () {
                                            t.$super.init.apply(this, arguments);
                                        }),
                                    (t.init.prototype = t),
                                    (t.$super = this),
                                    t
                                );
                            },
                            create: function () {
                                var e = this.extend();
                                return e.init.apply(e, arguments), e;
                            },
                            init: function () {},
                            mixIn: function (e) {
                                for (var t in e) e.hasOwnProperty(t) && (this[t] = e[t]);
                                e.hasOwnProperty("toString") && (this.toString = e.toString);
                            },
                            clone: function () {
                                return this.init.prototype.extend(this);
                            },
                        };
                    })()),
                    a = (i.WordArray = o.extend({
                        init: function (e, n) {
                            (e = this.words = e || []), n != t ? (this.sigBytes = n) : (this.sigBytes = 4 * e.length);
                        },
                        toString: function (e) {
                            return (e || l).stringify(this);
                        },
                        concat: function (e) {
                            var t = this.words,
                                n = e.words,
                                r = this.sigBytes,
                                i = e.sigBytes;
                            if ((this.clamp(), r % 4))
                                for (var o = 0; o < i; o++) {
                                    var a = (n[o >>> 2] >>> (24 - (o % 4) * 8)) & 255;
                                    t[(r + o) >>> 2] |= a << (24 - ((r + o) % 4) * 8);
                                }
                            else for (var o = 0; o < i; o += 4) t[(r + o) >>> 2] = n[o >>> 2];
                            return (this.sigBytes += i), this;
                        },
                        clamp: function () {
                            var t = this.words,
                                n = this.sigBytes;
                            (t[n >>> 2] &= 4294967295 << (32 - (n % 4) * 8)), (t.length = e.ceil(n / 4));
                        },
                        clone: function () {
                            var e = o.clone.call(this);
                            return (e.words = this.words.slice(0)), e;
                        },
                        random: function (t) {
                            for (
                                var n,
                                    r = [],
                                    i = function (t) {
                                        var t = t,
                                            n = 987654321,
                                            r = 4294967295;
                                        return function () {
                                            (n = (36969 * (65535 & n) + (n >> 16)) & r), (t = (18e3 * (65535 & t) + (t >> 16)) & r);
                                            var i = ((n << 16) + t) & r;
                                            return (i /= 4294967296), (i += 0.5), i * (e.random() > 0.5 ? 1 : -1);
                                        };
                                    },
                                    o = 0;
                                o < t;
                                o += 4
                            ) {
                                var s = i(4294967296 * (n || e.random()));
                                (n = 987654071 * s()), r.push((4294967296 * s()) | 0);
                            }
                            return new a.init(r, t);
                        },
                    })),
                    s = (r.enc = {}),
                    l = (s.Hex = {
                        stringify: function (e) {
                            for (var t = e.words, n = e.sigBytes, r = [], i = 0; i < n; i++) {
                                var o = (t[i >>> 2] >>> (24 - (i % 4) * 8)) & 255;
                                r.push((o >>> 4).toString(16)), r.push((15 & o).toString(16));
                            }
                            return r.join("");
                        },
                        parse: function (e) {
                            for (var t = e.length, n = [], r = 0; r < t; r += 2) n[r >>> 3] |= parseInt(e.substr(r, 2), 16) << (24 - (r % 8) * 4);
                            return new a.init(n, t / 2);
                        },
                    }),
                    c = (s.Latin1 = {
                        stringify: function (e) {
                            for (var t = e.words, n = e.sigBytes, r = [], i = 0; i < n; i++) {
                                var o = (t[i >>> 2] >>> (24 - (i % 4) * 8)) & 255;
                                r.push(String.fromCharCode(o));
                            }
                            return r.join("");
                        },
                        parse: function (e) {
                            for (var t = e.length, n = [], r = 0; r < t; r++) n[r >>> 2] |= (255 & e.charCodeAt(r)) << (24 - (r % 4) * 8);
                            return new a.init(n, t);
                        },
                    }),
                    u = (s.Utf8 = {
                        stringify: function (e) {
                            try {
                                return decodeURIComponent(escape(c.stringify(e)));
                            } catch (e) {
                                throw new Error("Malformed UTF-8 data");
                            }
                        },
                        parse: function (e) {
                            return c.parse(unescape(encodeURIComponent(e)));
                        },
                    }),
                    d = (i.BufferedBlockAlgorithm = o.extend({
                        reset: function () {
                            (this._data = new a.init()), (this._nDataBytes = 0);
                        },
                        _append: function (e) {
                            "string" == typeof e && (e = u.parse(e)), this._data.concat(e), (this._nDataBytes += e.sigBytes);
                        },
                        _process: function (t) {
                            var n = this._data,
                                r = n.words,
                                i = n.sigBytes,
                                o = this.blockSize,
                                s = 4 * o,
                                l = i / s;
                            l = t ? e.ceil(l) : e.max((0 | l) - this._minBufferSize, 0);
                            var c = l * o,
                                u = e.min(4 * c, i);
                            if (c) {
                                for (var d = 0; d < c; d += o) this._doProcessBlock(r, d);
                                var f = r.splice(0, c);
                                n.sigBytes -= u;
                            }
                            return new a.init(f, u);
                        },
                        clone: function () {
                            var e = o.clone.call(this);
                            return (e._data = this._data.clone()), e;
                        },
                        _minBufferSize: 0,
                    })),
                    f =
                        ((i.Hasher = d.extend({
                            cfg: o.extend(),
                            init: function (e) {
                                (this.cfg = this.cfg.extend(e)), this.reset();
                            },
                            reset: function () {
                                d.reset.call(this), this._doReset();
                            },
                            update: function (e) {
                                return this._append(e), this._process(), this;
                            },
                            finalize: function (e) {
                                e && this._append(e);
                                var t = this._doFinalize();
                                return t;
                            },
                            blockSize: 16,
                            _createHelper: function (e) {
                                return function (t, n) {
                                    return new e.init(n).finalize(t);
                                };
                            },
                            _createHmacHelper: function (e) {
                                return function (t, n) {
                                    return new f.HMAC.init(e, n).finalize(t);
                                };
                            },
                        })),
                        (r.algo = {}));
                return r;
            })(Math);
        return e;
    }),
    define("cryptoJs", ["cryptoJs/core"], function (e) {
        return e;
    }),
    (function (e, t) {
        "object" == typeof exports ? (module.exports = exports = t(require("./core"))) : "function" == typeof define && define.amd ? define("cryptoJs/sha1", ["./core"], t) : t(e.CryptoJS);
    })(this, function (e) {
        return (
            (function () {
                var t = e,
                    n = t.lib,
                    r = n.WordArray,
                    i = n.Hasher,
                    o = t.algo,
                    a = [],
                    s = (o.SHA1 = i.extend({
                        _doReset: function () {
                            this._hash = new r.init([1732584193, 4023233417, 2562383102, 271733878, 3285377520]);
                        },
                        _doProcessBlock: function (e, t) {
                            for (var n = this._hash.words, r = n[0], i = n[1], o = n[2], s = n[3], l = n[4], c = 0; c < 80; c++) {
                                if (c < 16) a[c] = 0 | e[t + c];
                                else {
                                    var u = a[c - 3] ^ a[c - 8] ^ a[c - 14] ^ a[c - 16];
                                    a[c] = (u << 1) | (u >>> 31);
                                }
                                var d = ((r << 5) | (r >>> 27)) + l + a[c];
                                (d += c < 20 ? ((i & o) | (~i & s)) + 1518500249 : c < 40 ? (i ^ o ^ s) + 1859775393 : c < 60 ? ((i & o) | (i & s) | (o & s)) - 1894007588 : (i ^ o ^ s) - 899497514),
                                    (l = s),
                                    (s = o),
                                    (o = (i << 30) | (i >>> 2)),
                                    (i = r),
                                    (r = d);
                            }
                            (n[0] = (n[0] + r) | 0), (n[1] = (n[1] + i) | 0), (n[2] = (n[2] + o) | 0), (n[3] = (n[3] + s) | 0), (n[4] = (n[4] + l) | 0);
                        },
                        _doFinalize: function () {
                            var e = this._data,
                                t = e.words,
                                n = 8 * this._nDataBytes,
                                r = 8 * e.sigBytes;
                            return (t[r >>> 5] |= 128 << (24 - (r % 32))), (t[(((r + 64) >>> 9) << 4) + 14] = Math.floor(n / 4294967296)), (t[(((r + 64) >>> 9) << 4) + 15] = n), (e.sigBytes = 4 * t.length), this._process(), this._hash;
                        },
                        clone: function () {
                            var e = i.clone.call(this);
                            return (e._hash = this._hash.clone()), e;
                        },
                    }));
                (t.SHA1 = i._createHelper(s)), (t.HmacSHA1 = i._createHmacHelper(s));
            })(),
            e.SHA1
        );
    }),
    define("readium_js/epub-fetch/encryption_handler", ["cryptoJs/sha1"], function (e) {
        var t = function (e) {
            function t(e, t) {
                var n = new FileReader();
                (n.onload = function () {
                    var e = this.result;
                    t(new Uint8Array(e));
                }),
                    n.readAsArrayBuffer(e);
            }
            function n(e, n, r, i) {
                var o = e.slice(0, n);
                t(o, function (t) {
                    for (var o = r.length, a = 0; a < n; a++) t[a] = t[a] ^ r[a % o];
                    var s = new Blob([t], { type: e.type }),
                        l = e.slice(n),
                        c = new Blob([s, l], { type: e.type });
                    i(c);
                });
            }
            function r(t, r) {
                var i = 1040;
                n(t, i, e.uidHash, r);
            }
            function i(e) {
                var t = /(urn:uuid:)?([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})/i,
                    n = t.exec(e),
                    r = n[2] + n[3] + n[4] + n[5] + n[6];
                (r && 32 == r.length) || console.error("Bad UUID format for ID :" + e);
                for (var i = [], o = 0; o < 16; o++) {
                    var a = r.substr(2 * o, 2),
                        s = parseInt(a, 16);
                    i.push(s);
                }
                return i;
            }
            function o(t, r) {
                var o = i(e.uid),
                    a = 1024;
                n(t, a, o, r);
            }
            var a = this,
                s = { "http://www.idpf.org/2008/embedding": r, "http://ns.adobe.com/pdf/enc#RC": o };
            (this.isEncryptionSpecified = function () {
                return e && e.encryptions;
            }),
                (this.getEncryptionMethodForRelativePath = function (t) {
                    return a.isEncryptionSpecified() ? e.encryptions[t] : void 0;
                }),
                (this.getDecryptionFunctionForRelativePath = function (e) {
                    var t = a.getEncryptionMethodForRelativePath(e);
                    return t && s[t] ? s[t] : void 0;
                });
        };
        return (
            (t.CreateEncryptionData = function (t, n) {
                for (var r = unescape(encodeURIComponent(t.trim())), i = e(r), o = [], a = 0; a < i.sigBytes; a++) o.push((i.words[a >>> 2] >>> (24 - (a % 4) * 8)) & 255);
                var s = { uid: t, uidHash: o, encryptions: void 0 },
                    l = $("EncryptedData", n);
                return (
                    l.each(function (e, t) {
                        var n = $("EncryptionMethod", t).first().attr("Algorithm"),
                            r = $("CipherReference", t);
                        r.each(function (e, t) {
                            var r = $(t).attr("URI");
                            console.log("Encryption/obfuscation algorithm " + n + " specified for " + r), s.encryptions || (s.encryptions = {}), (s.encryptions[r] = n);
                        });
                    }),
                    s
                );
            }),
            t
        );
    }),
    define("readium_js/epub-fetch/publication_fetcher", [
        "jquery",
        "URIjs",
        "./markup_parser",
        "./plain_resource_fetcher",
        "./zip_resource_fetcher",
        "./content_document_fetcher",
        "./resource_cache",
        "./encryption_handler",
        "./discover_content_type",
        "readium_shared_js/helpers",
    ], function (e, t, n, r, i, o, a, s, l, c) {
        var u = function (u, d, f, h, p, g) {
            function m() {
                if (u instanceof Blob || u instanceof File) return !1;
                if (I && (I.indexOf("application/epub+zip") >= 0 || I.indexOf("application/zip") >= 0 || I.indexOf("application/octet-stream") >= 0)) return !1;
                var e = u;
                try {
                    e = new t(e).search("").hash("").toString();
                } catch (e) {
                    console.error(e), console.log(u);
                }
                return !/\.epub$/.test(e);
            }
            function v(e, t) {
                e ? (console.log(" --- using PlainResourceFetcher"), (_ = new r(b)), t(_)) : (console.log(" --- using ZipResourceFetcher"), (_ = new i(b, d)), t(_));
            }
            var b = this;
            b.contentTypePackageReadStrategyMap = { "application/oebps-package+xml": "exploded", "application/epub+zip": "zipped", "application/zip": "zipped" };
            var y,
                _,
                w,
                x,
                E,
                C,
                T,
                S = new a(f, h),
                R = p,
                I = g;
            (this.markupParser = new n()),
                (this.initialize = function (e) {
                    var t = m();
                    (y = !t),
                        console.log("_shouldConstructDomProgrammatically INIT: " + y),
                        v(t, function (t) {
                            b.getPackageDom(
                                function () {
                                    e(t);
                                },
                                function (t) {
                                    console.error("unable to find package document: " + t), e(void 0);
                                }
                            );
                        });
                }),
                (this.shouldConstructDomProgrammatically = function () {
                    return y;
                }),
                (this.shouldFetchMediaAssetsProgrammatically = function () {
                    var e = y && !m();
                    return e;
                }),
                (this.getEbookURL = function () {
                    return u;
                }),
                (this.getEbookURL_FilePath = function () {
                    return c.getEbookUrlFilePath(u);
                }),
                (this.getJsLibRoot = function () {
                    return d;
                }),
                (this.flushCache = function () {
                    S.flushCache();
                }),
                (this.getPackageUrl = function () {
                    return E;
                }),
                (this.getPackageFullPathRelativeToBase = function () {
                    return x;
                }),
                (this.fetchContentDocument = function (e, t, n, r) {
                    S.unPinResources();
                    var i = new o(b, e.spineItem, t, S, R);
                    i.fetchContentDocumentAndResolveDom(n, r);
                }),
                (this.getFileContentsFromPackage = function (e, t, n) {
                    x
                        ? b.relativeToPackageFetchFileContents(
                              e,
                              "text",
                              function (e) {
                                  t(e);
                              },
                              n
                          )
                        : (console.debug("FETCHING (INIT) ... " + e),
                          e && "/" == e.charAt(0) && (e = e.substr(1)),
                          _.fetchFileContentsText(
                              e,
                              function (e) {
                                  t(e);
                              },
                              n
                          ));
                }),
                (this.getXmlFileDom = function (e, t, n) {
                    b.getFileContentsFromPackage(
                        e,
                        function (e) {
                            var n = b.markupParser.parseXml(e);
                            t(n);
                        },
                        n
                    );
                }),
                (this.getPackageFullPath = function (e, t) {
                    b.getXmlFileDom(
                        "/META-INF/container.xml",
                        function (t) {
                            var n = b.getRootFile(t);
                            e(n);
                        },
                        t
                    );
                }),
                (this.getRootFile = function (t) {
                    var n = e("rootfile", t),
                        r = n.attr("full-path");
                    return r;
                }),
                (this.getPackageDom = function (t, n) {
                    C
                        ? t(C)
                        : T
                        ? T.done(t)
                        : ((T = e.Deferred()),
                          T.done(t),
                          b.getPackageFullPath(function (e) {
                              (x = e),
                                  (E = _.resolveURI(x)),
                                  console.debug("PACKAGE: "),
                                  console.log(x),
                                  console.log(E),
                                  e && "/" != e.charAt(0) && (e = "/" + e),
                                  b.getXmlFileDom(e, function (e) {
                                      (C = e), T.resolve(e), (T = void 0);
                                  });
                          }, n));
                }),
                (this.convertPathRelativeToPackageToRelativeToBase = function (e) {
                    return new t(e).absoluteTo(x).toString();
                }),
                (this.relativeToPackageFetchFileContents = function (n, r, i, o) {
                    var a = decodeURIComponent(b.convertPathRelativeToPackageToRelativeToBase(n));
                    console.debug("FETCHING ... " + a), "/" === a.charAt(0) && (a = a.substr(1));
                    var s = function () {
                        var e = arguments ? (arguments.length && arguments[0] instanceof Error ? arguments[0] : arguments instanceof Error ? arguments : void 0) : void 0,
                            t = 0 == a.indexOf("META-INF/com.apple.ibooks.display-options.xml") || 0 == a.indexOf("META-INF/encryption.xml");
                        console.log("MISSING: " + a), t || (e && (console.error(e), e.message && console.debug(e.message), e.stack && console.log(e.stack))), o && o.apply(this, arguments);
                    };
                    if (y && "" !== new t(n).scheme())
                        if ((console.log("shouldConstructDomProgrammatically EXTERNAL RESOURCE ..."), "blob" === r)) {
                            var c = new XMLHttpRequest();
                            c.open("GET", n, !0),
                                (c.responseType = "arraybuffer"),
                                (c.onerror = s),
                                (c.onload = function (e) {
                                    var t = new Blob([c.response], { type: l.identifyContentTypeFromFileName(n) });
                                    i(t);
                                }),
                                c.send();
                        } else
                            "data64uri" === r
                                ? console.error("data64uri??")
                                : e.ajax({
                                      isLocal: !1,
                                      url: n,
                                      dataType: "text",
                                      async: !0,
                                      success: function (e) {
                                          i(e);
                                      },
                                      error: function (e, t, n) {
                                          s(new Error(n));
                                      },
                                  });
                    else {
                        var u = _.fetchFileContentsText;
                        "blob" === r ? (u = _.fetchFileContentsBlob) : "data64uri" === r && (console.error("data64uri??"), (u = _.fetchFileContentsData64Uri)), u.call(_, a, i, s);
                    }
                }),
                (this.getRelativeXmlFileDom = function (e, t, n) {
                    b.getXmlFileDom(b.convertPathRelativeToPackageToRelativeToBase(e), t, n);
                }),
                (this.setPackageMetadata = function (e, t) {
                    b.getXmlFileDom(
                        "/META-INF/encryption.xml",
                        function (n) {
                            var r = s.CreateEncryptionData(e.id, n);
                            (w = new s(r)), w.isEncryptionSpecified() && ((y = !0), console.log("_shouldConstructDomProgrammatically ENCRYPTION ACTIVE: " + y)), t();
                        },
                        function (e) {
                            (w = new s(void 0)), t();
                        }
                    );
                }),
                (this.getDecryptionFunctionForRelativePath = function (e) {
                    return w.getDecryptionFunctionForRelativePath(e);
                });
        };
        return u;
    }),
    define("readium_js/epub-model/package_document", ["jquery", "underscore", "URIjs"], function (e, t, n) {
        var r = function (t, r, i, o, a) {
            function s(t) {
                var n = e("<ol></ol>");
                return (
                    e.each(t.children("navPoint"), function (t, r) {
                        l(e(r), n);
                    }),
                    n
                );
            }
            function l(t, n) {
                var r = t.children("navLabel").text().trim(),
                    i = t.children("content").attr("src"),
                    o = e('<li class="nav-elem"></li>').append(e("<a></a>", { href: i, text: r }));
                if ((n.append(o), t.children("navPoint").length > 0)) {
                    var a = e("<li></li>"),
                        s = e("<ol></ol>");
                    e.each(t.children("navPoint"), function (t, n) {
                        s.append(l(e(n), s));
                    }),
                        a.append(s),
                        n.append(a);
                }
            }
            var c;
            (this.manifest = a),
                (this.getSharedJsPackageData = function () {
                    var e = t.substr(0, t.lastIndexOf("/"));
                    return {
                        rootUrl: e,
                        rendition_viewport: i.rendition_viewport,
                        rendition_layout: i.rendition_layout,
                        rendition_orientation: i.rendition_orientation,
                        rendition_flow: i.rendition_flow,
                        rendition_spread: i.rendition_spread,
                        media_overlay: i.media_overlay,
                        spine: { direction: this.getPageProgressionDirection(), items: o },
                    };
                }),
                (this.getSpineItem = function (e) {
                    var t = o[e];
                    return t;
                }),
                (this.setPageProgressionDirection = function (e) {
                    c = e;
                }),
                (this.getPageProgressionDirection = function () {
                    return "rtl" === c ? "rtl" : "default" === c ? "default" : "ltr";
                }),
                (this.spineLength = function () {
                    return o.length;
                }),
                (this.getMetadata = function () {
                    return i;
                }),
                (this.getTocItem = function () {
                    var e = a.getNavItem();
                    if (e) return e;
                    var t = i.ncx;
                    return t && t.length > 0 ? a.getManifestItemByIdref(t) : null;
                }),
                (this.getToc = function () {
                    var e = this.getTocItem();
                    return e ? e.href : null;
                }),
                (this.getTocText = function (e) {
                    var t = this.getToc();
                    return t
                        ? void r.relativeToPackageFetchFileContents(
                              t,
                              "text",
                              function (t) {
                                  e(t);
                              },
                              function (n) {
                                  console.error("ERROR fetching TOC from [" + t + "]:"), console.error(n), e(void 0);
                              }
                          )
                        : (console.error("No TOC?!"), void e(void 0));
                }),
                (this.getTocDom = function (e) {
                    this.getTocText(function (t) {
                        if ("string" == typeof t) {
                            var n = new DOMParser().parseFromString(t, "text/xml");
                            e(n);
                        } else e(void 0);
                    });
                }),
                (this.generateTocListDOM = function (r) {
                    var i = this;
                    this.getTocDom(function (o) {
                        if (o)
                            if (i.tocIsNcx()) {
                                var a;
                                (a = s(e("navMap", o))), r(a[0]);
                            } else {
                                var l = new n(t).absoluteTo(document.URL),
                                    c = new n(i.getToc()).absoluteTo(l),
                                    u = (e(o).remove("base"), e("<base></base>"));
                                e(u).attr("href", c), e(o).find("head").append(u), r(o);
                            }
                        else r(void 0);
                    });
                }),
                (this.tocIsNcx = function () {
                    var e = this.getTocItem(),
                        t = e.href,
                        n = t.substr(t.lastIndexOf(".") + 1);
                    return "ncx" === n.trim().toLowerCase();
                });
        };
        return r;
    }),
    define("readium_js/epub-model/smil_document_parser", ["jquery", "underscore"], function (e, t) {
        var n = function (t, r) {
            function i(e) {
                return { id: "", href: "", spineItemId: e.idref, children: [{ nodeType: "seq", textref: e.href, children: [{ nodeType: "par", children: [{ nodeType: "text", src: e.href, srcFile: e.href, srcFragmentId: "" }] }] }] };
            }
            this.parse = function (n, i, o, a, s, l) {
                var c = this,
                    u = r.convertPathRelativeToPackageToRelativeToBase(i.href);
                "/" != u.charAt(0) && (u = "/" + u),
                    r.getXmlFileDom(
                        u,
                        function (r) {
                            var l = e("smil", r)[0];
                            (o.smilVersion = l.getAttribute("version")), (o.children = c.getChildren(l)), (o.href = i.href), (o.id = i.id), (o.spineItemId = n.idref);
                            var u = t.getMetadata().getMediaItemByRefinesId(i.id);
                            u && (o.duration = u.duration), s(a, o);
                        },
                        function (e) {
                            l(a, e);
                        }
                    );
            };
            var o = function (e, t, n, r, i) {
                var o = e.split(":"),
                    a = o[o.length - 1];
                "type" === a && (a = "epubtype"), void 0 != t.getAttribute(e) ? (n[a] = t.getAttribute(e)) : r && (void 0 !== i ? (n[a] = i) : console.log("Required property " + e + " not found in smil node " + t.nodeName));
            };
            (this.getChildren = function (t) {
                var n = this,
                    r = [];
                return (
                    e.each(t.childNodes, function (e, t) {
                        if (1 === t.nodeType) {
                            var i = n.createItemFromElement(t);
                            i && r.push(i);
                        }
                    }),
                    r
                );
            }),
                (this.createItemFromElement = function (e) {
                    var t = this,
                        r = {};
                    r.nodeType = e.nodeName;
                    var i = !1;
                    if (("body" === r.nodeType && ((i = !0), (r.nodeType = "seq")), "seq" === r.nodeType)) o("epub:textref", e, r, !i), o("id", e, r), o("epub:type", e, r), (r.children = t.getChildren(e));
                    else if ("par" === r.nodeType) o("id", e, r), o("epub:type", e, r), (r.children = t.getChildren(e));
                    else if ("text" === r.nodeType) {
                        o("src", e, r, !0);
                        var a = r.src.split("#");
                        (r.srcFile = a[0]), (r.srcFragmentId = 2 === a.length ? a[1] : ""), o("id", e, r);
                    } else {
                        if ("audio" !== r.nodeType) return;
                        o("src", e, r, !0), o("id", e, r), (r.clipBegin = n.resolveClockValue(e.getAttribute("clipBegin"))), (r.clipEnd = n.resolveClockValue(e.getAttribute("clipEnd")));
                    }
                    return r;
                }),
                (this.fillSmilData = function (n) {
                    var r = this;
                    if (t.spineLength() <= 0) return void n();
                    for (var o = !0, a = [], s = [], l = 0; l < t.spineLength(); l++) {
                        var c = t.getSpineItem(l);
                        if (c.media_overlay_id) {
                            var u = t.manifest.getManifestItemByIdref(c.media_overlay_id);
                            if (!u) {
                                console.error("Cannot find SMIL manifest item for spine/manifest item?! " + c.media_overlay_id);
                                continue;
                            }
                            var d = e.Deferred();
                            (d.media_overlay_id = c.media_overlay_id), s.push(d);
                            var f = {};
                            a.push(f),
                                r.parse(
                                    c,
                                    u,
                                    f,
                                    d,
                                    function (e, t) {
                                        (o = !1), e.resolve();
                                    },
                                    function (e, t) {
                                        console.log("Error when parsing SMIL manifest item " + u.href + ":"), console.log(t), e.resolve();
                                    }
                                );
                        } else a.push(i(c));
                    }
                    e.when.apply(e, s).done(function () {
                        t.getMetadata().setMoMap(a), o && t.getMetadata().setMoMap([]), n();
                    });
                });
        };
        return (
            (n.resolveClockValue = function (e) {
                if (!e) return 0;
                var t = 0,
                    n = 0,
                    r = 0;
                if (e.indexOf("min") != -1) n = parseFloat(e.substr(0, e.indexOf("min")));
                else if (e.indexOf("ms") != -1) {
                    var i = parseFloat(e.substr(0, e.indexOf("ms")));
                    r = i / 1e3;
                } else if (e.indexOf("s") != -1) r = parseFloat(e.substr(0, e.indexOf("s")));
                else if (e.indexOf("h") != -1) t = parseFloat(e.substr(0, e.indexOf("h")));
                else {
                    var o = e.split(":");
                    (r = parseFloat(o.pop())), o.length > 0 && ((n = parseFloat(o.pop())), o.length > 0 && (t = parseFloat(o.pop())));
                }
                var a = 3600 * t + 60 * n + r;
                return a;
            }),
            n
        );
    }),
    define("readium_js/epub-model/metadata", ["underscore"], function (e) {
        var t = function () {
            var t = this,
                n = {};
            (this.eachMediaItem = function (n) {
                return t.mediaItems && e.each(t.mediaItems, n), this;
            }),
                (this.getMediaItemByRefinesId = function (e) {
                    return n[e];
                }),
                (this.setMoMap = function (e) {
                    t.media_overlay.smil_models = e;
                }),
                this.eachMediaItem(function (e) {
                    var t = e.refines,
                        r = t.indexOf("#");
                    if (r >= 0) {
                        var i = r + 1,
                            o = t.length - 1;
                        t = t.substr(i, o);
                    }
                    (t = t.trim()), (n[t] = e);
                });
        };
        return t;
    }),
    define("readium_js/epub-model/manifest", ["underscore"], function (e) {
        var t = function (t) {
            var n,
                r = {};
            (this.manifestLength = function () {
                return t.length;
            }),
                (this.getManifestItemByIdref = function (e) {
                    return r[e];
                }),
                (this.each = function (n) {
                    return e.each(t, n), this;
                }),
                (this.getNavItem = function () {
                    return n;
                }),
                this.each(function (e) {
                    (r[e.id] = e), e.properties && e.properties.indexOf("nav") !== -1 && (n = e);
                });
        };
        return t;
    }),
    define("readium_js/epub-model/package_document_parser", ["jquery", "underscore", "../epub-fetch/markup_parser", "URIjs", "./package_document", "./smil_document_parser", "./metadata", "./manifest"], function (e, t, n, r, i, o, a, s) {
        var l = function (r) {
            function l(e, t) {
                var n = new o(e, r);
                n.fillSmilData(function () {
                    t(e);
                });
            }
            function c(t) {
                var i = e.Deferred();
                if (t.rendition_layout) i.resolve();
                else {
                    var o = "/META-INF/com.apple.ibooks.display-options.xml";
                    r.relativeToPackageFetchFileContents(
                        o,
                        "text",
                        function (r) {
                            if (r) {
                                var o = new n(),
                                    a = o.parseXml(r),
                                    s = e("option[name=fixed-layout]", a)[0];
                                if (s) {
                                    var l = e(s).text();
                                    "true" === l && ((t.rendition_layout = "pre-paginated"), console.log("using com.apple.ibooks.display-options.xml fixed-layout property"));
                                }
                            }
                            i.resolve();
                        },
                        function (e) {
                            i.resolve();
                        }
                    );
                }
                return i.promise();
            }
            function u(n, r, i) {
                var o,
                    a = [];
                return (
                    (o = e(d(n, "spine")).children()),
                    e.each(o, function (n, o) {
                        var s = e(o),
                            l = s.attr("idref") ? s.attr("idref") : "",
                            c = r.getManifestItemByIdref(l),
                            u = s.attr("id"),
                            d = void 0;
                        t.each(i.rendition_viewports, function (e) {
                            if (e.refines == u) return (d = e.viewport), !0;
                        });
                        var f = {
                                rendition_viewport: d,
                                idref: l,
                                href: c.href,
                                manifest_id: c.id,
                                media_type: c.media_type,
                                media_overlay_id: c.media_overlay_id,
                                linear: s.attr("linear") ? s.attr("linear") : "",
                                properties: s.attr("properties") ? s.attr("properties") : "",
                            },
                            h = _(f.properties);
                        e.extend(f, h), a.push(f);
                    }),
                    a
                );
            }
            function d(e, n, r) {
                var i = e.getElementsByTagNameNS("*", n);
                return r ? t.find(i, r) : i[0];
            }
            function f(e, n, r) {
                var i = e.getElementsByTagNameNS("*", n);
                return t.filter(i, r);
            }
            function h(e, t, n) {
                var r = d(e, t, n);
                return r ? r.textContent : "";
            }
            function p(e, t, n, r) {
                var i = d(e, t, r);
                return i ? i.getAttribute(n) : "";
            }
            function g(e, t) {
                var n = d(e, "meta", function (e) {
                    return e.getAttribute("property") === t;
                });
                return n ? n.textContent : "";
            }
            function m(e) {
                var n = new a(),
                    r = d(e, "metadata"),
                    i = d(e, "package"),
                    s = d(e, "spine");
                (n.author = h(r, "creator")),
                    (n.description = h(r, "description")),
                    (n.epub_version = i.getAttribute("version") ? i.getAttribute("version") : ""),
                    (n.id = h(r, "identifier")),
                    (n.language = h(r, "language")),
                    (n.modified_date = g(r, "dcterms:modified")),
                    (n.ncx = s.getAttribute("toc") ? s.getAttribute("toc") : ""),
                    (n.pubdate = h(r, "date")),
                    (n.publisher = h(r, "publisher")),
                    (n.rights = h(r, "rights")),
                    (n.title = h(r, "title")),
                    (n.rendition_orientation = g(r, "rendition:orientation")),
                    (n.rendition_layout = g(r, "rendition:layout")),
                    (n.rendition_spread = g(r, "rendition:spread")),
                    (n.rendition_flow = g(r, "rendition:flow")),
                    (n.rendition_viewport = h(r, "meta", function (e) {
                        return "rendition:viewport" === e.getAttribute("property") && !e.hasAttribute("refines");
                    }));
                var l = [],
                    c = f(r, "meta", function (e) {
                        return "rendition:viewport" === e.getAttribute("property") && e.hasAttribute("refines");
                    });
                t.each(c, function (e) {
                    var t = e.getAttribute("refines");
                    if (t) {
                        var n = t.indexOf("#");
                        if (n >= 0) {
                            var r = n + 1,
                                i = t.length - 1;
                            t = t.substr(r, i);
                        }
                        t = t.trim();
                    }
                    var o = { refines: t, viewport: e.textContent };
                    l.push(o);
                }),
                    (n.rendition_viewports = l),
                    (n.mediaItems = []);
                var u = f(r, "meta", function (e) {
                    return "media:duration" === e.getAttribute("property") && e.hasAttribute("refines");
                });
                return (
                    t.each(u, function (e) {
                        n.mediaItems.push({ refines: e.getAttribute("refines"), duration: o.resolveClockValue(e.textContent) });
                    }),
                    (n.media_overlay = {
                        duration: o.resolveClockValue(
                            h(r, "meta", function (e) {
                                return "media:duration" === e.getAttribute("property") && !e.hasAttribute("refines");
                            })
                        ),
                        narrator: g(r, "media:narrator"),
                        activeClass: g(r, "media:active-class"),
                        playbackActiveClass: g(r, "media:playback-active-class"),
                        smil_models: [],
                        skippables: ["sidebar", "practice", "marginalia", "annotation", "help", "note", "footnote", "rearnote", "table", "table-row", "table-cell", "list", "list-item", "pagebreak"],
                        escapables: [
                            "sidebar",
                            "bibliography",
                            "toc",
                            "loi",
                            "appendix",
                            "landmarks",
                            "lot",
                            "index",
                            "colophon",
                            "epigraph",
                            "conclusion",
                            "afterword",
                            "warning",
                            "epilogue",
                            "foreword",
                            "introduction",
                            "prologue",
                            "preface",
                            "preamble",
                            "notice",
                            "errata",
                            "copyright-page",
                            "acknowledgments",
                            "other-credits",
                            "titlepage",
                            "imprimatur",
                            "contributors",
                            "halftitlepage",
                            "dedication",
                            "help",
                            "annotation",
                            "marginalia",
                            "practice",
                            "note",
                            "footnote",
                            "rearnote",
                            "footnotes",
                            "rearnotes",
                            "bridgehead",
                            "page-list",
                            "table",
                            "table-row",
                            "table-cell",
                            "list",
                            "list-item",
                            "glossary",
                        ],
                    }),
                    n
                );
            }
            function v(t) {
                var n = e(d(t, "manifest")).children(),
                    r = [];
                return (
                    e.each(n, function (t, n) {
                        var i = e(n),
                            o = i.attr("href") ? i.attr("href") : "",
                            a = {
                                href: o,
                                id: i.attr("id") ? i.attr("id") : "",
                                media_overlay_id: i.attr("media-overlay") ? i.attr("media-overlay") : "",
                                media_type: i.attr("media-type") ? i.attr("media-type") : "",
                                properties: i.attr("properties") ? i.attr("properties") : "",
                            };
                        r.push(a);
                    }),
                    r
                );
            }
            function b(t) {
                var n = e(d(t, "bindings")).children(),
                    r = [];
                return (
                    e.each(n, function (t, n) {
                        var i = e(n),
                            o = { handler: i.attr("handler") ? i.attr("handler") : "", media_type: i.attr("media-type") ? i.attr("media-type") : "" };
                        r.push(o);
                    }),
                    r
                );
            }
            function y(n) {
                var r, i;
                if (
                    ((r = d(n, "manifest")),
                    (i = e(
                        d(r, "item", function (e) {
                            var n = e.getAttribute("properties");
                            return n && t.contains(n.split(" "), "cover-image");
                        })
                    )),
                    1 === i.length && i.attr("href"))
                )
                    return i.attr("href");
                var o = e(
                        d(n, "meta", function (e) {
                            return "cover" === e.getAttribute("name");
                        })
                    ),
                    a = o.attr("content");
                return 1 === o.length &&
                    a &&
                    ((i = e(
                        d(r, "item", function (e) {
                            return e.getAttribute("id") === a;
                        })
                    )),
                    1 === i.length && i.attr("href"))
                    ? i.attr("href")
                    : ((i = e(
                          d(r, "item", function (e) {
                              return "cover" === e.getAttribute("id");
                          })
                      )),
                      1 === i.length && i.attr("href") ? i.attr("href") : null);
            }
            function _(e) {
                for (var t = {}, n = e.split(" "), r = 0; r < n.length; r++)
                    "rendition:orientation-landscape" === n[r] && (t.rendition_orientation = "landscape"),
                        "rendition:orientation-portrait" === n[r] && (t.rendition_orientation = "portrait"),
                        "rendition:orientation-auto" === n[r] && (t.rendition_orientation = "auto"),
                        "rendition:spread-none" === n[r] && (t.rendition_spread = "none"),
                        "rendition:spread-landscape" === n[r] && (t.rendition_spread = "landscape"),
                        "rendition:spread-portrait" === n[r] && (t.rendition_spread = "portrait"),
                        "rendition:spread-both" === n[r] && (t.rendition_spread = "both"),
                        "rendition:spread-auto" === n[r] && (t.rendition_spread = "auto"),
                        "rendition:flow-paginated" === n[r] && (t.rendition_flow = "paginated"),
                        "rendition:flow-scrolled-continuous" === n[r] && (t.rendition_flow = "scrolled-continuous"),
                        "rendition:flow-scrolled-doc" === n[r] && (t.rendition_flow = "scrolled-doc"),
                        "rendition:flow-auto" === n[r] && (t.rendition_flow = "auto"),
                        "rendition:page-spread-center" === n[r] && (t.page_spread = "page-spread-center"),
                        "page-spread-left" === n[r] && (t.page_spread = "page-spread-left"),
                        "page-spread-right" === n[r] && (t.page_spread = "page-spread-right"),
                        "rendition:layout-reflowable" === n[r] && ((t.fixed_flow = !1), (t.rendition_layout = "reflowable")),
                        "rendition:layout-pre-paginated" === n[r] && ((t.fixed_flow = !0), (t.rendition_layout = "pre-paginated"));
                return t;
            }
            var w,
                x = r,
                E = e.Deferred();
            r.getPackageDom(
                function (e) {
                    (w = e), E.resolve(e);
                },
                function () {
                    E.resolve(void 0);
                }
            ),
                (this.parse = function (t) {
                    E.done(function (n) {
                        if (!n) return void t(void 0);
                        var o = m(n),
                            a = (n.getElementsByTagNameNS("*", "spine")[0], p(n, "spine", "page-progression-direction")),
                            d = (b(n), new s(v(n))),
                            f = u(n, d, o),
                            h = y(n);
                        h && (o.cover_href = h),
                            e.when(c(o)).then(function () {
                                x.setPackageMetadata(o, function () {
                                    var e = new i(r.getPackageUrl(), r, o, f, d);
                                    e.setPageProgressionDirection(a), l(e, t);
                                });
                            });
                    });
                });
        };
        return l;
    }),
    define("readium_js/epub-fetch/iframe_zip_loader", ["URIjs", "readium_shared_js/views/iframe_loader", "underscore", "./discover_content_type"], function (e, t, n, r) {
        var i = function (o, a) {
            function s(e, t) {
                $.ajax({
                    url: e,
                    dataType: "html",
                    async: !0,
                    success: function (e) {
                        t(e);
                    },
                    error: function (n, r, i) {
                        console.error("Error when AJAX fetching " + e), console.error(r), console.error(i), t();
                    },
                });
            }
            function l(e, t) {
                s(e, function (n) {
                    return n ? (f && (n = f(e, n)), void t(n)) : void t();
                });
            }
            var c = LDEpubUtils.isMobileDevice() || window.navigator.userAgent.indexOf("Trident") > 0 || window.navigator.userAgent.indexOf("Edge") > 0,
                u = new t(),
                d = this,
                f = a;
            (this.addIFrameEventListener = function (e, t, n) {
                u.addIFrameEventListener(e, t, n);
            }),
                (this.updateIframeEvents = function (e) {
                    u.updateIframeEvents(e);
                }),
                (this.loadIframe = function (t, n, r, i, a) {
                    t.baseURI
                        ? console.log("iframe.baseURI: " + t.baseURI)
                        : (c && t.ownerDocument.defaultView.frameElement
                              ? ((t.baseURI = t.ownerDocument.defaultView.frameElement.getAttribute("data-loadUri")),
                                null == t.baseURI && "undefined" != typeof location && (t.baseURI = location.href + ""),
                                console.log("iframe.baseURI IE: " + t.baseURI),
                                console.log("EPUB doc iframe src (BEFORE):"),
                                console.log(n),
                                (n = new e(n).absoluteTo(t.baseURI).search("").hash("").toString()))
                              : "undefined" != typeof location && (t.baseURI = location.href + ""),
                          console.error("!iframe.baseURI => " + t.baseURI)),
                        console.log("EPUB doc iframe src:"),
                        console.log(n),
                        t.setAttribute("data-src", n),
                        console.log("EPUB doc iframe base URI:"),
                        console.log(t.baseURI),
                        t.setAttribute("data-baseUri", t.baseURI);
                    var s = new e(n).absoluteTo(t.baseURI).search("").hash("").toString();
                    console.log("EPUB doc iframe LOAD URI:"), console.log(s), t.setAttribute("data-loadUri", s);
                    var u = o().shouldConstructDomProgrammatically();
                    u
                        ? (console.log("shouldConstructDomProgrammatically..."),
                          o().fetchContentDocument(
                              a,
                              s,
                              function (e) {
                                  d._loadIframeWithDocument(t, a, e.documentElement.outerHTML, function () {
                                      r.call(i, !0, a);
                                  });
                              },
                              function (e) {
                                  r.call(i, !1, a);
                              }
                          ))
                        : l(s, function (e) {
                              e
                                  ? d._loadIframeWithDocument(t, a, e, function () {
                                        r.call(i, !0, a);
                                    })
                                  : r.call(i, !1, a);
                          });
                }),
                (this._loadIframeWithDocument = function (t, s, l, u) {
                    if (c)
                        t.contentWindow.document.open(),
                            window.MSApp && window.MSApp.execUnsafeLocalFunction
                                ? window.MSApp.execUnsafeLocalFunction(function () {
                                      t.contentWindow.document.write(l);
                                  })
                                : t.contentWindow.document.write(l);
                    else {
                        var f = "text/html";
                        s.spineItem.media_type && s.spineItem.media_type.length && (f = s.spineItem.media_type);
                        var h = window.URL.createObjectURL(new Blob([l], { type: f }));
                    }
                    (t.onload = function () {
                        var l = t.contentDocument || t.contentWindow.document;
                        if (t.contentWindow.frames)
                            for (var f = 0; f < t.contentWindow.frames.length; f++) {
                                var p = t.contentWindow.frames[f],
                                    g = void 0;
                                try {
                                    g = p.frameElement.getAttribute("data-src");
                                } catch (e) {
                                    console.warn(e);
                                    continue;
                                }
                                if (g) {
                                    var m = s.spineItem.href,
                                        v = o(),
                                        b = v.convertPathRelativeToPackageToRelativeToBase(m),
                                        y = new e(g).absoluteTo(b).toString(),
                                        _ = v.getPackageFullPathRelativeToBase(),
                                        w = new e("/" + y).relativeTo("/" + _).toString(),
                                        x = r.identifyContentTypeFromFileName(w),
                                        E = new i(o, a);
                                    E.loadIframe(
                                        p.frameElement,
                                        g,
                                        function () {
                                            console.log("CHILD IFRAME LOADED.");
                                        },
                                        d,
                                        { spineItem: { media_type: x, href: w } }
                                    );
                                } else "iframe" == p.frameElement.localName && console.error("IFRAME data-src missing?!");
                            }
                        $("svg", l).load(function () {
                            console.log("SVG loaded");
                        }),
                            d.updateIframeEvents(t);
                        var C = t.contentWindow.MathJax;
                        if (C) {
                            console.log("MathJax VERSION: " + C.cdnVersion + " // " + C.fileversion + " // " + C.version);
                            var T = !0;
                            C.Hub.Browser.isFirefox && (T = !1),
                                C.Hub.Browser.isChrome && (T = !1),
                                window.navigator.userAgent.indexOf("Edge") > 0 && (T = !1),
                                C.Hub.Config({ showMathMenu: !1, messageStyle: "none", showProcessingMessages: !0, SVG: { useFontCache: T } });
                            var S = n.once(u);
                            try {
                                C.Hub.Queue(S);
                            } catch (e) {
                                console.error("MathJax fail!"), u();
                            }
                        } else u();
                        c || window.URL.revokeObjectURL(h);
                    }),
                        c ? t.contentWindow.document.close() : t.setAttribute("src", h);
                });
        };
        return i;
    }),
    define("readium_js/Readium", [
        "readium_shared_js/globals",
        "text!version.json",
        "jquery",
        "underscore",
        "readium_shared_js/views/reader_view",
        "readium_js/epub-fetch/publication_fetcher",
        "readium_js/epub-model/package_document_parser",
        "readium_js/epub-fetch/iframe_zip_loader",
        "readium_shared_js/views/iframe_loader",
    ], function (e, t, n, r, i, o, a, s, l) {
        var c = !1,
            u = function (t, r) {
                var c = { mathJaxUrl: r.mathJaxUrl },
                    u = function (e, t) {
                        function n(e) {
                            return e.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&apos;");
                        }
                        function r() {
                            navigator.epubReadingSystem = window.parent.navigator.epubReadingSystem;
                        }
                        var i = e.split("/"),
                            o = i.join("/");
                        console.log("EPUB doc base href:"), console.log(o);
                        var a = '<base href="' + encodeURI(n(o)) + '"/>',
                            s = '<script type="text/javascript">(' + r.toString() + ")()</script>";
                        return (
                            c && c.mathJaxUrl && t.search(/<(\w+:|)(?=math)/) >= 0 && (s += '<script type="text/javascript" src="' + c.mathJaxUrl + '"> </script>'),
                            (t = t.replace(/(<head[\s\S]*?>)/, "$1" + a + s)),
                            (t = t.replace(/(<iframe[\s\S]+?)src[\s]*=[\s]*(["'])[\s]*(.*)[\s]*(["'])([\s\S]*?>)/g, "$1data-src=$2$3$4$5")),
                            (t = t.replace(/(<iframe[\s\S]+?)data-src[\s]*=[\s]*(["'])[\s]*(http[s]?:\/\/.*)[\s]*(["'])([\s\S]*?>)/g, "$1src=$2$3$4$5")),
                            (t = t.replace(/<title>[\s]*<\/title>/g, "<title>TITLE</title>")),
                            (t = t.replace(/<title[\s]*\/>/g, "<title>TITLE</title>"))
                        );
                    },
                    d = this,
                    f = void 0;
                this.getCurrentPublicationFetcher = function () {
                    return f;
                };
                var h = t.jsLibRoot;
                t.useSimpleLoader
                    ? (r.iframeLoader = new l())
                    : (r.iframeLoader = new s(function () {
                          return f;
                      }, u)),
                    (r.needsFixedLayoutScalerWorkAround = !0),
                    (this.reader = new i(r)),
                    (ReadiumSDK.reader = this.reader);
                var p = function (e, r, i, s) {
                    f && f.flushCache();
                    var l = null;
                    t.cacheSizeEvictThreshold && (l = t.cacheSizeEvictThreshold),
                        (f = new o(e, h, window, l, u, s)),
                        f.initialize(function (e) {
                            if (!e) return void r(void 0);
                            var o = new a(f);
                            o.parse(function (e) {
                                if (!e) return void r(void 0);
                                var o = t.openBookOptions || {},
                                    a = n.extend(e.getSharedJsPackageData(), o);
                                i && (a.openPageRequest = i), d.reader.openBook(a);
                                var s = { metadata: e.getMetadata() };
                                r(e, s);
                            });
                        });
                };
                (this.openPackageDocument = function (e, t, n) {
                    if (!(e instanceof Blob || e instanceof File)) {
                        console.debug("-------------------------------");
                        var r = window.location.origin;
                        r || (r = window.location.protocol + "//" + window.location.host);
                        var i = r + window.location.pathname;
                        console.debug("BASE URL: " + i), console.debug("RELATIVE URL: " + e);
                        try {
                            e = new URI(e).absoluteTo(i).toString();
                        } catch (t) {
                            console.error(t), console.log(e);
                        }
                        if ((console.debug("==>"), console.debug("ABSOLUTE URL: " + e), console.debug("-------------------------------"), 0 == e.indexOf("http://") || 0 == e.indexOf("https://"))) {
                            var o = new XMLHttpRequest();
                            return (
                                (o.onreadystatechange = function () {
                                    if (4 == this.readyState) {
                                        var r = void 0,
                                            i = (o.status >= 200 && o.status < 300) || 304 === o.status;
                                        if (i) {
                                            var a = "";
                                            o.getAllResponseHeaders && ((a = o.getAllResponseHeaders()), (a = a ? a.toLowerCase() : "")),
                                                a.indexOf("content-type") >= 0 && ((r = o.getResponseHeader("Content-Type") || o.getResponseHeader("content-type")), r || (r = void 0), console.debug("CONTENT-TYPE: " + e + " ==> " + r));
                                            var s = o.responseURL;
                                            s || (a.indexOf("location") >= 0 && (s = o.getResponseHeader("Location") || o.getResponseHeader("location"))), s && s !== e && (console.debug("REDIRECT: " + e + " ==> " + s), (e = s));
                                        }
                                        p(e, t, n, r);
                                    }
                                }),
                                o.open("HEAD", e, !0),
                                void o.send(null)
                            );
                        }
                    }
                    p(e, t, n);
                }),
                    (this.closePackageDocument = function () {
                        f && f.flushCache();
                    }),
                    e.logEvent("READER_INITIALIZED", "EMIT", "Readium.js"),
                    ReadiumSDK.emit(ReadiumSDK.Events.READER_INITIALIZED, ReadiumSDK.reader);
            };
        return (
            (u.version = JSON.parse(t)),
            (u.getVersion = function (e) {
                var t = u.version;
                if (t.needsPopulating) {
                    c && console.log("version.json needsPopulating ...");
                    var r = function (i) {
                        if (i >= t.repos.length) return delete t.needsPopulating, delete t.repos, c && (console.log("version"), console.debug(t)), (u.version = t), void e(t);
                        var o = t.repos[i];
                        c && (console.log("##########################"), console.log("repo.name"), console.debug(o.name), console.log("repo.path"), console.debug(o.path)),
                            (t[o.name] = {}),
                            (t[o.name].timestamp = new Date().getTime()),
                            n
                                .getJSON(o.path + "/package.json", function (e) {
                                    c && (console.log("version"), console.debug(e.version)), (t[o.name].version = e.version), (t[o.name].chromeVersion = "2." + e.version.substring(2));
                                    var a = function (e, o, a) {
                                            var s = e + "/" + a;
                                            c && (console.log("getRef"), console.debug(s)),
                                                n
                                                    .get(s, function (e) {
                                                        t[o.name].branch = a;
                                                        var n = e.substring(0, e.length - 1);
                                                        (t[o.name].sha = n), c && (console.log("getRef OKAY"), console.debug(s), console.log(e), console.log("branch"), console.debug(a), console.log("sha"), console.debug(n)), r(++i);
                                                    })
                                                    .fail(function (e) {
                                                        c && (console.log("getRef ERROR"), console.debug(s)), r(++i);
                                                    });
                                        },
                                        s = function (e) {
                                            var t = e.path + "/.git";
                                            c && (console.log("getGit"), console.debug(t)),
                                                n
                                                    .get(t, function (n) {
                                                        if ((c && (console.log("getGit OKAY"), console.debug(t), console.log(n)), 0 == n.indexOf("gitdir: "))) {
                                                            var o = e.path + "/" + n.substring("gitdir: ".length).trim();
                                                            c && (console.log("gitdir: OKAY"), console.log(o)), l(o, e);
                                                        } else c && console.log("gitdir: ERROR"), r(++i);
                                                    })
                                                    .fail(function (e) {
                                                        c && (console.log("getGit ERROR"), console.debug(t)), r(++i);
                                                    });
                                        },
                                        l = function (e, t, o) {
                                            var l = e + "/HEAD";
                                            c && (console.log("getHead"), console.debug(l)),
                                                n
                                                    .get(l, function (n) {
                                                        c && (console.log("getHead OKAY"), console.debug(l), console.log(n));
                                                        var r = n.substring(5, n.length - 1);
                                                        a(e, t, r);
                                                    })
                                                    .fail(function (e) {
                                                        c && (console.log("getHead ERROR"), console.debug(l)), o ? s(t) : (c && console.log("getHead ABORT"), r(++i));
                                                    });
                                        };
                                    l(o.path + "/.git", o, !0);
                                })
                                .fail(function (e) {
                                    r(++i);
                                });
                    };
                    r(0);
                } else e(t);
            }),
            u
        );
    }),
    define("readium_js", ["readium_js/Readium"], function (e) {
        return e;
    }),
    define("readium_js_viewer/ModuleConfig", ["module"], function (e) {
        var t = e.config();
        return {
            imagePathPrefix: t.imagePathPrefix || "",
            epubLibraryPath: t.epubLibraryPath || "",
            canHandleUrl: t.canHandleUrl || !1,
            canHandleDirectory: t.canHandleDirectory || !1,
            epubReadingSystemUrl: t.epubReadingSystemUrl || "/EPUBREADINGSYSTEM.js",
            workerUrl: t.workerUrl || "/READIUMWORKER.js",
            annotationCSSUrl: t.annotationCSSUrl || "/ANNOTATIONS.css",
            mathJaxUrl: t.mathJaxUrl || "/MATHJAX.js",
            jsLibRoot: t.jsLibRoot || "/ZIPJS/",
            useSimpleLoader: t.useSimpleLoader || !1,
        };
    }),
    "undefined" == typeof jQuery)
)
    throw new Error("Bootstrap's JavaScript requires jQuery");
+(function (e) {
    "use strict";
    var t = e.fn.jquery.split(" ")[0].split(".");
    if ((t[0] < 2 && t[1] < 9) || (1 == t[0] && 9 == t[1] && t[2] < 1) || t[0] > 3) throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4");
})(jQuery),
    +(function (e) {
        "use strict";
        function t() {
            var e = document.createElement("bootstrap"),
                t = { WebkitTransition: "webkitTransitionEnd", MozTransition: "transitionend", OTransition: "oTransitionEnd otransitionend", transition: "transitionend" };
            for (var n in t) if (void 0 !== e.style[n]) return { end: t[n] };
            return !1;
        }
        (e.fn.emulateTransitionEnd = function (t) {
            var n = !1,
                r = this;
            e(this).one("bsTransitionEnd", function () {
                n = !0;
            });
            var i = function () {
                n || e(r).trigger(e.support.transition.end);
            };
            return setTimeout(i, t), this;
        }),
            e(function () {
                (e.support.transition = t()),
                    e.support.transition &&
                        (e.event.special.bsTransitionEnd = {
                            bindType: e.support.transition.end,
                            delegateType: e.support.transition.end,
                            handle: function (t) {
                                if (e(t.target).is(this)) return t.handleObj.handler.apply(this, arguments);
                            },
                        });
            });
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var n = e(this),
                    i = n.data("bs.alert");
                i || n.data("bs.alert", (i = new r(this))), "string" == typeof t && i[t].call(n);
            });
        }
        var n = '[data-dismiss="alert"]',
            r = function (t) {
                e(t).on("click", n, this.close);
            };
        (r.VERSION = "3.3.7"),
            (r.TRANSITION_DURATION = 150),
            (r.prototype.close = function (t) {
                function n() {
                    a.detach().trigger("closed.bs.alert").remove();
                }
                var i = e(this),
                    o = i.attr("data-target");
                o || ((o = i.attr("href")), (o = o && o.replace(/.*(?=#[^\s]*$)/, "")));
                var a = e("#" === o ? [] : o);
                t && t.preventDefault(),
                    a.length || (a = i.closest(".alert")),
                    a.trigger((t = e.Event("close.bs.alert"))),
                    t.isDefaultPrevented() || (a.removeClass("in"), e.support.transition && a.hasClass("fade") ? a.one("bsTransitionEnd", n).emulateTransitionEnd(r.TRANSITION_DURATION) : n());
            });
        var i = e.fn.alert;
        (e.fn.alert = t),
            (e.fn.alert.Constructor = r),
            (e.fn.alert.noConflict = function () {
                return (e.fn.alert = i), this;
            }),
            e(document).on("click.bs.alert.data-api", n, r.prototype.close);
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var r = e(this),
                    i = r.data("bs.button"),
                    o = "object" == typeof t && t;
                i || r.data("bs.button", (i = new n(this, o))), "toggle" == t ? i.toggle() : t && i.setState(t);
            });
        }
        var n = function (t, r) {
            (this.$element = e(t)), (this.options = e.extend({}, n.DEFAULTS, r)), (this.isLoading = !1);
        };
        (n.VERSION = "3.3.7"),
            (n.DEFAULTS = { loadingText: "loading..." }),
            (n.prototype.setState = function (t) {
                var n = "disabled",
                    r = this.$element,
                    i = r.is("input") ? "val" : "html",
                    o = r.data();
                (t += "Text"),
                    null == o.resetText && r.data("resetText", r[i]()),
                    setTimeout(
                        e.proxy(function () {
                            r[i](null == o[t] ? this.options[t] : o[t]),
                                "loadingText" == t ? ((this.isLoading = !0), r.addClass(n).attr(n, n).prop(n, !0)) : this.isLoading && ((this.isLoading = !1), r.removeClass(n).removeAttr(n).prop(n, !1));
                        }, this),
                        0
                    );
            }),
            (n.prototype.toggle = function () {
                var e = !0,
                    t = this.$element.closest('[data-toggle="buttons"]');
                if (t.length) {
                    var n = this.$element.find("input");
                    "radio" == n.prop("type")
                        ? (n.prop("checked") && (e = !1), t.find(".active").removeClass("active"), this.$element.addClass("active"))
                        : "checkbox" == n.prop("type") && (n.prop("checked") !== this.$element.hasClass("active") && (e = !1), this.$element.toggleClass("active")),
                        n.prop("checked", this.$element.hasClass("active")),
                        e && n.trigger("change");
                } else this.$element.attr("aria-pressed", !this.$element.hasClass("active")), this.$element.toggleClass("active");
            });
        var r = e.fn.button;
        (e.fn.button = t),
            (e.fn.button.Constructor = n),
            (e.fn.button.noConflict = function () {
                return (e.fn.button = r), this;
            }),
            e(document)
                .on("click.bs.button.data-api", '[data-toggle^="button"]', function (n) {
                    var r = e(n.target).closest(".btn");
                    t.call(r, "toggle"), e(n.target).is('input[type="radio"], input[type="checkbox"]') || (n.preventDefault(), r.is("input,button") ? r.trigger("focus") : r.find("input:visible,button:visible").first().trigger("focus"));
                })
                .on("focus.bs.button.data-api blur.bs.button.data-api", '[data-toggle^="button"]', function (t) {
                    e(t.target)
                        .closest(".btn")
                        .toggleClass("focus", /^focus(in)?$/.test(t.type));
                });
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var r = e(this),
                    i = r.data("bs.carousel"),
                    o = e.extend({}, n.DEFAULTS, r.data(), "object" == typeof t && t),
                    a = "string" == typeof t ? t : o.slide;
                i || r.data("bs.carousel", (i = new n(this, o))), "number" == typeof t ? i.to(t) : a ? i[a]() : o.interval && i.pause().cycle();
            });
        }
        var n = function (t, n) {
            (this.$element = e(t)),
                (this.$indicators = this.$element.find(".carousel-indicators")),
                (this.options = n),
                (this.paused = null),
                (this.sliding = null),
                (this.interval = null),
                (this.$active = null),
                (this.$items = null),
                this.options.keyboard && this.$element.on("keydown.bs.carousel", e.proxy(this.keydown, this)),
                "hover" == this.options.pause && !("ontouchstart" in document.documentElement) && this.$element.on("mouseenter.bs.carousel", e.proxy(this.pause, this)).on("mouseleave.bs.carousel", e.proxy(this.cycle, this));
        };
        (n.VERSION = "3.3.7"),
            (n.TRANSITION_DURATION = 600),
            (n.DEFAULTS = { interval: 5e3, pause: "hover", wrap: !0, keyboard: !0 }),
            (n.prototype.keydown = function (e) {
                if (!/input|textarea/i.test(e.target.tagName)) {
                    switch (e.which) {
                        case 37:
                            this.prev();
                            break;
                        case 39:
                            this.next();
                            break;
                        default:
                            return;
                    }
                    e.preventDefault();
                }
            }),
            (n.prototype.cycle = function (t) {
                return t || (this.paused = !1), this.interval && clearInterval(this.interval), this.options.interval && !this.paused && (this.interval = setInterval(e.proxy(this.next, this), this.options.interval)), this;
            }),
            (n.prototype.getItemIndex = function (e) {
                return (this.$items = e.parent().children(".item")), this.$items.index(e || this.$active);
            }),
            (n.prototype.getItemForDirection = function (e, t) {
                var n = this.getItemIndex(t),
                    r = ("prev" == e && 0 === n) || ("next" == e && n == this.$items.length - 1);
                if (r && !this.options.wrap) return t;
                var i = "prev" == e ? -1 : 1,
                    o = (n + i) % this.$items.length;
                return this.$items.eq(o);
            }),
            (n.prototype.to = function (e) {
                var t = this,
                    n = this.getItemIndex((this.$active = this.$element.find(".item.active")));
                if (!(e > this.$items.length - 1 || e < 0))
                    return this.sliding
                        ? this.$element.one("slid.bs.carousel", function () {
                              t.to(e);
                          })
                        : n == e
                        ? this.pause().cycle()
                        : this.slide(e > n ? "next" : "prev", this.$items.eq(e));
            }),
            (n.prototype.pause = function (t) {
                return t || (this.paused = !0), this.$element.find(".next, .prev").length && e.support.transition && (this.$element.trigger(e.support.transition.end), this.cycle(!0)), (this.interval = clearInterval(this.interval)), this;
            }),
            (n.prototype.next = function () {
                if (!this.sliding) return this.slide("next");
            }),
            (n.prototype.prev = function () {
                if (!this.sliding) return this.slide("prev");
            }),
            (n.prototype.slide = function (t, r) {
                var i = this.$element.find(".item.active"),
                    o = r || this.getItemForDirection(t, i),
                    a = this.interval,
                    s = "next" == t ? "left" : "right",
                    l = this;
                if (o.hasClass("active")) return (this.sliding = !1);
                var c = o[0],
                    u = e.Event("slide.bs.carousel", { relatedTarget: c, direction: s });
                if ((this.$element.trigger(u), !u.isDefaultPrevented())) {
                    if (((this.sliding = !0), a && this.pause(), this.$indicators.length)) {
                        this.$indicators.find(".active").removeClass("active");
                        var d = e(this.$indicators.children()[this.getItemIndex(o)]);
                        d && d.addClass("active");
                    }
                    var f = e.Event("slid.bs.carousel", { relatedTarget: c, direction: s });
                    return (
                        e.support.transition && this.$element.hasClass("slide")
                            ? (o.addClass(t),
                              o[0].offsetWidth,
                              i.addClass(s),
                              o.addClass(s),
                              i
                                  .one("bsTransitionEnd", function () {
                                      o.removeClass([t, s].join(" ")).addClass("active"),
                                          i.removeClass(["active", s].join(" ")),
                                          (l.sliding = !1),
                                          setTimeout(function () {
                                              l.$element.trigger(f);
                                          }, 0);
                                  })
                                  .emulateTransitionEnd(n.TRANSITION_DURATION))
                            : (i.removeClass("active"), o.addClass("active"), (this.sliding = !1), this.$element.trigger(f)),
                        a && this.cycle(),
                        this
                    );
                }
            });
        var r = e.fn.carousel;
        (e.fn.carousel = t),
            (e.fn.carousel.Constructor = n),
            (e.fn.carousel.noConflict = function () {
                return (e.fn.carousel = r), this;
            });
        var i = function (n) {
            var r,
                i = e(this),
                o = e(i.attr("data-target") || ((r = i.attr("href")) && r.replace(/.*(?=#[^\s]+$)/, "")));
            if (o.hasClass("carousel")) {
                var a = e.extend({}, o.data(), i.data()),
                    s = i.attr("data-slide-to");
                s && (a.interval = !1), t.call(o, a), s && o.data("bs.carousel").to(s), n.preventDefault();
            }
        };
        e(document).on("click.bs.carousel.data-api", "[data-slide]", i).on("click.bs.carousel.data-api", "[data-slide-to]", i),
            e(window).on("load", function () {
                e('[data-ride="carousel"]').each(function () {
                    var n = e(this);
                    t.call(n, n.data());
                });
            });
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(t) {
            var n,
                r = t.attr("data-target") || ((n = t.attr("href")) && n.replace(/.*(?=#[^\s]+$)/, ""));
            return e(r);
        }
        function n(t) {
            return this.each(function () {
                var n = e(this),
                    i = n.data("bs.collapse"),
                    o = e.extend({}, r.DEFAULTS, n.data(), "object" == typeof t && t);
                !i && o.toggle && /show|hide/.test(t) && (o.toggle = !1), i || n.data("bs.collapse", (i = new r(this, o))), "string" == typeof t && i[t]();
            });
        }
        var r = function (t, n) {
            (this.$element = e(t)),
                (this.options = e.extend({}, r.DEFAULTS, n)),
                (this.$trigger = e('[data-toggle="collapse"][href="#' + t.id + '"],[data-toggle="collapse"][data-target="#' + t.id + '"]')),
                (this.transitioning = null),
                this.options.parent ? (this.$parent = this.getParent()) : this.addAriaAndCollapsedClass(this.$element, this.$trigger),
                this.options.toggle && this.toggle();
        };
        (r.VERSION = "3.3.7"),
            (r.TRANSITION_DURATION = 350),
            (r.DEFAULTS = { toggle: !0 }),
            (r.prototype.dimension = function () {
                var e = this.$element.hasClass("width");
                return e ? "width" : "height";
            }),
            (r.prototype.show = function () {
                if (!this.transitioning && !this.$element.hasClass("in")) {
                    var t,
                        i = this.$parent && this.$parent.children(".panel").children(".in, .collapsing");
                    if (!(i && i.length && ((t = i.data("bs.collapse")), t && t.transitioning))) {
                        var o = e.Event("show.bs.collapse");
                        if ((this.$element.trigger(o), !o.isDefaultPrevented())) {
                            i && i.length && (n.call(i, "hide"), t || i.data("bs.collapse", null));
                            var a = this.dimension();
                            this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded", !0), this.$trigger.removeClass("collapsed").attr("aria-expanded", !0), (this.transitioning = 1);
                            var s = function () {
                                this.$element.removeClass("collapsing").addClass("collapse in")[a](""), (this.transitioning = 0), this.$element.trigger("shown.bs.collapse");
                            };
                            if (!e.support.transition) return s.call(this);
                            var l = e.camelCase(["scroll", a].join("-"));
                            this.$element.one("bsTransitionEnd", e.proxy(s, this)).emulateTransitionEnd(r.TRANSITION_DURATION)[a](this.$element[0][l]);
                        }
                    }
                }
            }),
            (r.prototype.hide = function () {
                if (!this.transitioning && this.$element.hasClass("in")) {
                    var t = e.Event("hide.bs.collapse");
                    if ((this.$element.trigger(t), !t.isDefaultPrevented())) {
                        var n = this.dimension();
                        this.$element[n](this.$element[n]())[0].offsetHeight,
                            this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded", !1),
                            this.$trigger.addClass("collapsed").attr("aria-expanded", !1),
                            (this.transitioning = 1);
                        var i = function () {
                            (this.transitioning = 0), this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse");
                        };
                        return e.support.transition ? void this.$element[n](0).one("bsTransitionEnd", e.proxy(i, this)).emulateTransitionEnd(r.TRANSITION_DURATION) : i.call(this);
                    }
                }
            }),
            (r.prototype.toggle = function () {
                this[this.$element.hasClass("in") ? "hide" : "show"]();
            }),
            (r.prototype.getParent = function () {
                return e(this.options.parent)
                    .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
                    .each(
                        e.proxy(function (n, r) {
                            var i = e(r);
                            this.addAriaAndCollapsedClass(t(i), i);
                        }, this)
                    )
                    .end();
            }),
            (r.prototype.addAriaAndCollapsedClass = function (e, t) {
                var n = e.hasClass("in");
                e.attr("aria-expanded", n), t.toggleClass("collapsed", !n).attr("aria-expanded", n);
            });
        var i = e.fn.collapse;
        (e.fn.collapse = n),
            (e.fn.collapse.Constructor = r),
            (e.fn.collapse.noConflict = function () {
                return (e.fn.collapse = i), this;
            }),
            e(document).on("click.bs.collapse.data-api", '[data-toggle="collapse"]', function (r) {
                var i = e(this);
                i.attr("data-target") || r.preventDefault();
                var o = t(i),
                    a = o.data("bs.collapse"),
                    s = a ? "toggle" : i.data();
                n.call(o, s);
            });
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(t) {
            var n = t.attr("data-target");
            n || ((n = t.attr("href")), (n = n && /#[A-Za-z]/.test(n) && n.replace(/.*(?=#[^\s]*$)/, "")));
            var r = n && e(n);
            return r && r.length ? r : t.parent();
        }
        function n(n) {
            (n && 3 === n.which) ||
                (e(i).remove(),
                e(o).each(function () {
                    var r = e(this),
                        i = t(r),
                        o = { relatedTarget: this };
                    i.hasClass("open") &&
                        ((n && "click" == n.type && /input|textarea/i.test(n.target.tagName) && e.contains(i[0], n.target)) ||
                            (i.trigger((n = e.Event("hide.bs.dropdown", o))), n.isDefaultPrevented() || (r.attr("aria-expanded", "false"), i.removeClass("open").trigger(e.Event("hidden.bs.dropdown", o)))));
                }));
        }
        function r(t) {
            return this.each(function () {
                var n = e(this),
                    r = n.data("bs.dropdown");
                r || n.data("bs.dropdown", (r = new a(this))), "string" == typeof t && r[t].call(n);
            });
        }
        var i = ".dropdown-backdrop",
            o = '[data-toggle="dropdown"]',
            a = function (t) {
                e(t).on("click.bs.dropdown", this.toggle);
            };
        (a.VERSION = "3.3.7"),
            (a.prototype.toggle = function (r) {
                var i = e(this);
                if (!i.is(".disabled, :disabled")) {
                    var o = t(i),
                        a = o.hasClass("open");
                    if ((n(), !a)) {
                        "ontouchstart" in document.documentElement && !o.closest(".navbar-nav").length && e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click", n);
                        var s = { relatedTarget: this };
                        if ((o.trigger((r = e.Event("show.bs.dropdown", s))), r.isDefaultPrevented())) return;
                        i.trigger("focus").attr("aria-expanded", "true"), o.toggleClass("open").trigger(e.Event("shown.bs.dropdown", s));
                    }
                    return !1;
                }
            }),
            (a.prototype.keydown = function (n) {
                if (/(38|40|27|32)/.test(n.which) && !/input|textarea/i.test(n.target.tagName)) {
                    var r = e(this);
                    if ((n.preventDefault(), n.stopPropagation(), !r.is(".disabled, :disabled"))) {
                        var i = t(r),
                            a = i.hasClass("open");
                        if ((!a && 27 != n.which) || (a && 27 == n.which)) return 27 == n.which && i.find(o).trigger("focus"), r.trigger("click");
                        var s = " li:not(.disabled):visible a",
                            l = i.find(".dropdown-menu" + s);
                        if (l.length) {
                            var c = l.index(n.target);
                            38 == n.which && c > 0 && c--, 40 == n.which && c < l.length - 1 && c++, ~c || (c = 0), l.eq(c).trigger("focus");
                        }
                    }
                }
            });
        var s = e.fn.dropdown;
        (e.fn.dropdown = r),
            (e.fn.dropdown.Constructor = a),
            (e.fn.dropdown.noConflict = function () {
                return (e.fn.dropdown = s), this;
            }),
            e(document)
                .on("click.bs.dropdown.data-api", n)
                .on("click.bs.dropdown.data-api", ".dropdown form", function (e) {
                    e.stopPropagation();
                })
                .on("click.bs.dropdown.data-api", o, a.prototype.toggle)
                .on("keydown.bs.dropdown.data-api", o, a.prototype.keydown)
                .on("keydown.bs.dropdown.data-api", ".dropdown-menu", a.prototype.keydown);
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(t, r) {
            return this.each(function () {
                var i = e(this),
                    o = i.data("bs.modal"),
                    a = e.extend({}, n.DEFAULTS, i.data(), "object" == typeof t && t);
                o || i.data("bs.modal", (o = new n(this, a))), "string" == typeof t ? o[t](r) : a.show && o.show(r);
            });
        }
        var n = function (t, n) {
            (this.options = n),
                (this.$body = e(document.body)),
                (this.$element = e(t)),
                (this.$dialog = this.$element.find(".modal-dialog")),
                (this.$backdrop = null),
                (this.isShown = null),
                (this.originalBodyPad = null),
                (this.scrollbarWidth = 0),
                (this.ignoreBackdropClick = !1),
                this.options.remote &&
                    this.$element.find(".modal-content").load(
                        this.options.remote,
                        e.proxy(function () {
                            this.$element.trigger("loaded.bs.modal");
                        }, this)
                    );
        };
        (n.VERSION = "3.3.7"),
            (n.TRANSITION_DURATION = 300),
            (n.BACKDROP_TRANSITION_DURATION = 150),
            (n.DEFAULTS = { backdrop: !0, keyboard: !0, show: !0 }),
            (n.prototype.toggle = function (e) {
                return this.isShown ? this.hide() : this.show(e);
            }),
            (n.prototype.show = function (t) {
                var r = this,
                    i = e.Event("show.bs.modal", { relatedTarget: t });
                this.$element.trigger(i),
                    this.isShown ||
                        i.isDefaultPrevented() ||
                        ((this.isShown = !0),
                        this.checkScrollbar(),
                        this.setScrollbar(),
                        this.$body.addClass("modal-open"),
                        this.escape(),
                        this.resize(),
                        this.$element.on("click.dismiss.bs.modal", '[data-dismiss="modal"]', e.proxy(this.hide, this)),
                        this.$dialog.on("mousedown.dismiss.bs.modal", function () {
                            r.$element.one("mouseup.dismiss.bs.modal", function (t) {
                                e(t.target).is(r.$element) && (r.ignoreBackdropClick = !0);
                            });
                        }),
                        this.backdrop(function () {
                            var i = e.support.transition && r.$element.hasClass("fade");
                            r.$element.parent().length || r.$element.appendTo(r.$body), r.$element.show().scrollTop(0), r.adjustDialog(), i && r.$element[0].offsetWidth, r.$element.addClass("in"), r.enforceFocus();
                            var o = e.Event("shown.bs.modal", { relatedTarget: t });
                            i
                                ? r.$dialog
                                      .one("bsTransitionEnd", function () {
                                          r.$element.trigger("focus").trigger(o);
                                      })
                                      .emulateTransitionEnd(n.TRANSITION_DURATION)
                                : r.$element.trigger("focus").trigger(o);
                        }));
            }),
            (n.prototype.hide = function (t) {
                t && t.preventDefault(),
                    (t = e.Event("hide.bs.modal")),
                    this.$element.trigger(t),
                    this.isShown &&
                        !t.isDefaultPrevented() &&
                        ((this.isShown = !1),
                        this.escape(),
                        this.resize(),
                        e(document).off("focusin.bs.modal"),
                        this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),
                        this.$dialog.off("mousedown.dismiss.bs.modal"),
                        e.support.transition && this.$element.hasClass("fade") ? this.$element.one("bsTransitionEnd", e.proxy(this.hideModal, this)).emulateTransitionEnd(n.TRANSITION_DURATION) : this.hideModal());
            }),
            (n.prototype.enforceFocus = function () {
                e(document)
                    .off("focusin.bs.modal")
                    .on(
                        "focusin.bs.modal",
                        e.proxy(function (e) {
                            document === e.target || this.$element[0] === e.target || this.$element.has(e.target).length || this.$element.trigger("focus");
                        }, this)
                    );
            }),
            (n.prototype.escape = function () {
                this.isShown && this.options.keyboard
                    ? this.$element.on(
                          "keydown.dismiss.bs.modal",
                          e.proxy(function (e) {
                              27 == e.which && this.hide();
                          }, this)
                      )
                    : this.isShown || this.$element.off("keydown.dismiss.bs.modal");
            }),
            (n.prototype.resize = function () {
                this.isShown ? e(window).on("resize.bs.modal", e.proxy(this.handleUpdate, this)) : e(window).off("resize.bs.modal");
            }),
            (n.prototype.hideModal = function () {
                var e = this;
                this.$element.hide(),
                    this.backdrop(function () {
                        e.$body.removeClass("modal-open"), e.resetAdjustments(), e.resetScrollbar(), e.$element.trigger("hidden.bs.modal");
                    });
            }),
            (n.prototype.removeBackdrop = function () {
                this.$backdrop && this.$backdrop.remove(), (this.$backdrop = null);
            }),
            (n.prototype.backdrop = function (t) {
                var r = this,
                    i = this.$element.hasClass("fade") ? "fade" : "";
                if (this.isShown && this.options.backdrop) {
                    var o = e.support.transition && i;
                    if (
                        ((this.$backdrop = e(document.createElement("div"))
                            .addClass("modal-backdrop " + i)
                            .appendTo(this.$body)),
                        this.$element.on(
                            "click.dismiss.bs.modal",
                            e.proxy(function (e) {
                                return this.ignoreBackdropClick ? void (this.ignoreBackdropClick = !1) : void (e.target === e.currentTarget && ("static" == this.options.backdrop ? this.$element[0].focus() : this.hide()));
                            }, this)
                        ),
                        o && this.$backdrop[0].offsetWidth,
                        this.$backdrop.addClass("in"),
                        !t)
                    )
                        return;
                    o ? this.$backdrop.one("bsTransitionEnd", t).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION) : t();
                } else if (!this.isShown && this.$backdrop) {
                    this.$backdrop.removeClass("in");
                    var a = function () {
                        r.removeBackdrop(), t && t();
                    };
                    e.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one("bsTransitionEnd", a).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION) : a();
                } else t && t();
            }),
            (n.prototype.handleUpdate = function () {
                this.adjustDialog();
            }),
            (n.prototype.adjustDialog = function () {
                var e = this.$element[0].scrollHeight > document.documentElement.clientHeight;
                this.$element.css({ paddingLeft: !this.bodyIsOverflowing && e ? this.scrollbarWidth : "", paddingRight: this.bodyIsOverflowing && !e ? this.scrollbarWidth : "" });
            }),
            (n.prototype.resetAdjustments = function () {
                this.$element.css({ paddingLeft: "", paddingRight: "" });
            }),
            (n.prototype.checkScrollbar = function () {
                var e = window.innerWidth;
                if (!e) {
                    var t = document.documentElement.getBoundingClientRect();
                    e = t.right - Math.abs(t.left);
                }
                (this.bodyIsOverflowing = document.body.clientWidth < e), (this.scrollbarWidth = this.measureScrollbar());
            }),
            (n.prototype.setScrollbar = function () {
                var e = parseInt(this.$body.css("padding-right") || 0, 10);
                (this.originalBodyPad = document.body.style.paddingRight || ""), this.bodyIsOverflowing && this.$body.css("padding-right", e + this.scrollbarWidth);
            }),
            (n.prototype.resetScrollbar = function () {
                this.$body.css("padding-right", this.originalBodyPad);
            }),
            (n.prototype.measureScrollbar = function () {
                var e = document.createElement("div");
                (e.className = "modal-scrollbar-measure"), this.$body.append(e);
                var t = e.offsetWidth - e.clientWidth;
                return this.$body[0].removeChild(e), t;
            });
        var r = e.fn.modal;
        (e.fn.modal = t),
            (e.fn.modal.Constructor = n),
            (e.fn.modal.noConflict = function () {
                return (e.fn.modal = r), this;
            }),
            e(document).on("click.bs.modal.data-api", '[data-toggle="modal"]', function (n) {
                var r = e(this),
                    i = r.attr("href"),
                    o = e(r.attr("data-target") || (i && i.replace(/.*(?=#[^\s]+$)/, ""))),
                    a = o.data("bs.modal") ? "toggle" : e.extend({ remote: !/#/.test(i) && i }, o.data(), r.data());
                r.is("a") && n.preventDefault(),
                    o.one("show.bs.modal", function (e) {
                        e.isDefaultPrevented() ||
                            o.one("hidden.bs.modal", function () {
                                r.is(":visible") && r.trigger("focus");
                            });
                    }),
                    t.call(o, a, this);
            });
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var r = e(this),
                    i = r.data("bs.tooltip"),
                    o = "object" == typeof t && t;
                (!i && /destroy|hide/.test(t)) || (i || r.data("bs.tooltip", (i = new n(this, o))), "string" == typeof t && i[t]());
            });
        }
        var n = function (e, t) {
            (this.type = null), (this.options = null), (this.enabled = null), (this.timeout = null), (this.hoverState = null), (this.$element = null), (this.inState = null), this.init("tooltip", e, t);
        };
        (n.VERSION = "3.3.7"),
            (n.TRANSITION_DURATION = 150),
            (n.DEFAULTS = {
                animation: !0,
                placement: "top",
                selector: !1,
                template: '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
                trigger: "hover focus",
                title: "",
                delay: 0,
                html: !1,
                container: !1,
                viewport: { selector: "body", padding: 0 },
            }),
            (n.prototype.init = function (t, n, r) {
                if (
                    ((this.enabled = !0),
                    (this.type = t),
                    (this.$element = e(n)),
                    (this.options = this.getOptions(r)),
                    (this.$viewport = this.options.viewport && e(e.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : this.options.viewport.selector || this.options.viewport)),
                    (this.inState = { click: !1, hover: !1, focus: !1 }),
                    this.$element[0] instanceof document.constructor && !this.options.selector)
                )
                    throw new Error("`selector` option must be specified when initializing " + this.type + " on the window.document object!");
                for (var i = this.options.trigger.split(" "), o = i.length; o--; ) {
                    var a = i[o];
                    if ("click" == a) this.$element.on("click." + this.type, this.options.selector, e.proxy(this.toggle, this));
                    else if ("manual" != a) {
                        var s = "hover" == a ? "mouseenter" : "focusin",
                            l = "hover" == a ? "mouseleave" : "focusout";
                        this.$element.on(s + "." + this.type, this.options.selector, e.proxy(this.enter, this)), this.$element.on(l + "." + this.type, this.options.selector, e.proxy(this.leave, this));
                    }
                }
                this.options.selector ? (this._options = e.extend({}, this.options, { trigger: "manual", selector: "" })) : this.fixTitle();
            }),
            (n.prototype.getDefaults = function () {
                return n.DEFAULTS;
            }),
            (n.prototype.getOptions = function (t) {
                return (t = e.extend({}, this.getDefaults(), this.$element.data(), t)), t.delay && "number" == typeof t.delay && (t.delay = { show: t.delay, hide: t.delay }), t;
            }),
            (n.prototype.getDelegateOptions = function () {
                var t = {},
                    n = this.getDefaults();
                return (
                    this._options &&
                        e.each(this._options, function (e, r) {
                            n[e] != r && (t[e] = r);
                        }),
                    t
                );
            }),
            (n.prototype.enter = function (t) {
                var n = t instanceof this.constructor ? t : e(t.currentTarget).data("bs." + this.type);
                return (
                    n || ((n = new this.constructor(t.currentTarget, this.getDelegateOptions())), e(t.currentTarget).data("bs." + this.type, n)),
                    t instanceof e.Event && (n.inState["focusin" == t.type ? "focus" : "hover"] = !0),
                    n.tip().hasClass("in") || "in" == n.hoverState
                        ? void (n.hoverState = "in")
                        : (clearTimeout(n.timeout),
                          (n.hoverState = "in"),
                          n.options.delay && n.options.delay.show
                              ? void (n.timeout = setTimeout(function () {
                                    "in" == n.hoverState && n.show();
                                }, n.options.delay.show))
                              : n.show())
                );
            }),
            (n.prototype.isInStateTrue = function () {
                for (var e in this.inState) if (this.inState[e]) return !0;
                return !1;
            }),
            (n.prototype.leave = function (t) {
                var n = t instanceof this.constructor ? t : e(t.currentTarget).data("bs." + this.type);
                if (
                    (n || ((n = new this.constructor(t.currentTarget, this.getDelegateOptions())), e(t.currentTarget).data("bs." + this.type, n)),
                    t instanceof e.Event && (n.inState["focusout" == t.type ? "focus" : "hover"] = !1),
                    !n.isInStateTrue())
                )
                    return (
                        clearTimeout(n.timeout),
                        (n.hoverState = "out"),
                        n.options.delay && n.options.delay.hide
                            ? void (n.timeout = setTimeout(function () {
                                  "out" == n.hoverState && n.hide();
                              }, n.options.delay.hide))
                            : n.hide()
                    );
            }),
            (n.prototype.show = function () {
                var t = e.Event("show.bs." + this.type);
                if (this.hasContent() && this.enabled) {
                    this.$element.trigger(t);
                    var r = e.contains(this.$element[0].ownerDocument.documentElement, this.$element[0]);
                    if (t.isDefaultPrevented() || !r) return;
                    var i = this,
                        o = this.tip(),
                        a = this.getUID(this.type);
                    this.setContent(), o.attr("id", a), this.$element.attr("aria-describedby", a), this.options.animation && o.addClass("fade");
                    var s = "function" == typeof this.options.placement ? this.options.placement.call(this, o[0], this.$element[0]) : this.options.placement,
                        l = /\s?auto?\s?/i,
                        c = l.test(s);
                    c && (s = s.replace(l, "") || "top"),
                        o
                            .detach()
                            .css({ top: 0, left: 0, display: "block" })
                            .addClass(s)
                            .data("bs." + this.type, this),
                        this.options.container ? o.appendTo(this.options.container) : o.insertAfter(this.$element),
                        this.$element.trigger("inserted.bs." + this.type);
                    var u = this.getPosition(),
                        d = o[0].offsetWidth,
                        f = o[0].offsetHeight;
                    if (c) {
                        var h = s,
                            p = this.getPosition(this.$viewport);
                        (s = "bottom" == s && u.bottom + f > p.bottom ? "top" : "top" == s && u.top - f < p.top ? "bottom" : "right" == s && u.right + d > p.width ? "left" : "left" == s && u.left - d < p.left ? "right" : s),
                            o.removeClass(h).addClass(s);
                    }
                    var g = this.getCalculatedOffset(s, u, d, f);
                    this.applyPlacement(g, s);
                    var m = function () {
                        var e = i.hoverState;
                        i.$element.trigger("shown.bs." + i.type), (i.hoverState = null), "out" == e && i.leave(i);
                    };
                    e.support.transition && this.$tip.hasClass("fade") ? o.one("bsTransitionEnd", m).emulateTransitionEnd(n.TRANSITION_DURATION) : m();
                }
            }),
            (n.prototype.applyPlacement = function (t, n) {
                var r = this.tip(),
                    i = r[0].offsetWidth,
                    o = r[0].offsetHeight,
                    a = parseInt(r.css("margin-top"), 10),
                    s = parseInt(r.css("margin-left"), 10);
                isNaN(a) && (a = 0),
                    isNaN(s) && (s = 0),
                    (t.top += a),
                    (t.left += s),
                    e.offset.setOffset(
                        r[0],
                        e.extend(
                            {
                                using: function (e) {
                                    r.css({ top: Math.round(e.top), left: Math.round(e.left) });
                                },
                            },
                            t
                        ),
                        0
                    ),
                    r.addClass("in");
                var l = r[0].offsetWidth,
                    c = r[0].offsetHeight;
                "top" == n && c != o && (t.top = t.top + o - c);
                var u = this.getViewportAdjustedDelta(n, t, l, c);
                u.left ? (t.left += u.left) : (t.top += u.top);
                var d = /top|bottom/.test(n),
                    f = d ? 2 * u.left - i + l : 2 * u.top - o + c,
                    h = d ? "offsetWidth" : "offsetHeight";
                r.offset(t), this.replaceArrow(f, r[0][h], d);
            }),
            (n.prototype.replaceArrow = function (e, t, n) {
                this.arrow()
                    .css(n ? "left" : "top", 50 * (1 - e / t) + "%")
                    .css(n ? "top" : "left", "");
            }),
            (n.prototype.setContent = function () {
                var e = this.tip(),
                    t = this.getTitle();
                e.find(".tooltip-inner")[this.options.html ? "html" : "text"](t), e.removeClass("fade in top bottom left right");
            }),
            (n.prototype.hide = function (t) {
                function r() {
                    "in" != i.hoverState && o.detach(), i.$element && i.$element.removeAttr("aria-describedby").trigger("hidden.bs." + i.type), t && t();
                }
                var i = this,
                    o = e(this.$tip),
                    a = e.Event("hide.bs." + this.type);
                if ((this.$element.trigger(a), !a.isDefaultPrevented()))
                    return o.removeClass("in"), e.support.transition && o.hasClass("fade") ? o.one("bsTransitionEnd", r).emulateTransitionEnd(n.TRANSITION_DURATION) : r(), (this.hoverState = null), this;
            }),
            (n.prototype.fixTitle = function () {
                var e = this.$element;
                (e.attr("title") || "string" != typeof e.attr("data-original-title")) && e.attr("data-original-title", e.attr("title") || "").attr("title", "");
            }),
            (n.prototype.hasContent = function () {
                return this.getTitle();
            }),
            (n.prototype.getPosition = function (t) {
                t = t || this.$element;
                var n = t[0],
                    r = "BODY" == n.tagName,
                    i = n.getBoundingClientRect();
                null == i.width && (i = e.extend({}, i, { width: i.right - i.left, height: i.bottom - i.top }));
                var o = window.SVGElement && n instanceof window.SVGElement,
                    a = r ? { top: 0, left: 0 } : o ? null : t.offset(),
                    s = { scroll: r ? document.documentElement.scrollTop || document.body.scrollTop : t.scrollTop() },
                    l = r ? { width: e(window).width(), height: e(window).height() } : null;
                return e.extend({}, i, s, l, a);
            }),
            (n.prototype.getCalculatedOffset = function (e, t, n, r) {
                return "bottom" == e
                    ? { top: t.top + t.height, left: t.left + t.width / 2 - n / 2 }
                    : "top" == e
                    ? { top: t.top - r, left: t.left + t.width / 2 - n / 2 }
                    : "left" == e
                    ? { top: t.top + t.height / 2 - r / 2, left: t.left - n }
                    : { top: t.top + t.height / 2 - r / 2, left: t.left + t.width };
            }),
            (n.prototype.getViewportAdjustedDelta = function (e, t, n, r) {
                var i = { top: 0, left: 0 };
                if (!this.$viewport) return i;
                var o = (this.options.viewport && this.options.viewport.padding) || 0,
                    a = this.getPosition(this.$viewport);
                if (/right|left/.test(e)) {
                    var s = t.top - o - a.scroll,
                        l = t.top + o - a.scroll + r;
                    s < a.top ? (i.top = a.top - s) : l > a.top + a.height && (i.top = a.top + a.height - l);
                } else {
                    var c = t.left - o,
                        u = t.left + o + n;
                    c < a.left ? (i.left = a.left - c) : u > a.right && (i.left = a.left + a.width - u);
                }
                return i;
            }),
            (n.prototype.getTitle = function () {
                var e,
                    t = this.$element,
                    n = this.options;
                return (e = t.attr("data-original-title") || ("function" == typeof n.title ? n.title.call(t[0]) : n.title));
            }),
            (n.prototype.getUID = function (e) {
                do e += ~~(1e6 * Math.random());
                while (document.getElementById(e));
                return e;
            }),
            (n.prototype.tip = function () {
                if (!this.$tip && ((this.$tip = e(this.options.template)), 1 != this.$tip.length)) throw new Error(this.type + " `template` option must consist of exactly 1 top-level element!");
                return this.$tip;
            }),
            (n.prototype.arrow = function () {
                return (this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow"));
            }),
            (n.prototype.enable = function () {
                this.enabled = !0;
            }),
            (n.prototype.disable = function () {
                this.enabled = !1;
            }),
            (n.prototype.toggleEnabled = function () {
                this.enabled = !this.enabled;
            }),
            (n.prototype.toggle = function (t) {
                var n = this;
                t && ((n = e(t.currentTarget).data("bs." + this.type)), n || ((n = new this.constructor(t.currentTarget, this.getDelegateOptions())), e(t.currentTarget).data("bs." + this.type, n))),
                    t ? ((n.inState.click = !n.inState.click), n.isInStateTrue() ? n.enter(n) : n.leave(n)) : n.tip().hasClass("in") ? n.leave(n) : n.enter(n);
            }),
            (n.prototype.destroy = function () {
                var e = this;
                clearTimeout(this.timeout),
                    this.hide(function () {
                        e.$element.off("." + e.type).removeData("bs." + e.type), e.$tip && e.$tip.detach(), (e.$tip = null), (e.$arrow = null), (e.$viewport = null), (e.$element = null);
                    });
            });
        var r = e.fn.tooltip;
        (e.fn.tooltip = t),
            (e.fn.tooltip.Constructor = n),
            (e.fn.tooltip.noConflict = function () {
                return (e.fn.tooltip = r), this;
            });
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var r = e(this),
                    i = r.data("bs.popover"),
                    o = "object" == typeof t && t;
                (!i && /destroy|hide/.test(t)) || (i || r.data("bs.popover", (i = new n(this, o))), "string" == typeof t && i[t]());
            });
        }
        var n = function (e, t) {
            this.init("popover", e, t);
        };
        if (!e.fn.tooltip) throw new Error("Popover requires tooltip.js");
        (n.VERSION = "3.3.7"),
            (n.DEFAULTS = e.extend({}, e.fn.tooltip.Constructor.DEFAULTS, {
                placement: "right",
                trigger: "click",
                content: "",
                template: '<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',
            })),
            (n.prototype = e.extend({}, e.fn.tooltip.Constructor.prototype)),
            (n.prototype.constructor = n),
            (n.prototype.getDefaults = function () {
                return n.DEFAULTS;
            }),
            (n.prototype.setContent = function () {
                var e = this.tip(),
                    t = this.getTitle(),
                    n = this.getContent();
                e.find(".popover-title")[this.options.html ? "html" : "text"](t),
                    e.find(".popover-content").children().detach().end()[this.options.html ? ("string" == typeof n ? "html" : "append") : "text"](n),
                    e.removeClass("fade top bottom left right in"),
                    e.find(".popover-title").html() || e.find(".popover-title").hide();
            }),
            (n.prototype.hasContent = function () {
                return this.getTitle() || this.getContent();
            }),
            (n.prototype.getContent = function () {
                var e = this.$element,
                    t = this.options;
                return e.attr("data-content") || ("function" == typeof t.content ? t.content.call(e[0]) : t.content);
            }),
            (n.prototype.arrow = function () {
                return (this.$arrow = this.$arrow || this.tip().find(".arrow"));
            });
        var r = e.fn.popover;
        (e.fn.popover = t),
            (e.fn.popover.Constructor = n),
            (e.fn.popover.noConflict = function () {
                return (e.fn.popover = r), this;
            });
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(n, r) {
            (this.$body = e(document.body)),
                (this.$scrollElement = e(e(n).is(document.body) ? window : n)),
                (this.options = e.extend({}, t.DEFAULTS, r)),
                (this.selector = (this.options.target || "") + " .nav li > a"),
                (this.offsets = []),
                (this.targets = []),
                (this.activeTarget = null),
                (this.scrollHeight = 0),
                this.$scrollElement.on("scroll.bs.scrollspy", e.proxy(this.process, this)),
                this.refresh(),
                this.process();
        }
        function n(n) {
            return this.each(function () {
                var r = e(this),
                    i = r.data("bs.scrollspy"),
                    o = "object" == typeof n && n;
                i || r.data("bs.scrollspy", (i = new t(this, o))), "string" == typeof n && i[n]();
            });
        }
        (t.VERSION = "3.3.7"),
            (t.DEFAULTS = { offset: 10 }),
            (t.prototype.getScrollHeight = function () {
                return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight);
            }),
            (t.prototype.refresh = function () {
                var t = this,
                    n = "offset",
                    r = 0;
                (this.offsets = []),
                    (this.targets = []),
                    (this.scrollHeight = this.getScrollHeight()),
                    e.isWindow(this.$scrollElement[0]) || ((n = "position"), (r = this.$scrollElement.scrollTop())),
                    this.$body
                        .find(this.selector)
                        .map(function () {
                            var t = e(this),
                                i = t.data("target") || t.attr("href"),
                                o = /^#./.test(i) && e(i);
                            return (o && o.length && o.is(":visible") && [[o[n]().top + r, i]]) || null;
                        })
                        .sort(function (e, t) {
                            return e[0] - t[0];
                        })
                        .each(function () {
                            t.offsets.push(this[0]), t.targets.push(this[1]);
                        });
            }),
            (t.prototype.process = function () {
                var e,
                    t = this.$scrollElement.scrollTop() + this.options.offset,
                    n = this.getScrollHeight(),
                    r = this.options.offset + n - this.$scrollElement.height(),
                    i = this.offsets,
                    o = this.targets,
                    a = this.activeTarget;
                if ((this.scrollHeight != n && this.refresh(), t >= r)) return a != (e = o[o.length - 1]) && this.activate(e);
                if (a && t < i[0]) return (this.activeTarget = null), this.clear();
                for (e = i.length; e--; ) a != o[e] && t >= i[e] && (void 0 === i[e + 1] || t < i[e + 1]) && this.activate(o[e]);
            }),
            (t.prototype.activate = function (t) {
                (this.activeTarget = t), this.clear();
                var n = this.selector + '[data-target="' + t + '"],' + this.selector + '[href="' + t + '"]',
                    r = e(n).parents("li").addClass("active");
                r.parent(".dropdown-menu").length && (r = r.closest("li.dropdown").addClass("active")), r.trigger("activate.bs.scrollspy");
            }),
            (t.prototype.clear = function () {
                e(this.selector).parentsUntil(this.options.target, ".active").removeClass("active");
            });
        var r = e.fn.scrollspy;
        (e.fn.scrollspy = n),
            (e.fn.scrollspy.Constructor = t),
            (e.fn.scrollspy.noConflict = function () {
                return (e.fn.scrollspy = r), this;
            }),
            e(window).on("load.bs.scrollspy.data-api", function () {
                e('[data-spy="scroll"]').each(function () {
                    var t = e(this);
                    n.call(t, t.data());
                });
            });
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var r = e(this),
                    i = r.data("bs.tab");
                i || r.data("bs.tab", (i = new n(this))), "string" == typeof t && i[t]();
            });
        }
        var n = function (t) {
            this.element = e(t);
        };
        (n.VERSION = "3.3.7"),
            (n.TRANSITION_DURATION = 150),
            (n.prototype.show = function () {
                var t = this.element,
                    n = t.closest("ul:not(.dropdown-menu)"),
                    r = t.data("target");
                if ((r || ((r = t.attr("href")), (r = r && r.replace(/.*(?=#[^\s]*$)/, ""))), !t.parent("li").hasClass("active"))) {
                    var i = n.find(".active:last a"),
                        o = e.Event("hide.bs.tab", { relatedTarget: t[0] }),
                        a = e.Event("show.bs.tab", { relatedTarget: i[0] });
                    if ((i.trigger(o), t.trigger(a), !a.isDefaultPrevented() && !o.isDefaultPrevented())) {
                        var s = e(r);
                        this.activate(t.closest("li"), n),
                            this.activate(s, s.parent(), function () {
                                i.trigger({ type: "hidden.bs.tab", relatedTarget: t[0] }), t.trigger({ type: "shown.bs.tab", relatedTarget: i[0] });
                            });
                    }
                }
            }),
            (n.prototype.activate = function (t, r, i) {
                function o() {
                    a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded", !1),
                        t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded", !0),
                        s ? (t[0].offsetWidth, t.addClass("in")) : t.removeClass("fade"),
                        t.parent(".dropdown-menu").length && t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded", !0),
                        i && i();
                }
                var a = r.find("> .active"),
                    s = i && e.support.transition && ((a.length && a.hasClass("fade")) || !!r.find("> .fade").length);
                a.length && s ? a.one("bsTransitionEnd", o).emulateTransitionEnd(n.TRANSITION_DURATION) : o(), a.removeClass("in");
            });
        var r = e.fn.tab;
        (e.fn.tab = t),
            (e.fn.tab.Constructor = n),
            (e.fn.tab.noConflict = function () {
                return (e.fn.tab = r), this;
            });
        var i = function (n) {
            n.preventDefault(), t.call(e(this), "show");
        };
        e(document).on("click.bs.tab.data-api", '[data-toggle="tab"]', i).on("click.bs.tab.data-api", '[data-toggle="pill"]', i);
    })(jQuery),
    +(function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var r = e(this),
                    i = r.data("bs.affix"),
                    o = "object" == typeof t && t;
                i || r.data("bs.affix", (i = new n(this, o))), "string" == typeof t && i[t]();
            });
        }
        var n = function (t, r) {
            (this.options = e.extend({}, n.DEFAULTS, r)),
                (this.$target = e(this.options.target).on("scroll.bs.affix.data-api", e.proxy(this.checkPosition, this)).on("click.bs.affix.data-api", e.proxy(this.checkPositionWithEventLoop, this))),
                (this.$element = e(t)),
                (this.affixed = null),
                (this.unpin = null),
                (this.pinnedOffset = null),
                this.checkPosition();
        };
        (n.VERSION = "3.3.7"),
            (n.RESET = "affix affix-top affix-bottom"),
            (n.DEFAULTS = { offset: 0, target: window }),
            (n.prototype.getState = function (e, t, n, r) {
                var i = this.$target.scrollTop(),
                    o = this.$element.offset(),
                    a = this.$target.height();
                if (null != n && "top" == this.affixed) return i < n && "top";
                if ("bottom" == this.affixed) return null != n ? !(i + this.unpin <= o.top) && "bottom" : !(i + a <= e - r) && "bottom";
                var s = null == this.affixed,
                    l = s ? i : o.top,
                    c = s ? a : t;
                return null != n && i <= n ? "top" : null != r && l + c >= e - r && "bottom";
            }),
            (n.prototype.getPinnedOffset = function () {
                if (this.pinnedOffset) return this.pinnedOffset;
                this.$element.removeClass(n.RESET).addClass("affix");
                var e = this.$target.scrollTop(),
                    t = this.$element.offset();
                return (this.pinnedOffset = t.top - e);
            }),
            (n.prototype.checkPositionWithEventLoop = function () {
                setTimeout(e.proxy(this.checkPosition, this), 1);
            }),
            (n.prototype.checkPosition = function () {
                if (this.$element.is(":visible")) {
                    var t = this.$element.height(),
                        r = this.options.offset,
                        i = r.top,
                        o = r.bottom,
                        a = Math.max(e(document).height(), e(document.body).height());
                    "object" != typeof r && (o = i = r), "function" == typeof i && (i = r.top(this.$element)), "function" == typeof o && (o = r.bottom(this.$element));
                    var s = this.getState(a, t, i, o);
                    if (this.affixed != s) {
                        null != this.unpin && this.$element.css("top", "");
                        var l = "affix" + (s ? "-" + s : ""),
                            c = e.Event(l + ".bs.affix");
                        if ((this.$element.trigger(c), c.isDefaultPrevented())) return;
                        (this.affixed = s),
                            (this.unpin = "bottom" == s ? this.getPinnedOffset() : null),
                            this.$element
                                .removeClass(n.RESET)
                                .addClass(l)
                                .trigger(l.replace("affix", "affixed") + ".bs.affix");
                    }
                    "bottom" == s && this.$element.offset({ top: a - t - o });
                }
            });
        var r = e.fn.affix;
        (e.fn.affix = t),
            (e.fn.affix.Constructor = n),
            (e.fn.affix.noConflict = function () {
                return (e.fn.affix = r), this;
            }),
            e(window).on("load", function () {
                e('[data-spy="affix"]').each(function () {
                    var n = e(this),
                        r = n.data();
                    (r.offset = r.offset || {}), null != r.offsetBottom && (r.offset.bottom = r.offsetBottom), null != r.offsetTop && (r.offset.top = r.offsetTop), t.call(n, r);
                });
            });
    })(jQuery),
    define("bootstrap", ["jquery"], (function (e) {
        return function () {
            var t;
            return t || e.bootstrap;
        };
    })(this)),
    (function (e) {
        "use strict";
        var t = function (e) {
                return (e || "ui-id") + "-" + Math.floor(1e3 * Math.random() + 1);
            },
            n = function (t, n) {
                var i,
                    o,
                    a,
                    s = t.nodeName.toLowerCase();
                return "area" === s
                    ? ((i = t.parentNode), (o = i.name), !(!t.href || !o || "map" !== i.nodeName.toLowerCase()) && ((a = e("img[usemap='#" + o + "']")[0]), !!a && r(a)))
                    : (/input|select|textarea|button|object/.test(s) ? !t.disabled : "a" === s ? t.href || n : n) && r(t);
            },
            r = function (t) {
                return (
                    e.expr.filters.visible(t) &&
                    !e(t)
                        .parents()
                        .addBack()
                        .filter(function () {
                            return "hidden" === e.css(this, "visibility");
                        }).length
                );
            };
        e.extend(e.expr[":"], {
            data: e.expr.createPseudo
                ? e.expr.createPseudo(function (t) {
                      return function (n) {
                          return !!e.data(n, t);
                      };
                  })
                : function (t, n, r) {
                      return !!e.data(t, r[3]);
                  },
            focusable: function (t) {
                return n(t, !isNaN(e.attr(t, "tabindex")));
            },
            tabbable: function (t) {
                var r = e.attr(t, "tabindex"),
                    i = isNaN(r);
                return (i || r >= 0) && n(t, !i);
            },
        }),
            e(".modal-dialog").attr({ role: "document" });
        var i = e.fn.modal.Constructor.prototype.hide;
        e.fn.modal.Constructor.prototype.hide = function () {
            i.apply(this, arguments), e(document).off("keydown.bs.modal");
        };
        var o = e.fn.modal.Constructor.prototype.enforceFocus;
        e.fn.modal.Constructor.prototype.enforceFocus = function () {
            var t = this.$element.find(".modal-content"),
                n = t.find(":tabbable"),
                r = e(n[n.length - 1]),
                i = e(n[0]);
            r.on(
                "keydown.bs.modal",
                e.proxy(function (e) {
                    9 !== e.keyCode || e.shiftKey | e.ctrlKey | e.metaKey | e.altKey || (e.preventDefault(), i.focus());
                }, this)
            ),
                i.on(
                    "keydown.bs.modal",
                    e.proxy(function (e) {
                        9 === e.keyCode && e.shiftKey && (e.preventDefault(), r.focus());
                    }, this)
                ),
                o.apply(this, arguments);
        };
        var a,
            s,
            l = "[data-toggle=dropdown]",
            c = 200,
            u = e(l).parent().find("ul").attr("role", "menu"),
            d = u.find("li").attr("role", "presentation");
        d.find("a").attr({ role: "menuitem", tabIndex: "-1" }),
            e(l).attr({ "aria-haspopup": "true", "aria-expanded": "false" }),
            e(l)
                .parent()
                .on("shown.bs.dropdown", function (t) {
                    a = e(this);
                    var n = a.find(l);
                    n.attr("aria-expanded", "true"),
                        n.on(
                            "keydown.bs.dropdown",
                            e.proxy(function (t) {
                                setTimeout(function () {
                                    s = e(".dropdown-menu [role=menuitem]:visible", a)[0];
                                    try {
                                        s.focus();
                                    } catch (e) {}
                                }, c);
                            }, this)
                        );
                })
                .on("hidden.bs.dropdown", function (t) {
                    a = e(this);
                    var n = a.find(l);
                    n.attr("aria-expanded", "false");
                }),
            e(document)
                .on("focusout.dropdown.data-api", ".dropdown-menu", function (t) {
                    var n = e(this),
                        r = this;
                    n.parent().hasClass("open") &&
                        setTimeout(function () {
                            e.contains(r, document.activeElement) || n.parent().find("[data-toggle=dropdown]").dropdown("toggle");
                        }, 150);
                })
                .on("keydown.bs.dropdown.data-api", l + ", [role=menu]", e.fn.dropdown.Constructor.prototype.keydown);
        var f = e(".nav-tabs, .nav-pills"),
            h = f.children("li"),
            p = f.find('[data-toggle="tab"], [data-toggle="pill"]');
        p && (f.attr("role", "tablist"), h.attr("role", "presentation"), p.attr("role", "tab")),
            p.each(function (n) {
                var r = e(e(this).attr("href")),
                    i = e(this),
                    o = i.attr("id") || t("ui-tab");
                i.attr("id", o),
                    i.parent().hasClass("active")
                        ? (i.attr({ tabIndex: "0", "aria-selected": "true", "aria-controls": i.attr("href").substr(1) }), r.attr({ role: "tabpanel", tabIndex: "0", "aria-hidden": "false", "aria-labelledby": o }))
                        : (i.attr({ tabIndex: "-1", "aria-selected": "false", "aria-controls": i.attr("href").substr(1) }), r.attr({ role: "tabpanel", tabIndex: "-1", "aria-hidden": "true", "aria-labelledby": o }));
            }),
            (e.fn.tab.Constructor.prototype.keydown = function (t) {
                var n,
                    r,
                    i = e(this),
                    o = i.closest("ul[role=tablist] "),
                    a = t.which || t.keyCode;
                if (((i = e(this)), /(37|38|39|40)/.test(a))) {
                    (n = o.find("[role=tab]:visible")), (r = n.index(n.filter(":focus"))), (38 != a && 37 != a) || r--, (39 != a && 40 != a) || r++, r < 0 && (r = n.length - 1), r == n.length && (r = 0);
                    var s = n.eq(r);
                    "tab" === s.attr("role") && s.tab("show").focus(), t.preventDefault(), t.stopPropagation();
                }
            }),
            e(document).on("keydown.tab.data-api", '[data-toggle="tab"], [data-toggle="pill"]', e.fn.tab.Constructor.prototype.keydown);
        var g = e.fn.tab.Constructor.prototype.activate;
        e.fn.tab.Constructor.prototype.activate = function (e, t, n) {
            var r = t.find("> .active");
            r.find("[data-toggle=tab], [data-toggle=pill]").attr({ tabIndex: "-1", "aria-selected": !1 }),
                r.filter(".tab-pane").attr({ "aria-hidden": !0, tabIndex: "-1" }),
                g.apply(this, arguments),
                e.addClass("active"),
                e.find("[data-toggle=tab], [data-toggle=pill]").attr({ tabIndex: "0", "aria-selected": !0 }),
                e.filter(".tab-pane").attr({ "aria-hidden": !1, tabIndex: "0" });
        };
        var m = e('[data-toggle="collapse"]');
        m.each(function (n) {
            var r = e(this),
                i = e(r.attr("data-target") ? r.attr("data-target") : r.attr("href")),
                o = r.attr("data-parent"),
                a = o && e(o),
                s = r.attr("id") || t("ui-collapse");
            r.attr("id", s),
                a &&
                    (r.attr({ role: "tab", "aria-selected": "false", "aria-expanded": "false" }),
                    e(a).find("div:not(.collapse,.panel-body), h4").attr("role", "presentation"),
                    a.attr({ role: "tablist", "aria-multiselectable": "true" }),
                    i.hasClass("in")
                        ? (r.attr({ "aria-controls": i.attr("id"), "aria-selected": "true", "aria-expanded": "true", tabindex: "0" }), i.attr({ role: "tabpanel", tabindex: "0", "aria-labelledby": s, "aria-hidden": "false" }))
                        : (r.attr({ "aria-controls": i.attr("id"), tabindex: "-1" }), i.attr({ role: "tabpanel", tabindex: "-1", "aria-labelledby": s, "aria-hidden": "true" })));
        });
        var v = e.fn.collapse.Constructor.prototype.toggle;
        (e.fn.collapse.Constructor.prototype.toggle = function () {
            var t,
                n = this.$parent && this.$parent.find('[aria-expanded="true"]');
            if (n) {
                var r,
                    i = n.attr("data-target") || ((t = n.attr("href")) && t.replace(/.*(?=#[^\s]+$)/, "")),
                    o = e(i),
                    a = this.$element;
                this.$parent;
                this.$parent && (r = this.$parent.find('[data-toggle=collapse][href="#' + this.$element.attr("id") + '"]')),
                    v.apply(this, arguments),
                    e.support.transition &&
                        this.$element.one(e.support.transition.end, function () {
                            n.attr({ "aria-selected": "false", "aria-expanded": "false", tabIndex: "-1" }),
                                o.attr({ "aria-hidden": "true", tabIndex: "-1" }),
                                r.attr({ "aria-selected": "true", "aria-expanded": "true", tabIndex: "0" }),
                                a.hasClass("in") ? a.attr({ "aria-hidden": "false", tabIndex: "0" }) : (r.attr({ "aria-selected": "false", "aria-expanded": "false" }), a.attr({ "aria-hidden": "true", tabIndex: "-1" }));
                        });
            } else v.apply(this, arguments);
        }),
            (e.fn.collapse.Constructor.prototype.keydown = function (t) {
                var n,
                    r,
                    i = e(this),
                    o = i.closest("div[role=tablist] "),
                    a = t.which || t.keyCode;
                (i = e(this)),
                    /(32|37|38|39|40)/.test(a) &&
                        (32 == a && i.click(),
                        (n = o.find("[role=tab]")),
                        (r = n.index(n.filter(":focus"))),
                        (38 != a && 37 != a) || r--,
                        (39 != a && 40 != a) || r++,
                        r < 0 && (r = n.length - 1),
                        r == n.length && (r = 0),
                        n.eq(r).focus(),
                        t.preventDefault(),
                        t.stopPropagation());
            }),
            e(document).on("keydown.collapse.data-api", '[data-toggle="collapse"]', e.fn.collapse.Constructor.prototype.keydown),
            e(".carousel").each(function (t) {
                function n() {
                    var t,
                        n,
                        r,
                        o,
                        a = {};
                    (a.top = 0), (a.left = 32e3), (a.height = 0), (a.width = 0);
                    for (var s = 0; s < h.length; s++) {
                        (t = h[s]), (n = e(t).offset()), (r = e(t).height()), (o = e(t).width()), a.top < n.top && (a.top = Math.round(n.top)), a.height < r && (a.height = Math.round(r)), a.left > n.left && (a.left = Math.round(n.left));
                        var l = n.left - a.left + Math.round(o);
                        a.width < l && (a.width = l);
                    }
                    (i.style.top = a.top - 2 + "px"), (i.style.left = a.left - 2 + "px"), (i.style.height = a.height + 7 + "px"), (i.style.width = a.width + 8 + "px");
                }
                var r,
                    i,
                    o,
                    a,
                    s,
                    l,
                    c = e(this),
                    u = c.find('[data-slide="prev"]'),
                    d = c.find('[data-slide="next"]'),
                    f = c.find(".carousel-indicators"),
                    h = c.find(".carousel-indicators li"),
                    p = c.find(".item"),
                    g = !1,
                    m = "id_title",
                    v = "id_desc";
                for (
                    f.attr("role", "tablist"),
                        h.focus(function () {
                            c.carousel("pause"), (g = !0), (o.innerHTML = "Play Carousel"), e(this).parent().addClass("active"), n(), e(i).addClass("focus"), e(this).parents(".carousel").addClass("contrast");
                        }),
                        h.blur(function (t) {
                            e(this).parent().removeClass("active"), e(i).removeClass("focus"), e(this).parents(".carousel").removeClass("contrast");
                        }),
                        l = 0;
                    l < p.length;
                    l++
                )
                    (r = p[l]), r.setAttribute("role", "tabpanel"), r.setAttribute("id", "tabpanel-" + t + "-" + l), r.setAttribute("aria-labelledby", "tab-" + t + "-" + l);
                for (
                    "string" != typeof c.attr("role") &&
                        (c.attr("role", "complementary"),
                        c.attr("aria-labelledby", m),
                        c.attr("aria-describedby", v),
                        c.prepend(
                            '<p  id="' +
                                v +
                                '" class="sr-only">A carousel is a rotating set of images, rotation stops on keyboard focus on carousel tab controls or hovering the mouse pointer over images.  Use the tabs or the previous and next buttons to change the displayed slide.</p>'
                        ),
                        c.prepend('<h2 id="' + m + '" class="sr-only">Carousel content with ' + p.length + " slides.</h2>")),
                        l = 0;
                    l < h.length;
                    l++
                ) {
                    (s = h[l]), s.setAttribute("role", "tab"), s.setAttribute("id", "tab-" + t + "-" + l), s.setAttribute("aria-controls", "tabpanel-" + t + "-" + l);
                    var b = "#tabpanel-" + t + "-" + l,
                        y = c.find(b).find("h1").text();
                    ("string" == typeof y && 0 !== y.length) || (y = c.find(b).text()),
                        ("string" == typeof y && 0 !== y.length) || (y = c.find(b).find("h3").text()),
                        ("string" == typeof y && 0 !== y.length) || (y = c.find(b).find("h4").text()),
                        ("string" == typeof y && 0 !== y.length) || (y = c.find(b).find("h5").text()),
                        ("string" == typeof y && 0 !== y.length) || (y = c.find(b).find("h6").text()),
                        ("string" == typeof y && 0 !== y.length) || (y = "no title");
                    var _ = document.createElement("span");
                    _.setAttribute("class", "sr-only"), (_.innerHTML = "Slide " + (l + 1)), y && (_.innerHTML += ": " + y), s.appendChild(_);
                }
                (i = document.createElement("div")),
                    (i.className = "carousel-tablist-highlight"),
                    document.body.appendChild(i),
                    (a = document.createElement("aside")),
                    a.setAttribute("class", "carousel-aside-pause"),
                    a.setAttribute("aria-label", "carousel pause/play control"),
                    c.prepend(a),
                    (o = document.createElement("button")),
                    (o.className = "carousel-pause-button"),
                    (o.innerHTML = "Pause Carousel"),
                    o.setAttribute("title", "Pause/Play carousel button can be used by screen reader users to stop carousel animations"),
                    e(a).append(o),
                    e(o).click(function () {
                        g ? ((o.innerHTML = "Pause Carousel"), c.carousel("cycle"), (g = !1)) : ((o.innerHTML = "Play Carousel"), c.carousel("pause"), (g = !0));
                    }),
                    e(o).focus(function () {
                        e(this).addClass("focus");
                    }),
                    e(o).blur(function () {
                        e(this).removeClass("focus");
                    }),
                    n(),
                    e(window).resize(function () {
                        n();
                    }),
                    u.attr("aria-label", "Previous Slide"),
                    u.keydown(function (e) {
                        var t = e.which || e.keyCode;
                        /(13|32)/.test(t) && (e.preventDefault(), e.stopPropagation(), u.trigger("click"));
                    }),
                    u.focus(function () {
                        e(this).parents(".carousel").addClass("contrast");
                    }),
                    u.blur(function () {
                        e(this).parents(".carousel").removeClass("contrast");
                    }),
                    d.attr("aria-label", "Next Slide"),
                    d.keydown(function (e) {
                        var t = e.which || e.keyCode;
                        /(13|32)/.test(t) && (e.preventDefault(), e.stopPropagation(), d.trigger("click"));
                    }),
                    d.focus(function () {
                        e(this).parents(".carousel").addClass("contrast");
                    }),
                    d.blur(function () {
                        e(this).parents(".carousel").removeClass("contrast");
                    }),
                    e(".carousel-inner a").focus(function () {
                        e(this).parents(".carousel").addClass("contrast");
                    }),
                    e(".carousel-inner a").blur(function () {
                        e(this).parents(".carousel").removeClass("contrast");
                    }),
                    h.each(function () {
                        var t = e(this);
                        t.hasClass("active") ? t.attr({ "aria-selected": "true", tabindex: "0" }) : t.attr({ "aria-selected": "false", tabindex: "-1" });
                    });
            });
        var b = e.fn.carousel.Constructor.prototype.slide;
        e.fn.carousel.Constructor.prototype.slide = function (e, t) {
            var n,
                r = this.$element,
                i = r.find("[role=tabpanel].active"),
                o = t || i[e](),
                a = r.find("[role=tabpanel]").size(),
                s = r.find('[data-slide="prev"]'),
                l = r.find('[data-slide="next"]'),
                c = 0,
                u = a - 1,
                d = 1;
            o && o.attr("id") && ((n = o.attr("id")), (c = n.lastIndexOf("-")), c >= 0 && (c = parseInt(n.substring(c + 1), 10)), (u = c - 1), u < 1 && (u = a - 1), (d = c + 1), d >= a && (d = 0)),
                s.attr("aria-label", "Show slide " + (u + 1) + " of " + a),
                l.attr("aria-label", "Show slide " + (d + 1) + " of " + a),
                b.apply(this, arguments),
                i.one("bsTransitionEnd", function () {
                    var e;
                    (e = r.find('li[aria-controls="' + i.attr("id") + '"]')),
                        e && e.attr({ "aria-selected": !1, tabIndex: "-1" }),
                        (e = r.find('li[aria-controls="' + o.attr("id") + '"]')),
                        e && e.attr({ "aria-selected": !0, tabIndex: "0" });
                });
        };
        var y;
        (e.fn.carousel.Constructor.prototype.keydown = function (t) {
            function n(e) {
                e >= o.length ||
                    e < 0 ||
                    (i.carousel(e),
                    setTimeout(function () {
                        o[e].focus();
                    }, 150));
            }
            (y = y || e(this)), this instanceof Node && (y = e(this));
            var r,
                i = e(t.target).closest(".carousel"),
                o = i.find("[role=tab]"),
                a = t.which || t.keyCode;
            /(37|38|39|40)/.test(a) && ((r = o.index(o.filter(".active"))), (37 != a && 38 != a) || (r--, n(r)), (39 != a && 40 != a) || (r++, n(r)), t.preventDefault(), t.stopPropagation());
        }),
            e(document).on("keydown.carousel.data-api", "li[role=tab]", e.fn.carousel.Constructor.prototype.keydown);
    })(jQuery),
    define("bootstrapA11y", ["bootstrap"], (function (e) {
        return function () {
            var t;
            return t || e.bootstrapA11y;
        };
    })(this)),
    (function (e, t) {
        "object" == typeof module && module.exports ? (module.exports = t()) : "function" == typeof define && define.amd ? define("spin", t) : (e.Spinner = t());
    })(this, function () {
        "use strict";
        function e(e, t) {
            var n,
                r = document.createElement(e || "div");
            for (n in t) r[n] = t[n];
            return r;
        }
        function t(e) {
            for (var t = 1, n = arguments.length; t < n; t++) e.appendChild(arguments[t]);
            return e;
        }
        function n(e, t, n, r) {
            var i = ["opacity", t, ~~(100 * e), n, r].join("-"),
                o = 0.01 + (n / r) * 100,
                a = Math.max(1 - ((1 - e) / t) * (100 - o), e),
                s = c.substring(0, c.indexOf("Animation")).toLowerCase(),
                l = (s && "-" + s + "-") || "";
            return (
                f[i] ||
                    (u.insertRule("@" + l + "keyframes " + i + "{0%{opacity:" + a + "}" + o + "%{opacity:" + e + "}" + (o + 0.01) + "%{opacity:1}" + ((o + t) % 100) + "%{opacity:" + e + "}100%{opacity:" + a + "}}", u.cssRules.length),
                    (f[i] = 1)),
                i
            );
        }
        function r(e, t) {
            var n,
                r,
                i = e.style;
            if (((t = t.charAt(0).toUpperCase() + t.slice(1)), void 0 !== i[t])) return t;
            for (r = 0; r < d.length; r++) if (((n = d[r] + t), void 0 !== i[n])) return n;
        }
        function i(e, t) {
            for (var n in t) e.style[r(e, n) || n] = t[n];
            return e;
        }
        function o(e) {
            for (var t = 1; t < arguments.length; t++) {
                var n = arguments[t];
                for (var r in n) void 0 === e[r] && (e[r] = n[r]);
            }
            return e;
        }
        function a(e, t) {
            return "string" == typeof e ? e : e[t % e.length];
        }
        function s(e) {
            this.opts = o(e || {}, s.defaults, h);
        }
        function l() {
            function n(t, n) {
                return e("<" + t + ' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">', n);
            }
            u.addRule(".spin-vml", "behavior:url(#default#VML)"),
                (s.prototype.lines = function (e, r) {
                    function o() {
                        return i(n("group", { coordsize: u + " " + u, coordorigin: -c + " " + -c }), { width: u, height: u });
                    }
                    function s(e, s, l) {
                        t(
                            f,
                            t(
                                i(o(), { rotation: (360 / r.lines) * e + "deg", left: ~~s }),
                                t(
                                    i(n("roundrect", { arcsize: r.corners }), { width: c, height: r.scale * r.width, left: r.scale * r.radius, top: (-r.scale * r.width) >> 1, filter: l }),
                                    n("fill", { color: a(r.color, e), opacity: r.opacity }),
                                    n("stroke", { opacity: 0 })
                                )
                            )
                        );
                    }
                    var l,
                        c = r.scale * (r.length + r.width),
                        u = 2 * r.scale * c,
                        d = -(r.width + r.length) * r.scale * 2 + "px",
                        f = i(o(), { position: "absolute", top: d, left: d });
                    if (r.shadow) for (l = 1; l <= r.lines; l++) s(l, -2, "progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");
                    for (l = 1; l <= r.lines; l++) s(l);
                    return t(e, f);
                }),
                (s.prototype.opacity = function (e, t, n, r) {
                    var i = e.firstChild;
                    (r = (r.shadow && r.lines) || 0), i && t + r < i.childNodes.length && ((i = i.childNodes[t + r]), (i = i && i.firstChild), (i = i && i.firstChild), i && (i.opacity = n));
                });
        }
        var c,
            u,
            d = ["webkit", "Moz", "ms", "O"],
            f = {},
            h = {
                lines: 12,
                length: 7,
                width: 5,
                radius: 10,
                scale: 1,
                corners: 1,
                color: "#000",
                opacity: 0.25,
                rotate: 0,
                direction: 1,
                speed: 1,
                trail: 100,
                fps: 20,
                zIndex: 2e9,
                className: "spinner",
                top: "50%",
                left: "50%",
                shadow: !1,
                hwaccel: !1,
                position: "absolute",
            };
        if (
            ((s.defaults = {}),
            o(s.prototype, {
                spin: function (t) {
                    this.stop();
                    var n = this,
                        r = n.opts,
                        o = (n.el = e(null, { className: r.className }));
                    if ((i(o, { position: r.position, width: 0, zIndex: r.zIndex, left: r.left, top: r.top }), t && t.insertBefore(o, t.firstChild || null), o.setAttribute("role", "progressbar"), n.lines(o, n.opts), !c)) {
                        var a,
                            s = 0,
                            l = ((r.lines - 1) * (1 - r.direction)) / 2,
                            u = r.fps,
                            d = u / r.speed,
                            f = (1 - r.opacity) / ((d * r.trail) / 100),
                            h = d / r.lines;
                        !(function e() {
                            s++;
                            for (var t = 0; t < r.lines; t++) (a = Math.max(1 - ((s + (r.lines - t) * h) % d) * f, r.opacity)), n.opacity(o, t * r.direction + l, a, r);
                            n.timeout = n.el && setTimeout(e, ~~(1e3 / u));
                        })();
                    }
                    return n;
                },
                stop: function () {
                    var e = this.el;
                    return e && (clearTimeout(this.timeout), e.parentNode && e.parentNode.removeChild(e), (this.el = void 0)), this;
                },
                lines: function (r, o) {
                    function s(t, n) {
                        return i(e(), {
                            position: "absolute",
                            width: o.scale * (o.length + o.width) + "px",
                            height: o.scale * o.width + "px",
                            background: t,
                            boxShadow: n,
                            transformOrigin: "left",
                            transform: "rotate(" + ~~((360 / o.lines) * u + o.rotate) + "deg) translate(" + o.scale * o.radius + "px,0)",
                            borderRadius: ((o.corners * o.scale * o.width) >> 1) + "px",
                        });
                    }
                    for (var l, u = 0, d = ((o.lines - 1) * (1 - o.direction)) / 2; u < o.lines; u++)
                        (l = i(e(), {
                            position: "absolute",
                            top: 1 + ~((o.scale * o.width) / 2) + "px",
                            transform: o.hwaccel ? "translate3d(0,0,0)" : "",
                            opacity: o.opacity,
                            animation: c && n(o.opacity, o.trail, d + u * o.direction, o.lines) + " " + 1 / o.speed + "s linear infinite",
                        })),
                            o.shadow && t(l, i(s("#000", "0 0 4px #000"), { top: "2px" })),
                            t(r, t(l, s(a(o.color, u), "0 0 1px rgba(0,0,0,.1)")));
                    return r;
                },
                opacity: function (e, t, n) {
                    t < e.childNodes.length && (e.childNodes[t].style.opacity = n);
                },
            }),
            "undefined" != typeof document)
        ) {
            u = (function () {
                var n = e("style", { type: "text/css" });
                return t(document.getElementsByTagName("head")[0], n), n.sheet || n.styleSheet;
            })();
            var p = i(e("group"), { behavior: "url(#default#VML)" });
            !r(p, "transform") && p.adj ? l() : (c = r(p, "animation"));
        }
        return s;
    }),
    define("readium_js_viewer/Spinner", ["spin"], function (e) {
        var t = { lines: 17, length: 0, width: 10, radius: 48, corners: 1, rotate: 0, direction: 1, color: "#000", speed: 1, trail: 66, shadow: !1, hwaccel: !1, className: "spinner", zIndex: 2e9, top: "50%", left: "50%" };
        return new e(t);
    }),
    define("Settings", [], function () {
        var e = void 0,
            t = function () {
                if (e) return !0;
                if ("undefined" == typeof e) {
                    if (((e = !1), localStorage))
                        try {
                            localStorage.setItem("_isLocalStorageEnabled", "?"), localStorage.removeItem("_isLocalStorageEnabled"), (e = !0);
                        } catch (e) {}
                    return e;
                }
                return !1;
            },
            n = void 0,
            r = function (e) {
                var t = e;
                return n ? (t = n + t) : "undefined" != typeof LDEpubUtils && ((n = "undefined" != typeof LDEpubUtils.config ? LDEpubUtils.config.piezaGUID + "_" + LDEpubUtils.config.userGUID + "_" : ""), (t = n + t)), t;
            };
        return (
            (Settings = {
                put: function (e, n, i) {
                    if (!t()) return void (i && i());
                    var n = JSON.stringify(n);
                    (localStorage[r(e)] = n), i && i();
                },
                get: function (e, n) {
                    if (!t()) return void (n && n(null));
                    var i = localStorage[r(e)];
                    n(i ? JSON.parse(i) : null);
                },
                getMultiple: function (e, n) {
                    if (!t()) return void (n && n({}));
                    for (var i = {}, o = 0; o < e.length; o++) localStorage[r(e[o])] && (i[e[o]] = localStorage[r(e[o])]);
                    n(i);
                },
            }),
            Settings
        );
    }),
    define("text!readium_js_viewer_i18n/_locales/de/messages.json", [], function () {
        return '{ "about": {\r\n    "message": "ber Readium"\r\n    },\r\n    "preview": {\r\n        "message": "Vorschau"\r\n    },\r\n    "list_view": {\r\n        "message": "Listenansicht"\r\n    },\r\n    "thumbnail_view": {\r\n        "message": "Kachelansicht"\r\n    },\r\n    "view_library": {\r\n        "message": "Bibliothek"\r\n    },\r\n    "highlight_selection": {\r\n        "message": "Ausgewhlten Text hervorheben"\r\n    },\r\n    "toc": {\r\n        "message": "Inhaltsverzeichnis"\r\n    },\r\n    "settings": {\r\n        "message": "Einstellungen"\r\n    },\r\n    "enter_fullscreen": {\r\n        "message": "Vollbildmodus"\r\n    },\r\n    "exit_fullscreen": {\r\n        "message": "Vollbildmodus verlassen"\r\n    },\r\n    "chrome_extension_name": {\r\n        "message": "Readium"\r\n    },\r\n    "chrome_extension_description": {\r\n        "message": "Ein Leseprogramm fr EPUB3 Bcher."\r\n    },\r\n    "ok" : {\r\n        "message" : "Ok"\r\n    },\r\n    "i18n_readium_library": {\r\n        "message": "Readium Bibliothek"\r\n    },\r\n    "i18n_loading": {\r\n        "message": "Bibliothek wird geladen"\r\n    },\r\n    "i18n_readium_options": {\r\n        "message": "Readium Einstellungen:"\r\n    },\r\n    "i18n_save_changes": {\r\n        "message": "nderungen speichern"\r\n    },\r\n    "i18n_close": {\r\n        "message": "Schlieen"\r\n    },\r\n    "i18n_keyboard_shortcuts": {\r\n        "message": "Funktionstasten"\r\n    },\r\n    "i18n_keyboard_reload": {\r\n        "message": "Bitte laden Sie die Seite im Browser neu, damit die nderungen der Tastaturkrzel wirksam werden."\r\n    },\r\n    "i18n_reset_key": {\r\n        "message": "Taste zurcksetzen"\r\n    },\r\n    "i18n_reset_key_all": {\r\n        "message": "Alle Funktionstasten auf Standard zurcksetzen"\r\n    },\r\n    "i18n_duplicate_keyboard_shortcut": {\r\n        "message": "Doppelbelegung"\r\n    },\r\n    "i18n_invalid_keyboard_shortcut": {\r\n        "message": "Nicht zulssig"\r\n    },\r\n    "i18n_paginate_all": {\r\n        "message": "Flietext des EPUB Inhalts paginieren"\r\n    },\r\n    "i18n_automatically": {\r\n        "message": "*.epub URLs automatisch in Readium ffnen"\r\n    },\r\n    "i18n_show_warning": {\r\n        "message": "Warnhinweise beim Entpacken von EPUB Dateien anzeigen"\r\n    },\r\n    "i18n_details": {\r\n        "message": "Details"\r\n    },\r\n    "i18n_read": {\r\n        "message": "Lesen"\r\n    },\r\n    "i18n_delete": {\r\n        "message": "Lschen"\r\n    },\r\n    "i18n_are_you_sure": {\r\n        "message": "Mchten Sie diese Datei wirklich unwiderruflich lschen?"\r\n    },\r\n    "delete_dlg_title": {\r\n        "message": "Lschen besttigen"\r\n    },\r\n\r\n    "i18n_auto_page_turn_enable": {\r\n        "message": "Automatisches Umblttern einschalten"\r\n    },\r\n    "i18n_auto_page_turn_disable": {\r\n        "message": "Automatisches Umblttern ausschalten"\r\n    },\r\n\r\n    "i18n_playback_scroll_enable": {\r\n        "message": "Scrollen whrend der Wiedergabe"\r\n    },\r\n    "i18n_playback_scroll_disable": {\r\n        "message": "Kein Scrollen whrend der Wiedergabe"\r\n    },\r\n    "i18n_audio_touch_enable": {\r\n        "message": "Touch-to-play einschalten"\r\n    },\r\n    "i18n_audio_touch_disable": {\r\n        "message": "Touch-to-play ausschalten"\r\n    },\r\n    "i18n_audio_highlight_default": {\r\n        "message": "Standard"\r\n    },\r\n    "i18n_audio_highlight": {\r\n        "message": "Hervorhebungsfarbe"\r\n    },\r\n\r\n    "delete_progress_title": {\r\n        "message": "Lschen wird ausgefhrt"\r\n    },\r\n    "delete_progress_message": {\r\n        "message": "Lschen"\r\n    },\r\n    "migrate_dlg_title": {\r\n        "message": "Bcher migrieren"\r\n    },\r\n    "migrate_dlg_message": {\r\n        "message": "Daten werden geladen..."\r\n    },\r\n    "migrating": {\r\n        "message": "Migrieren..."\r\n    },\r\n    "replace_dlg_title": {\r\n        "message": "Konflikt festgestellt"\r\n    },\r\n    "replace_dlg_message": {\r\n        "message": "Soll das bestehende EPUB wirklich ersetzt werden?"\r\n    },\r\n    "import_dlg_title": {\r\n        "message": "EPUB importieren"\r\n    },\r\n    "import_dlg_message": {\r\n        "message": "EPUB Inhalt berprfen..."\r\n    },\r\n    "storing_file": {\r\n        "message": "Datei speichern"\r\n    },\r\n    "err_unknown": {\r\n        "message": "Unbekannter Fehler. Fr Details ffnen Sie die Konsole."\r\n    },\r\n    "err_storage": {\r\n        "message": "Zugriff auf Dateispeicher nicht mglich."\r\n    },\r\n    "err_epub_corrupt": {\r\n        "message": "Ungltiges oder beschdigtes EPUB Paket"\r\n    },\r\n    "err_dlg_title": {\r\n        "message": "Unerwarteter Fehler"\r\n    },\r\n    "replace" : {\r\n        "message": "Ersetzen"\r\n    },\r\n    "i18n_author": {\r\n        "message": "Autor: "\r\n    },\r\n    "i18n_publisher": {\r\n        "message": "Verlag: "\r\n    },\r\n    "i18n_source": {\r\n        "message": "Quelle: "\r\n    },\r\n    "i18n_pub_date": {\r\n        "message": "Verffentlicht am: "\r\n    },\r\n    "i18n_modified_date": {\r\n        "message": "Zuletzt gendert am: "\r\n    },\r\n    "i18n_id": {\r\n        "message": "ID: "\r\n    },\r\n    "i18n_epub_version": {\r\n        "message": "EPUB Version: "\r\n    },\r\n    "i18n_created_at": {\r\n        "message": "Erstellt am: "\r\n    },\r\n    "i18n_format": {\r\n        "message": "Format: "\r\n    },\r\n    "i18n_added": {\r\n        "message": "Hinzugefgt am: "\r\n    },\r\n    "i18n_unknown": {\r\n        "message": "Unbekannt"\r\n    },\r\n    "i18n_sorry": {\r\n        "message": "Das aktuelle EPUB enthlt fr diesen Inhalt keine Media Overlays."\r\n    },\r\n    "i18n_add_items": {\r\n        "message": "Fge Werke zur Bibliothek hinzu."\r\n    },\r\n    "i18n_extracting": {\r\n        "message": "Entpacke: "\r\n    },\r\n    "i18n_add_book_to_readium_library": {\r\n        "message": "Buch zur Readium Bibliothek hinzufgen:"\r\n    },\r\n    "i18n_add_book": {\r\n        "message": "Buch hinzufgen"\r\n    },\r\n    "i18n_cancel": {\r\n        "message": "Abbrechen"\r\n    },\r\n    "i18n_from_the_web": {\r\n        "message": "Internet:"\r\n    },\r\n    "i18n_from_local_file": {\r\n        "message": "Lokale Datei:"\r\n    },\r\n    "i18n_enter_a_url": {\r\n        "message": "URL einer .epub Datei eingeben"\r\n    },\r\n    "i18n_unpacked_directory": {\r\n        "message": "Entpacktes Verzeichnis:"\r\n    },\r\n    "i18n_validate": {\r\n        "message": "Prfe:"\r\n    },\r\n    "i18n_confirm_that_this_book": {\r\n        "message": "Besttigung, dass dieses Buch mit EPUB Standards bereinstimmt"\r\n    },\r\n    "i18n_single_pages": {\r\n        "message": "Einzelseiten"\r\n    },\r\n    "i18n_double_pages": {\r\n        "message": "Doppelseiten"\r\n    },\r\n    "i18n_save_settings": {\r\n        "message": "Einstellungen speichern"\r\n    },\r\n    "i18n_font_size": {\r\n        "message": "Schriftgre"\r\n    },\r\n    "i18n_margins": {\r\n        "message": "Rand"\r\n    },\r\n    "i18n_text_and_background_color": {\r\n        "message": "Text- und Hintergrundfarbe"\r\n    },\r\n    "i18n_author_theme": {\r\n        "message": "Vorgabe des Autors"\r\n    },\r\n    "i18n_black_and_white": {\r\n        "message": "Schwarzweiss"\r\n    },\r\n    "i18n_arabian_nights": {\r\n        "message": "Arabian Nights"\r\n    },\r\n    "i18n_sands_of_dune": {\r\n        "message": "Sands of Dune"\r\n    },\r\n    "i18n_ballard_blues": {\r\n        "message": "Ballard Blues"\r\n    },\r\n    "i18n_vancouver_mist": {\r\n        "message": "Vancouver Mist"\r\n    },\r\n    "i18n_display_format": {\r\n        "message": "Anzeigeformat"\r\n    },\r\n    "i18n_spread_auto": {\r\n        "message": "Automatisch"\r\n    },\r\n    "i18n_scroll_mode": {\r\n        "message": "Scroll Modus"\r\n    },\r\n    "i18n_scroll_mode_auto": {\r\n        "message": "Automatisch"\r\n    },\r\n    "i18n_scroll_mode_doc": {\r\n        "message": "Dokument"\r\n    },\r\n    "i18n_scroll_mode_continuous": {\r\n        "message": "Kontinuierlich"\r\n    },\r\n\r\n    "i18n_page_transition": {\r\n        "message": "Umbltter-Effekt"\r\n    },\r\n    "i18n_page_transition_none": {\r\n        "message": "Keiner"\r\n    },\r\n    "i18n_page_transition_fade": {\r\n        "message": "Fade"\r\n    },\r\n    "i18n_page_transition_slide": {\r\n        "message": "Slide"\r\n    },\r\n    "i18n_page_transition_swoosh": {\r\n        "message": "Swoosh"\r\n    },\r\n    "i18n_page_transition_butterfly": {\r\n        "message": "Butterfly"\r\n    },\r\n    "i18n_html_readium_tm_a_project": {\r\n        "message": "Readium fr Chrome ist die Chrome Browser Erweiterung basierend auf ReadiumJS, einem Open-Source Lesesystem und einer JavaScript Bibliothek zur Darstellung von EPUB Verffentlichungen in Web-Browsern. ReadiumJS ist ein Projekt der Readium Foundation (Readium.org). Wenn Sie mehr darber erfahren mchten oder das Projekt untersttzen wollen, besuchen Sie bitte die <a href=\\"http://readium.org/\\">Projekt Homepage</a>."\r\n\r\n    },\r\n    "gethelp": {\r\n        "message": "Falls Sie auf Probleme stoen, Fragen haben oder \\"Hallo\\" sagen mchten, besuchen Sie <a href=\\"http://idpf.org/forums/readium\\">unser Forum</a>."\r\n    },\r\n    "i18n_toolbar": {\r\n        "message": "Werkzeugleiste"\r\n    },\r\n    "i18n_toolbar_show": {\r\n        "message": "Werkzeugleiste anzeigen"\r\n    },\r\n    "i18n_toolbar_hide": {\r\n        "message": "Werkzeugleiste ausblenden"\r\n    },\r\n    "i18n_audio_play": {\r\n        "message": "Audio - Abspielen"\r\n    },\r\n    "i18n_audio_pause": {\r\n        "message": "Audio - Pause"\r\n    },\r\n    "i18n_audio_play_background": {\r\n        "message": "Hintergrundaudio ein"\r\n    },\r\n    "i18n_audio_pause_background": {\r\n        "message": "Hintergrundaudio aus"\r\n    },\r\n    "i18n_audio_previous": {\r\n        "message": "Vorige Audiophrase"\r\n    },\r\n    "i18n_audio_next": {\r\n        "message": "Nchste Audiophrase"\r\n    },\r\n    "i18n_audio_volume": {\r\n        "message": "Lautstrke"\r\n    },\r\n    "i18n_audio_volume_increase": {\r\n        "message": "Lautstrke erhhen"\r\n    },\r\n    "i18n_audio_volume_decrease": {\r\n        "message": "Lautstrke verringern"\r\n    },\r\n    "i18n_audio_time": {\r\n        "message": "Audio - Zeitmarke"\r\n    },\r\n    "i18n_audio_mute": {\r\n        "message": "Audio ausschalten"\r\n    },\r\n    "i18n_audio_unmute": {\r\n        "message": "Audio einschalten"\r\n    },\r\n    "i18n_audio_expand": {\r\n        "message": "Erweiterte Audio-Steuerung anzeigen"\r\n    },\r\n    "i18n_audio_collapse": {\r\n        "message": "Erweiterte Audio-Steuerung ausblenden"\r\n    },\r\n    "i18n_audio_esc": {\r\n        "message": "Aktuellen Audio-Bereich verlassen"\r\n    },\r\n    "i18n_audio_rate": {\r\n        "message": "Audio - Wiedergabegeschwindigkeit"\r\n    },\r\n    "i18n_audio_rate_increase": {\r\n        "message": "Audio - Wiedergabegeschwindigkeit erhhen"\r\n    },\r\n    "i18n_audio_rate_decrease": {\r\n        "message": "Audio - Wiedergabegeschwindigkeit verringern"\r\n    },\r\n    "i18n_audio_rate_reset": {\r\n        "message": "Audio - Wiedergabegeschwindigkeit zurcksetzen"\r\n    },\r\n    "i18n_audio_skip_disable": {\r\n        "message": "Audio - berspringen unterbinden "\r\n    },\r\n    "i18n_audio_skip_enable": {\r\n        "message": "Audio - berspringen ermglichen"\r\n    },\r\n    "i18n_audio_sync": {\r\n        "message": "Text-Audio-Synchronisation"\r\n    },\r\n    "i18n_audio_sync_default": {\r\n        "message": "Nach Vorgabe"\r\n    },\r\n    "i18n_audio_sync_word": {\r\n        "message": "Wort"\r\n    },\r\n    "i18n_audio_sync_sentence": {\r\n        "message": "Satz"\r\n    },\r\n    "i18n_audio_sync_paragraph": {\r\n        "message": "Absatz"\r\n    },\r\n    "i18n_page_previous": {\r\n        "message": "Vorige Seite"\r\n    },\r\n    "i18n_page_next": {\r\n        "message": "Nchste Seite"\r\n    },\r\n    "chrome_accept_languages": {\r\n        "message": "$CHROME$ akzeptiert $languages$ Sprachen",\r\n        "placeholders": {\r\n            "chrome": {\r\n                "content": "Chrome",\r\n                "example": "Chrome"\r\n            },\r\n            "languages": {\r\n                "content": "$1",\r\n                "example": "en-US,ja,sr,de,zh_CN"\r\n            }\r\n        }\r\n    }\r\n}';
    }),
    define("text!readium_js_viewer_i18n/_locales/es/messages.json", [], function () {
        return '{\r\n    "chrome_extension_name": {\r\n        "message": "Readium"\r\n    },\r\n    "about" : {\r\n        "message" : "Acerca de"\r\n    },\r\n    "preview" : {\r\n        "message" : "Vista previa"\r\n    },\r\n    "list_view" : {\r\n        "message" : "Vista en lista"\r\n    },\r\n    "thumbnail_view" : {\r\n        "message" : "Vista en miniaturas"\r\n    },\r\n    "view_library": {\r\n        "message" : "Biblioteca"\r\n    },\r\n    "highlight_selection" : {\r\n        "message" : "Subrayar texto seleccionado"\r\n    },\r\n    "toc" : {\r\n        "message" : "Tabla de contenidos"\r\n    },\r\n    "extra_contents" : {\r\n        "message" : "Contenidos Extras"\r\n    },\r\n    "settings" : {\r\n        "message" : "Preferencias"\r\n    },\r\n    "layout" : {\r\n        "message" : "Presentacin"\r\n    },\r\n    "style" : {\r\n        "message" : "Estilo"\r\n    },\r\n    "enter_fullscreen" : {\r\n        "message" : "Abrir modo de pantalla completa"\r\n    },\r\n    "exit_fullscreen" : {\r\n        "message" : "Cerrar modo de pantalla completa"\r\n    },\r\n    "chrome_extension_description": {\r\n        "message": "Lector de libros EPUB3."\r\n    },\r\n    "ok" : {\r\n        "message" : "Ok"\r\n    },\r\n    "delete_dlg_title" : {\r\n        "message" : "Confirmar eliminacin"\r\n    },\r\n    "delete_progress_title" : {\r\n        "message" : "Eliminacin en progreso"\r\n    },\r\n    "delete_progress_message" : {\r\n        "message" : "Eliminando"\r\n    },\r\n    "migrate_dlg_title" : {\r\n        "message" : "Migrando libros"\r\n    },\r\n    "migrate_dlg_message" : {\r\n        "message" : "Cargando datos..."\r\n    },\r\n    "migrating" : {\r\n        "message" : "Migrando"\r\n    },\r\n    "replace_dlg_title" : {\r\n        "message": "Se ha detectado un conflicto"\r\n    },\r\n    "replace_dlg_message": {\r\n        "message": "Si decide continuar, el siguiente epub ser reemplazado por el que est siendo importado"\r\n    },\r\n    "import_dlg_title" : {\r\n        "message": "Importando EPUB"\r\n    },\r\n    "import_dlg_message" : {\r\n        "message": "Examinando contenido del EPUB..."\r\n    },\r\n    "storing_file" : {\r\n        "message": "Guardando archivo"\r\n    },\r\n    "err_unknown" : {\r\n        "message": "Error desconocido. Chequear la consola para conocer ms detalles."\r\n    },\r\n    "err_storage" : {\r\n        "message": "No es posible acceder al dispositvo"\r\n    },\r\n    "err_epub_corrupt" : {\r\n        "message": "Paquete EPUB invlido o corrupto"\r\n    },\r\n    "err_dlg_title" : {\r\n        "message": "Error inesperado"\r\n    },\r\n    "replace" : {\r\n        "message": "Reemplazar"\r\n    },\r\n    "gethelp" : {\r\n        "message" : "Si encuentra algn problema, tiene preguntas, o le gustara decir hola, visite <a href=\\"http://idpf.org/forums/readium\\">nuestro foro</a>"\r\n    },\r\n    "i18n_readium_library" : {\r\n        "message" : "Biblioteca Readium"\r\n    },\r\n    "i18n_loading" : {\r\n        "message" : "Cargando biblioteca"\r\n    },\r\n    "i18n_readium_options" : {\r\n        "message" : "Readium Opciones:"\r\n    },\r\n    "i18n_save_changes" : {\r\n        "message" : "Guardar cambios"\r\n    },\r\n    "i18n_close" : {\r\n        "message" : "Cerrar"\r\n    },\r\n    "i18n_keyboard_shortcuts" : {\r\n        "message" : "Teclas de acceso rpido"\r\n    },\r\n    "i18n_keyboard_reload" : {\r\n        "message" : "Por favor, actualiza la pgina para que las teclas de acceso rpido tengan efecto."\r\n    },\r\n    "i18n_reset_key" : {\r\n        "message" : "Reestablecer tecla"\r\n    },\r\n    "i18n_reset_key_all" : {\r\n        "message" : "Reestablecer todos las teclas de acceso rpido"\r\n    },\r\n    "i18n_duplicate_keyboard_shortcut" : {\r\n        "message" : "DUPLICADO"\r\n    },\r\n    "i18n_invalid_keyboard_shortcut" : {\r\n        "message" : "INVALIDO"\r\n    },\r\n    "i18n_paginate_all" : {\r\n        "message" : "Paginar todo el contenido ePUB repaginable"\r\n    },\r\n    "i18n_automatically" : {\r\n        "message" : "Abrir automticamente urls *.epub en readium"\r\n    },\r\n    "i18n_show_warning" : {\r\n        "message" : "Mostrar advertencias al desempaquetar archivos EPUB"\r\n    },\r\n    "i18n_details" : {\r\n        "message" : "Detalles"\r\n    },\r\n    "i18n_read" : {\r\n        "message" : "Leer"\r\n    },\r\n    "i18n_delete" : {\r\n        "message" : "Eliminar"\r\n    },\r\n    "i18n_author" : {\r\n        "message" : "Autor: "\r\n    },\r\n    "i18n_publisher" : {\r\n        "message" : "Editor: "\r\n    },\r\n    "i18n_source" : {\r\n        "message" : "Fuente: "\r\n    },\r\n    "i18n_pub_date" : {\r\n        "message" : "Fecha de publicacin: "\r\n    },\r\n    "i18n_modified_date" : {\r\n        "message" : "Fecha de modificacin: "\r\n    },\r\n    "i18n_id" : {\r\n        "message" : "ID: "\r\n    },\r\n    "i18n_epub_version" : {\r\n        "message" : "Versin EPUB: "\r\n    },\r\n    "i18n_created_at" : {\r\n        "message" : "Creado en: "\r\n    },\r\n    "i18n_format" : {\r\n        "message" : "Formato: "\r\n    },\r\n    "i18n_added" : {\r\n        "message" : "Aadido: "\r\n    },\r\n    "i18n_unknown" : {\r\n        "message" : "Desconocido"\r\n    },\r\n    "i18n_sorry" : {\r\n        "message" : "Disculpa, el EPUB actual no contiene superposicin multimedia para este contenido"\r\n    },\r\n    "i18n_add_items" : {\r\n        "message" : "Aade aqu elementos a tu biblioteca!"\r\n    },\r\n    "i18n_extracting" : {\r\n        "message" : "extrayendo: "\r\n    },\r\n    "i18n_are_you_sure" : {\r\n        "message" : "Est seguro que desea eliminar de forma permanente"\r\n    },\r\n    "i18n_add_book_to_readium_library" : {\r\n        "message" : "Aadir libro a biblioteca Readium:"\r\n    },\r\n    "i18n_add_book" : {\r\n        "message" : "Aadir a la biblioteca"\r\n    },\r\n    "i18n_cancel" : {\r\n        "message" : "Cancelar"\r\n    },\r\n    "i18n_from_the_web" : {\r\n        "message" : "Desde la web:"\r\n    },\r\n    "i18n_from_local_file" : {\r\n        "message" : "Desde un archivo local:"\r\n    },\r\n    "i18n_enter_a_url" : {\r\n        "message" : "Ingresa una URL a un archivo .epub"\r\n    },\r\n    "i18n_unpacked_directory" : {\r\n        "message" : "Carpeta descomprimida:"\r\n    },\r\n    "i18n_validate" : {\r\n        "message" : "Validar:"\r\n    },\r\n    "i18n_confirm_that_this_book" : {\r\n        "message" : "Confirmar que este libro cumple con los estndares ePUB"\r\n    },\r\n    "i18n_single_pages" : {\r\n        "message" : "Pginas simple"\r\n    },\r\n    "i18n_double_pages" : {\r\n        "message" : "Pginas doble"\r\n    },\r\n    "i18n_save_settings" : {\r\n        "message" : "Guardar preferencias"\r\n    },\r\n    "i18n_font_size" : {\r\n        "message" : "TAMAO DE FUENTE"\r\n    },\r\n    "i18n_margins" : {\r\n        "message" : "MARGENES"\r\n    },\r\n    "i18n_text_and_background_color" : {\r\n        "message" : "COLOR DE FUENTE Y FONDO"\r\n    },\r\n    "i18n_black_and_white" : {\r\n        "message" : "Blanco y negro"\r\n    },\r\n    "i18n_arabian_nights" : {\r\n        "message" : "Las mil y una noches"\r\n    },\r\n    "i18n_sands_of_dune" : {\r\n        "message" : "Arenas de duna"\r\n    },\r\n    "i18n_ballard_blues" : {\r\n        "message" : "Ballard Blues"\r\n    },\r\n    "i18n_vancouver_mist" : {\r\n        "message" : "Bruma de Vancouver"\r\n    },\r\n    "i18n_display_format" : {\r\n        "message" : "MOSTRAR FORMATO"\r\n    },\r\n    "i18n_scroll_mode" : {\r\n        "message" : "MODO DE DESPLAZAMIENTO"\r\n    },\r\n    "i18n_scroll_mode_default" : {\r\n        "message" : "Por defecto"\r\n    },\r\n    "i18n_scroll_mode_doc" : {\r\n        "message" : "Documento"\r\n    },\r\n    "i18n_scroll_mode_continuous" : {\r\n        "message" : "Continuo"\r\n    },\r\n    "i18n_html_readium_tm_a_project" : {\r\n        "message" : "Readium para Chrome es la extensin para Chrome de ReadiumJS, un sistema de lectura de cdigo abierto y librera JavaScript para renderizar publicaciones EPUB en navegadores web. ReadiumJS es un proyecto de Readium Foundation (Readium.org). Para saber ms o contribuir, visita el <a href=\\"http://readium.org/projects/readiumjs\\">sitio del proyecto</a>"\r\n    },\r\n    "i18n_toolbar_show" : {\r\n        "message" : "Mostrar barra de herramientas"\r\n    },\r\n    "i18n_toolbar_hide" : {\r\n        "message" : "Ocultar barra de herramientas"\r\n    },\r\n    "i18n_audio_play" : {\r\n        "message" : "Reproducir"\r\n    },\r\n    "i18n_audio_pause" : {\r\n        "message" : "Pausa"\r\n    },\r\n    "i18n_audio_previous" : {\r\n        "message" : "Frase de audio anterior"\r\n    },\r\n    "i18n_audio_next" : {\r\n        "message" : "Frase de audio siguiente"\r\n    },\r\n    "i18n_audio_volume" : {\r\n        "message" : "Volumen de audio"\r\n    },\r\n    "i18n_audio_volume_increase" : {\r\n        "message" : "Incrementar volumen de audio"\r\n    },\r\n    "i18n_audio_volume_decrease" : {\r\n        "message" : "Reducir volumen de audio"\r\n    },\r\n    "i18n_audio_time" : {\r\n        "message" : "Cursor de tiempo de audio"\r\n    },\r\n    "i18n_audio_mute" : {\r\n        "message" : "Desactivar audio"\r\n    },\r\n    "i18n_audio_unmute" : {\r\n        "message" : "Activar audio"\r\n    },\r\n    "i18n_audio_expand" : {\r\n        "message" : "Mostrar controles avanzados de audio"\r\n    },\r\n    "i18n_audio_collapse" : {\r\n        "message" : "Cerrar controles avanzados de audio"\r\n    },\r\n    "i18n_audio_esc" : {\r\n        "message" : "Salir de contexto actual de audio"\r\n    },\r\n    "i18n_audio_rate" : {\r\n        "message" : "Velocidad de reproduccin de audio"\r\n    },\r\n    "i18n_audio_rate_increase" : {\r\n        "message" : "Incrementar velocidad de reproduccin de audio"\r\n    },\r\n    "i18n_audio_rate_decrease" : {\r\n        "message" : "Reducir velocidad de reproduccin de audio"\r\n    },\r\n    "i18n_audio_rate_reset" : {\r\n        "message" : "Reestablecer reproduccin de audio a velocidad normal"\r\n    },\r\n    "i18n_audio_skip_disable" : {\r\n        "message" : "Desactivar capacidad de omisin"\r\n    },\r\n    "i18n_audio_skip_enable" : {\r\n        "message" : "Activar capacidad de omisin"\r\n    },\r\n    "i18n_audio_touch_enable" : {\r\n        "message" : "Activar touch-to-play"\r\n    },\r\n    "i18n_audio_touch_disable" : {\r\n        "message" : "Desactivar touch-to-play"\r\n    },\r\n    "i18n_audio_highlight_default" : {\r\n        "message" : "por defecto"\r\n    },\r\n    "i18n_audio_highlight" : {\r\n        "message" : "Color de audio"\r\n    },\r\n    "i18n_audio_sync" : {\r\n        "message" : "Granularidad de sincronizacin texto/audio"\r\n    },\r\n    "i18n_audio_sync_default" : {\r\n        "message" : "Por defecto"\r\n    },\r\n    "i18n_audio_sync_word" : {\r\n        "message" : "Palabra"\r\n    },\r\n    "i18n_audio_sync_sentence" : {\r\n        "message" : "Oracin"\r\n    },\r\n    "i18n_audio_sync_paragraph" : {\r\n        "message" : "Prrafo"\r\n    },\r\n    "i18n_page_previous" : {\r\n        "message" : "Pgina previa"\r\n    },\r\n    "i18n_page_next" : {\r\n        "message" : "Pgina siguiente"\r\n    },\r\n    "i18n_author_theme" : {\r\n      "message" : "Por defecto (estilos de autor)"\r\n    },\r\n\r\n  "i18n_spread_auto" : {\r\n       "message" : "Automtico"\r\n    },\r\n\r\n  "i18n_scroll_mode_auto" : {\r\n      "message" : "Automtico"\r\n    },\r\n\r\n   "i18n_page_transition" : {\r\n      "message" : "EFECTOS DE PGINA"\r\n    },\r\n    "i18n_page_transition_none" : {\r\n      "message" : "Desactivado"\r\n    },\r\n    "i18n_page_transition_fade" : {\r\n      "message" : "Apagarse"\r\n    },\r\n    "i18n_page_transition_slide" : {\r\n      "message" : "Deslizar"\r\n    },\r\n    "i18n_page_transition_swoosh" : {\r\n      "message" : "Swoosh"\r\n    },\r\n    "i18n_page_transition_butterfly" : {\r\n      "message" : "Mariposa"\r\n    },\r\n\r\n  "i18n_toolbar" : {\r\n      "message" : "Barra de herramientas"\r\n    },\r\n\r\n   "i18n_audio_play_background" : {\r\n      "message" : "Reproducir pista en segundo plano"\r\n    },\r\n    "i18n_audio_pause_background" : {\r\n      "message" : "Pausar pista en segundo plano"\r\n},\r\n\r\n   "i18n_auto_page_turn_enable" : {\r\n      "message" : "Activar vuelta de pgina automtica"\r\n    },\r\n    "i18n_auto_page_turn_disable" : {\r\n      "message" : "Desactivar vuelta de pgina automtica"\r\n    },\r\n\r\n   "i18n_playback_scroll_enable" : {\r\n      "message" : "Activar desplazamiento durante la reproduccin"\r\n    },\r\n\r\n    "i18n_playback_scroll_disable" : {\r\n      "message" : "Desactivar desplazamiento durante la reproduccin"\r\n    },\r\n\r\n    "chrome_accept_languages": {\r\n        "message": "$CHROME$ acepta idiomas $languages$",\r\n        "placeholders": {\r\n            "chrome": {\r\n                "content": "Chrome",\r\n                "example": "Chrome"\r\n            },\r\n            "languages": {\r\n                "content": "$1",\r\n                "example": "en-US,ja,sr,de,zh_CN"\r\n            }\r\n        }\r\n    },\r\n\r\n    "i18n_zoom_custom": {\r\n        "message": "Personalizado"\r\n    },\r\n    "i18n_zoom_width": {\r\n        "message": "Ajustar al ancho"\r\n    },\r\n    "i18n_zoom_screen": {\r\n        "message": "Ajustar a la pantalla"\r\n    }\r\n}';
    }),
    define("text!readium_js_viewer_i18n/_locales/ca/messages.json", [], function () {
        return '{\r\n\r\n    "chrome_extension_name": {\r\n        "message": "Readium"\r\n    },\r\n    "about" : {\r\n        "message" : "Acerca de"\r\n    },\r\n    "preview" : {\r\n        "message" : "Vista previa"\r\n    },\r\n    "list_view" : {\r\n        "message" : "Vista en lista"\r\n    },\r\n    "thumbnail_view" : {\r\n        "message" : "Vista en miniaturas"\r\n    },\r\n    "view_library": {\r\n        "message" : "Biblioteca"\r\n    },\r\n    "highlight_selection" : {\r\n        "message" : "Subrayar texto seleccionado"\r\n    },\r\n    "toc" : {\r\n        "message" : "Tabla de contenidos"\r\n    },\r\n    "extra_contents" : {\r\n        "message" : "Continguts extres"\r\n    },\r\n    "settings" : {\r\n        "message" : "Preferencias"\r\n    },\r\n    "enter_fullscreen" : {\r\n        "message" : "Abrir modo de pantalla completa"\r\n    },\r\n    "exit_fullscreen" : {\r\n        "message" : "Cerrar modo de pantalla completa"\r\n    },\r\n    "chrome_extension_description": {\r\n        "message": "Lector de libros EPUB3."\r\n    },\r\n    "ok" : {\r\n        "message" : "Ok"\r\n    },\r\n    "delete_dlg_title" : {\r\n        "message" : "Confirmar eliminacin"\r\n    },\r\n    "delete_progress_title" : {\r\n        "message" : "Eliminacin en progreso"\r\n    },\r\n    "delete_progress_message" : {\r\n        "message" : "Eliminando"\r\n    },\r\n    "migrate_dlg_title" : {\r\n        "message" : "Migrando libros"\r\n    },\r\n    "migrate_dlg_message" : {\r\n        "message" : "Cargando datos..."\r\n    },\r\n    "migrating" : {\r\n        "message" : "Migrando"\r\n    },\r\n    "replace_dlg_title" : {\r\n        "message": "Se ha detectado un conflicto"\r\n    },\r\n    "replace_dlg_message": {\r\n        "message": "Si decide continuar, el siguiente epub ser reemplazado por el que est siendo importado"\r\n    },\r\n    "import_dlg_title" : {\r\n        "message": "Importando EPUB"\r\n    },\r\n    "import_dlg_message" : {\r\n        "message": "Examinando contenido del EPUB..."\r\n    },\r\n    "storing_file" : {\r\n        "message": "Guardando archivo"\r\n    },\r\n    "err_unknown" : {\r\n        "message": "Error desconocido. Chequear la consola para conocer ms detalles."\r\n    },\r\n    "err_storage" : {\r\n        "message": "No es posible acceder al dispositvo"\r\n    },\r\n    "err_epub_corrupt" : {\r\n        "message": "Paquete EPUB invlido o corrupto"\r\n    },\r\n    "err_dlg_title" : {\r\n        "message": "Error inesperado"\r\n    },\r\n    "replace" : {\r\n        "message": "Reemplazar"\r\n    },\r\n    "gethelp" : {\r\n        "message" : "Si encuentra algn problema, tiene preguntas, o le gustara decir hola, visite <a href=\\"http://idpf.org/forums/readium\\">nuestro foro</a>"\r\n    },\r\n    "i18n_readium_library" : {\r\n        "message" : "Biblioteca Readium"\r\n    },\r\n    "i18n_loading" : {\r\n        "message" : "Cargando biblioteca"\r\n    },\r\n    "i18n_readium_options" : {\r\n        "message" : "Readium Opciones:"\r\n    },\r\n    "i18n_save_changes" : {\r\n        "message" : "Guardar cambios"\r\n    },\r\n    "i18n_close" : {\r\n        "message" : "Cerrar"\r\n    },\r\n    "i18n_keyboard_shortcuts" : {\r\n        "message" : "Teclas de acceso rpido"\r\n    },\r\n    "i18n_keyboard_reload" : {\r\n        "message" : "Por favor, actualiza la pgina para que las teclas de acceso rpido tengan efecto."\r\n    },\r\n    "i18n_reset_key" : {\r\n        "message" : "Reestablecer tecla"\r\n    },\r\n    "i18n_reset_key_all" : {\r\n        "message" : "Reestablecer todos las teclas de acceso rpido"\r\n    },\r\n    "i18n_duplicate_keyboard_shortcut" : {\r\n        "message" : "DUPLICADO"\r\n    },\r\n    "i18n_invalid_keyboard_shortcut" : {\r\n        "message" : "INVALIDO"\r\n    },\r\n    "i18n_paginate_all" : {\r\n        "message" : "Paginar todo el contenido ePUB repaginable"\r\n    },\r\n    "i18n_automatically" : {\r\n        "message" : "Abrir automticamente urls *.epub en readium"\r\n    },\r\n    "i18n_show_warning" : {\r\n        "message" : "Mostrar advertencias al desempaquetar archivos EPUB"\r\n    },\r\n    "i18n_details" : {\r\n        "message" : "Detalles"\r\n    },\r\n    "i18n_read" : {\r\n        "message" : "Leer"\r\n    },\r\n    "i18n_delete" : {\r\n        "message" : "Eliminar"\r\n    },\r\n    "i18n_author" : {\r\n        "message" : "Autor: "\r\n    },\r\n    "i18n_publisher" : {\r\n        "message" : "Editor: "\r\n    },\r\n    "i18n_source" : {\r\n        "message" : "Fuente: "\r\n    },\r\n    "i18n_pub_date" : {\r\n        "message" : "Fecha de publicacin: "\r\n    },\r\n    "i18n_modified_date" : {\r\n        "message" : "Fecha de modificacin: "\r\n    },\r\n    "i18n_id" : {\r\n        "message" : "ID: "\r\n    },\r\n    "i18n_epub_version" : {\r\n        "message" : "Versin EPUB: "\r\n    },\r\n    "i18n_created_at" : {\r\n        "message" : "Creado en: "\r\n    },\r\n    "i18n_format" : {\r\n        "message" : "Formato: "\r\n    },\r\n    "i18n_added" : {\r\n        "message" : "Aadido: "\r\n    },\r\n    "i18n_unknown" : {\r\n        "message" : "Desconocido"\r\n    },\r\n    "i18n_sorry" : {\r\n        "message" : "Disculpa, el EPUB actual no contiene superposicin multimedia para este contenido"\r\n    },\r\n    "i18n_add_items" : {\r\n        "message" : "Aade aqu elementos a tu biblioteca!"\r\n    },\r\n    "i18n_extracting" : {\r\n        "message" : "extrayendo: "\r\n    },\r\n    "i18n_are_you_sure" : {\r\n        "message" : "Est seguro que desea eliminar de forma permanente"\r\n    },\r\n    "i18n_add_book_to_readium_library" : {\r\n        "message" : "Aadir libro a biblioteca Readium:"\r\n    },\r\n    "i18n_add_book" : {\r\n        "message" : "Aadir a la biblioteca"\r\n    },\r\n    "i18n_cancel" : {\r\n        "message" : "Cancelar"\r\n    },\r\n    "i18n_from_the_web" : {\r\n        "message" : "Desde la web:"\r\n    },\r\n    "i18n_from_local_file" : {\r\n        "message" : "Desde un archivo local:"\r\n    },\r\n    "i18n_enter_a_url" : {\r\n        "message" : "Ingresa una URL a un archivo .epub"\r\n    },\r\n    "i18n_unpacked_directory" : {\r\n        "message" : "Carpeta descomprimida:"\r\n    },\r\n    "i18n_validate" : {\r\n        "message" : "Validar:"\r\n    },\r\n    "i18n_confirm_that_this_book" : {\r\n        "message" : "Confirmar que este libro cumple con los estndares ePUB"\r\n    },\r\n    "i18n_single_pages" : {\r\n        "message" : "Pginas simple"\r\n    },\r\n    "i18n_double_pages" : {\r\n        "message" : "Pginas doble"\r\n    },\r\n    "i18n_save_settings" : {\r\n        "message" : "Guardar preferencias"\r\n    },\r\n    "i18n_font_size" : {\r\n        "message" : "TAMAO DE FUENTE"\r\n    },\r\n    "i18n_margins" : {\r\n        "message" : "MARGENES"\r\n    },\r\n    "i18n_text_and_background_color" : {\r\n        "message" : "COLOR DE FUENTE Y FONDO"\r\n    },\r\n    "i18n_black_and_white" : {\r\n        "message" : "Blanco y negro"\r\n    },\r\n    "i18n_arabian_nights" : {\r\n        "message" : "Las mil y una noches"\r\n    },\r\n    "i18n_sands_of_dune" : {\r\n        "message" : "Arenas de duna"\r\n    },\r\n    "i18n_ballard_blues" : {\r\n        "message" : "Ballard Blues"\r\n    },\r\n    "i18n_vancouver_mist" : {\r\n        "message" : "Bruma de Vancouver"\r\n    },\r\n    "i18n_display_format" : {\r\n        "message" : "MOSTRAR FORMATO"\r\n    },\r\n    "i18n_scroll_mode" : {\r\n        "message" : "MODO DE DESPLAZAMIENTO"\r\n    },\r\n    "i18n_scroll_mode_default" : {\r\n        "message" : "Por defecto"\r\n    },\r\n    "i18n_scroll_mode_doc" : {\r\n        "message" : "Documento"\r\n    },\r\n    "i18n_scroll_mode_continuous" : {\r\n        "message" : "Continuo"\r\n    },\r\n    "i18n_html_readium_tm_a_project" : {\r\n        "message" : "Readium para Chrome es la extensin para Chrome de ReadiumJS, un sistema de lectura de cdigo abierto y librera JavaScript para renderizar publicaciones EPUB en navegadores web. ReadiumJS es un proyecto de Readium Foundation (Readium.org). Para saber ms o contribuir, visita el <a href=\\"http://readium.org/projects/readiumjs\\">sitio del proyecto</a>"\r\n    },\r\n    "i18n_toolbar_show" : {\r\n        "message" : "Mostrar barra de herramientas"\r\n    },\r\n    "i18n_toolbar_hide" : {\r\n        "message" : "Ocultar barra de herramientas"\r\n    },\r\n    "i18n_audio_play" : {\r\n        "message" : "Reproducir"\r\n    },\r\n    "i18n_audio_pause" : {\r\n        "message" : "Pausa"\r\n    },\r\n    "i18n_audio_previous" : {\r\n        "message" : "Frase de audio anterior"\r\n    },\r\n    "i18n_audio_next" : {\r\n        "message" : "Frase de audio siguiente"\r\n    },\r\n    "i18n_audio_volume" : {\r\n        "message" : "Volumen de audio"\r\n    },\r\n    "i18n_audio_volume_increase" : {\r\n        "message" : "Incrementar volumen de audio"\r\n    },\r\n    "i18n_audio_volume_decrease" : {\r\n        "message" : "Reducir volumen de audio"\r\n    },\r\n    "i18n_audio_time" : {\r\n        "message" : "Cursor de tiempo de audio"\r\n    },\r\n    "i18n_audio_mute" : {\r\n        "message" : "Desactivar audio"\r\n    },\r\n    "i18n_audio_unmute" : {\r\n        "message" : "Activar audio"\r\n    },\r\n    "i18n_audio_expand" : {\r\n        "message" : "Mostrar controles avanzados de audio"\r\n    },\r\n    "i18n_audio_collapse" : {\r\n        "message" : "Cerrar controles avanzados de audio"\r\n    },\r\n    "i18n_audio_esc" : {\r\n        "message" : "Salir de contexto actual de audio"\r\n    },\r\n    "i18n_audio_rate" : {\r\n        "message" : "Velocidad de reproduccin de audio"\r\n    },\r\n    "i18n_audio_rate_increase" : {\r\n        "message" : "Incrementar velocidad de reproduccin de audio"\r\n    },\r\n    "i18n_audio_rate_decrease" : {\r\n        "message" : "Reducir velocidad de reproduccin de audio"\r\n    },\r\n    "i18n_audio_rate_reset" : {\r\n        "message" : "Reestablecer reproduccin de audio a velocidad normal"\r\n    },\r\n    "i18n_audio_skip_disable" : {\r\n        "message" : "Desactivar capacidad de omisin"\r\n    },\r\n    "i18n_audio_skip_enable" : {\r\n        "message" : "Activar capacidad de omisin"\r\n    },\r\n    "i18n_audio_touch_enable" : {\r\n        "message" : "Activar touch-to-play"\r\n    },\r\n    "i18n_audio_touch_disable" : {\r\n        "message" : "Desactivar touch-to-play"\r\n    },\r\n    "i18n_audio_highlight_default" : {\r\n        "message" : "por defecto"\r\n    },\r\n    "i18n_audio_highlight" : {\r\n        "message" : "Color de audio"\r\n    },\r\n    "i18n_audio_sync" : {\r\n        "message" : "Granularidad de sincronizacin texto/audio"\r\n    },\r\n    "i18n_audio_sync_default" : {\r\n        "message" : "Por defecto"\r\n    },\r\n    "i18n_audio_sync_word" : {\r\n        "message" : "Palabra"\r\n    },\r\n    "i18n_audio_sync_sentence" : {\r\n        "message" : "Oracin"\r\n    },\r\n    "i18n_audio_sync_paragraph" : {\r\n        "message" : "Prrafo"\r\n    },\r\n    "i18n_page_previous" : {\r\n        "message" : "Pgina previa"\r\n    },\r\n    "i18n_page_next" : {\r\n        "message" : "Pgina siguiente"\r\n    },\r\n    "i18n_author_theme" : {\r\n      "message" : "Por defecto (estilos de autor)"\r\n    },\r\n\r\n  "i18n_spread_auto" : {\r\n       "message" : "Automtico"\r\n    },\r\n\r\n  "i18n_scroll_mode_auto" : {\r\n      "message" : "Automtico"\r\n    },\r\n\r\n   "i18n_page_transition" : {\r\n      "message" : "EFECTOS DE PGINA"\r\n    },\r\n    "i18n_page_transition_none" : {\r\n      "message" : "Desactivado"\r\n    },\r\n    "i18n_page_transition_fade" : {\r\n      "message" : "Apagarse"\r\n    },\r\n    "i18n_page_transition_slide" : {\r\n      "message" : "Deslizar"\r\n    },\r\n    "i18n_page_transition_swoosh" : {\r\n      "message" : "Swoosh"\r\n    },\r\n    "i18n_page_transition_butterfly" : {\r\n      "message" : "Mariposa"\r\n    },\r\n\r\n  "i18n_toolbar" : {\r\n      "message" : "Barra de herramientas"\r\n    },\r\n\r\n   "i18n_audio_play_background" : {\r\n      "message" : "Reproducir pista en segundo plano"\r\n    },\r\n    "i18n_audio_pause_background" : {\r\n      "message" : "Pausar pista en segundo plano"\r\n},\r\n\r\n   "i18n_auto_page_turn_enable" : {\r\n      "message" : "Activar vuelta de pgina automtica"\r\n    },\r\n    "i18n_auto_page_turn_disable" : {\r\n      "message" : "Desactivar vuelta de pgina automtica"\r\n    },\r\n\r\n   "i18n_playback_scroll_enable" : {\r\n      "message" : "Activar desplazamiento durante la reproduccin"\r\n    },\r\n\r\n    "i18n_playback_scroll_disable" : {\r\n      "message" : "Desactivar desplazamiento durante la reproduccin"\r\n    },\r\n\r\n    "chrome_accept_languages": {\r\n        "message": "$CHROME$ acepta idiomas $languages$",\r\n        "placeholders": {\r\n            "chrome": {\r\n                "content": "Chrome",\r\n                "example": "Chrome"\r\n            },\r\n            "languages": {\r\n                "content": "$1",\r\n                "example": "en-US,ja,sr,de,zh_CN"\r\n            }\r\n        }\r\n    },\r\n\r\n    "i18n_zoom_custom": {\r\n        "message": "Custom"\r\n    },\r\n    "i18n_zoom_width": {\r\n        "message": "Ajusta ample"\r\n    },\r\n    "i18n_zoom_screen": {\r\n        "message": "Ajusta ample de pgina"\r\n    }\r\n}';
    }),
    define("text!readium_js_viewer_i18n/_locales/en_US/messages.json", [], function () {
        return '{\r\n  "gitHasLocalChanges": {\r\n    "message": "with local changes"\r\n  },\r\n\r\n  "chrome_extension_name": {\r\n    "message": "Readium"\r\n  },\r\n  "about" : {\r\n    "message" : "About"\r\n  },\r\n  "preview" : {\r\n    "message" : "PREVIEW"\r\n  },\r\n  "list_view" : {\r\n    "message" : "List View"\r\n  },\r\n  "thumbnail_view" : {\r\n    "message" : "Thumbnail View"\r\n  },\r\n  "view_library": {\r\n    "message" : "Library"\r\n  },\r\n  "highlight_selection" : {\r\n    "message" : "Highlight Selected Text"\r\n  },\r\n  "share_url" : {\r\n    "message" : "Share reader bookmark..."\r\n  },\r\n  "share_url_label" : {\r\n    "message" : "Use your clipboard to copy/paste this shareable link:"\r\n  },\r\n  "toc" : {\r\n    "message" : "Table of Contents"\r\n  },\r\n  "extra_contents" : {\r\n        "message" : "Extra Contents"\r\n    },\r\n  "settings" : {\r\n    "message" : "Settings"\r\n  },\r\n  "layout" : {\r\n    "message" : "Layout"\r\n  },\r\n  "style" : {\r\n    "message" : "Style"\r\n  },\r\n  "enter_fullscreen" : {\r\n    "message" : "Enter Fullscreen"\r\n  },\r\n  "exit_fullscreen" : {\r\n    "message" : "Exit Fullscreen"\r\n  },\r\n  "chrome_extension_description": {\r\n    "message": "A reader for EPUB3 books."\r\n  },\r\n  "ok" : {\r\n    "message" : "Ok"\r\n  },\r\n  "delete_dlg_title" : {\r\n    "message" : "Confirm Delete"\r\n  },\r\n  "delete_progress_title" : {\r\n    "message" : "Delete in Progress"\r\n  },\r\n  "delete_progress_message" : {\r\n    "message" : "Deleting"\r\n  },\r\n  "migrate_dlg_title" : {\r\n    "message" : "Migrating Books"\r\n  },\r\n  "migrate_dlg_message" : {\r\n    "message" : "Loading data..."\r\n  },\r\n  "migrating" : {\r\n    "message" : "Migrating"\r\n  },\r\n  "replace_dlg_title" : {\r\n    "message": "Conflict Detected"\r\n  },\r\n  "replace_dlg_message": {\r\n    "message": "If you continue, the following epub will be replaced with the one you are importing"\r\n  },\r\n  "import_dlg_title" : {\r\n    "message": "Importing EPUB"\r\n  },\r\n  "import_dlg_message" : {\r\n    "message": "Examining EPUB content..."\r\n  },\r\n  "storing_file" : {\r\n    "message": "Storing file"\r\n  },\r\n  "err_unknown" : {\r\n    "message": "Unknown error. Check console for more details."\r\n  },\r\n  "err_storage" : {\r\n    "message": "Unable to access storage"\r\n  },\r\n  "err_epub_corrupt" : {\r\n    "message": "Invalid or corrupted EPUB package"\r\n  },\r\n  "err_ajax": {\r\n    "message": "Error in ajax request"\r\n  },\r\n  "err_dlg_title" : {\r\n    "message": "Unexpected Error"\r\n  },\r\n  "replace" : {\r\n    "message": "Replace"\r\n  },\r\n  "gethelp" : {\r\n    "message" : "If you encounter any problems, have questions, or would like to say hello, visit <a href=\\"http://idpf.org/forums/readium\\">our forum</a>"\r\n  },\r\n  "i18n_readium_library" : {\r\n    "message" : "Readium Library"\r\n  },\r\n  "i18n_loading" : {\r\n    "message" : "Loading Library"\r\n  },\r\n  "i18n_readium_options" : {\r\n    "message" : "Readium Options:"\r\n  },\r\n  "i18n_save_changes" : {\r\n    "message" : "Save changes"\r\n  },\r\n  "i18n_close" : {\r\n    "message" : "Close"\r\n  },\r\n  "i18n_keyboard_shortcuts" : {\r\n    "message" : "Keyboard shortcuts"\r\n  },\r\n  "i18n_keyboard_reload" : {\r\n    "message" : "Please reload the page for keyboard shortcuts to take effect."\r\n  },\r\n  "i18n_keyboard_onerror_reset" : {\r\n    "message" : "Please note: Any shortcuts marked INVALID or DUPLICATE have been reset to original values."\r\n  },\r\n  "i18n_reset_key" : {\r\n    "message" : "Reset key"\r\n  },\r\n  "i18n_reset_key_all" : {\r\n    "message" : "Reset all keyboard shortcuts"\r\n  },\r\n  "i18n_duplicate_keyboard_shortcut" : {\r\n    "message" : "DUPLICATE"\r\n  },\r\n  "i18n_invalid_keyboard_shortcut" : {\r\n    "message" : "INVALID"\r\n  },\r\n  "i18n_paginate_all" : {\r\n    "message" : "Paginate all reflowable ePUB content"\r\n  },\r\n  "i18n_automatically" : {\r\n    "message" : "Automatically open *.epub urls in readium"\r\n  },\r\n  "i18n_show_warning" : {\r\n    "message" : "Show warning messages when unpacking EPUB files"\r\n  },\r\n  "i18n_details" : {\r\n    "message" : "Details"\r\n  },\r\n  "i18n_read" : {\r\n    "message" : "Read"\r\n  },\r\n  "i18n_delete" : {\r\n    "message" : "Delete"\r\n  },\r\n  "i18n_author" : {\r\n    "message" : "Author: "\r\n  },\r\n  "i18n_publisher" : {\r\n    "message" : "Publisher: "\r\n  },\r\n  "i18n_source" : {\r\n    "message" : "Source: "\r\n  },\r\n  "i18n_pub_date" : {\r\n    "message" : "Pub Date: "\r\n  },\r\n  "i18n_modified_date" : {\r\n    "message" : "Modified Date: "\r\n  },\r\n  "i18n_id" : {\r\n    "message" : "ID: "\r\n  },\r\n  "i18n_epub_version" : {\r\n    "message" : "EPUB version: "\r\n  },\r\n  "i18n_created_at" : {\r\n    "message" : "Created at: "\r\n  },\r\n  "i18n_format" : {\r\n    "message" : "Format: "\r\n  },\r\n  "i18n_added" : {\r\n    "message" : "Added: "\r\n  },\r\n  "i18n_unknown" : {\r\n    "message" : "Unknown"\r\n  },\r\n  "i18n_sorry" : {\r\n    "message" : "Sorry, the current EPUB does not contain a media overlay for this content"\r\n  },\r\n  "i18n_add_items" : {\r\n    "message" : "Add items to your library here!"\r\n  },\r\n  "i18n_extracting" : {\r\n    "message" : "extracting: "\r\n  },\r\n  "i18n_are_you_sure" : {\r\n    "message" : "Are you sure you want to permanently delete "\r\n  },\r\n  "i18n_add_book_to_readium_library" : {\r\n    "message" : "Add Book To Readium Library:"\r\n  },\r\n  "i18n_add_book" : {\r\n    "message" : "Add to Library"\r\n  },\r\n  "i18n_cancel" : {\r\n    "message" : "Cancel"\r\n  },\r\n  "i18n_from_the_web" : {\r\n    "message" : "From the web:"\r\n  },\r\n  "i18n_from_local_file" : {\r\n    "message" : "From Local File:"\r\n  },\r\n  "i18n_enter_a_url" : {\r\n    "message" : "Enter a URL to a .epub file"\r\n  },\r\n  "i18n_unpacked_directory" : {\r\n    "message" : "Unpacked Directory:"\r\n  },\r\n  "i18n_validate" : {\r\n    "message" : "Validate:"\r\n  },\r\n  "i18n_confirm_that_this_book" : {\r\n    "message" : "Confirm that this book complies with ePUB standards"\r\n  },\r\n  "i18n_single_pages" : {\r\n    "message" : "Single Pages"\r\n  },\r\n  "i18n_double_pages" : {\r\n    "message" : "Double Pages"\r\n  },\r\n  "i18n_save_settings" : {\r\n    "message" : "Save Settings"\r\n  },\r\n  "i18n_font_size" : {\r\n    "message" : "FONT SIZE"\r\n  },\r\n  "i18n_margins" : {\r\n    "message" : "MARGINS"\r\n  },\r\n  "i18n_pageMaxWidth" : {\r\n    "message" : "PAGE WIDTH"\r\n  },\r\n  "i18n_pageMaxWidth_Disabled" : {\r\n    "message" : "Disabled (no maximum)"\r\n  },\r\n  "i18n_text_and_background_color" : {\r\n    "message" : "TEXT AND BACKGROUND COLOR"\r\n  },\r\n  "i18n_author_theme" : {\r\n    "message" : "Default (author styles)"\r\n  },\r\n  "i18n_black_and_white" : {\r\n    "message" : "Black and White"\r\n  },\r\n  "i18n_arabian_nights" : {\r\n    "message" : "Arabian Nights"\r\n  },\r\n  "i18n_sands_of_dune" : {\r\n    "message" : "Sands of Dune"\r\n  },\r\n  "i18n_ballard_blues" : {\r\n    "message" : "Ballard Blues"\r\n  },\r\n  "i18n_vancouver_mist" : {\r\n    "message" : "Vancouver Mist"\r\n  },\r\n  "i18n_display_format" : {\r\n    "message" : "DISPLAY FORMAT"\r\n  },\r\n  "i18n_spread_auto" : {\r\n     "message" : "Auto"\r\n  },\r\n  "i18n_scroll_mode" : {\r\n    "message" : "SCROLL MODE"\r\n  },\r\n  "i18n_scroll_mode_auto" : {\r\n    "message" : "Auto"\r\n  },\r\n  "i18n_scroll_mode_doc" : {\r\n    "message" : "Document"\r\n  },\r\n  "i18n_scroll_mode_continuous" : {\r\n    "message" : "Continuous"\r\n  },\r\n\r\n  "i18n_page_transition" : {\r\n    "message" : "PAGE EFFECTS"\r\n  },\r\n  "i18n_page_transition_none" : {\r\n    "message" : "Disabled"\r\n  },\r\n  "i18n_page_transition_fade" : {\r\n    "message" : "Fade"\r\n  },\r\n  "i18n_page_transition_slide" : {\r\n    "message" : "Slide"\r\n  },\r\n  "i18n_page_transition_swoosh" : {\r\n    "message" : "Swoosh"\r\n  },\r\n  "i18n_page_transition_butterfly" : {\r\n    "message" : "Butterfly"\r\n  },\r\n\r\n  "i18n_html_readium_tm_a_project" : {\r\n    "message" : "Readium for Chrome is the Chrome browser extension configuration of ReadiumJS, an open source reading system and JavaScript library for displaying EPUB publications in web browsers. ReadiumJS is a project of the Readium Foundation (Readium.org). To learn more or to contribute, visit the <a id=\\"aboutFirst Focusable\\" href=\\"http://readium.org/projects/readiumjs\\">project homepage</a>"\r\n  },\r\n  "i18n_toolbar" : {\r\n    "message" : "Toolbar"\r\n  },\r\n  "i18n_toolbar_show" : {\r\n    "message" : "Show toolbar"\r\n  },\r\n  "i18n_toolbar_hide" : {\r\n    "message" : "Hide toolbar"\r\n  },\r\n  "i18n_audio_play" : {\r\n    "message" : "Play"\r\n  },\r\n  "i18n_audio_pause" : {\r\n    "message" : "Pause"\r\n  },\r\n  "i18n_audio_play_background" : {\r\n    "message" : "Play background track"\r\n  },\r\n  "i18n_audio_pause_background" : {\r\n    "message" : "Pause background track"\r\n  },\r\n  "i18n_audio_previous" : {\r\n    "message" : "Previous audio phrase"\r\n  },\r\n  "i18n_audio_next" : {\r\n    "message" : "Next audio phrase"\r\n  },\r\n  "i18n_audio_volume" : {\r\n    "message" : "Audio volume"\r\n  },\r\n  "i18n_audio_volume_increase" : {\r\n    "message" : "Increase audio volume"\r\n  },\r\n  "i18n_audio_volume_decrease" : {\r\n    "message" : "Decrease audio volume"\r\n  },\r\n  "i18n_audio_time" : {\r\n    "message" : "Audio time cursor"\r\n  },\r\n  "i18n_audio_mute" : {\r\n    "message" : "Mute audio"\r\n  },\r\n  "i18n_audio_unmute" : {\r\n    "message" : "Unmute audio"\r\n  },\r\n  "i18n_audio_expand" : {\r\n    "message" : "Show advanced audio controls"\r\n  },\r\n  "i18n_audio_collapse" : {\r\n    "message" : "Close advanced audio controls"\r\n  },\r\n  "i18n_audio_esc" : {\r\n    "message" : "Escape current audio context"\r\n  },\r\n  "i18n_audio_rate" : {\r\n    "message" : "Audio playback rate"\r\n  },\r\n  "i18n_audio_rate_increase" : {\r\n    "message" : "Increase audio playback rate"\r\n  },\r\n  "i18n_audio_rate_decrease" : {\r\n    "message" : "Decrease audio playback rate"\r\n  },\r\n  "i18n_audio_rate_reset" : {\r\n    "message" : "Reset audio playback to normal speed"\r\n  },\r\n  "i18n_audio_skip_disable" : {\r\n    "message" : "Disable skippability"\r\n  },\r\n  "i18n_audio_skip_enable" : {\r\n    "message" : "Enable skippability"\r\n  },\r\n\r\n  "i18n_auto_page_turn_enable" : {\r\n    "message" : "Enable automatic page turn"\r\n  },\r\n  "i18n_auto_page_turn_disable" : {\r\n    "message" : "Disable automatic page turn"\r\n  },\r\n\r\n  "i18n_playback_scroll_enable" : {\r\n    "message" : "Enable scroll during playback"\r\n  },\r\n  "i18n_playback_scroll_disable" : {\r\n    "message" : "Disable scroll during playback"\r\n  },\r\n\r\n  "i18n_audio_touch_enable" : {\r\n    "message" : "Enable touch-to-play"\r\n  },\r\n  "i18n_audio_touch_disable" : {\r\n    "message" : "Disable touch-to-play"\r\n  },\r\n  "i18n_audio_highlight_default" : {\r\n    "message" : "default"\r\n  },\r\n  "i18n_audio_highlight" : {\r\n    "message" : "Audio color"\r\n  },\r\n  "i18n_audio_sync" : {\r\n    "message" : "Text/audio synchronization granularity"\r\n  },\r\n  "i18n_audio_sync_default" : {\r\n    "message" : "Default"\r\n  },\r\n  "i18n_audio_sync_word" : {\r\n    "message" : "Word"\r\n  },\r\n  "i18n_audio_sync_sentence" : {\r\n    "message" : "Sentence"\r\n  },\r\n  "i18n_audio_sync_paragraph" : {\r\n    "message" : "Paragraph"\r\n  },\r\n  "i18n_page_previous" : {\r\n    "message" : "Previous Page"\r\n  },\r\n  "i18n_page_next" : {\r\n    "message" : "Next Page"\r\n  },\r\n  "i18n_page_navigation" : {\r\n    "message" : "Page Navigation"\r\n  },\r\n  "chrome_accept_languages": {\r\n    "message": "$CHROME$ accepts $languages$ languages",\r\n    "placeholders": {\r\n      "chrome": {\r\n        "content": "Chrome",\r\n        "example": "Chrome"\r\n      },\r\n      "languages": {\r\n        "content": "$1",\r\n        "example": "en-US,ja,sr,de,zh_CN"\r\n      }\r\n    }\r\n  },\r\n  "i18n_zoom_custom": {\r\n        "message": "Custom"\r\n    },\r\n    "i18n_zoom_width": {\r\n        "message": "Fit width"\r\n    },\r\n    "i18n_zoom_screen": {\r\n        "message": "Fit screen"\r\n    }\r\n}\r\n';
    }),
    define("text!readium_js_viewer_i18n/_locales/fr/messages.json", [], function () {
        return '{\r\n  "chrome_extension_name": {\r\n    "message": "Readium"\r\n  },\r\n  "chrome_extension_description": {\r\n    "message": "Un lecteur de livres numriques EPUB3."\r\n  },\r\n  "i18n_readium_library" : {\r\n    "message" : "Bibliothque Readium"\r\n  },\r\n  "i18n_loading" : {\r\n    "message" : "Chargement de la bibliothque"\r\n  },\r\n  "i18n_readium_options" : {\r\n    "message" : "Options de Readium :"\r\n  },\r\n  "i18n_save_changes" : {\r\n    "message" : "Enregistrer les changements"\r\n  },\r\n  "i18n_close" : {\r\n    "message" : "Fermer"\r\n  },\r\n  "i18n_keyboard_shortcuts" : {\r\n    "message" : "Raccourcis clavier"\r\n  },\r\n  "i18n_keyboard_reload" : {\r\n    "message" : "Veuillez recharger la page pour que les raccourcis clavier prennent effet."\r\n  },\r\n  "i18n_reset_key" : {\r\n    "message" : "Rinitialiser le raccourci clavier par dfaut"\r\n  },\r\n  "i18n_reset_key_all" : {\r\n    "message" : "Rinitialiser tous les raccourcis clavier par dfaut"\r\n  },\r\n  "i18n_duplicate_keyboard_shortcut" : {\r\n    "message" : "DUPLIQUE"\r\n  },\r\n  "i18n_invalid_keyboard_shortcut" : {\r\n    "message" : "INVALIDE"\r\n  },\r\n  "i18n_paginate_all" : {\r\n    "message" : "Paginer tout le contenu des EPUB recomposables"\r\n  },\r\n  "i18n_automatically" : {\r\n    "message" : "Ouvrir automatiquement les urls *.epub dans Readium"\r\n  },\r\n  "i18n_show_warning" : {\r\n    "message" : "Montrer les messages d\'avertissement pendant la dcompression des fichiers EPUB"\r\n  },\r\n  "i18n_details" : {\r\n    "message" : "Dtails"\r\n  },\r\n  "i18n_read" : {\r\n    "message" : "Lire"\r\n  },\r\n  "i18n_delete" : {\r\n    "message" : "Supprimer"\r\n  },\r\n  "i18n_author" : {\r\n    "message" : "Auteur : "\r\n  },\r\n  "i18n_publisher" : {\r\n    "message" : "diteur : "\r\n  },\r\n  "i18n_source" : {\r\n    "message" : "Source : "\r\n  },\r\n  "i18n_pub_date" : {\r\n    "message" : "Date de publication :  "\r\n  },\r\n  "i18n_modified_date" : {\r\n    "message" : "Date de modification : "\r\n  },\r\n  "i18n_id" : {\r\n    "message" : "ID: "\r\n  },\r\n  "i18n_epub_version" : {\r\n    "message" : "version de l\'EPUB : "\r\n  },\r\n  "i18n_created_at" : {\r\n    "message" : "Ajout le : "\r\n  },\r\n  "i18n_format" : {\r\n    "message" : "Format : "\r\n  },\r\n  "i18n_added" : {\r\n    "message" : "Ajout le : "\r\n  },\r\n  "i18n_unknown" : {\r\n    "message" : "Inconnu"\r\n  },\r\n  "i18n_sorry" : {\r\n    "message" : "Dsol, l\'EPUB actuel ne contient pas de mdia associ (media overlay) pour ce contenu"\r\n  },\r\n  "i18n_add_items" : {\r\n    "message" : "Ajoutez des articles  votre bibliothque ici !"\r\n  },\r\n  "i18n_extracting" : {\r\n    "message" : "extraction : "\r\n  },\r\n  "i18n_are_you_sure" : {\r\n    "message" : "Voulez-vous vraiment supprimer "\r\n  },\r\n  "i18n_add_book_to_readium_library" : {\r\n    "message" : "Ajoutez un livre  la bibliothque de Readium :"\r\n  },\r\n  "i18n_add_book" : {\r\n    "message" : "Ajouter un livre"\r\n  },\r\n  "i18n_cancel" : {\r\n    "message" : "Annuler"\r\n  },\r\n  "i18n_from_the_web" : {\r\n    "message" : " partir du Web :"\r\n  },\r\n  "i18n_from_local_file" : {\r\n    "message" : " partir d\'un fichier local :"\r\n  },\r\n  "i18n_enter_a_url" : {\r\n    "message" : "Entrez l\'URL d\'un fichier .epub"\r\n  },\r\n  "i18n_unpacked_directory" : {\r\n    "message" : "Rpertoire non-compress :"\r\n  },\r\n  "i18n_validate" : {\r\n    "message" : "Valider :"\r\n  },\r\n  "i18n_confirm_that_this_book" : {\r\n    "message" : "Confirmer que ce livre est conforme aux standards EPUB"\r\n  },\r\n  "i18n_single_pages" : {\r\n    "message" : "Pages simples"\r\n  },\r\n  "i18n_double_pages" : {\r\n    "message" : "Doubles-pages"\r\n  },\r\n  "i18n_save_settings" : {\r\n    "message" : "Enregistrer"\r\n  },\r\n  "i18n_font_size" : {\r\n    "message" : "TAILLE DE LA POLICE"\r\n  },\r\n  "i18n_margins" : {\r\n    "message" : "MARGES"\r\n  },\r\n  "i18n_text_and_background_color" : {\r\n    "message" : "COULEUR DU TEXTE ET DU FOND"\r\n  },\r\n  "i18n_black_and_white" : {\r\n    "message" : "Noir et Blanc"\r\n  },\r\n  "i18n_arabian_nights" : {\r\n    "message" : "Mille et une Nuits"\r\n  },\r\n  "i18n_sands_of_dune" : {\r\n    "message" : "Sables de Dune"\r\n  },\r\n  "i18n_ballard_blues" : {\r\n    "message" : "Le Blues de Ballard"\r\n  },\r\n  "i18n_vancouver_mist" : {\r\n    "message" : "Le Brouillard de Vancouver"\r\n  },\r\n  "i18n_display_format" : {\r\n    "message" : "FORMAT D\'AFFICHAGE"\r\n  },\r\n  "i18n_scroll_mode" : {\r\n    "message" : "MODE DE DFILEMENT"\r\n  },\r\n  "i18n_scroll_mode_auto" : {\r\n    "message" : "Auto"\r\n  },\r\n  "i18n_scroll_mode_doc" : {\r\n    "message" : "Document"\r\n  },\r\n  "i18n_scroll_mode_continuous" : {\r\n    "message" : "Continu"\r\n  },\r\n  "i18n_html_readium_tm_a_project" : {\r\n    "message" : "Readium pour Chrome est l\'extension du navigateur Chrome de ReadiumJS, un systme de lecture open-source et une librairie JavaScript pour afficher des documents EPUB dans les navigateurs web. ReadiumJS est un projet de la fondation Readium (Readium.org). Pour en savoir plus ou pour contribuer, visiter la <a href=\\"http://readium.org/projects/readiumjs\\">page d\'accueil du projet</a>."\r\n  },\r\n  "i18n_audio_play" : {\r\n    "message" : "Jouer"\r\n  },\r\n  "i18n_audio_pause" : {\r\n    "message" : "Pauser"\r\n  },\r\n  "i18n_audio_previous" : {\r\n    "message" : "Phrase audio prcdente"\r\n  },\r\n  "i18n_audio_next" : {\r\n    "message" : "Phrase audio suivante"\r\n  },\r\n  "i18n_audio_volume" : {\r\n    "message" : "Ajustement du volume audio"\r\n  },\r\n  "i18n_audio_time" : {\r\n    "message" : "Contrle du curseur temporel audio"\r\n  },\r\n  "i18n_audio_mute" : {\r\n    "message" : "Silence audio"\r\n  },\r\n  "i18n_audio_unmute" : {\r\n    "message" : "Restaurer le volume audio"\r\n  },\r\n  "i18n_audio_expand" : {\r\n    "message" : "Afficher les contrles audio avancs"\r\n  },\r\n  "i18n_audio_collapse" : {\r\n    "message" : "Fermer les contrles audio avancs"\r\n  },\r\n  "i18n_audio_esc" : {\r\n    "message" : "chapper le contexte audio actuel"\r\n  },\r\n  "i18n_audio_rate" : {\r\n    "message" : "Vitesse de lecture audio"\r\n  },\r\n  "i18n_audio_rate_reset" : {\r\n    "message" : "Retour  la vitesse normale de lecture audio"\r\n  },\r\n  "i18n_audio_skip_disable" : {\r\n    "message" : "Dsactiver la \'skippabilit\'"\r\n  },\r\n  "i18n_audio_skip_enable" : {\r\n    "message" : "Activer la \'skippabilit\'"\r\n  },\r\n  "i18n_audio_touch_enable" : {\r\n    "message" : "Activer la fonction \'toucher pour jouer\'"\r\n  },\r\n  "i18n_audio_touch_disable" : {\r\n    "message" : "Dsactiver la fonction \'toucher pour jouer\'"\r\n  },\r\n  "i18n_audio_highlight_default" : {\r\n    "message" : "dfaut"\r\n  },\r\n  "i18n_audio_highlight" : {\r\n    "message" : "Couleur audio"\r\n  },\r\n  "i18n_audio_sync" : {\r\n    "message" : "Granularit de synchronisation texte / audio"\r\n  },\r\n  "i18n_audio_sync_default" : {\r\n    "message" : "Dfaut"\r\n  },\r\n  "i18n_audio_sync_word" : {\r\n    "message" : "Mot"\r\n  },\r\n  "i18n_audio_sync_sentence" : {\r\n    "message" : "Phrase"\r\n  },\r\n  "i18n_audio_sync_paragraph" : {\r\n    "message" : "Paragraphe"\r\n  },\r\n  "i18n_page_previous" : {\r\n    "message" : "Page prcdente"\r\n  },\r\n  "i18n_page_next" : {\r\n    "message" : "Page suivante"\r\n  },\r\n  "chrome_accept_languages": {\r\n    "message": "$CHROME$ accepts $languages$ languages",\r\n    "placeholders": {\r\n      "chrome": {\r\n        "content": "Chrome",\r\n        "example": "Chrome"\r\n      },\r\n      "languages": {\r\n        "content": "$1",\r\n        "example": "en-US,fr,ja,de"\r\n      }\r\n    }\r\n  }\r\n}\r\n';
    }),
    define("text!readium_js_viewer_i18n/_locales/it/messages.json", [], function () {
        return '{\r\n  "chrome_extension_name": {\r\n    "message": "Readium"\r\n  },\r\n  "chrome_extension_description": {\r\n    "message": "Un visualizzatore di documenti EPUB3"\r\n  },\r\n  "i18n_readium_library" : {\r\n    "message" : "Biblioteca di Readium"\r\n  },\r\n  "i18n_loading" : {\r\n    "message" : "Caricamento biblioteca"\r\n  },\r\n  "i18n_readium_options" : {\r\n    "message" : "Opzioni di Readium"\r\n  },\r\n  "i18n_save_changes" : {\r\n    "message" : "Applica"\r\n  },\r\n  "i18n_close" : {\r\n    "message" : "Chiudi"\r\n  },\r\n  "i18n_paginate_all" : {\r\n    "message" : "Impagina anche i file EPUB reflowable"\r\n  },\r\n  "i18n_automatically" : {\r\n    "message" : "Apri in Readium gli URL che terminano in .epub"\r\n  },\r\n  "i18n_show_warning" : {\r\n    "message" : "Mostra errori e avvisi relativi ai file EPUB"\r\n  },\r\n  "i18n_details" : {\r\n    "message" : "Dettagli"\r\n  },\r\n  "i18n_read" : {\r\n    "message" : "Leggi"\r\n  },\r\n  "i18n_delete" : {\r\n    "message" : "Elimina"\r\n  },\r\n  "i18n_author" : {\r\n    "message" : "Autore: "\r\n  },\r\n  "i18n_publisher" : {\r\n    "message" : "Editore: "\r\n  },\r\n  "i18n_source" : {\r\n    "message" : "Origine: "\r\n  },\r\n  "i18n_pub_date" : {\r\n    "message" : "Data pubblicazione: "\r\n  },\r\n  "i18n_modified_date" : {\r\n    "message" : "Data ultima modifica: "\r\n  },\r\n  "i18n_id" : {\r\n    "message" : "ID: "\r\n  },\r\n  "i18n_epub_version" : {\r\n    "message" : "Versione EPUB: "\r\n  },\r\n  "i18n_created_at" : {\r\n    "message" : "Data importazione: "\r\n  },\r\n  "i18n_format" : {\r\n    "message" : "Formato: "\r\n  },\r\n  "i18n_added" : {\r\n    "message" : "Aggiunto: "\r\n  },\r\n  "i18n_unknown" : {\r\n    "message" : "Sconosciuto"\r\n  },\r\n  "i18n_sorry" : {\r\n    "message" : "Spiacente, non ci sono risorse Media Overlays associate a questo elemento."\r\n  },\r\n  "i18n_add_items" : {\r\n    "message" : "Aggiungi libri alla tua biblioteca!"\r\n  },\r\n  "i18n_extracting" : {\r\n    "message" : "Decomprimendo: "\r\n  },\r\n  "i18n_are_you_sure" : {\r\n    "message" : "Sei sicuro di voler cancellare definitivamente "\r\n  },\r\n  "i18n_add_book_to_readium_library" : {\r\n    "message" : "Aggiungi libro alla Biblioteca di Readium"\r\n  },\r\n  "i18n_add_book" : {\r\n    "message" : "Aggiungi libro"\r\n  },\r\n  "i18n_cancel" : {\r\n    "message" : "Annulla"\r\n  },\r\n  "i18n_from_the_web" : {\r\n    "message" : "Scarica dal Web:"\r\n  },\r\n  "i18n_from_local_file" : {\r\n    "message" : "Importa file EPUB dal tuo computer:"\r\n  },\r\n  "i18n_enter_a_url" : {\r\n    "message" : "Indirizzo Web del file EPUB che vuoi aggiungere:"\r\n  },\r\n  "i18n_unpacked_directory" : {\r\n    "message" : "Importa directory decompressa:"\r\n  },\r\n  "i18n_validate" : {\r\n    "message" : "Convalida:"\r\n  },\r\n  "i18n_confirm_that_this_book" : {\r\n    "message" : "Controlla che i file siano conformi allo standard EPUB prima di aprirli"\r\n  },\r\n  "i18n_single_pages" : {\r\n    "message" : "Singole"\r\n  },\r\n  "i18n_double_pages" : {\r\n    "message" : "Affiancate"\r\n  },\r\n  "i18n_save_settings" : {\r\n    "message" : "Applica"\r\n  },\r\n  "i18n_font_size" : {\r\n    "message" : "DIMENSIONE CARATTERE"\r\n  },\r\n  "i18n_margins" : {\r\n    "message" : "MARGINI"\r\n  },\r\n  "i18n_text_and_background_color" : {\r\n    "message" : "COMBINAZIONE COLORE TESTO/SFONDO"\r\n  },\r\n  "i18n_black_and_white" : {\r\n    "message" : "Bianco su nero"\r\n  },\r\n  "i18n_arabian_nights" : {\r\n    "message" : "Notturno"\r\n  },\r\n  "i18n_sands_of_dune" : {\r\n    "message" : "Deserto"\r\n  },\r\n  "i18n_ballard_blues" : {\r\n    "message" : "Mediterraneo"\r\n  },\r\n  "i18n_vancouver_mist" : {\r\n    "message" : "Nebbia"\r\n  },\r\n  "i18n_display_format" : {\r\n    "message" : "VISUALIZZAZIONE PAGINE"\r\n  },\r\n  "i18n_html_readium_tm_a_project" : {\r\n    "message" : "Readium<sup>TM</sup>, progetto dell\'International Digital Publishing Forum (IDPF) e dei suoi sostenitori,  una piattaforma open source di lettura e un motore di rendering per documenti in formato EPUB&reg;. Per saperne di pi, visita la <a href=\\"http://readium.org/\\">pagina principale del progetto</a>. Lo sviluppo del progetto  stato guidato da <a href=\\"http://evidentpoint.com/\\">Evident Point</a> e <a href=\\"http://www.bluefirereader.com/\\">Bluefire Productions</a>. Per contribuire, visita il <a href=\\"https://github.com/readium/readium-js-viewer\\">repository github</a>."\r\n  },\r\n  "chrome_accept_languages": {\r\n    "message": "$CHROME$ accetta le seguenti lingue: $languages$",\r\n    "placeholders": {\r\n      "chrome": {\r\n        "content": "Chrome",\r\n        "example": "Chrome"\r\n      },\r\n      "languages": {\r\n        "content": "$1",\r\n        "example": "en-US,it,ja,sr,de,zh_CN"\r\n      }\r\n    }\r\n  }\r\n}\r\n';
    }),
    define("text!readium_js_viewer_i18n/_locales/id/messages.json", [], function () {
        return '{\r\n  "chrome_extension_name": {\r\n    "message": "Readium"\r\n  },\r\n  "chrome_extension_description": {\r\n    "message": "reader untuk buku-buku EPUB3 ."\r\n  },\r\n  "i18n_readium_library" : {\r\n    "message" : "Perpustakaan Readium"\r\n  },\r\n  "i18n_loading" : {\r\n    "message" : "Loading Library"\r\n  },\r\n  "i18n_readium_options" : {\r\n    "message" : "Pilihan Readium :"\r\n  },\r\n  "i18n_save_changes" : {\r\n    "message" : "Simpan perubahan"\r\n  },\r\n  "i18n_close" : {\r\n    "message" : "Tutup"\r\n  },\r\n  "i18n_paginate_all" : {\r\n    "message" : "Paginate all reflowable ePUB content"\r\n  },\r\n  "i18n_automatically" : {\r\n    "message" : "Secara otomatis buka *.epub urls di readium"\r\n  },\r\n  "i18n_show_warning" : {\r\n    "message" : "Tampilkan pesan peringatan ketika unpacking file EPUB"\r\n  },\r\n  "i18n_details" : {\r\n    "message" : "Detail"\r\n  },\r\n  "i18n_read" : {\r\n    "message" : "Baca"\r\n  },\r\n  "i18n_delete" : {\r\n    "message" : "Hapus"\r\n  },\r\n  "i18n_author" : {\r\n    "message" : "Penulis: "\r\n  },\r\n  "i18n_publisher" : {\r\n    "message" : "Penerbit: "\r\n  },\r\n  "i18n_source" : {\r\n    "message" : "Sumber: "\r\n  },\r\n  "i18n_pub_date" : {\r\n    "message" : "Tgl Terbit: "\r\n  },\r\n  "i18n_modified_date" : {\r\n    "message" : "Tgl Modifikasi: "\r\n  },\r\n  "i18n_id" : {\r\n    "message" : "ID: "\r\n  },\r\n  "i18n_epub_version" : {\r\n    "message" : "Versi EPUB: "\r\n  },\r\n  "i18n_created_at" : {\r\n    "message" : "Dibuat di: "\r\n  },\r\n  "i18n_format" : {\r\n    "message" : "Format: "\r\n  },\r\n  "i18n_added" : {\r\n    "message" : "Menambahkan: "\r\n  },\r\n  "i18n_unknown" : {\r\n    "message" : "Tidak dikenal"\r\n  },\r\n  "i18n_sorry" : {\r\n    "message" : "Maaf, EPUB saat ini tidak berisi overlay media untuk konten ini "\r\n  },\r\n  "i18n_add_items" : {\r\n    "message" : "Masukkan item r Library disini!"\r\n  },\r\n  "i18n_extracting" : {\r\n    "message" : "extracting: "\r\n  },\r\n  "i18n_are_you_sure" : {\r\n    "message" : "Apakah and yakin ingin menghapus secara permanen "\r\n  },\r\n  "i18n_add_book_to_readium_library" : {\r\n    "message" : "Masukkan Buku ke Readium Library:"\r\n  },\r\n  "i18n_add_book" : {\r\n    "message" : "Add Book"\r\n  },\r\n  "i18n_cancel" : {\r\n    "message" : "Batal"\r\n  },\r\n  "i18n_from_the_web" : {\r\n    "message" : "Dari Web:"\r\n  },\r\n  "i18n_from_local_file" : {\r\n    "message" : "Dari File local:"\r\n  },\r\n  "i18n_enter_a_url" : {\r\n    "message" : "Masukkan  URL ke file .epub "\r\n  },\r\n  "i18n_unpacked_directory" : {\r\n    "message" : "Unpacked Directory:"\r\n  },\r\n  "i18n_validate" : {\r\n    "message" : "Validasi:"\r\n  },\r\n  "i18n_confirm_that_this_book" : {\r\n    "message" : "Konfirmasikan bahwa buku ini sesuai dengan standar EPUB"\r\n  },\r\n  "i18n_single_pages" : {\r\n    "message" : "Single Pages"\r\n  },\r\n  "i18n_double_pages" : {\r\n    "message" : "Double Pages"\r\n  },\r\n  "i18n_save_settings" : {\r\n    "message" : "Save Settings"\r\n  },\r\n  "i18n_font_size" : {\r\n    "message" : "FONT SIZE"\r\n  },\r\n  "i18n_margins" : {\r\n    "message" : "MARGINS"\r\n  },\r\n  "i18n_text_and_background_color" : {\r\n    "message" : "TEKS DAN WARNA LATAR"\r\n  },\r\n  "i18n_black_and_white" : {\r\n    "message" : "Black and White"\r\n  },\r\n  "i18n_arabian_nights" : {\r\n    "message" : "Arabian Nights"\r\n  },\r\n  "i18n_sands_of_dune" : {\r\n    "message" : "Sands of Dune"\r\n  },\r\n  "i18n_ballard_blues" : {\r\n    "message" : "Ballard Blues"\r\n  },\r\n  "i18n_vancouver_mist" : {\r\n    "message" : "Vancouver Mist"\r\n  },\r\n  "i18n_display_format" : {\r\n    "message" : "DISPLAY FORMAT"\r\n  },\r\n  "i18n_html_readium_tm_a_project" : {\r\n    "message" : "Readium<sup>TM</sup>, a project of the International Digital Publishing Forum (IDPF) and supporters, adalah sistem referensi open source DAN rendering engine untuk EPUB&reg; publikasi.  Untuk mengetahui lebih lanjut, kunjungi <a href=\\"http://readium.org/\\">project homepage</a>. Sampai saat ini, pengembangan project telah dipimpin oleh  <a href=\\"http://evidentpoint.com/\\">Evident Point</a> and <a href=\\"http://www.bluefirereader.com/\\">Bluefire Productions</a>. Untuk kontribusi, kunjungi <a href=\\"https://github.com/readium/readium-js-viewer\\">github repository</a>"\r\n  },\r\n  "chrome_accept_languages": {\r\n    "message": "$CHROME$ accepts $languages$ languages",\r\n    "placeholders": {\r\n      "chrome": {\r\n        "content": "Chrome",\r\n        "example": "Chrome"\r\n      },\r\n      "languages": {\r\n        "content": "$1",\r\n        "example": "en-US,ja,sr,de,zh_CN"\r\n      }\r\n    }\r\n  }\r\n}\r\n';
    }),
    define("text!readium_js_viewer_i18n/_locales/ja/messages.json", [], function () {
        return '{\r\n  "chrome_extension_name": {\r\n    "message": "Readium"\r\n  },\r\n  "chrome_extension_description": {\r\n    "message": "EPUB3"\r\n  },\r\n  "i18n_readium_library" : {\r\n    "message" : "Readium"\r\n  },\r\n  "i18n_loading" : {\r\n    "message" : "Loading Library"\r\n  },\r\n  "i18n_readium_options" : {\r\n    "message" : "Readium:"\r\n  },\r\n  "i18n_save_changes" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_close" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_paginate_all" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_automatically" : {\r\n    "message" : "URL*.epubReadium"\r\n  },\r\n  "i18n_show_warning" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_details" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_read" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_delete" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_author" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_publisher" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_source" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_pub_date" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_modified_date" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_id" : {\r\n    "message" : "ID: "\r\n  },\r\n  "i18n_epub_version" : {\r\n    "message" : "EPUB: "\r\n  },\r\n  "i18n_created_at" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_format" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_added" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_unknown" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_sorry" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_add_items" : {\r\n    "message" : "!"\r\n  },\r\n  "i18n_extracting" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_are_you_sure" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_add_book_to_readium_library" : {\r\n    "message" : "Readium:"\r\n  },\r\n  "i18n_add_book" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_cancel" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_from_the_web" : {\r\n    "message" : "Web:"\r\n  },\r\n  "i18n_from_local_file" : {\r\n    "message" : ":"\r\n  },\r\n  "i18n_enter_a_url" : {\r\n    "message" : ".epubURL"\r\n  },\r\n  "i18n_unpacked_directory" : {\r\n    "message" : ":"\r\n  },\r\n  "i18n_validate" : {\r\n    "message" : ":"\r\n  },\r\n  "i18n_confirm_that_this_book" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_single_pages" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_double_pages" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_save_settings" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_font_size" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_margins" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_text_and_background_color" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_black_and_white" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_arabian_nights" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_sands_of_dune" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_ballard_blues" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_vancouver_mist" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_display_format" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_html_readium_tm_a_project" : {\r\n    "message" : "Readium<sup>TM</sup>, International Digital Publishing Forum (IDPF) , EPUB&reg; <a href=\\"http://readium.org/\\"></a><a href=\\"http://evidentpoint.com/\\">Evident Point</a><a href=\\"http://www.bluefirereader.com/\\">Bluefire Productions</a> <a href=\\"https://github.com/readium/readium-js-viewer\\">github</a>"\r\n  },\r\n  "chrome_accept_languages": {\r\n    "message": "$CHROME$ accepts $languages$ languages",\r\n    "placeholders": {\r\n      "chrome": {\r\n        "content": "Chrome",\r\n        "example": "Chrome"\r\n      },\r\n      "languages": {\r\n        "content": "$1",\r\n        "example": "en-US,ja,sr,de"\r\n      }\r\n    }\r\n  }\r\n}\r\n';
    }),
    define("text!readium_js_viewer_i18n/_locales/ko/messages.json", [], function () {
        return '{\r\n  "chrome_extension_name": {\r\n    "message": "Readium"\r\n  },\r\n  "chrome_extension_description": {\r\n    "message": "EPUB3 ."\r\n  },\r\n  "i18n_readium_library" : {\r\n    "message" : "Readium "\r\n  },\r\n  "i18n_loading" : {\r\n    "message" : "Loading Library"\r\n  },\r\n  "i18n_readium_options" : {\r\n    "message" : "Readium :"\r\n  },\r\n  "i18n_save_changes" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_close" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_paginate_all" : {\r\n    "message" : "   "\r\n  },\r\n  "i18n_automatically" : {\r\n    "message" : "*.epub url radium  "\r\n  },\r\n  "i18n_show_warning" : {\r\n    "message" : "EPUB    "\r\n  },\r\n  "i18n_details" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_read" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_delete" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_author" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_publisher" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_source" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_pub_date" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_modified_date" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_id" : {\r\n    "message" : "ID: "\r\n  },\r\n  "i18n_epub_version" : {\r\n    "message" : "EPUB : "\r\n  },\r\n  "i18n_created_at" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_format" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_added" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_unknown" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_sorry" : {\r\n    "message" : " EPUB        ."\r\n  },\r\n  "i18n_add_items" : {\r\n    "message" : "    !"\r\n  },\r\n  "i18n_extracting" : {\r\n    "message" : "  : "\r\n  },\r\n  "i18n_are_you_sure" : {\r\n    "message" : "  ? "\r\n  },\r\n  "i18n_add_book_to_readium_library" : {\r\n    "message" : "Readium   :"\r\n  },\r\n  "i18n_add_book" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_cancel" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_from_the_web" : {\r\n    "message" : ":"\r\n  },\r\n  "i18n_from_local_file" : {\r\n    "message" : " :"\r\n  },\r\n  "i18n_enter_a_url" : {\r\n    "message" : ".epub  URL "\r\n  },\r\n  "i18n_unpacked_directory" : {\r\n    "message" : " :"\r\n  },\r\n  "i18n_validate" : {\r\n    "message" : ":"\r\n  },\r\n  "i18n_confirm_that_this_book" : {\r\n    "message" : "  ePUB  "\r\n  },\r\n  "i18n_single_pages" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_double_pages" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_save_settings" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_font_size" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_margins" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_text_and_background_color" : {\r\n    "message" : "  "\r\n  },\r\n  "i18n_black_and_white" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_arabian_nights" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_sands_of_dune" : {\r\n    "message" : "  "\r\n  },\r\n  "i18n_ballard_blues" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_vancouver_mist" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_display_format" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_html_readium_tm_a_project" : {\r\n    "message" : "Readium<sup>TM</sup> EPUB&reg;   (IDPF, International Digital Publishing Forum)        .   <a href=\\"http://readium.org/\\"> </a> . ,   <a href=\\"http://evidentpoint.com/\\">Evident Point</a> <a href=\\"http://www.bluefirereader.com/\\">Bluefire Productions</a>   .    <a href=\\"https://github.com/readium/readium-js-viewer\\">github </a>  ."\r\n  },\r\n  "chrome_accept_languages": {\r\n    "message": "$CHROME$ accepts $languages$ languages",\r\n    "placeholders": {\r\n      "chrome": {\r\n        "content": "Chrome",\r\n        "example": "Chrome"\r\n      },\r\n      "languages": {\r\n        "content": "$1",\r\n        "example": "en-US,ja,sr,de,zh_CN"\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n';
    }),
    define("text!readium_js_viewer_i18n/_locales/pt_BR/messages.json", [], function () {
        return '{\r\n  "chrome_extension_name": {\r\n    "message": "Readium"\r\n  },\r\n  "about": {\r\n    "message": "Sobre"\r\n  },\r\n  "preview": {\r\n    "message": "Visualizao prvia"\r\n  },\r\n  "list_view": {\r\n    "message": "Visualizao em lista"\r\n  },\r\n  "thumbnail_view": {\r\n    "message": "Visualizao em miniaturas"\r\n  },\r\n  "view_library": {\r\n    "message": "Biblioteca"\r\n  },\r\n  "highlight_selection": {\r\n    "message": "Destacar texto selecionado"\r\n  },\r\n  "toc": {\r\n    "message": "Tabela de contedos"\r\n  },\r\n  "extra_contents" : {\r\n        "message" : "Contedos extra"\r\n  },\r\n  "settings": {\r\n    "message": "Preferncias"\r\n  },\r\n  "enter_fullscreen": {\r\n    "message": "Abrir o modo de tela cheia"\r\n  },\r\n  "exit_fullscreen": {\r\n    "message": "Fechar modo de tela cheia"\r\n  },\r\n  "chrome_extension_description": {\r\n    "message": "Leitor de livros ePUB3."\r\n  },\r\n  "ok": {\r\n    "message": "OK"\r\n  },\r\n  "delete_dlg_title": {\r\n    "message": "Confirmar excluso"\r\n  },\r\n  "delete_progress_title": {\r\n    "message": "Excluir em processo"\r\n  },\r\n  "delete_progress_message": {\r\n    "message": "Excluindo"\r\n  },\r\n  "migrate_dlg_title": {\r\n    "message": "Migrando livros"\r\n  },\r\n  "migrate_dlg_message": {\r\n    "message": "Carregando dados..."\r\n  },\r\n  "migrating": {\r\n    "message": "Migrando"\r\n  },\r\n  "replace_dlg_title": {\r\n    "message": "Foi detectado um conflito"\r\n  },\r\n  "replace_dlg_message": {\r\n    "message": "Caso continue, o seguinte ePUB ser substitudo por aquele que est sendo importado"\r\n  },\r\n  "import_dlg_title": {\r\n    "message": "Importando ePUB"\r\n  },\r\n  "import_dlg_message": {\r\n    "message": "Examinando contedo do ePUB..."\r\n  },\r\n  "storing_file": {\r\n    "message": "Armazenando arquivo"\r\n  },\r\n  "err_unknown": {\r\n    "message": "Erro desconhecido. Verifique o console para obter detalhes."\r\n  },\r\n  "err_storage": {\r\n    "message": "No  possvel acessar o dispositvo"\r\n  },\r\n  "err_epub_corrupt": {\r\n    "message": "Pacote ePUB invlido ou corrompido"\r\n  },\r\n  "err_dlg_title": {\r\n    "message": "Erro inesperado"\r\n  },\r\n  "replace": {\r\n    "message": "Substitur"\r\n  },\r\n  "gethelp": {\r\n    "message": "Se voc encontrar quaisquer problemas, perguntas, ou gostaria de dizer ol, visite <a href=\\"http://idpf.org/forums/readium\\">nuestro foro</a>"\r\n  },\r\n  "i18n_readium_library": {\r\n    "message": "Biblioteca Readium"\r\n  },\r\n  "i18n_loading": {\r\n    "message": "Carregando biblioteca"\r\n  },\r\n  "i18n_readium_options": {\r\n    "message": "Opes do Readium:"\r\n  },\r\n  "i18n_save_changes": {\r\n    "message": "Salvar mudanas"\r\n  },\r\n  "i18n_close": {\r\n    "message": "Fechar"\r\n  },\r\n  "i18n_keyboard_shortcuts": {\r\n    "message": "Teclas de atalho"\r\n  },\r\n  "i18n_keyboard_reload": {\r\n    "message": "Atualize a pgina para que as teclas de atalho funcionem."\r\n  },\r\n  "i18n_reset_key": {\r\n    "message": "Redefinir boto de atalho"\r\n  },\r\n  "i18n_reset_key_all": {\r\n    "message": "Redefinir todos os botes de atalho"\r\n  },\r\n  "i18n_duplicate_keyboard_shortcut": {\r\n    "message": "DUPLICADO"\r\n  },\r\n  "i18n_invalid_keyboard_shortcut": {\r\n    "message": "INVLIDO"\r\n  },\r\n  "i18n_paginate_all": {\r\n    "message": "Paginar todo o contedo ePUB repaginvel"\r\n  },\r\n  "i18n_automatically": {\r\n    "message": "Abrir automticamente arquivos *.epub no Readium"\r\n  },\r\n  "i18n_show_warning": {\r\n    "message": "Exibir avisos quando descompactar arquivos ePUB"\r\n  },\r\n  "i18n_details": {\r\n    "message": "Detalles"\r\n  },\r\n  "i18n_read": {\r\n    "message": "Ler"\r\n  },\r\n  "i18n_delete": {\r\n    "message": "Excluir"\r\n  },\r\n  "i18n_author": {\r\n    "message": "Autor: "\r\n  },\r\n  "i18n_publisher": {\r\n    "message": "Editor: "\r\n  },\r\n  "i18n_source": {\r\n    "message": "Fonte: "\r\n  },\r\n  "i18n_pub_date": {\r\n    "message": "Data de publicao: "\r\n  },\r\n  "i18n_modified_date": {\r\n    "message": "Data de modificao: "\r\n  },\r\n  "i18n_id": {\r\n    "message": "ID: "\r\n  },\r\n  "i18n_epub_version": {\r\n    "message": "Verso ePUB: "\r\n  },\r\n  "i18n_created_at": {\r\n    "message": "Criado em: "\r\n  },\r\n  "i18n_format": {\r\n    "message": "Formato: "\r\n  },\r\n  "i18n_added": {\r\n    "message": "Adicionado: "\r\n  },\r\n  "i18n_unknown": {\r\n    "message": "Desconhecido"\r\n  },\r\n  "i18n_sorry": {\r\n    "message": "Desculpe, o ePUB atual no contm sobreposio de multimdia para este contedo"\r\n  },\r\n  "i18n_add_items": {\r\n    "message": "Adicione elementos  sua biblioteca aqui!"\r\n  },\r\n  "i18n_extracting": {\r\n    "message": "extraindo: "\r\n  },\r\n  "i18n_are_you_sure": {\r\n    "message": "Tem certeza de que deseja excluir permanentemente?"\r\n  },\r\n  "i18n_add_book_to_readium_library": {\r\n    "message": "Adicionar livro  biblioteca Readium"\r\n  },\r\n  "i18n_add_book": {\r\n    "message": "Adicionar  biblioteca"\r\n  },\r\n  "i18n_cancel": {\r\n    "message": "Cancelar"\r\n  },\r\n  "i18n_from_the_web": {\r\n    "message": "A partir da web:"\r\n  },\r\n  "i18n_from_local_file": {\r\n    "message": "A partir de um arquivo local:"\r\n  },\r\n  "i18n_enter_a_url": {\r\n    "message": "Digite uma URL para um arquivo .epub"\r\n  },\r\n  "i18n_unpacked_directory": {\r\n    "message": "pasta descompactada:"\r\n  },\r\n  "i18n_validate": {\r\n    "message": "Validar:"\r\n  },\r\n  "i18n_confirm_that_this_book": {\r\n    "message": "Confirmar que este livro se encontra com as normas ePUB"\r\n  },\r\n  "i18n_single_pages": {\r\n    "message": "Pginas simples"\r\n  },\r\n  "i18n_double_pages": {\r\n    "message": "Pginas duplas"\r\n  },\r\n  "i18n_save_settings": {\r\n    "message": "Guardar preferncias"\r\n  },\r\n  "i18n_font_size": {\r\n    "message": "TAMANHO DE FONTE"\r\n  },\r\n  "i18n_margins": {\r\n    "message": "MARGENS"\r\n  },\r\n  "i18n_text_and_background_color": {\r\n    "message": "COR DE FONTE E FUNDO"\r\n  },\r\n  "i18n_black_and_white": {\r\n    "message": "Branco e preto"\r\n  },\r\n  "i18n_arabian_nights": {\r\n    "message": "As Mil e Uma Noites"\r\n  },\r\n  "i18n_sands_of_dune": {\r\n    "message": "Dunas de areia"\r\n  },\r\n  "i18n_ballard_blues": {\r\n    "message": "Ballard azuis"\r\n  },\r\n  "i18n_vancouver_mist": {\r\n    "message": "Bruma de Vancouver"\r\n  },\r\n  "i18n_display_format": {\r\n    "message": "MOSTRAR FORMATO"\r\n  },\r\n  "i18n_scroll_mode": {\r\n    "message": "MODO DE DESVIO"\r\n  },\r\n  "i18n_scroll_mode_default": {\r\n    "message": "Por padro"\r\n  },\r\n  "i18n_scroll_mode_doc": {\r\n    "message": "Documento"\r\n  },\r\n  "i18n_scroll_mode_continuous": {\r\n    "message": "Continuo"\r\n  },\r\n  "i18n_html_readium_tm_a_project": {\r\n    "message": "Readium para o Chrome  a extenso para o Chrome ReadiumJS, uma sistema de leitura de cdigo aberto e biblioteca JavaScript para renderizao publicaes ePUB em Navegadores Web. ReadiumJS  um projeto da Fundao Readium (Readium.org). Para saber mais ou contribuir, visita <a href=\\"http://readium.org/projects/readiumjs\\">sitio del proyecto</a>"\r\n  },\r\n  "i18n_toolbar_show": {\r\n    "message": "Mostrar barra de ferramentas"\r\n  },\r\n  "i18n_toolbar_hide": {\r\n    "message": "Ocultar barra de ferramentas"\r\n  },\r\n  "i18n_audio_play": {\r\n    "message": "Reproduzir"\r\n  },\r\n  "i18n_audio_pause": {\r\n    "message": "Pausa"\r\n  },\r\n  "i18n_audio_previous": {\r\n    "message": "udio anterior"\r\n  },\r\n  "i18n_audio_next": {\r\n    "message": "udio siguinte"\r\n  },\r\n  "i18n_audio_volume": {\r\n    "message": "Volume de udio"\r\n  },\r\n  "i18n_audio_volume_increase": {\r\n    "message": "Aumentar volume"\r\n  },\r\n  "i18n_audio_volume_decrease": {\r\n    "message": "Reduzir o volume"\r\n  },\r\n  "i18n_audio_time": {\r\n    "message": "Linha de tempo de udio"\r\n  },\r\n  "i18n_audio_mute": {\r\n    "message": "Desativar udio"\r\n  },\r\n  "i18n_audio_unmute": {\r\n    "message": "Ativar udio"\r\n  },\r\n  "i18n_audio_expand": {\r\n    "message": "Exibir controles avanados de udio"\r\n  },\r\n  "i18n_audio_collapse": {\r\n    "message": "Fechar controles avanados de udio"\r\n  },\r\n  "i18n_audio_esc": {\r\n    "message": "Sair do contexto atual de audio"\r\n  },\r\n  "i18n_audio_rate": {\r\n    "message": "Velocidade de reproduo de udio"\r\n  },\r\n  "i18n_audio_rate_increase": {\r\n    "message": "Aumentar velocidade de reproduo de udio"\r\n  },\r\n  "i18n_audio_rate_decrease": {\r\n    "message": "Reduzir velocidade de reproduo de udio"\r\n  },\r\n  "i18n_audio_rate_reset": {\r\n    "message": "Reestabelecer reproduo de udio a velocidade normal"\r\n  },\r\n  "i18n_audio_skip_disable": {\r\n    "message": "Desativar capacidade de omisso"\r\n  },\r\n  "i18n_audio_skip_enable": {\r\n    "message": "Ativar capacidade de omisso"\r\n  },\r\n  "i18n_audio_touch_enable": {\r\n    "message": "Ativar touch-to-play"\r\n  },\r\n  "i18n_audio_touch_disable": {\r\n    "message": "Desativar touch-to-play"\r\n  },\r\n  "i18n_audio_highlight_default": {\r\n    "message": "por padro"\r\n  },\r\n  "i18n_audio_highlight": {\r\n    "message": "Cor do udio"\r\n  },\r\n  "i18n_audio_sync": {\r\n    "message": "Nivel de sincronizao texto/udio"\r\n  },\r\n  "i18n_audio_sync_default": {\r\n    "message": "Por padro"\r\n  },\r\n  "i18n_audio_sync_word": {\r\n    "message": "Palavra"\r\n  },\r\n  "i18n_audio_sync_sentence": {\r\n    "message": "Orao"\r\n  },\r\n  "i18n_audio_sync_paragraph": {\r\n    "message": "Pargrafo"\r\n  },\r\n  "i18n_page_previous": {\r\n    "message": "Pgina anterior"\r\n  },\r\n  "i18n_page_next": {\r\n    "message": "Pgina seguinte"\r\n  },\r\n  "i18n_author_theme": {\r\n    "message": "Por padro (estilos de autor)"\r\n  },\r\n  "i18n_spread_auto": {\r\n    "message": "Automtico"\r\n  },\r\n  "i18n_scroll_mode_auto": {\r\n    "message": "Automtico"\r\n  },\r\n  "i18n_page_transition": {\r\n    "message": "EFEITOS DE PGINA"\r\n  },\r\n  "i18n_page_transition_none": {\r\n    "message": "Desativado"\r\n  },\r\n  "i18n_page_transition_fade": {\r\n    "message": "Apagar"\r\n  },\r\n  "i18n_page_transition_slide": {\r\n    "message": "Deslizar"\r\n  },\r\n  "i18n_page_transition_swoosh": {\r\n    "message": "Swoosh"\r\n  },\r\n  "i18n_page_transition_butterfly": {\r\n    "message": "Borboleta"\r\n  },\r\n  "i18n_toolbar": {\r\n    "message": "Barra de ferramentas"\r\n  },\r\n  "i18n_audio_play_background": {\r\n    "message": "Reproducir faixa em segundo plano"\r\n  },\r\n  "i18n_audio_pause_background": {\r\n    "message": "Pausar faixa em segundo plano"\r\n  },\r\n  "i18n_auto_page_turn_enable": {\r\n    "message": "Ativar voltar pgina automtica"\r\n  },\r\n  "i18n_auto_page_turn_disable": {\r\n    "message": "Desativar voltar pgina automtica"\r\n  },\r\n  "i18n_playback_scroll_enable": {\r\n    "message": "Ativar deslocamento durante a reproduo"\r\n  },\r\n  "i18n_playback_scroll_disable": {\r\n    "message": "Desativar deslocamento durante a reproduo"\r\n  },\r\n  "chrome_accept_languages": {\r\n    "message": "$CHROME$ acepta idiomas $languages$",\r\n    "placeholders": {\r\n      "chrome": {\r\n        "content": "Chrome",\r\n        "example": "Chrome"\r\n      },\r\n      "languages": {\r\n        "content": "$1",\r\n        "example": "en-US,ja,sr,de,zh_CN"\r\n      }\r\n    }\r\n  },\r\n   "i18n_zoom_custom": {\r\n        "message": "Custom"\r\n    },\r\n    "i18n_zoom_width": {\r\n        "message": "Ajustar  largura"\r\n    },\r\n    "i18n_zoom_screen": {\r\n        "message": "Ajustar uma pgina inteira  janela"\r\n    }\r\n}';
    }),
    define("text!readium_js_viewer_i18n/_locales/zh_CN/messages.json", [], function () {
        return '{\r\n  "chrome_extension_name": {\r\n    "message": "Readium"\r\n  },\r\n  "chrome_extension_description": {\r\n    "message": "EPUB3"\r\n  },\r\n  "i18n_readium_library" : {\r\n    "message" : "Readium"\r\n  },\r\n  "i18n_loading" : {\r\n    "message" : "Loading Library"\r\n  },\r\n  "i18n_readium_options" : {\r\n    "message" : "Readium:"\r\n  },\r\n  "i18n_save_changes" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_close" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_paginate_all" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_automatically" : {\r\n    "message" : "Readium*.epub"\r\n  },\r\n  "i18n_show_warning" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_details" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_read" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_delete" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_author" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_publisher" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_source" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_pub_date" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_modified_date" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_id" : {\r\n    "message" : "ID: "\r\n  },\r\n  "i18n_epub_version" : {\r\n    "message" : "EPUB: "\r\n  },\r\n  "i18n_created_at" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_format" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_added" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_unknown" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_sorry" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_add_items" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_extracting" : {\r\n    "message" : ": "\r\n  },\r\n  "i18n_are_you_sure" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_add_book_to_readium_library" : {\r\n    "message" : "Readium:"\r\n  },\r\n  "i18n_add_book" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_cancel" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_from_the_web" : {\r\n    "message" : ":"\r\n  },\r\n  "i18n_from_local_file" : {\r\n    "message" : ":"\r\n  },\r\n  "i18n_enter_a_url" : {\r\n    "message" : ".EPUBURL"\r\n  },\r\n  "i18n_unpacked_directory" : {\r\n    "message" : ":"\r\n  },\r\n  "i18n_validate" : {\r\n    "message" : ":"\r\n  },\r\n  "i18n_confirm_that_this_book" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_single_pages" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_double_pages" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_save_settings" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_font_size" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_margins" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_text_and_background_color" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_black_and_white" : {\r\n    "message" : "Black and White"\r\n  },\r\n  "i18n_arabian_nights" : {\r\n    "message" : "Arabian Nights"\r\n  },\r\n  "i18n_sands_of_dune" : {\r\n    "message" : "Sands of Dune"\r\n  },\r\n  "i18n_ballard_blues" : {\r\n    "message" : "Ballard Blues"\r\n  },\r\n  "i18n_vancouver_mist" : {\r\n    "message" : "Vancouver Mist"\r\n  },\r\n  "i18n_display_format" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_html_readium_tm_a_project" : {\r\n    "message" : "Readium<sup>TM</sup>International Digital Publishing Forum (IDPF)EPUB<a href=\\"http://readium.org/\\"></a><a href=\\"http://evidentpoint.com/\\">Evident Point</a><a href=\\"http://www.bluefirereader.com/\\">Bluefire Productions</a><a href=\\"https://github.com/readium/readium-js-viewer\\">GitHub</a>"\r\n  },\r\n  "chrome_accept_languages": {\r\n    "message": "$CHROME$ accepts $languages$ languages",\r\n    "placeholders": {\r\n      "chrome": {\r\n        "content": "Chrome",\r\n        "example": "Chrome"\r\n      },\r\n      "languages": {\r\n        "content": "$1",\r\n        "example": "en-US,ja,sr,de,zh_CN"\r\n      }\r\n    }\r\n  }\r\n}\r\n';
    }),
    define("text!readium_js_viewer_i18n/_locales/zh_TW/messages.json", [], function () {
        return '{\r\n  "chrome_extension_name": {\r\n    "message": "Readium"\r\n  },\r\n  "chrome_extension_description": {\r\n    "message": "EPUB3"\r\n  },\r\n  "i18n_readium_library" : {\r\n    "message" : "Readium"\r\n  },\r\n  "i18n_loading" : {\r\n    "message" : "Loading Library"\r\n  },\r\n  "i18n_readium_options" : {\r\n    "message" : "Readium:"\r\n  },\r\n  "i18n_save_changes" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_close" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_paginate_all" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_automatically" : {\r\n    "message" : "Readium.epub"\r\n  },\r\n  "i18n_show_warning" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_details" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_read" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_delete" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_author" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_publisher" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_source" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_pub_date" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_modified_date" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_id" : {\r\n    "message" : "ID"\r\n  },\r\n  "i18n_epub_version" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_created_at" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_format" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_added" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_unknown" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_sorry" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_add_items" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_extracting" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_are_you_sure" : {\r\n    "message" : " "\r\n  },\r\n  "i18n_add_book_to_readium_library" : {\r\n    "message" : "Readium"\r\n  },\r\n  "i18n_add_book" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_cancel" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_from_the_web" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_from_local_file" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_enter_a_url" : {\r\n    "message" : " .epub "\r\n  },\r\n  "i18n_unpacked_directory" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_validate" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_confirm_that_this_book" : {\r\n    "message" : "EPUB"\r\n  },\r\n  "i18n_single_pages" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_double_pages" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_save_settings" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_font_size" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_margins" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_text_and_background_color" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_black_and_white" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_arabian_nights" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_sands_of_dune" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_ballard_blues" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_vancouver_mist" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_display_format" : {\r\n    "message" : ""\r\n  },\r\n  "i18n_html_readium_tm_a_project" : {\r\n    "message" : "Readium<sup>TM</sup>International Digital Publishing Forum (IDPF)EPUB&reg; <a href=\\"http://readium.org/\\"></a><a href=\\"http://evidentpoint.com/\\">Evident Point</a><a href=\\"http://www.bluefirereader.com/\\">Bluefire Productions</a><a href=\\"https://github.com/readium/readium-js-viewer\\">GitHub</a>"\r\n  },\r\n  "chrome_accept_languages": {\r\n    "message": "$CHROME$ accepts $languages$ languages",\r\n    "placeholders": {\r\n      "chrome": {\r\n        "content": "Chrome",\r\n        "example": "Chrome"\r\n      },\r\n      "languages": {\r\n        "content": "$1",\r\n        "example": "en-US,zh-TW,zh-HK,ja,sr,de"\r\n      }\r\n    }\r\n  }\r\n}\r\n';
    }),
    define("i18nStrings", [
        "text!readium_js_viewer_i18n/_locales/de/messages.json",
        "text!readium_js_viewer_i18n/_locales/es/messages.json",
        "text!readium_js_viewer_i18n/_locales/ca/messages.json",
        "text!readium_js_viewer_i18n/_locales/en_US/messages.json",
        "text!readium_js_viewer_i18n/_locales/fr/messages.json",
        "text!readium_js_viewer_i18n/_locales/it/messages.json",
        "text!readium_js_viewer_i18n/_locales/id/messages.json",
        "text!readium_js_viewer_i18n/_locales/ja/messages.json",
        "text!readium_js_viewer_i18n/_locales/ko/messages.json",
        "text!readium_js_viewer_i18n/_locales/pt_BR/messages.json",
        "text!readium_js_viewer_i18n/_locales/zh_CN/messages.json",
        "text!readium_js_viewer_i18n/_locales/zh_TW/messages.json",
    ], function (e, t, n, r, i, o, a, s, l, c, u, d) {
        var f = {};
        (f.de = e), (f.es = t), (f.ca = n), (f.en_US = r), (f.fr = i), (f.id = o), (f.it = a), (f.ja = s), (f.ko = l), (f["pt-BR"] = c), (f.zh_CN = u), (f.zh_TW = d);
        var h = navigator.userLanguage || navigator.language;
        console.log("Language: [" + h + "]");
        var p = !0,
            g = f[h] || h.indexOf("es-") != -1 ? t : r,
            m = JSON.parse(g),
            v = g === r ? m : JSON.parse(r);
        for (var b in v) {
            var y = b in m;
            y || console.log("Language [" + h + "], missing string: [" + b + "]"), (m[b] = y ? m[b].message : p ? "*" + v[b].message : "");
        }
        return m;
    });
var Hogan = {};
!(function (e) {
    function t(e, t, n) {
        var r;
        return t && "object" == typeof t && (void 0 !== t[e] ? (r = t[e]) : n && t.get && "function" == typeof t.get && (r = t.get(e))), r;
    }
    function n(e, t, n, r, i, o) {
        function a() {}
        function s() {}
        (a.prototype = e), (s.prototype = e.subs);
        var l,
            c = new a();
        (c.subs = new s()), (c.subsText = {}), (c.buf = ""), (r = r || {}), (c.stackSubs = r), (c.subsText = o);
        for (l in t) r[l] || (r[l] = t[l]);
        for (l in r) c.subs[l] = r[l];
        (i = i || {}), (c.stackPartials = i);
        for (l in n) i[l] || (i[l] = n[l]);
        for (l in i) c.partials[l] = i[l];
        return c;
    }
    function r(e) {
        return String(null === e || void 0 === e ? "" : e);
    }
    function i(e) {
        return (e = r(e)), u.test(e) ? e.replace(o, "&amp;").replace(a, "&lt;").replace(s, "&gt;").replace(l, "&#39;").replace(c, "&quot;") : e;
    }
    (e.Template = function (e, t, n, r) {
        (e = e || {}), (this.r = e.code || this.r), (this.c = n), (this.options = r || {}), (this.text = t || ""), (this.partials = e.partials || {}), (this.subs = e.subs || {}), (this.buf = "");
    }),
        (e.Template.prototype = {
            r: function (e, t, n) {
                return "";
            },
            v: i,
            t: r,
            render: function (e, t, n) {
                return this.ri([e], t || {}, n);
            },
            ri: function (e, t, n) {
                return this.r(e, t, n);
            },
            ep: function (e, t) {
                var r = this.partials[e],
                    i = t[r.name];
                if (r.instance && r.base == i) return r.instance;
                if ("string" == typeof i) {
                    if (!this.c) throw new Error("No compiler available.");
                    i = this.c.compile(i, this.options);
                }
                if (!i) return null;
                if (((this.partials[e].base = i), r.subs)) {
                    t.stackText || (t.stackText = {});
                    for (key in r.subs) t.stackText[key] || (t.stackText[key] = void 0 !== this.activeSub && t.stackText[this.activeSub] ? t.stackText[this.activeSub] : this.text);
                    i = n(i, r.subs, r.partials, this.stackSubs, this.stackPartials, t.stackText);
                }
                return (this.partials[e].instance = i), i;
            },
            rp: function (e, t, n, r) {
                var i = this.ep(e, n);
                return i ? i.ri(t, n, r) : "";
            },
            rs: function (e, t, n) {
                var r = e[e.length - 1];
                if (!d(r)) return void n(e, t, this);
                for (var i = 0; i < r.length; i++) e.push(r[i]), n(e, t, this), e.pop();
            },
            s: function (e, t, n, r, i, o, a) {
                var s;
                return (!d(e) || 0 !== e.length) && ("function" == typeof e && (e = this.ms(e, t, n, r, i, o, a)), (s = !!e), !r && s && t && t.push("object" == typeof e ? e : t[t.length - 1]), s);
            },
            d: function (e, n, r, i) {
                var o,
                    a = e.split("."),
                    s = this.f(a[0], n, r, i),
                    l = this.options.modelGet,
                    c = null;
                if ("." === e && d(n[n.length - 2])) s = n[n.length - 1];
                else for (var u = 1; u < a.length; u++) (o = t(a[u], s, l)), void 0 !== o ? ((c = s), (s = o)) : (s = "");
                return !(i && !s) && (i || "function" != typeof s || (n.push(c), (s = this.mv(s, n, r)), n.pop()), s);
            },
            f: function (e, n, r, i) {
                for (var o = !1, a = null, s = !1, l = this.options.modelGet, c = n.length - 1; c >= 0; c--)
                    if (((a = n[c]), (o = t(e, a, l)), void 0 !== o)) {
                        s = !0;
                        break;
                    }
                return s ? (i || "function" != typeof o || (o = this.mv(o, n, r)), o) : !i && "";
            },
            ls: function (e, t, n, i, o) {
                var a = this.options.delimiters;
                return (this.options.delimiters = o), this.b(this.ct(r(e.call(t, i)), t, n)), (this.options.delimiters = a), !1;
            },
            ct: function (e, t, n) {
                if (this.options.disableLambda) throw new Error("Lambda features disabled.");
                return this.c.compile(e, this.options).render(t, n);
            },
            b: function (e) {
                this.buf += e;
            },
            fl: function () {
                var e = this.buf;
                return (this.buf = ""), e;
            },
            ms: function (e, t, n, r, i, o, a) {
                var s,
                    l = t[t.length - 1],
                    c = e.call(l);
                return "function" == typeof c ? !!r || ((s = this.activeSub && this.subsText && this.subsText[this.activeSub] ? this.subsText[this.activeSub] : this.text), this.ls(c, l, n, s.substring(i, o), a)) : c;
            },
            mv: function (e, t, n) {
                var i = t[t.length - 1],
                    o = e.call(i);
                return "function" == typeof o ? this.ct(r(o.call(i)), i, n) : o;
            },
            sub: function (e, t, n, r) {
                var i = this.subs[e];
                i && ((this.activeSub = e), i(t, n, this, r), (this.activeSub = !1));
            },
        });
    var o = /&/g,
        a = /</g,
        s = />/g,
        l = /\'/g,
        c = /\"/g,
        u = /[&<>\"\']/,
        d =
            Array.isArray ||
            function (e) {
                return "[object Array]" === Object.prototype.toString.call(e);
            };
})("undefined" != typeof exports ? exports : Hogan),
    (function (e) {
        function t(e) {
            "}" === e.n.substr(e.n.length - 1) && (e.n = e.n.substring(0, e.n.length - 1));
        }
        function n(e) {
            return e.trim ? e.trim() : e.replace(/^\s*|\s*$/g, "");
        }
        function r(e, t, n) {
            if (t.charAt(n) != e.charAt(0)) return !1;
            for (var r = 1, i = e.length; r < i; r++) if (t.charAt(n + r) != e.charAt(r)) return !1;
            return !0;
        }
        function i(t, n, r, s) {
            var l = [],
                c = null,
                u = null,
                d = null;
            for (u = r[r.length - 1]; t.length > 0; ) {
                if (((d = t.shift()), u && "<" == u.tag && !(d.tag in w))) throw new Error("Illegal content in < super tag.");
                if (e.tags[d.tag] <= e.tags.$ || o(d, s)) r.push(d), (d.nodes = i(t, d.tag, r, s));
                else {
                    if ("/" == d.tag) {
                        if (0 === r.length) throw new Error("Closing tag without opener: /" + d.n);
                        if (((c = r.pop()), d.n != c.n && !a(d.n, c.n, s))) throw new Error("Nesting error: " + c.n + " vs. " + d.n);
                        return (c.end = d.i), l;
                    }
                    "\n" == d.tag && (d.last = 0 == t.length || "\n" == t[0].tag);
                }
                l.push(d);
            }
            if (r.length > 0) throw new Error("missing closing tag: " + r.pop().n);
            return l;
        }
        function o(e, t) {
            for (var n = 0, r = t.length; n < r; n++) if (t[n].o == e.n) return (e.tag = "#"), !0;
        }
        function a(e, t, n) {
            for (var r = 0, i = n.length; r < i; r++) if (n[r].c == e && n[r].o == t) return !0;
        }
        function s(e) {
            var t = [];
            for (var n in e) t.push('"' + c(n) + '": function(c,p,t,i) {' + e[n] + "}");
            return "{ " + t.join(",") + " }";
        }
        function l(e) {
            var t = [];
            for (var n in e.partials) t.push('"' + c(n) + '":{name:"' + c(e.partials[n].name) + '", ' + l(e.partials[n]) + "}");
            return "partials: {" + t.join(",") + "}, subs: " + s(e.subs);
        }
        function c(e) {
            return e.replace(b, "\\\\").replace(g, '\\"').replace(m, "\\n").replace(v, "\\r").replace(y, "\\u2028").replace(_, "\\u2029");
        }
        function u(e) {
            return ~e.indexOf(".") ? "d" : "f";
        }
        function d(e, t) {
            var n = "<" + (t.prefix || ""),
                r = n + e.n + x++;
            return (t.partials[r] = { name: e.n, partials: {} }), (t.code += 't.b(t.rp("' + c(r) + '",c,p,"' + (e.indent || "") + '"));'), r;
        }
        function f(e, t) {
            t.code += "t.b(t.t(t." + u(e.n) + '("' + c(e.n) + '",c,p,0)));';
        }
        function h(e) {
            return "t.b(" + e + ");";
        }
        var p = /\S/,
            g = /\"/g,
            m = /\n/g,
            v = /\r/g,
            b = /\\/g,
            y = /\u2028/,
            _ = /\u2029/;
        (e.tags = { "#": 1, "^": 2, "<": 3, $: 4, "/": 5, "!": 6, ">": 7, "=": 8, _v: 9, "{": 10, "&": 11, _t: 12 }),
            (e.scan = function (i, o) {
                function a() {
                    b.length > 0 && (y.push({ tag: "_t", text: new String(b) }), (b = ""));
                }
                function s() {
                    for (var t = !0, n = x; n < y.length; n++) if (((t = e.tags[y[n].tag] < e.tags._v || ("_t" == y[n].tag && null === y[n].text.match(p))), !t)) return !1;
                    return t;
                }
                function l(e, t) {
                    if ((a(), e && s())) for (var n, r = x; r < y.length; r++) y[r].text && ((n = y[r + 1]) && ">" == n.tag && (n.indent = y[r].text.toString()), y.splice(r, 1));
                    else t || y.push({ tag: "\n" });
                    (_ = !1), (x = y.length);
                }
                function c(e, t) {
                    var r = "=" + C,
                        i = e.indexOf(r, t),
                        o = n(e.substring(e.indexOf("=", t) + 1, i)).split(" ");
                    return (E = o[0]), (C = o[o.length - 1]), i + r.length - 1;
                }
                var u = i.length,
                    d = 0,
                    f = 1,
                    h = 2,
                    g = d,
                    m = null,
                    v = null,
                    b = "",
                    y = [],
                    _ = !1,
                    w = 0,
                    x = 0,
                    E = "{{",
                    C = "}}";
                for (o && ((o = o.split(" ")), (E = o[0]), (C = o[1])), w = 0; w < u; w++)
                    g == d
                        ? r(E, i, w)
                            ? (--w, a(), (g = f))
                            : "\n" == i.charAt(w)
                            ? l(_)
                            : (b += i.charAt(w))
                        : g == f
                        ? ((w += E.length - 1), (v = e.tags[i.charAt(w + 1)]), (m = v ? i.charAt(w + 1) : "_v"), "=" == m ? ((w = c(i, w)), (g = d)) : (v && w++, (g = h)), (_ = w))
                        : r(C, i, w)
                        ? (y.push({ tag: m, n: n(b), otag: E, ctag: C, i: "/" == m ? _ - E.length : w + C.length }), (b = ""), (w += C.length - 1), (g = d), "{" == m && ("}}" == C ? w++ : t(y[y.length - 1])))
                        : (b += i.charAt(w));
                return l(_, !0), y;
            });
        var w = { _t: !0, "\n": !0, $: !0, "/": !0 };
        e.stringify = function (t, n, r) {
            return "{code: function (c,p,i) { " + e.wrapMain(t.code) + " }," + l(t) + "}";
        };
        var x = 0;
        (e.generate = function (t, n, r) {
            x = 0;
            var i = { code: "", subs: {}, partials: {} };
            return e.walk(t, i), r.asString ? this.stringify(i, n, r) : this.makeTemplate(i, n, r);
        }),
            (e.wrapMain = function (e) {
                return 'var t=this;t.b(i=i||"");' + e + "return t.fl();";
            }),
            (e.template = e.Template),
            (e.makeTemplate = function (e, t, n) {
                var r = this.makePartials(e);
                return (r.code = new Function("c", "p", "i", this.wrapMain(e.code))), new this.template(r, t, this, n);
            }),
            (e.makePartials = function (e) {
                var t,
                    n = { subs: {}, partials: e.partials, name: e.name };
                for (t in n.partials) n.partials[t] = this.makePartials(n.partials[t]);
                for (t in e.subs) n.subs[t] = new Function("c", "p", "t", "i", e.subs[t]);
                return n;
            }),
            (e.codegen = {
                "#": function (t, n) {
                    (n.code += "if(t.s(t." + u(t.n) + '("' + c(t.n) + '",c,p,1),c,p,0,' + t.i + "," + t.end + ',"' + t.otag + " " + t.ctag + '")){t.rs(c,p,function(c,p,t){'), e.walk(t.nodes, n), (n.code += "});c.pop();}");
                },
                "^": function (t, n) {
                    (n.code += "if(!t.s(t." + u(t.n) + '("' + c(t.n) + '",c,p,1),c,p,1,0,0,"")){'), e.walk(t.nodes, n), (n.code += "};");
                },
                ">": d,
                "<": function (t, n) {
                    var r = { partials: {}, code: "", subs: {}, inPartial: !0 };
                    e.walk(t.nodes, r);
                    var i = n.partials[d(t, n)];
                    (i.subs = r.subs), (i.partials = r.partials);
                },
                $: function (t, n) {
                    var r = { subs: {}, code: "", partials: n.partials, prefix: t.n };
                    e.walk(t.nodes, r), (n.subs[t.n] = r.code), n.inPartial || (n.code += 't.sub("' + c(t.n) + '",c,p,i);');
                },
                "\n": function (e, t) {
                    t.code += h('"\\n"' + (e.last ? "" : " + i"));
                },
                _v: function (e, t) {
                    t.code += "t.b(t.v(t." + u(e.n) + '("' + c(e.n) + '",c,p,0)));';
                },
                _t: function (e, t) {
                    t.code += h('"' + c(e.text) + '"');
                },
                "{": f,
                "&": f,
            }),
            (e.walk = function (t, n) {
                for (var r, i = 0, o = t.length; i < o; i++) (r = e.codegen[t[i].tag]), r && r(t[i], n);
                return n;
            }),
            (e.parse = function (e, t, n) {
                return (n = n || {}), i(e, "", [], n.sectionTags || []);
            }),
            (e.cache = {}),
            (e.cacheKey = function (e, t) {
                return [e, !!t.asString, !!t.disableLambda, t.delimiters, !!t.modelGet].join("||");
            }),
            (e.compile = function (t, n) {
                n = n || {};
                var r = e.cacheKey(t, n),
                    i = this.cache[r];
                if (i) {
                    var o = i.partials;
                    for (var a in o) delete o[a].instance;
                    return i;
                }
                return (i = this.generate(this.parse(this.scan(t, n.delimiters), t, n), t, n)), (this.cache[r] = i);
            });
    })("undefined" != typeof exports ? exports : Hogan),
    "function" == typeof define && define.amd && define("hogan", Hogan),
    define("hgn", {
        load: function (e) {
            throw new Error("Dynamic load not allowed: " + e);
        },
    }),
    define("hgn!readium_js_viewer_html_templates/managed-dialog.html", ["hogan"], function (e) {
        function t() {
            return n.render.apply(n, arguments);
        }
        var n = new e.Template(
            {
                code: function (e, t, n) {
                    var r = this;
                    return (
                        r.b((n = n || "")),
                        r.b('<div class="modal fade" id="managed-dialog" tabindex="-1" role="dialog" aria-labelledby="managed-label">\r'),
                        r.b("\n" + n),
                        r.b('    <div class="modal-dialog">\r'),
                        r.b("\n" + n),
                        r.b('        <div class="modal-content">\r'),
                        r.b("\n" + n),
                        r.b('            <div class="modal-header">\r'),
                        r.b("\n" + n),
                        r.b('                <button type="button" class="close" data-dismiss="modal" aria-label="close" title="close"><span aria-hidden="true">&times;<span></button>\r'),
                        r.b("\n" + n),
                        r.b('                <h4 class="modal-title" id="managed-label"></h4>\r'),
                        r.b("\n" + n),
                        r.b("            </div>\r"),
                        r.b("\n" + n),
                        r.b('            <div class="modal-body">\r'),
                        r.b("\n" + n),
                        r.b("            </div>\r"),
                        r.b("\n" + n),
                        r.b('            <div class="modal-footer">\r'),
                        r.b("\n" + n),
                        r.b("            </div>\r"),
                        r.b("\n" + n),
                        r.b("        </div>\r"),
                        r.b("\n" + n),
                        r.b("        <!-- /.modal-content --> \r"),
                        r.b("\n" + n),
                        r.b("    </div><!-- /.modal-dialog -->\r"),
                        r.b("\n" + n),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b("<!-- /.modal -->"),
                        r.fl()
                    );
                },
                partials: {},
                subs: {},
            },
            "",
            e
        );
        return (t.template = n), t;
    }),
    define("hgn!readium_js_viewer_html_templates/progress-dialog.html", ["hogan"], function (e) {
        function t() {
            return n.render.apply(n, arguments);
        }
        var n = new e.Template(
            {
                code: function (e, t, n) {
                    var r = this;
                    return (
                        r.b((n = n || "")),
                        r.b('<div class="progress progress-striped active">\r'),
                        r.b("\n" + n),
                        r.b('  <div class="progress-bar"  role="progressbar" aria-valuenow="1" aria-valuemin="1" aria-valuemax="100" style="width: 1%">\r'),
                        r.b("\n" + n),
                        r.b('    <!-- <span class="progress-message sr-only">'),
                        r.b(r.v(r.f("message", e, t, 0))),
                        r.b("</span> -->\r"),
                        r.b("\n" + n),
                        r.b("  </div>\r"),
                        r.b("\n" + n),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b('<div class="progress-message">'),
                        r.b(r.v(r.f("message", e, t, 0))),
                        r.b("</div>\r"),
                        r.b("\n"),
                        r.fl()
                    );
                },
                partials: {},
                subs: {},
            },
            "",
            e
        );
        return (t.template = n), t;
    }),
    define("hgn!readium_js_viewer_html_templates/managed-buttons.html", ["hogan"], function (e) {
        function t() {
            return n.render.apply(n, arguments);
        }
        var n = new e.Template(
            {
                code: function (e, t, n) {
                    var r = this;
                    return (
                        r.b((n = n || "")),
                        r.s(r.f("buttons", e, t, 1), e, t, 0, 12, 157, "{{ }}") &&
                            (r.rs(e, t, function (e, t, r) {
                                r.b('<button type="button" class="btn btn-default '),
                                    r.s(r.f("classes", e, t, 1), e, t, 0, 71, 77, "{{ }}") &&
                                        (r.rs(e, t, function (e, t, n) {
                                            n.b(n.v(n.d(".", e, t, 0))), n.b(" ");
                                        }),
                                        e.pop()),
                                    r.b('" '),
                                    r.s(r.f("dismiss", e, t, 1), e, t, 0, 103, 125, "{{ }}") &&
                                        (r.rs(e, t, function (e, t, n) {
                                            n.b(' data-dismiss="modal" ');
                                        }),
                                        e.pop()),
                                    r.b(">"),
                                    r.b(r.v(r.f("text", e, t, 0))),
                                    r.b("</button>\r"),
                                    r.b("\n" + n);
                            }),
                            e.pop()),
                        r.fl()
                    );
                },
                partials: {},
                subs: {},
            },
            "",
            e
        );
        return (t.template = n), t;
    }),
    define("readium_js_viewer/workers/Messages", [], function () {
        return {
            IMPORT_ZIP: 0,
            OVERWRITE_CONTINUE: 1,
            FIND_PACKAGE_RESPONSE: 2,
            PARSE_PACKAGE_RESPONSE: 3,
            DELETE_EPUB: 4,
            IMPORT_DIR: 5,
            IMPORT_URL: 6,
            MIGRATE: 7,
            OVERWRITE_SIDE_BY_SIDE: 8,
            CONTINUE_IMPORT_ZIP: 9,
            SUCCESS: 100,
            PROGRESS: 101,
            ERROR: 102,
            OVERWRITE: 103,
            FIND_PACKAGE: 104,
            PARSE_PACKAGE: 105,
            PROGRESS_EXTRACTING: 200,
            PROGRESS_WRITING: 201,
            PROGRESS_DELETING: 202,
            PROGRESS_MIGRATING: 203,
            ERROR_STORAGE: 300,
            ERROR_EPUB: 301,
            ERROR_AJAX: 302,
            ERROR_PACKAGE_PARSE: 303,
            READY: 400,
        };
    }),
    define("readium_js_viewer/Dialogs", [
        "hgn!readium_js_viewer_html_templates/managed-dialog.html",
        "hgn!readium_js_viewer_html_templates/progress-dialog.html",
        "hgn!readium_js_viewer_html_templates/managed-buttons.html",
        "i18nStrings",
        "./workers/Messages",
    ], function (e, t, n, r, i) {
        var o,
            a,
            s = function () {
                o && o.modal("hide");
            },
            l = function (t, n, r, i) {
                o || ((o = $(e({}))), $("#app-container").append(o)),
                    $("#managed-label").text(n),
                    $("#managed-dialog .modal-body").empty().append(r),
                    $("#managed-dialog .modal-footer").empty().append(i),
                    t ? $("#managed-dialog .close").show() : $("#managed-dialog .close").hide(),
                    o.is(":hidden") && (t ? $("#managed-dialog").modal({ backdrop: !0, keyboard: !0, show: !0 }) : $("#managed-dialog").modal({ backdrop: "static", keyboard: !1, show: !0 }));
            };
        return (
            (Dialogs = {
                showError: function (e, t) {
                    var n = r.err_unknown;
                    switch (e) {
                        case i.ERROR_PACKAGE_PARSE:
                            return void Dialogs.showErrorWithDetails(r.err_epub_corrupt, t);
                        case i.ERROR_STORAGE:
                            n = r.err_storage;
                            break;
                        case i.ERROR_EPUB:
                            n = r.err_epub_corrupt;
                            break;
                        case i.ERROR_AJAX:
                            n = r.err_ajax;
                            break;
                        default:
                            (n = r.err_unknown), console.trace();
                    }
                    Dialogs.showModalMessage(r.err_dlg_title, n);
                },
                showErrorWithDetails: function (e, t) {
                    var i = $("<pre></pre>").text(t || "Unknown Error"),
                        o = n({ buttons: [{ dismiss: !0, text: r.ok }] });
                    l(!0, e, i, o);
                },
                showModalMessage: function (e, t) {
                    var i = $("<p></p>").text(t),
                        o = n({ buttons: [{ dismiss: !0, text: r.ok }] });
                    l(!0, e, i, o);
                },
                showModalMessageEx: function (e, t) {
                    var i = n({ buttons: [{ dismiss: !0, text: r.ok }] });
                    l(!0, e, t, i);
                },
                showModalPromptEx: function (e, t, r, i) {
                    var o = $("<p></p>").text(t),
                        a = n({ buttons: r });
                    l(!1, e, o, a);
                    for (var s = 0; s < i.length; s++) i[s] && $("#managed-dialog ." + r[s].classes[0]).on("click", i[s]);
                },
                showModalPrompt: function (e, t, n, r, i, o) {
                    var a = [
                        { dismiss: !0, text: r, classes: ["no-button"] },
                        { dismiss: !0, text: n, classes: ["yes-button", "btn-primary"] },
                    ];
                    (handlers = [o, i]), Dialogs.showModalPromptEx(e, t, a, handlers);
                },
                showReplaceConfirm: function (e, t, n, r, i, o, a, s) {
                    var l = [
                        { dismiss: !0, text: r, classes: ["no-button"] },
                        { dismiss: !0, text: n, classes: ["yes-button", "btn-danger"] },
                        { dismiss: !0, text: i, classes: ["keep-both-button", "btn-primary"] },
                    ];
                    (handlers = [a, o, s]), Dialogs.showModalPromptEx(e, t, l, handlers);
                },
                showModalProgress: function (e, i, o) {
                    var s = { message: i };
                    a = e;
                    var c = n({ buttons: [{ text: r.i18n_cancel, classes: ["cancel-button", "btn-primary"] }] });
                    l(!1, e, t(s), o ? c : ""), o && $("#managed-dialog .cancel-button").on("click", o);
                },
                updateModalProgressTitle: function (e) {
                    $("#managed-label").text(e);
                },
                updateProgress: function (e, t, n, o) {
                    var a = "";
                    switch (t) {
                        case i.PROGRESS_MIGRATING:
                            a = r.migrating + " " + n;
                            break;
                        case i.PROGRESS_EXTRACTING:
                            a = r.i18n_extracting + " " + n;
                            break;
                        case i.PROGRESS_WRITING:
                            a = r.storing_file + " " + n;
                            break;
                        case i.PROGRESS_DELETING:
                            a = r.delete_progress_message + " " + n;
                    }
                    $("#managed-dialog .progress-bar")
                        .attr("aria-valuenow", e)
                        .css("width", e + "%"),
                        $("#managed-dialog .progress-message").text(a);
                },
                closeModal: function () {
                    s();
                },
                reset: function () {
                    o && (o.remove(), (o = null));
                },
            }),
            Dialogs
        );
    }),
    define("hgn!readium_js_viewer_html_templates/settings-dialog.html", ["hogan"], function (e) {
        function t() {
            return n.render.apply(n, arguments);
        }
        var n = new e.Template(
            {
                code: function (e, t, n) {
                    var r = this;
                    return (
                        r.b((n = n || "")),
                        r.b('<div tabindex="-1" class="modal fade" id="settings-dialog" role="dialog" aria-label="'),
                        r.b(r.v(r.d("strings.settings", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('    <div class="modal-dialog">\r'),
                        r.b("\n" + n),
                        r.b('        <div class="modal-content">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('           <!-- div class="modal-header">\r'),
                        r.b("\n" + n),
                        r.b('            <h4 class="modal-title" id="settings-label">'),
                        r.b(r.v(r.d("strings.settings", e, t, 0))),
                        r.b("</h4>\r"),
                        r.b("\n" + n),
                        r.b("           </div -->\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('            <div class="modal-body">\r'),
                        r.b("\n" + n),
                        r.b('           <button type="button" class="close" id="closeSettingsCross" data-dismiss="modal" title="'),
                        r.b(r.v(r.d("strings.i18n_close", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.settings", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_close", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.settings", e, t, 0))),
                        r.b('"><span aria-hidden="true">&times;</span></button>\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('           <ul class="nav nav-tabs" role="tablist" aria-owns="tab-butt-style tab-butt-layout tab-butt-keys">\r'),
                        r.b("\n" + n),
                        r.b('             <li class="active" role="presentation"><button id="tab-butt-style"  title="'),
                        r.b(r.v(r.d("strings.style", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.style", e, t, 0))),
                        r.b('" role=\'tab\' aria-controls="tab-style" data-toggle="tab" data-target="#tab-style" tabindex="0">'),
                        r.b(r.v(r.d("strings.style", e, t, 0))),
                        r.b("</button></li>\r"),
                        r.b("\n" + n),
                        r.b("             \r"),
                        r.b("\n" + n),
                        r.b('             <li role="presentation"><button id="tab-butt-layout"  title="'),
                        r.b(r.v(r.d("strings.layout", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.layout", e, t, 0))),
                        r.b('" role=\'tab\' aria-controls="tab-layout" data-toggle="tab" data-target="#tab-layout" tabindex="-1">'),
                        r.b(r.v(r.d("strings.layout", e, t, 0))),
                        r.b("</button></li>\r"),
                        r.b("\n" + n),
                        r.b('             <!--<li role="presentation"><button id="tab-butt-keys"  title="'),
                        r.b(r.v(r.d("strings.i18n_keyboard_shortcuts", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_keyboard_shortcuts", e, t, 0))),
                        r.b('" role=\'tab\' aria-controls="tab-keyboard" data-toggle="tab" data-target="#tab-keyboard" tabindex="-1">'),
                        r.b(r.v(r.d("strings.i18n_keyboard_shortcuts", e, t, 0))),
                        r.b("</button></li>-->\r"),
                        r.b("\n" + n),
                        r.b("           </ul>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('           <div class="tab-content">\r'),
                        r.b("\n" + n),
                        r.b('                <div id="tab-style" class="tab-pane active" role="tabpanel" aria-expanded="true">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                <h5 aria-hidden="true">'),
                        r.b(r.v(r.d("strings.preview", e, t, 0))),
                        r.b("</h5>\r"),
                        r.b("\n" + n),
                        r.b('                <div  aria-hidden="true" class="row">\r'),
                        r.b("\n" + n),
                        r.b('                    <div data-theme="default-theme" class="col-xs-10 col-xs-offset-1 preview-text default-theme">\r'),
                        r.b("\n" + n),
                        r.b("                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus neque dui, congue a suscipit non, feugiat eu urna. Cras in felis sed orci aliquam sagittis.\r"),
                        r.b("\n" + n),
                        r.b("                    </div>\r"),
                        r.b("\n" + n),
                        r.b("                </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('<!-- button  type="button" title="TESTING" aria-label="TESTING">TESTING DANIEL</button -->\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                    <h5 id="setting-header-font-size" class="setting-header">'),
                        r.b(r.v(r.d("strings.i18n_font_size", e, t, 0))),
                        r.b("</h5>\r"),
                        r.b("\n" + n),
                        r.b('                    <div class="row">\r'),
                        r.b("\n" + n),
                        r.b('                        <div class="col-xs-2 icon-scale-down">\r'),
                        r.b("\n" + n),
                        r.b('                            <img id="btTxtMinus" src="'),
                        r.b(r.t(r.f("imagePathPrefix", e, t, 0))),
                        r.b('images/glyphicons_115_text_smaller.png" alt="" aria-hidden="true">\r'),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b('                        <div class="col-xs-8">\r'),
                        r.b("\n" + n),
                        r.b(
                            '                            <input  type="range" aria-labelledby="setting-header-font-size" id="font-size-input" min="60" aria-value-min="60" aria-valuemin="60" step="10" max="250" aria-value-max="250" aria-valuemax="250" value="100" aria-valuenow="100" aria-value-now="100" aria-valuetext="1em" aria-value-text="1em" title="'
                        ),
                        r.b(r.v(r.d("strings.i18n_font_size", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_font_size", e, t, 0))),
                        r.b('" />\r'),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b('                        <div class="col-xs-2">\r'),
                        r.b("\n" + n),
                        r.b('                            <img id="btTxtPlus" src="'),
                        r.b(r.t(r.f("imagePathPrefix", e, t, 0))),
                        r.b('images/glyphicons_116_text_bigger.png" alt="" aria-hidden="true">\r'),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("                    </div>\r"),
                        r.b("\n" + n),
                        r.b('                    <div class="SMHiding" style="">\r'),
                        r.b("\n" + n),
                        r.b('                        <h5 id="setting-header-color-legend" class="setting-header">'),
                        r.b(r.v(r.d("strings.i18n_text_and_background_color", e, t, 0))),
                        r.b("</h5>\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="group" aria-labelledby="setting-header-color-legend" id="theme-radio-group" class="row">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                            <button role="button" data-theme="author-theme"  title="'),
                        r.b(r.v(r.d("strings.i18n_author_theme", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_author_theme", e, t, 0))),
                        r.b('" class="col-xs-8 col-xs-offset-2 theme-option author-theme clickable">'),
                        r.b(r.v(r.d("strings.i18n_author_theme", e, t, 0))),
                        r.b("</button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                            <button role="button" data-theme="default-theme"  title="'),
                        r.b(r.v(r.d("strings.i18n_black_and_white", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_black_and_white", e, t, 0))),
                        r.b('" class="col-xs-8 col-xs-offset-2 theme-option default-theme clickable">'),
                        r.b(r.v(r.d("strings.i18n_black_and_white", e, t, 0))),
                        r.b("</button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                            <button role="button" data-theme="night-theme"  title="'),
                        r.b(r.v(r.d("strings.i18n_arabian_nights", e, t, 0))),
                        r.b(" ["),
                        r.b(r.v(r.d("keyboard.NightTheme", e, t, 0))),
                        r.b(']" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_arabian_nights", e, t, 0))),
                        r.b(" ["),
                        r.b(r.v(r.d("keyboard.NightTheme", e, t, 0))),
                        r.b(']" class="col-xs-8 col-xs-offset-2 theme-option night-theme clickable" >'),
                        r.b(r.v(r.d("strings.i18n_arabian_nights", e, t, 0))),
                        r.b('</button> <!-- accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.NightTheme", e, t, 0))),
                        r.b('" -->\r'),
                        r.b("\n" + n),
                        r.b("                            \r"),
                        r.b("\n" + n),
                        r.b('                            <button role="button" data-theme="parchment-theme"  title="'),
                        r.b(r.v(r.d("strings.i18n_sands_of_dune", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_sands_of_dune", e, t, 0))),
                        r.b('" class="col-xs-8 col-xs-offset-2 theme-option parchment-theme clickable">'),
                        r.b(r.v(r.d("strings.i18n_sands_of_dune", e, t, 0))),
                        r.b("</button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                            <button role="button" data-theme="ballard-theme"  title="'),
                        r.b(r.v(r.d("strings.i18n_ballard_blues", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_ballard_blues", e, t, 0))),
                        r.b('" class="col-xs-8 col-xs-offset-2 theme-option ballard-theme clickable">'),
                        r.b(r.v(r.d("strings.i18n_ballard_blues", e, t, 0))),
                        r.b("</button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                            <button role="button" data-theme="vancouver-theme"  title="'),
                        r.b(r.v(r.d("strings.i18n_vancouver_mist", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_vancouver_mist", e, t, 0))),
                        r.b('" class="col-xs-8 col-xs-offset-2 theme-option vancouver-theme clickable">'),
                        r.b(r.v(r.d("strings.i18n_vancouver_mist", e, t, 0))),
                        r.b("</button>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("                   </div>\r"),
                        r.b("\n" + n),
                        r.b("                </div>\r"),
                        r.b("\n" + n),
                        r.b('                <div id="tab-layout" class="tab-pane" role="tabpanel" >\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                    <!-- disabled: replaced with setting-header-column-max-width-legend (see below) -->\r"),
                        r.b("\n" + n),
                        r.b('                    <h5 style="display:none;" id="setting-header-margins-legend" class="setting-header">'),
                        r.b(r.v(r.d("strings.i18n_margins", e, t, 0))),
                        r.b("</h5>\r"),
                        r.b("\n" + n),
                        r.b('                    <div style="display:none;" class="row">\r'),
                        r.b("\n" + n),
                        r.b('                        <div class="col-xs-2 icon-scale-down">\r'),
                        r.b("\n" + n),
                        r.b('                            <img style="height: 32px;" src="'),
                        r.b(r.t(r.f("imagePathPrefix", e, t, 0))),
                        r.b('images/margin1_off.png" alt="" aria-hidden="true">\r'),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b('                        <div class="col-xs-8">\r'),
                        r.b("\n" + n),
                        r.b(
                            '                            <input  type="range" role="slider" aria-labelledby="setting-header-margins-legend" id="margin-size-input" min="20" aria-value-min="20" aria-valuemin="20" step="20" max="100" aria-value-max="100" aria-valuemax="100" value="20" aria-valuenow="20" aria-value-now="20" aria-valuetext="20" aria-value-text="20" title="'
                        ),
                        r.b(r.v(r.d("strings.i18n_margins", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_margins", e, t, 0))),
                        r.b('"/>\r'),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b('                        <div class="col-xs-2">\r'),
                        r.b("\n" + n),
                        r.b('                            <img style="height: 32px;" src="'),
                        r.b(r.t(r.f("imagePathPrefix", e, t, 0))),
                        r.b('images/margin4_off.png" alt="" aria-hidden="true">\r'),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("                    </div>\r"),
                        r.b("\n" + n),
                        r.b("                    \r"),
                        r.b("\n" + n),
                        r.b('                    <h5 style="display:none;"  id="setting-header-column-max-width-legend" class="setting-header">'),
                        r.b(r.v(r.d("strings.i18n_pageMaxWidth", e, t, 0))),
                        r.b("</h5>\r"),
                        r.b("\n" + n),
                        r.b('                     <div style="display:none;"  class="row">\r'),
                        r.b("\n" + n),
                        r.b('                        <div class="col-xs-2">\r'),
                        r.b("\n" + n),
                        r.b('                            <img style="height: 32px;" src="'),
                        r.b(r.t(r.f("imagePathPrefix", e, t, 0))),
                        r.b('images/margin4_off.png" alt="" aria-hidden="true">\r'),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b('                        <div class="col-xs-8">\r'),
                        r.b("\n" + n),
                        r.b(
                            '                            <input  type="range" role="slider" aria-labelledby="setting-header-column-max-width-legend" id="column-max-width-input" min="500" aria-value-min="500" aria-valuemin="500" step="50" max="2000" aria-value-max="2000" aria-valuemax="2000" value="700" aria-valuenow="700" aria-value-now="700" aria-valuetext="700" aria-value-text="700" title="'
                        ),
                        r.b(r.v(r.d("strings.i18n_pageMaxWidth", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_pageMaxWidth", e, t, 0))),
                        r.b('"/>\r'),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b('                        <div class="col-xs-2 icon-scale-down">\r'),
                        r.b("\n" + n),
                        r.b('                            <img style="height: 32px;" src="'),
                        r.b(r.t(r.f("imagePathPrefix", e, t, 0))),
                        r.b('images/margin1_off.png" alt="" aria-hidden="true">\r'),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("                    </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                    <h5 id="setting-header-display-legend" class="setting-header">'),
                        r.b(r.v(r.d("strings.i18n_display_format", e, t, 0))),
                        r.b("</h5>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                    <div role="radiogroup" class="row" style="width:100%;text-align:center;" aria-labelledby="setting-header-display-legend">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="spread-default-option"\r'),
                        r.b("\n" + n),
                        r.b('                        style="vertical-align:middle;width:30%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b('                            <input style=""  name="display-format" value="single" type="radio" id="spread-default-radio"/>\r'),
                        r.b("\n" + n),
                        r.b('                            <label style="" for="spread-default-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b("                                "),
                        r.b(r.v(r.d("strings.i18n_spread_auto", e, t, 0))),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="one-up-option"\r'),
                        r.b("\n" + n),
                        r.b('                        style="vertical-align:middle;width:30%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                            <input  name="display-format" value="single" type="radio" id="single-page-radio" />\r'),
                        r.b("\n" + n),
                        r.b('                                            <label for="single-page-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b('                                            <img src="'),
                        r.b(r.t(r.f("imagePathPrefix", e, t, 0))),
                        r.b('images/ico_singlepage_up.png" alt="'),
                        r.b(r.v(r.d("strings.i18n_display_format", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_single_pages", e, t, 0))),
                        r.b('"/>\r'),
                        r.b("\n" + n),
                        r.b("                                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="two-up-option"\r'),
                        r.b("\n" + n),
                        r.b('                        style="vertical-align:middle;width:30%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                                <input  name="display-format" value="double" type="radio" id="double-page-radio" />\r'),
                        r.b("\n" + n),
                        r.b('                                            <label for="double-page-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b('                                            <img src="'),
                        r.b(r.t(r.f("imagePathPrefix", e, t, 0))),
                        r.b('images/ico_doublepage_up.png" alt="'),
                        r.b(r.v(r.d("strings.i18n_display_format", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_double_pages", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b("                                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("                    </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                    <h5 id="setting-header-scroll-legend" class="setting-header">'),
                        r.b(r.v(r.d("strings.i18n_scroll_mode", e, t, 0))),
                        r.b("</h5>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                    <div role="radiogroup" class="row" style="width:100%;text-align:center;" aria-labelledby="setting-header-scroll-legend">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="scroll-default-option" style="vertical-align:middle;width:30%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b('                            <input style=""  name="scrolling" value="single" type="radio" id="scroll-default-radio"/>\r'),
                        r.b("\n" + n),
                        r.b('                            <label style="" for="scroll-default-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b("                                "),
                        r.b(r.v(r.d("strings.i18n_scroll_mode_auto", e, t, 0))),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="scroll-doc-option" style="vertical-align:middle;width:30%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b('                            <input style=""  name="scrolling" value="single" type="radio" id="scroll-doc-radio"/>\r'),
                        r.b("\n" + n),
                        r.b('                            <label style="" for="scroll-doc-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b('                                <span style="font-size:150%;color:#888888;" class="glyphicon glyphicon-file" aria-hidden="true"></span> '),
                        r.b(r.v(r.d("strings.i18n_scroll_mode_doc", e, t, 0))),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="scroll-continuous-option" style="vertical-align:middle;width:30%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b('                            <input style=""  name="scrolling" value="single" type="radio" id="scroll-continuous-radio"/>\r'),
                        r.b("\n" + n),
                        r.b('                            <label style="" for="scroll-continuous-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b('                                <span style="font-size:150%;color:#888888;" class="glyphicon glyphicon-road" aria-hidden="true"></span> '),
                        r.b(r.v(r.d("strings.i18n_scroll_mode_continuous", e, t, 0))),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                    </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                    <!-- Page transitions are seriously broken (see readium-shared-js one_page_view.js disablePageTransitions boolean), so we hide the UI config options -->\r"),
                        r.b("\n" + n),
                        r.b('                    <h5 style="display:none;" hiddenx="hidden" id="setting-header-pageTransition-legend" class="setting-header">'),
                        r.b(r.v(r.d("strings.i18n_page_transition", e, t, 0))),
                        r.b("</h5>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                    <div style="display:none; width:100%;text-align:center;" hiddenx="hidden" role="radiogroup" class="row" aria-labelledby="setting-header-pageTransition-legend">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="pageTransition-none-option" style="vertical-align:middle;width:15%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b('                            <input style=""  name="pageTransition" value="single" type="radio" id="pageTransition-none-radio"/>\r'),
                        r.b("\n" + n),
                        r.b('                            <label style="" for="pageTransition-none-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b("                                "),
                        r.b(r.v(r.d("strings.i18n_page_transition_none", e, t, 0))),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="pageTransition-1-option" style="vertical-align:middle;width:15%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b('                            <input style=""  name="pageTransition" value="single" type="radio" id="pageTransition-1-radio"/>\r'),
                        r.b("\n" + n),
                        r.b('                            <label style="" for="pageTransition-1-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b("                                "),
                        r.b(r.v(r.d("strings.i18n_page_transition_fade", e, t, 0))),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="pageTransition-2-option" style="vertical-align:middle;width:15%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b('                            <input style=""  name="pageTransition" value="single" type="radio" id="pageTransition-2-radio"/>\r'),
                        r.b("\n" + n),
                        r.b('                            <label style="" for="pageTransition-2-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b("                                "),
                        r.b(r.v(r.d("strings.i18n_page_transition_slide", e, t, 0))),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="pageTransition-3-option" style="vertical-align:middle;width:15%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b('                            <input style=""  name="pageTransition" value="single" type="radio" id="pageTransition-3-radio"/>\r'),
                        r.b("\n" + n),
                        r.b('                            <label style="" for="pageTransition-3-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b("                                "),
                        r.b(r.v(r.d("strings.i18n_page_transition_swoosh", e, t, 0))),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div role="radio" id="pageTransition-4-option" style="vertical-align:middle;width:15%;display:inline-block;position:relative;">\r'),
                        r.b("\n" + n),
                        r.b('                            <input style=""  name="pageTransition" value="single" type="radio" id="pageTransition-4-radio"/>\r'),
                        r.b("\n" + n),
                        r.b('                            <label style="" for="pageTransition-4-radio" class="underlinedLabel">\r'),
                        r.b("\n" + n),
                        r.b("                                "),
                        r.b(r.v(r.d("strings.i18n_page_transition_butterfly", e, t, 0))),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                            </label>\r"),
                        r.b("\n" + n),
                        r.b("                        </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                    </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                    </div>\r"),
                        r.b("\n" + n),
                        r.b('                    <div id="tab-keyboard" class="tab-pane" role="tabpanel">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                    <div class="row" style="position:relative;">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <div id="invalid_keyboard_shortcut_ALERT"></div>\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                        <ul id="keyboard-list">\r'),
                        r.b("\n" + n),
                        r.b("                        </ul>\r"),
                        r.b("\n" + n),
                        r.b("                    </div>\r"),
                        r.b("\n" + n),
                        r.b("                     </div>\r"),
                        r.b("\n" + n),
                        r.b("                </div>\r"),
                        r.b("\n" + n),
                        r.b("            </div>\r"),
                        r.b("\n" + n),
                        r.b('            <div class="modal-footer">\r'),
                        r.b("\n" + n),
                        r.b('                <button id="buttClose"  type="button" class="btn btn-default" data-dismiss="modal" title="'),
                        r.b(r.v(r.d("strings.i18n_close", e, t, 0))),
                        r.b(" ["),
                        r.b(r.v(r.d("keyboard.SettingsModalClose", e, t, 0))),
                        r.b(']" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_close", e, t, 0))),
                        r.b(" ["),
                        r.b(r.v(r.d("keyboard.SettingsModalClose", e, t, 0))),
                        r.b(']">'),
                        r.b(r.v(r.d("strings.i18n_close", e, t, 0))),
                        r.b("</button>\r"),
                        r.b("\n" + n),
                        r.b('                <button id="buttSave"  type="button" class="btn btn-primary" data-dismiss="modal" title="'),
                        r.b(r.v(r.d("strings.i18n_save_changes", e, t, 0))),
                        r.b(" ["),
                        r.b(r.v(r.d("keyboard.SettingsModalSave", e, t, 0))),
                        r.b(']" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_save_changes", e, t, 0))),
                        r.b(" ["),
                        r.b(r.v(r.d("keyboard.SettingsModalSave", e, t, 0))),
                        r.b(']">'),
                        r.b(r.v(r.d("strings.i18n_save_changes", e, t, 0))),
                        r.b("</button>\r"),
                        r.b("\n" + n),
                        r.b("            </div>\r"),
                        r.b("\n" + n),
                        r.b("        </div>\r"),
                        r.b("\n" + n),
                        r.b("        <!-- /.modal-content -->\r"),
                        r.b("\n" + n),
                        r.b("    </div>\r"),
                        r.b("\n" + n),
                        r.b("    <!-- /.modal-dialog -->\r"),
                        r.b("\n" + n),
                        r.b("</div>\r"),
                        r.b("\n"),
                        r.fl()
                    );
                },
                partials: {},
                subs: {},
            },
            "",
            e
        );
        return (t.template = n), t;
    }),
    define("hgn!readium_js_viewer_html_templates/settings-keyboard-item.html", ["hogan"], function (e) {
        function t() {
            return n.render.apply(n, arguments);
        }
        var n = new e.Template(
            {
                code: function (e, t, n) {
                    var r = this;
                    return (
                        r.b((n = n || "")),
                        r.s(r.f("name", e, t, 1), e, t, 0, 9, 747, "{{ }}") &&
                            (r.rs(e, t, function (e, t, r) {
                                r.b("<li>\r"),
                                    r.b("\n" + n),
                                    r.b('<label id="label_'),
                                    r.b(r.v(r.f("name", e, t, 0))),
                                    r.b('">'),
                                    r.b(r.v(r.f("i18n", e, t, 0))),
                                    r.b("<br/><span>"),
                                    r.b(r.v(r.f("name", e, t, 0))),
                                    r.b("</span></label>\r"),
                                    r.b("\n" + n),
                                    r.b('<input id="'),
                                    r.b(r.v(r.f("name", e, t, 0))),
                                    r.b('" name="'),
                                    r.b(r.v(r.f("name", e, t, 0))),
                                    r.b('" class="keyboardInput" type="text"  placeholder="'),
                                    r.b(r.v(r.f("shortcut", e, t, 0))),
                                    r.b('" value="'),
                                    r.b(r.v(r.f("shortcut", e, t, 0))),
                                    r.b('" aria-labelledbyxxx="label_'),
                                    r.b(r.v(r.f("name", e, t, 0))),
                                    r.b('" aria-label="'),
                                    r.b(r.v(r.f("i18n", e, t, 0))),
                                    r.b('" title="'),
                                    r.b(r.v(r.f("i18n", e, t, 0))),
                                    r.b('"></input>\r'),
                                    r.b("\n" + n),
                                    r.b('<button class="resetKey captureKeyboardShortcut" role="button" data-key="'),
                                    r.b(r.v(r.f("name", e, t, 0))),
                                    r.b('"  title="'),
                                    r.b(r.v(r.d("strings.i18n_reset_key", e, t, 0))),
                                    r.b(" ("),
                                    r.b(r.v(r.f("def", e, t, 0))),
                                    r.b(')" aria-label="'),
                                    r.b(r.v(r.d("strings.i18n_reset_key", e, t, 0))),
                                    r.b(" ("),
                                    r.b(r.v(r.f("def", e, t, 0))),
                                    r.b(')"><span aria-hidden="true">&#8855;</span></button>\r'),
                                    r.b("\n" + n),
                                    r.b('<span id="duplicate_keyboard_shortcut" aria-hidden="true">'),
                                    r.b(r.v(r.d("strings.i18n_duplicate_keyboard_shortcut", e, t, 0))),
                                    r.b("</span>\r"),
                                    r.b("\n" + n),
                                    r.b('<span id="invalid_keyboard_shortcut" aria-hidden="true">'),
                                    r.b(r.v(r.d("strings.i18n_invalid_keyboard_shortcut", e, t, 0))),
                                    r.b("</span>\r"),
                                    r.b("\n" + n),
                                    r.b("</li>\r"),
                                    r.b("\n" + n);
                            }),
                            e.pop()),
                        r.s(r.f("name", e, t, 1), e, t, 1, 0, 0, "") ||
                            (r.b('<li id="resetAllKeys'),
                            r.b(r.v(r.f("id", e, t, 0))),
                            r.b('" class="resetAllKeys">\r'),
                            r.b("\n" + n),
                            r.b('<button class="resetKey" role="button"  title="'),
                            r.b(r.v(r.d("strings.i18n_reset_key_all", e, t, 0))),
                            r.b('" aria-label="'),
                            r.b(r.v(r.d("strings.i18n_reset_key_all", e, t, 0))),
                            r.b('"><span aria-hidden="true">'),
                            r.b(r.v(r.d("strings.i18n_reset_key_all", e, t, 0))),
                            r.b("  &#8855;</span></button>\r"),
                            r.b("\n" + n),
                            r.b("</li>\r"),
                            r.b("\n" + n)),
                        r.fl()
                    );
                },
                partials: {},
                subs: {},
            },
            "",
            e
        );
        return (t.template = n), t;
    }),
    (function (e) {
        function t(e, t) {
            for (var n = e.length; n--; ) if (e[n] === t) return n;
            return -1;
        }
        function n(e, t) {
            if (e.length != t.length) return !1;
            for (var n = 0; n < e.length; n++) if (e[n] !== t[n]) return !1;
            return !0;
        }
        function r(e) {
            for (_ in x) x[_] = e[I[_]];
        }
        function i(e) {
            return e.keyCode || e.charCode || e.which || e.key || 0;
        }
        function o(e) {
            var n, o, a, s, c, u;
            if (((n = i(e)), t(R, n) == -1 && R.push(n), (93 != n && 224 != n) || (n = 91), n in x)) {
                x[n] = !0;
                for (a in C) C[a] == n && (l[a] = !0);
            } else if ((r(e), l.filter.call(this, e) && n in w))
                for (u = p(), s = 0; s < w[n].length; s++)
                    if (((o = w[n][s]), o.scope == u || "all" == o.scope)) {
                        c = o.mods.length > 0;
                        for (a in x) ((!x[a] && t(o.mods, +a) > -1) || (x[a] && t(o.mods, +a) == -1)) && (c = !1);
                        ((0 != o.mods.length || x[16] || x[18] || x[17] || x[91]) && !c) ||
                            (o.method(e, o) === !1 && (e.preventDefault ? e.preventDefault() : (e.returnValue = !1), e.stopPropagation && e.stopPropagation(), e.cancelBubble && (e.cancelBubble = !0)));
                    }
        }
        function a(e) {
            var n,
                r = i(e),
                o = t(R, r);
            if ((o >= 0 && R.splice(o, 1), (93 != r && 224 != r) || (r = 91), r in x)) {
                x[r] = !1;
                for (n in C) C[n] == r && (l[n] = !1);
            }
        }
        function s() {
            for (_ in x) x[_] = !1;
            for (_ in C) l[_] = !1;
        }
        function l(e, t, n) {
            var r, i;
            (r = m(e)), void 0 === n && ((n = t), (t = "all"));
            for (var o = 0; o < r.length; o++)
                (i = []), (e = r[o].split("+")), e.length > 1 && ((i = v(e)), (e = [e[e.length - 1]])), (e = e[0]), (e = S(e)), e in w || (w[e] = []), w[e].push({ shortcut: r[o], scope: t, method: n, key: r[o], mods: i });
        }
        function c(e, t) {
            var r,
                i,
                o,
                a,
                s,
                l = [];
            for (r = m(e), a = 0; a < r.length; a++) {
                if (((i = r[a].split("+")), i.length > 1 && (l = v(i)), (e = i[i.length - 1]), (e = S(e)), void 0 === t && (t = p()), !w[e])) return;
                for (o = 0; o < w[e].length; o++) (s = w[e][o]), s.scope === t && n(s.mods, l) && (w[e][o] = {});
            }
        }
        function u(e) {
            return "string" == typeof e && (e = S(e)), t(R, e) != -1;
        }
        function d() {
            return R.slice(0);
        }
        function f(e) {
            var t = (e.target || e.srcElement).tagName;
            return !("INPUT" == t || "SELECT" == t || "TEXTAREA" == t);
        }
        function h(e) {
            E = e || "all";
        }
        function p() {
            return E || "all";
        }
        function g(e) {
            var t, n, r;
            for (t in w) for (n = w[t], r = 0; r < n.length; ) n[r].scope === e ? n.splice(r, 1) : r++;
        }
        function m(e) {
            var t;
            return (e = e.replace(/\s/g, "")), (t = e.split(",")), "" == t[t.length - 1] && (t[t.length - 2] += ","), t;
        }
        function v(e) {
            for (var t = e.slice(0, e.length - 1), n = 0; n < t.length; n++) t[n] = C[t[n]];
            return t;
        }
        function b(e, t, n) {
            e.addEventListener
                ? e.addEventListener(t, n, !1)
                : e.attachEvent &&
                  e.attachEvent("on" + t, function () {
                      n(window.event);
                  });
        }
        function y() {
            var t = e.key;
            return (e.key = k), t;
        }
        var _,
            w = {},
            x = { 16: !1, 18: !1, 17: !1, 91: !1 },
            E = "all",
            C = { "": 16, shift: 16, "": 18, alt: 18, option: 18, "": 17, ctrl: 17, control: 17, "": 91, command: 91 },
            T = {
                backspace: 8,
                tab: 9,
                clear: 12,
                enter: 13,
                return: 13,
                esc: 27,
                escape: 27,
                space: 32,
                left: 37,
                up: 38,
                right: 39,
                down: 40,
                del: 46,
                delete: 46,
                home: 36,
                end: 35,
                pageup: 33,
                pagedown: 34,
                ",": 188,
                ".": 190,
                "/": 191,
                "`": 192,
                "-": 189,
                "=": 187,
                ";": 186,
                "'": 222,
                "[": 219,
                "]": 221,
                "\\": 220,
            },
            S = function (e) {
                return e.toUpperCase ? T[e] || e.toUpperCase().charCodeAt(0) : e;
            },
            R = [];
        for (_ = 1; _ < 20; _++) T["f" + _] = 111 + _;
        var I = { 16: "shiftKey", 18: "altKey", 17: "ctrlKey", 91: "metaKey" };
        for (_ in C) l[_] = !1;
        b(document, "keydown", function (e) {
            o(e);
        }),
            b(document, "keyup", a),
            b(window, "focus", s);
        var k = e.key;
        (e.key = l),
            (e.key.setScope = h),
            (e.key.getScope = p),
            (e.key.deleteScope = g),
            (e.key.filter = f),
            (e.key.isPressed = u),
            (e.key.getPressedKeyCodes = d),
            (e.key.noConflict = y),
            (e.key.unbind = c),
            "undefined" != typeof module && (module.exports = l);
    })(this),
    define("keymaster", (function (e) {
        return function () {
            var t;
            return t || e.key;
        };
    })(this)),
    define("readium_js_viewer/Keyboard", ["i18nStrings", "keymaster", "Settings"], function (e, t, n) {
        var r = {};
        void function () {
            function e(e, a) {
                var s;
                s = n ? document.createEvent("KeyboardEvent") : document.createEvent("Event");
                var l,
                    c = {};
                for (l in r) i(r, l) && (c[l] = ((i(a, l) && a) || r)[l]);
                var u = c.ctrlKey,
                    d = c.shiftKey,
                    f = c.altKey,
                    h = c.metaKey,
                    p = c.altGraphKey,
                    g = n > 3 ? ((u ? "Control" : "") + (d ? " Shift" : "") + (f ? " Alt" : "") + (h ? " Meta" : "") + (p ? " AltGraph" : "")).trim() : null,
                    m = c.key + "",
                    v = c.char + "",
                    b = c.location,
                    y = c.keyCode || (c.keyCode = (m && m.charCodeAt(0)) || 0),
                    _ = c.charCode || (c.charCode = (v && v.charCodeAt(0)) || 0),
                    w = c.bubbles,
                    x = c.cancelable,
                    E = c.repeat,
                    C = c.locale,
                    T = t;
                c.which || (c.which = c.keyCode),
                    "initKeyEvent" in s
                        ? s.initKeyEvent(e, w, x, T, u, f, d, h, y, _)
                        : n && "initKeyboardEvent" in s
                        ? 1 == n
                            ? s.initKeyboardEvent(e, w, x, T, m, b, u, d, f, h, p)
                            : 2 == n
                            ? s.initKeyboardEvent(e, w, x, T, u, f, d, h, y, _)
                            : 3 == n
                            ? s.initKeyboardEvent(e, w, x, T, m, b, u, f, d, h, p)
                            : 4 == n
                            ? s.initKeyboardEvent(e, w, x, T, m, b, g, E, C)
                            : s.initKeyboardEvent(e, w, x, T, v, m, b, g, E, C)
                        : s.initEvent(e, w, x);
                for (l in r)
                    if (i(r, l) && s[l] != c[l])
                        try {
                            delete s[l], o(s, l, { writable: !0, value: c[l] });
                        } catch (e) {}
                return s;
            }
            var t = this,
                n = (function (e) {
                    try {
                        return e.initKeyboardEvent("keyup", !1, !1, t, "+", 3, !0, !1, !0, !1, !1), ("+" == (e.keyIdentifier || e.key) && 3 == (e.keyLocation || e.location) && (e.ctrlKey ? (e.altKey ? 1 : 3) : e.shiftKey ? 2 : 4)) || 9;
                    } catch (e) {
                        n = 0;
                    }
                })(document.createEvent("KeyboardEvent")),
                r = { char: "", key: "", location: 0, ctrlKey: !1, shiftKey: !1, altKey: !1, metaKey: !1, repeat: !1, locale: "", detail: 0, bubbles: !1, cancelable: !1, keyCode: 0, charCode: 0, which: 0 },
                i = Function.prototype.call.bind(Object.prototype.hasOwnProperty),
                o =
                    Object.defineProperty ||
                    function (e, t, n) {
                        "value" in n && (e[t] = n.value);
                    };
            t.crossBrowser_initKeyboardEvent = e;
        }.call(window),
            (Keyboard = {
                resetToDefaults: function () {
                    for (prop in Keyboard.defaultOptions) Keyboard.defaultOptions.hasOwnProperty(prop) && "string" == typeof Keyboard.defaultOptions[prop] && (Keyboard[prop] = Keyboard.defaultOptions[prop]);
                },
                resetAccessKeys: function () {
                    var e = function (e) {
                        if (!e || !e.length) return "";
                        var t = e[e.length - 1];
                        return /^[a-z0-9]+$/i.test(t) ? t : "";
                    };
                    Keyboard.accesskeys = {};
                    for (prop in Keyboard)
                        if (Keyboard.hasOwnProperty(prop)) {
                            var t = Keyboard[prop];
                            "string" == typeof t && (Keyboard.accesskeys[prop] = e(t));
                        }
                },
                applySettings: function (e) {
                    if ((this.resetToDefaults(), e && e.keyboard)) for (prop in Keyboard) Keyboard.hasOwnProperty(prop) && "string" == typeof Keyboard[prop] && "string" == typeof e.keyboard[prop] && (Keyboard[prop] = e.keyboard[prop]);
                    this.resetAccessKeys();
                },
                dispatch: function (e, t) {
                    if (!t.cancelBubble && !t.defaultPrevented && ("undefined" == typeof t.returnValue || t.returnValue)) {
                        var n = t.srcElement || t.target;
                        if (n)
                            for (var r = n; r; ) {
                                var i = r.nodeName;
                                if ("input" === i || "textarea" === i) return;
                                if (r.getAttribute) {
                                    var o = r.getAttribute("contenteditable");
                                    if ("true" === o || "contenteditable" === o) return;
                                }
                                if (r.classList && r.classList.contains("keyboard-input")) return;
                                r = r.parentNode;
                            }
                        var a = crossBrowser_initKeyboardEvent(t.type, {
                            bubbles: !0,
                            cancelable: !1,
                            keyCode: t.keyCode,
                            charCode: t.charCode,
                            which: t.which,
                            ctrlKey: t.ctrlKey,
                            shiftKey: t.shiftKey,
                            altKey: t.altKey,
                            metaKey: t.metaKey,
                            char: t.char ? t.char : String.fromCharCode(t.charCode),
                            key: t.key ? t.key : t.keyCode,
                        });
                        e.dispatchEvent(a);
                    }
                },
                scope: function (e) {
                    e || alert("!SCOPE ACTIVATE!"), t.setScope(e);
                },
                on: function (e, n, i) {
                    e || console.error("!KEYS!"),
                        r.hasOwnProperty(n) || (r[n] = []),
                        r[n].push(e),
                        t.unbind(e, n),
                        t(e, n, function () {
                            $(document.body).addClass("keyboard"), i();
                        });
                },
                off: function (e) {
                    if ((e || alert("!SCOPE OFF!"), r.hasOwnProperty(e))) for (k in r[e]) t.unbind(k, e);
                },
                i18n: {
                    ShowSettingsModal: e.settings,
                    SettingsModalSave: e.settings + " - " + e.i18n_save_changes,
                    SettingsModalClose: e.settings + " - " + e.i18n_close,
                    PagePrevious: e.i18n_page_previous,
                    PageNext: e.i18n_page_next,
                    PagePreviousAlt: e.i18n_page_previous,
                    PageNextAlt: e.i18n_page_next,
                    ToolbarShow: e.i18n_toolbar_show,
                    ToolbarHide: e.i18n_toolbar_hide,
                    FullScreenToggle: e.enter_fullscreen + " / " + e.exit_fullscreen,
                    SwitchToLibrary: e.view_library,
                    TocShowHideToggle: e.toc,
                    NightTheme: e.i18n_arabian_nights,
                    MediaOverlaysPlayPause: e.i18n_audio_play + " / " + e.i18n_audio_pause,
                    MediaOverlaysPrevious: e.i18n_audio_previous,
                    MediaOverlaysNext: e.i18n_audio_next,
                    MediaOverlaysEscape: e.i18n_audio_esc,
                    MediaOverlaysRateIncrease: e.i18n_audio_rate_increase,
                    MediaOverlaysRateDecrease: e.i18n_audio_rate_decrease,
                    MediaOverlaysRateReset: e.i18n_audio_rate_reset,
                    MediaOverlaysVolumeIncrease: e.i18n_audio_volume_increase,
                    MediaOverlaysVolumeDecrease: e.i18n_audio_volume_decrease,
                    MediaOverlaysVolumeMuteToggle: e.i18n_audio_mute + " / " + e.i18n_audio_unmute,
                    MediaOverlaysAdvancedPanelShowHide: e.i18n_audio_expand,
                    BackgroundAudioPlayPause: e.i18n_audio_play_background + " / " + e.i18n_audio_pause_background,
                },
                defaultOptions: {},
                accesskeys: {},
                ShowSettingsModal: "o",
                SettingsModalSave: "s",
                SettingsModalClose: "c",
                PagePrevious: "left",
                PageNext: "right",
                PagePreviousAlt: "1",
                PageNextAlt: "2",
                ToolbarShow: "v",
                ToolbarHide: "x",
                FullScreenToggle: "h",
                SwitchToLibrary: "b",
                TocShowHideToggle: "t",
                NightTheme: "n",
                MediaOverlaysEscape: "r",
                MediaOverlaysPlayPause: "m",
                MediaOverlaysRateIncrease: "l",
                MediaOverlaysRateDecrease: "j",
                MediaOverlaysRateReset: "k",
                MediaOverlaysVolumeIncrease: "w",
                MediaOverlaysVolumeDecrease: "q",
                MediaOverlaysVolumeMuteToggle: "a",
                MediaOverlaysPrevious: "y",
                MediaOverlaysNext: "u",
                MediaOverlaysAdvancedPanelShowHide: "g",
                BackgroundAudioPlayPause: "d",
            });
        try {
            Keyboard.defaultOptions = {};
            for (prop in Keyboard) Keyboard.hasOwnProperty(prop) && "string" == typeof Keyboard[prop] && (Keyboard.defaultOptions[prop] = Keyboard[prop]);
            Keyboard.resetAccessKeys();
        } catch (e) {
            console.error(e);
        }
        return Keyboard;
    }),
    define("readium_js_viewer/ReaderSettingsDialog_Keyboard", ["hgn!readium_js_viewer_html_templates/settings-keyboard-item.html", "i18nStrings", "./Dialogs", "Settings", "./Keyboard", "underscore"], function (e, t, n, r, i, o) {
        var a = function (e, n) {
                var r = !1,
                    i = !1,
                    o = $("#keyboard-list"),
                    a = o.hasClass("atLeastOneInvalidOrDuplicateShortcut");
                o.removeClass("atLeastOneInvalidOrDuplicateShortcut");
                var l = $("#invalid_keyboard_shortcut_ALERT")[0];
                for (l.removeAttribute("role"), l.removeAttribute("aria-live"), l.removeAttribute("aria-atomic"); l.firstChild; ) l.removeChild(l.firstChild);
                var c = !1,
                    u = $(".keyboardInput");
                u.each(function () {
                    var t = $(this);
                    t.parent().removeClass("duplicateShortcut"),
                        t[0].removeAttribute("aria-invalid"),
                        s(t, n),
                        t.parent().hasClass("invalidShortcut") && (t[0].setAttribute("aria-invalid", "true"), (i = !0), e && e.length && e[0] === t[0] && (c = !0));
                });
                for (var d = !1, f = 0; f < 2; f++)
                    u.each(function () {
                        var t = $(this),
                            n = t.parent().hasClass("invalidShortcut"),
                            i = t.parent().hasClass("duplicateShortcut"),
                            o = t.attr("placeholder"),
                            a = n || i ? o : t.attr("data-val");
                        return (
                            !!i ||
                            void u.each(function () {
                                var n = $(this);
                                if (n[0] === t[0]) return !0;
                                var i = n.attr("placeholder"),
                                    o = n.parent().hasClass("invalidShortcut"),
                                    s = n.parent().hasClass("duplicateShortcut"),
                                    l = o || s ? i : n.attr("data-val");
                                a === l &&
                                    ((r = !0),
                                    e && e.length && (e[0] === t[0] || e[0] === n[0]) && (d = !0),
                                    t[0].setAttribute("aria-invalid", "true"),
                                    n[0].setAttribute("aria-invalid", "true"),
                                    n.parent().hasClass("duplicateShortcut") || n.parent().addClass("duplicateShortcut"),
                                    t.parent().hasClass("duplicateShortcut") || t.parent().addClass("duplicateShortcut"));
                            })
                        );
                    });
                if ((r || i) && (o.addClass("atLeastOneInvalidOrDuplicateShortcut"), c || d)) {
                    a ? l.setAttribute("aria-live", "polite") : l.setAttribute("role", "alert"), l.setAttribute("aria-atomic", "true");
                    var h = document.createTextNode(c ? t.i18n_invalid_keyboard_shortcut : t.i18n_duplicate_keyboard_shortcut);
                    l.appendChild(h), (l.style.visibility = "hidden"), (l.style.visibility = "visible");
                }
            },
            s = function (e, t) {
                e.parent().removeClass("invalidShortcut"), e.attr("data-val", e.val());
                var n = e.val().toLowerCase().trim(),
                    r = !1,
                    i = !1,
                    o = !1;
                n.indexOf("shift") >= 0 && (r = !0), n.indexOf("ctrl") >= 0 && (i = !0), n.indexOf("alt") >= 0 && (o = !0);
                var a = n.lastIndexOf("+") === n.length - 1;
                if (
                    ((n = n.replace(/shift/g, "")),
                    (n = n.replace(/ctrl/g, "")),
                    (n = n.replace(/alt/g, "")),
                    (n = n.replace(/\+/g, "")),
                    (n = n.replace(/\s/g, "")),
                    (n = n.trim()),
                    a && (n += "+"),
                    n.match(/^[0-9A-Za-z]$/) || n.match(/^backspace$/) || n.match(/^space$/) || n.match(/^return$/) || n.match(/^enter$/) || n.match(/^left$/) || n.match(/^right$/) || n.match(/^up$/) || n.match(/^down$/))
                ) {
                    var s = (r ? "shift + " : "") + (i ? "ctrl + " : "") + (o ? "alt + " : "") + n;
                    e.attr("data-val", s), t || e.val(s);
                } else e.parent().addClass("invalidShortcut");
            },
            l = function () {
                var n = $("#keyboard-list");
                n.empty(), n.append(e({ strings: t, id: "TOP" }));
                for (prop in i) i.hasOwnProperty(prop) && "string" == typeof i[prop] && n.append(e({ strings: t, keyboard: i, name: prop, shortcut: i[prop], i18n: i.i18n[prop], def: i.defaultOptions[prop] }));
                n.append(e({ strings: t, id: "BOTTOM" })), a();
                var r = void 0;
                $(".keyboardInput").on("blur", function (e) {
                    $(this);
                    (r = void 0), a();
                }),
                    $(".keyboardInput").on("focus", function (e) {
                        var t = $(this);
                        a(t, !0);
                    });
                var s = o.bind(o.debounce(a, 700), this);
                $(".keyboardInput").on("keyup", function () {
                    var e = $(this),
                        t = e.val();
                    t !== r && s(e, !0), (r = t);
                }),
                    $(".resetKey").on("click", function () {
                        $that = $(this);
                        var e = $that.attr("data-key");
                        if (e) {
                            var t = $("input#" + e);
                            t.val(i.defaultOptions[e]);
                        } else
                            $(".resetKey[data-key]").each(function () {
                                var e = $(this),
                                    t = e.attr("data-key");
                                if (t) {
                                    var n = $("input#" + t);
                                    n.val(i.defaultOptions[t]);
                                }
                            });
                        a();
                    });
            },
            c = function () {
                var e = !1,
                    r = !1,
                    o = {};
                if (
                    (a(),
                    $(".keyboardInput").each(function () {
                        var t = $(this),
                            n = t.attr("placeholder"),
                            a = t.attr("id"),
                            s = t.attr("data-val");
                        return (
                            (t.parent().hasClass("invalidShortcut") || t.parent().hasClass("duplicateShortcut")) && ((s = n), (r = !0)),
                            !s.length || ((s = s.toLowerCase()), n !== s && (e = !0), void (s !== i.defaultOptions[a] && (o[a] = s)))
                        );
                    }),
                    e || r)
                ) {
                    var s = "";
                    e && (s = "<p>" + t.i18n_keyboard_reload + "</p>"), r && (s += "<p>" + t.i18n_keyboard_onerror_reset + "</p>"), n.showModalMessageEx("Readium - " + t.i18n_keyboard_shortcuts, s);
                }
                return o;
            };
        return { initKeyboardList: l, saveKeys: c };
    }),
    define("readium_js_viewer/ReaderSettingsDialog", ["./ModuleConfig", "hgn!readium_js_viewer_html_templates/settings-dialog.html", "./ReaderSettingsDialog_Keyboard", "i18nStrings", "./Dialogs", "Settings", "./Keyboard"], function (
        e,
        t,
        n,
        r,
        i,
        o,
        a
    ) {
        var s = { fontSize: 100, syntheticSpread: "auto", scroll: "auto", columnGap: 60, columnMaxWidth: 550, columnMinWidth: 400 },
            l = function (e) {
                var t = "author-theme" === e,
                    n = $(".preview-text");
                c(n, e);
                var r = window.getComputedStyle(n[0]),
                    i = [{ selector: "body", declarations: { backgroundColor: t ? "" : r.backgroundColor, color: t ? "" : r.color } }];
                return i;
            },
            c = function (e, t) {
                var n = e.attr("data-theme");
                e.removeClass(n), e.addClass(t), e.attr("data-theme", t);
            },
            u = function (e, t) {
                if ((e.updateSettings(t), t.theme)) {
                    $("html").attr("data-theme", t.theme);
                    var n = l(t.theme);
                    e.setBookStyles(n), $("#reading-area").css(n[0].declarations);
                }
            },
            d = function (e, t, n, r) {
                e.attr("aria-valuenow", t + ""), e.attr("aria-value-now", t + ""), e.attr("aria-valuetext", n + ""), e.attr("aria-value-text", n + ""), e.attr("title", r + " " + n), e.attr("aria-label", r + " " + n);
            },
            f = function (l) {
                $("#app-container").append(t({ imagePathPrefix: e.imagePathPrefix, strings: r, dialogs: i, keyboard: a })),
                    ($previewText = $(".preview-text")),
                    $(".theme-option").on("click", function () {
                        var e = $(this).attr("data-theme");
                        c($previewText, e);
                    });
                var f = $("#margin-size-input");
                f.on("change", function () {
                    var e = f.val();
                    d(f, e, e + "px", r.i18n_margins);
                });
                var h = $("#column-max-width-input");
                h.on("change", function () {
                    var e = h.val(),
                        t = Number(h.attr("max")),
                        n = e >= t ? r.i18n_pageMaxWidth_Disabled : e + "px";
                    d(h, e, n, r.i18n_pageMaxWidth);
                });
                var p = $("#font-size-input");
                p.on("change", function () {
                    var e = p.val();
                    $previewText.css({ fontSize: e / 100 + "em" }), d(p, e, e + "%", r.i18n_font_size);
                });
                var g = $("#btTxtMinus");
                g.on("click", function () {
                    var e = parseInt(p.val(), 10);
                    return p.val(e - 10), p.trigger("change"), !1;
                });
                var m = $("#btTxtPlus");
                m.on("click", function () {
                    var e = parseInt(p.val(), 10);
                    return p.val(e + 10), p.trigger("change"), !1;
                }),
                    $("#tab-butt-main").on("click", function () {
                        $("#tab-keyboard").attr("aria-expanded", "false"), $("#tab-main").attr("aria-expanded", "true");
                    }),
                    $("#tab-butt-keys").on("click", function () {
                        $("#tab-main").attr("aria-expanded", "false"), $("#tab-keyboard").attr("aria-expanded", "true");
                    }),
                    $("#settings-dialog").on("hide.bs.modal", function () {
                        setTimeout(function () {
                            $("#keyboard-list").empty();
                        }, 500);
                    }),
                    $("#settings-dialog").on("show.bs.modal", function () {
                        $("#tab-butt-main").trigger("click"),
                            n.initKeyboardList(),
                            setTimeout(function () {
                                $("#closeSettingsCross")[0].focus();
                            }, 1e3),
                            o.get("reader", function (e) {
                                e = e || s;
                                for (prop in s) !s.hasOwnProperty(prop) || e.hasOwnProperty(prop) || e[prop] || (e[prop] = s[prop]);
                                p.val(e.fontSize), d(p, e.fontSize, e.fontSize + "%", r.i18n_font_size), (e.columnGap = s.columnGap), f.val(e.columnGap), d(f, e.columnGap, e.columnGap + "px", r.i18n_margins);
                                var t = Number(h.attr("max")),
                                    n = e.columnMaxWidth;
                                n >= t && (n = t);
                                var i = n >= t ? r.i18n_pageMaxWidth_Disabled : n + "px";
                                h.val(n),
                                    d(h, n, i, r.i18n_pageMaxWidth),
                                    "double" == e.syntheticSpread
                                        ? $("#two-up-option input").prop("checked", !0)
                                        : "single" == e.syntheticSpread
                                        ? $("#one-up-option input").prop("checked", !0)
                                        : $("#spread-default-option input").prop("checked", !0),
                                    "scroll-doc" == e.scroll
                                        ? $("#scroll-doc-option input").prop("checked", !0)
                                        : "scroll-continuous" == e.scroll
                                        ? $("#scroll-continuous-option input").prop("checked", !0)
                                        : $("#scroll-default-option input").prop("checked", !0),
                                    0 === e.pageTransition
                                        ? $("#pageTransition-1-option input").prop("checked", !0)
                                        : 1 === e.pageTransition
                                        ? $("#pageTransition-2-option input").prop("checked", !0)
                                        : 2 === e.pageTransition
                                        ? $("#pageTransition-3-option input").prop("checked", !0)
                                        : 3 === e.pageTransition
                                        ? $("#pageTransition-4-option input").prop("checked", !0)
                                        : $("#pageTransition-none-option input").prop("checked", !0),
                                    e.theme && c($previewText, e.theme),
                                    $previewText.css({ fontSize: e.fontSize / 100 + "em" });
                            });
                    });
                var v = function () {
                    var e = Number(h.attr("max")),
                        t = Number(h.val());
                    t >= e && (t = 99999);
                    var r = { fontSize: Number(p.val()), syntheticSpread: "auto", columnGap: Number(f.val()), columnMaxWidth: t, scroll: "auto" };
                    $("#scroll-doc-option input").prop("checked") ? (r.scroll = "scroll-doc") : $("#scroll-continuous-option input").prop("checked") && (r.scroll = "scroll-continuous"),
                        $("#two-up-option input").prop("checked") ? (r.syntheticSpread = "double") : $("#one-up-option input").prop("checked") && (r.syntheticSpread = "single"),
                        $("#pageTransition-1-option input").prop("checked")
                            ? (r.pageTransition = 0)
                            : $("#pageTransition-2-option input").prop("checked")
                            ? (r.pageTransition = 1)
                            : $("#pageTransition-3-option input").prop("checked")
                            ? (r.pageTransition = 2)
                            : $("#pageTransition-4-option input").prop("checked")
                            ? (r.pageTransition = 3)
                            : (r.pageTransition = -1),
                        (r.theme = $previewText.attr("data-theme")),
                        l && u(l, r);
                    var i = n.saveKeys();
                    o.get("reader", function (e) {
                        e || (e = {});
                        for (prop in r) r.hasOwnProperty(prop) && (e[prop] = r[prop]);
                        (e.keyboard = i),
                            o.put("reader", e),
                            setTimeout(function () {
                                a.applySettings(e);
                            }, 100);
                    });
                };
                a.on(a.NightTheme, "settings", function () {
                    o.get("reader", function (e) {
                        e || (e = {});
                        var t = "night-theme" === e.theme;
                        (e.theme = t ? "author-theme" : "night-theme"), o.put("reader", e), l && u(l, e);
                    });
                }),
                    a.on(a.SettingsModalSave, "settings", function () {
                        v(), $("#settings-dialog").modal("hide");
                    }),
                    a.on(a.SettingsModalClose, "settings", function () {
                        $("#settings-dialog").modal("hide");
                    }),
                    $("#settings-dialog .btn-primary").on("click", v);
            };
        return { initDialog: f, updateReader: u, defaultSettings: s };
    }),
    define("hgn!readium_js_viewer_html_templates/about-dialog.html", ["hogan"], function (e) {
        function t() {
            return n.render.apply(n, arguments);
        }
        var n = new e.Template(
            {
                code: function (e, t, n) {
                    var r = this;
                    return (
                        r.b((n = n || "")),
                        r.b('<div class="modal fade" id="about-dialog" tabindex="-1" role="dialog" aria-label="'),
                        r.b(r.t(r.d("strings.about", e, t, 0))),
                        r.b('" >\r'),
                        r.b("\n" + n),
                        r.b('  <div class="modal-dialog">\r'),
                        r.b("\n" + n),
                        r.b('    <div class="modal-content">\r'),
                        r.b("\n" + n),
                        r.b('      <div class="modal-body">\r'),
                        r.b("\n" + n),
                        r.b('          <div class="splash-logo">\r'),
                        r.b("\n" + n),
                        r.b('              <img src="'),
                        r.b(r.t(r.f("imagePathPrefix", e, t, 0))),
                        r.b('images/about_readium_logo.png" alt="">\r'),
                        r.b("\n" + n),
                        r.b("          </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('          <div class="about-message">\r'),
                        r.b("\n" + n),
                        r.b("              <span>"),
                        r.b(r.t(r.d("strings.i18n_html_readium_tm_a_project", e, t, 0))),
                        r.b("</span>\r"),
                        r.b("\n" + n),
                        r.b("          </div>\r"),
                        r.b("\n" + n),
                        r.b("          <div>\r"),
                        r.b("\n" + n),
                        r.b('                 <img src="'),
                        r.b(r.t(r.f("imagePathPrefix", e, t, 0))),
                        r.b('images/partner_logos.png">\r'),
                        r.b("\n" + n),
                        r.b("            </div>\r"),
                        r.b("\n" + n),
                        r.b('        <h4 style="color:#111155">'),
                        r.b(r.t(r.d("strings.gethelp", e, t, 0))),
                        r.b("</h4>\r"),
                        r.b("\n" + n),
                        r.b('        <div class="version">'),
                        r.b(r.v(r.d("viewerJs.chromeVersion", e, t, 0))),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b('        <div class="build-date">'),
                        r.b(r.v(r.f("dateTimeString", e, t, 0))),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b('        <div class="version-details">\r'),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b('          <div><a target="_blank" href="https://github.com/readium/readium-js-viewer/tree/'),
                        r.b(r.v(r.d("viewerJs.sha", e, t, 0))),
                        r.b('">readium-js-viewer@'),
                        r.b(r.v(r.d("viewerJs.sha", e, t, 0))),
                        r.b("</a>"),
                        r.s(r.d("viewerJs.clean", e, t, 1), e, t, 1, 0, 0, "") || (r.b('<span class="local-changes-alert"> ('), r.b(r.t(r.d("strings.gitHasLocalChanges", e, t, 0))), r.b(")</span>")),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b("          \r"),
                        r.b("\n" + n),
                        r.b('          <div><a target="_blank" href="https://github.com/readium/readium-js/tree/'),
                        r.b(r.v(r.d("readiumJs.sha", e, t, 0))),
                        r.b('">readium-js@'),
                        r.b(r.v(r.d("readiumJs.sha", e, t, 0))),
                        r.b("</a>"),
                        r.s(r.d("readiumJs.clean", e, t, 1), e, t, 1, 0, 0, "") || (r.b('<span class="local-changes-alert"> ('), r.b(r.t(r.d("strings.gitHasLocalChanges", e, t, 0))), r.b(")</span>")),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b("          \r"),
                        r.b("\n" + n),
                        r.b('          <div><a target="_blank" href="https://github.com/readium/readium-shared-js/tree/'),
                        r.b(r.v(r.d("sharedJs.sha", e, t, 0))),
                        r.b('">readium-shared-js@'),
                        r.b(r.v(r.d("sharedJs.sha", e, t, 0))),
                        r.b("</a>"),
                        r.s(r.d("sharedJs.clean", e, t, 1), e, t, 1, 0, 0, "") || (r.b('<span class="local-changes-alert"> ('), r.b(r.t(r.d("strings.gitHasLocalChanges", e, t, 0))), r.b(")</span>")),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b("          \r"),
                        r.b("\n" + n),
                        r.b('          <div><a target="_blank" href="https://github.com/readium/readium-cfi-js/tree/'),
                        r.b(r.v(r.d("cfiJs.sha", e, t, 0))),
                        r.b('">readium-cfi-js@'),
                        r.b(r.v(r.d("cfiJs.sha", e, t, 0))),
                        r.b("</a>"),
                        r.s(r.d("cfiJs.clean", e, t, 1), e, t, 1, 0, 0, "") || (r.b('<span class="local-changes-alert"> ('), r.b(r.t(r.d("strings.gitHasLocalChanges", e, t, 0))), r.b(")</span>")),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b("        </div>\r"),
                        r.b("\n" + n),
                        r.b("      </div>\r"),
                        r.b("\n" + n),
                        r.b("    </div><!-- /.modal-content -->\r"),
                        r.b("\n" + n),
                        r.b("  </div><!-- /.modal-dialog -->\r"),
                        r.b("\n" + n),
                        r.b("</div><!-- /.modal -->\r"),
                        r.b("\n"),
                        r.fl()
                    );
                },
                partials: {},
                subs: {},
            },
            "",
            e
        );
        return (t.template = n), t;
    }),
    define("hgn!readium_js_viewer_html_templates/reader-navbar.html", ["hogan"], function (e) {
        function t() {
            return n.render.apply(n, arguments);
        }
        var n = new e.Template(
            {
                code: function (e, t, n) {
                    var r = this;
                    return (
                        r.b((n = n || "")),
                        r.b('<div class="btn-group navbar-left">\r'),
                        r.b("\n" + n),
                        r.b('        <!-- <button type="button" class="btn btn-default icon icon-show-hide"></button>  -->\r'),
                        r.b("\n" + n),
                        r.b('    <!--<button id="aboutButt1" tabindex="1" type="button" class="btn icon-logo" data-toggle="modal" data-target="#about-dialog" title="'),
                        r.b(r.v(r.d("strings.about", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.about", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('        <span class="icon-readium" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("    </button>-->\r"),
                        r.b("\n" + n),
                        r.b('    <span id="navBarTitle"></span>\r'),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b('    <button id="buttShowToolBar" style="opacity:0;visibility:hidden;border:0;outline:0;padding:0;margin:0;width:1px;height=1px;" tabindex="-1" aria-hidden="true" type="button" title="access key '),
                        r.b(r.v(r.d("keyboard.ToolbarShow", e, t, 0))),
                        r.b('" aria-label="access key '),
                        r.b(r.v(r.d("keyboard.ToolbarShow", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.ToolbarShow", e, t, 0))),
                        r.b('"> </button>\r'),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b('    <button id="buttHideToolBar" style="opacity:0;visibility:hidden;border:0;outline:0;padding:0;margin:0;width:0;height=0;" tabindex="-1" aria-hidden="true" type="button" title="access key '),
                        r.b(r.v(r.d("keyboard.ToolbarHide", e, t, 0))),
                        r.b('" aria-label="access key '),
                        r.b(r.v(r.d("keyboard.ToolbarHide", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.ToolbarHide", e, t, 0))),
                        r.b('"> </button>\r'),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b('    <button id="buttNightTheme" style="opacity:0;visibility:hidden;border:0;outline:0;padding:0;margin:0;width:0;height=0;" tabindex="-1" aria-hidden="true" type="button" title="access key '),
                        r.b(r.v(r.d("keyboard.NightTheme", e, t, 0))),
                        r.b('" aria-label="access key '),
                        r.b(r.v(r.d("keyboard.NightTheme", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.NightTheme", e, t, 0))),
                        r.b('"> </button>\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('    <button id="buttRatePlus" style="opacity:0;visibility:hidden;border:0;outline:0;padding:0;margin:0;width:0;height=0;" tabindex="-1" aria-hidden="true" type="button" title="access key '),
                        r.b(r.v(r.d("keyboard.MediaOverlaysRateIncrease", e, t, 0))),
                        r.b('" aria-label="access key '),
                        r.b(r.v(r.d("keyboard.MediaOverlaysRateIncrease", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysRateIncrease", e, t, 0))),
                        r.b('"> </button>\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('    <button id="buttRateMinus" style="opacity:0;visibility:hidden;border:0;outline:0;padding:0;margin:0;width:0;height=0;" tabindex="-1" aria-hidden="true" type="button" title="access key '),
                        r.b(r.v(r.d("keyboard.MediaOverlaysRateDecrease", e, t, 0))),
                        r.b('" aria-label="access key '),
                        r.b(r.v(r.d("keyboard.MediaOverlaysRateDecrease", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysRateDecrease", e, t, 0))),
                        r.b('"> </button>\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('    <button id="buttVolumePlus" style="opacity:0;visibility:hidden;border:0;outline:0;padding:0;margin:0;width:0;height=0;" tabindex="-1" aria-hidden="true" type="button" title="access key '),
                        r.b(r.v(r.d("keyboard.MediaOverlaysVolumeIncrease", e, t, 0))),
                        r.b('" aria-label="access key '),
                        r.b(r.v(r.d("keyboard.MediaOverlaysVolumeIncrease", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysVolumeIncrease", e, t, 0))),
                        r.b('"> </button>\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('    <button id="buttVolumeMinus" style="opacity:0;visibility:hidden;border:0;outline:0;padding:0;margin:0;width:0;height=0;" tabindex="-1" aria-hidden="true" type="button" title="access key '),
                        r.b(r.v(r.d("keyboard.MediaOverlaysVolumeDecrease", e, t, 0))),
                        r.b('" aria-label="access key '),
                        r.b(r.v(r.d("keyboard.MediaOverlaysVolumeDecrease", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysVolumeDecrease", e, t, 0))),
                        r.b('"> </button>\r'),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b('<div class="btn-group navbar-right">\r'),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('    <div id="backgroundAudioTrack-div">\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('        <button style="display:none;" tabindex="1" id="backgroundAudioTrack-button-play" type="button" class="btn icon-play-audio-background"  title="'),
                        r.b(r.v(r.d("strings.i18n_audio_play_background", e, t, 0))),
                        r.b(" ["),
                        r.b(r.v(r.d("keyboard.BackgroundAudioPlayPause", e, t, 0))),
                        r.b(']"  aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_play_background", e, t, 0))),
                        r.b(" ["),
                        r.b(r.v(r.d("keyboard.BackgroundAudioPlayPause", e, t, 0))),
                        r.b(']" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.BackgroundAudioPlayPause", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('            <span class="glyphicon glyphicon-music" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="backgroundAudioTrack-button-pause" type="button" class="btn icon-pause-audio-background"  title="'),
                        r.b(r.v(r.d("strings.i18n_audio_pause_background", e, t, 0))),
                        r.b(" ["),
                        r.b(r.v(r.d("keyboard.BackgroundAudioPlayPause", e, t, 0))),
                        r.b(']"  aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_pause_background", e, t, 0))),
                        r.b(" ["),
                        r.b(r.v(r.d("keyboard.BackgroundAudioPlayPause", e, t, 0))),
                        r.b(']">\r'),
                        r.b("\n" + n),
                        r.b('            <span class="glyphicon glyphicon-volume-up" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b("        \r"),
                        r.b("\n" + n),
                        r.b("    </div>\r"),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b("    <!--Audioplayer Controls START-->\r"),
                        r.b("\n" + n),
                        r.b('    <div id="audioplayer">\r'),
                        r.b("\n" + n),
                        r.b("        \r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="btn-collapse-audio" type="button" class="btn icon-collapse-audio" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_collapse", e, t, 0))),
                        r.b(' " aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_collapse", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('            <span class="glyphicon glyphicon-open" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="btn-expand-audio" type="button" class="btn icon-expand-audio" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_expand", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_expand", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysAdvancedPanelShowHide", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('            <span class="glyphicon glyphicon-save" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b("        \r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="btn-previous-audio" type="button" class="btn icon-previous-audio" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_previous", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_previous", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysPrevious", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('            <span class="glyphicon glyphicon-backward" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b("        \r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="btn-play-audio" type="button" class="btn icon-play-audio"  title="'),
                        r.b(r.v(r.d("strings.i18n_audio_play", e, t, 0))),
                        r.b('"  aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_play", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysPlayPause", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('            <span class="glyphicon glyphicon-play" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="btn-pause-audio" type="button" class="btn icon-pause-audio"  title="'),
                        r.b(r.v(r.d("strings.i18n_audio_pause", e, t, 0))),
                        r.b('"  aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_pause", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('            <span class="glyphicon glyphicon-pause" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b("        \r"),
                        r.b("\n" + n),
                        r.b("        \r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="btn-next-audio" type="button" class="btn icon-next-audio" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_next", e, t, 0))),
                        r.b('" arial-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_next", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysNext", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('            <span class="glyphicon glyphicon-forward" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('        <div id="audioResponsive">\r'),
                        r.b("\n" + n),
                        r.b("        \r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="btn-audio-volume-mute" type="button" class="btn icon-audio-volume-mute" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_mute", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_mute", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysVolumeMuteToggle", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('            <span class="glyphicon glyphicon-volume-up" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="btn-audio-volume-unmute" type="button" class="btn icon-audio-volume-unmute" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_unmute", e, t, 0))),
                        r.b('" aria-label="{strings.i18n_audio_unmute}}">\r'),
                        r.b("\n" + n),
                        r.b('            <span class="glyphicon glyphicon-volume-off" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b("        \r"),
                        r.b("\n" + n),
                        r.b(
                            '        <input tabindex="1" id="volume-range-slider" type="range" role="slider" min="0" aria-value-min="0" aria-valuemin="0" max="100" aria-value-max="100" aria-valuemax="100" value="100" aria-valuenow="100" aria-value-now="100" aria-valuetext="100%" aria-value-text="100%" title="'
                        ),
                        r.b(r.v(r.d("strings.i18n_audio_volume", e, t, 0))),
                        r.b('" arial-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_volume", e, t, 0))),
                        r.b('" />\r'),
                        r.b("\n" + n),
                        r.b("        \r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="btn-touch-audio-enable" type="button" class="btn icon-touch-audio-enable" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_touch_enable", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_touch_enable", e, t, 0))),
                        r.b('" >\r'),
                        r.b("\n" + n),
                        r.b('            <span id="icon-touch-off-hand" class="glyphicon glyphicon-hand-up" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('            <span id="icon-touch-off" class="glyphicon glyphicon-remove" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('        <button tabindex="1" id="btn-touch-audio-disable" type="button" class="btn icon-touch-audio-disable" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_touch_disable", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_touch_disable", e, t, 0))),
                        r.b('" >\r'),
                        r.b("\n" + n),
                        r.b('            <span id="icon-touch-on-hand" class="glyphicon glyphicon-hand-up" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('            <span id="icon-touch-on" class="glyphicon glyphicon-ok" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("        </button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("        \r"),
                        r.b("\n" + n),
                        r.b("    </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('        <div id="audioExpanded" role="alert">\r'),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b(
                            '            <input tabindex="1" id="time-range-slider" type="range" role="slider" min="0" aria-value-min="0" aria-valuemin="0" max="100" aria-value-max="100" aria-valuemax="100" value="0" aria-valuenow="0" aria-value-now="0" aria-valuetext="0%" aria-value-text="0%" data-value="0" title="'
                        ),
                        r.b(r.v(r.d("strings.i18n_audio_time", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_time", e, t, 0))),
                        r.b('"  />\r'),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b('            <button tabindex="1" id="btn-audio-rate" type="button" class="btn icon-rate-audio" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_rate_reset", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_rate_reset", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysRateReset", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('                <span class="glyphicon glyphicon-play-circle" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("            </button>\r"),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b(
                            '            <input tabindex="1" id="rate-range-slider" type="range" role="slider" min="0" aria-value-min="0" aria-valuemin="0" max="4" aria-value-max="4" aria-valuemax="4" value="1" aria-valuenow="1" aria-value-now="1" aria-valuetext="1x" aria-value-text="1x" step="0.1" title="'
                        ),
                        r.b(r.v(r.d("strings.i18n_audio_rate", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_rate", e, t, 0))),
                        r.b('" />\r'),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b('            <span aria-hidden="true" tabindex="-1" id="rate-range-slider-label">1x</span>\r'),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b('            <form action="" id="mo-sync-form">\r'),
                        r.b("\n" + n),
                        r.b('                <input tabindex="1" type="radio" name="mo-sync" value="default" id="mo-sync-default" class="mo-sync" checked="checked"  title="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_default", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_default", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('"> </input>\r'),
                        r.b("\n" + n),
                        r.b('                <label tabindex="1" for="mo-sync-default" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_default", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('"><span aria-hidden="true">&#8855;</span></label>\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('                <input tabindex="1" type="radio" name="mo-sync" value="word" id="mo-sync-word" class="mo-sync" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_word", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_word", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('"> </input>\r'),
                        r.b("\n" + n),
                        r.b('                <label tabindex="1" for="mo-sync-word" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_word", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('"><span aria-hidden="true">'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_word", e, t, 0))),
                        r.b("</span></label>\r"),
                        r.b("\n" + n),
                        r.b("                \r"),
                        r.b("\n" + n),
                        r.b('                <input tabindex="1" type="radio" name="mo-sync" value="sentence" id="mo-sync-sentence" class="mo-sync" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_sentence", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_sentence", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('"> </input>\r'),
                        r.b("\n" + n),
                        r.b('                <label tabindex="1" for="mo-sync-sentence" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_sentence", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('"><span aria-hidden="true">'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_sentence", e, t, 0))),
                        r.b("</span></label>\r"),
                        r.b("\n" + n),
                        r.b("                \r"),
                        r.b("\n" + n),
                        r.b('                <input tabindex="1" type="radio" name="mo-sync" value="paragraph" id="mo-sync-paragraph" class="mo-sync" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_paragraph", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_paragraph", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('"> </input>\r'),
                        r.b("\n" + n),
                        r.b('                <label tabindex="1" for="mo-sync-paragraph" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_paragraph", e, t, 0))),
                        r.b(" "),
                        r.b(r.v(r.d("strings.i18n_audio_sync", e, t, 0))),
                        r.b('"><span aria-hidden="true">'),
                        r.b(r.v(r.d("strings.i18n_audio_sync_paragraph", e, t, 0))),
                        r.b("</span></label>\r"),
                        r.b("\n" + n),
                        r.b("            </form>\r"),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b('            <div id="audio-block">\r'),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b('            <div id="mo-highlighters">\r'),
                        r.b("\n" + n),
                        r.b('                <button tabindex="1" id="mo-highlighter-0" type="button" class="btn btn-mo-highlighter" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(": "),
                        r.b(r.v(r.d("strings.i18n_audio_highlight_default", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(": "),
                        r.b(r.v(r.d("strings.i18n_audio_highlight_default", e, t, 0))),
                        r.b('" aria-selected="true" data-mohighlight="0" >\r'),
                        r.b("\n" + n),
                        r.b("                    "),
                        r.b(r.v(r.d("strings.i18n_audio_highlight_default", e, t, 0))),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                </button>\r"),
                        r.b("\n" + n),
                        r.b('                <button tabindex="1" id="mo-highlighter-1" type="button" class="btn btn-mo-highlighter" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #1" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #1" data-mohighlight="1" >\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                </button>\r"),
                        r.b("\n" + n),
                        r.b('                <button tabindex="1" id="mo-highlighter-2" type="button" class="btn btn-mo-highlighter" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #2" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #2" data-mohighlight="2" >\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                </button>\r"),
                        r.b("\n" + n),
                        r.b('                <button tabindex="1" id="mo-highlighter-3" type="button" class="btn btn-mo-highlighter" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #3" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #3" data-mohighlight="3" >\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                </button>\r"),
                        r.b("\n" + n),
                        r.b('                <button tabindex="1" id="mo-highlighter-4" type="button" class="btn btn-mo-highlighter" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #4" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #4" data-mohighlight="4" >\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                </button>\r"),
                        r.b("\n" + n),
                        r.b('                <button tabindex="1" id="mo-highlighter-5" type="button" class="btn btn-mo-highlighter" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #5" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #5" data-mohighlight="5" >\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                </button>\r"),
                        r.b("\n" + n),
                        r.b('                <button tabindex="1" id="mo-highlighter-6" type="button" class="btn btn-mo-highlighter" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #6" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_highlight", e, t, 0))),
                        r.b(': #6" data-mohighlight="6" >\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("                </button>\r"),
                        r.b("\n" + n),
                        r.b("            </div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('            <button tabindex="1" id="btn-playback-scroll-enable" type="button" class="btn icon-playback-scroll-enable" title="'),
                        r.b(r.v(r.d("strings.i18n_playback_scroll_enable", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_playback_scroll_enable", e, t, 0))),
                        r.b('" >\r'),
                        r.b("\n" + n),
                        r.b('                <span id="icon-playback-scroll-off" class="glyphicon glyphicon-sort-by-attributes" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("            </button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('            <button tabindex="1" id="btn-playback-scroll-disable" type="button" class="btn icon-playback-scroll-disable" title="'),
                        r.b(r.v(r.d("strings.i18n_playback_scroll_disable", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_playback_scroll_disable", e, t, 0))),
                        r.b('" >\r'),
                        r.b("\n" + n),
                        r.b('                <span id="icon-playback-scroll-on" class="glyphicon glyphicon-sort" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("            </button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('            <button tabindex="1" id="btn-auto-page-turn-enable" type="button" class="btn icon-auto-page-turn-enable" title="'),
                        r.b(r.v(r.d("strings.i18n_auto_page_turn_enable", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_auto_page_turn_enable", e, t, 0))),
                        r.b('" >\r'),
                        r.b("\n" + n),
                        r.b('                <span id="icon-auto-page-turn-off" class="glyphicon glyphicon-sound-stereo" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("            </button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('            <button tabindex="1" id="btn-auto-page-turn-disable" type="button" class="btn icon-auto-page-turn-disable" title="'),
                        r.b(r.v(r.d("strings.i18n_auto_page_turn_disable", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_auto_page_turn_disable", e, t, 0))),
                        r.b('" >\r'),
                        r.b("\n" + n),
                        r.b('                <span id="icon-auto-page-turn-on" class="glyphicon glyphicon-sound-dolby" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("            </button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('            <button tabindex="1" id="btn-skip-audio-enable" type="button" class="btn icon-skip-audio-enable" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_skip_enable", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_skip_enable", e, t, 0))),
                        r.b('" >\r'),
                        r.b("\n" + n),
                        r.b('                <span id="icon-skip-off" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("            </button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('            <button tabindex="1" id="btn-skip-audio-disable" type="button" class="btn icon-skip-audio-disable" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_skip_disable", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_skip_disable", e, t, 0))),
                        r.b('" >\r'),
                        r.b("\n" + n),
                        r.b('                <span id="icon-skip-on" class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("            </button>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('            <button tabindex="1" id="btn-esc-audio" type="button" class="btn icon-esc-audio" title="'),
                        r.b(r.v(r.d("strings.i18n_audio_esc", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_audio_esc", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.MediaOverlaysEscape", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('                <span class="glyphicon glyphicon-eject" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("            </button>\r"),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b("            </div>\r"),
                        r.b("\n" + n),
                        r.b("            \r"),
                        r.b("\n" + n),
                        r.b('            <!-- div class="checkbox">\r'),
                        r.b("\n" + n),
                        r.b("              <label>\r"),
                        r.b("\n" + n),
                        r.b('                <input type="checkbox" value="false"> Skip\r'),
                        r.b("\n" + n),
                        r.b("              </label>\r"),
                        r.b("\n" + n),
                        r.b("            </div -->\r"),
                        r.b("\n" + n),
                        r.b("        </div>\r"),
                        r.b("\n" + n),
                        r.b("    </div> \r"),
                        r.b("\n" + n),
                        r.b("    <!--Audioplayer Controls END-->\r"),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b('    <div class="zoom-wrapper dropdown" style="display:none">\r'),
                        r.b("\n" + n),
                        r.b('        <a tabindex="1" href="#" data-toggle="dropdown"><input tabindex="1" type="text" value="100%" disabled/><span class="caret"></span></a>\r'),
                        r.b("\n" + n),
                        r.b('        <ul id="zoom-menu" class="dropdown-menu" role="menu">\r'),
                        r.b("\n" + n),
                        r.b('            <li id="zoom-custom"><a href="#" tabindex="1">'),
                        r.b(r.v(r.d("strings.i18n_zoom_custom", e, t, 0))),
                        r.b(' <span class="glyphicon glyphicon-ok"></span></a></li>\r'),
                        r.b("\n" + n),
                        r.b('            <li id="zoom-fit-width"><a href="#" tabindex="1">'),
                        r.b(r.v(r.d("strings.i18n_zoom_width", e, t, 0))),
                        r.b('<span class="glyphicon glyphicon-ok"></span></a></li>\r'),
                        r.b("\n" + n),
                        r.b('            <li id="zoom-fit-screen" class="active-zoom"><a href="#" tabindex="1">'),
                        r.b(r.v(r.d("strings.i18n_zoom_screen", e, t, 0))),
                        r.b('<span class="glyphicon glyphicon-ok"></span></a></li>\r'),
                        r.b("\n" + n),
                        r.b("        </ul>\r"),
                        r.b("\n" + n),
                        r.b("    </div>\r"),
                        r.b("\n" + n),
                        r.b('    <button tabindex="1" type="button" class="btn icon-library" title="'),
                        r.b(r.v(r.d("strings.view_library", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.view_library", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.SwitchToLibrary", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('        <span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("    </button>\r"),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b('    <button tabindex="1" type="button" class="btn icon-annotations" title="'),
                        r.b(r.v(r.d("strings.highlight_selection", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.highlight_selection", e, t, 0))),
                        r.b('" style="display:none">\r'),
                        r.b("\n" + n),
                        r.b('        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("    </button>\r"),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b("    <!--\r"),
                        r.b("\n" + n),
                        r.b('    <button tabindex="1" type="button" class="btn icon-shareUrl" title="'),
                        r.b(r.v(r.d("strings.share_url", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.share_url", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('        <span class="glyphicon glyphicon-link" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("    </button>\r"),
                        r.b("\n" + n),
                        r.b("    -->\r"),
                        r.b("\n" + n),
                        r.b('    <button id="btExtras" class="btn" title="'),
                        r.b(r.v(r.d("strings.extra_contents", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.extra_contents", e, t, 0))),
                        r.b('" style="display: none"><span class="sm-icons sm-icons-abrir"></span></button>\r'),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b('    <button id="tocButt" tabindex="1" type="button" class="btn icon-toc" title="'),
                        r.b(r.v(r.d("strings.toc", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.toc", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.TocShowHideToggle", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('        <span class="glyphicon glyphicon-list" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("    </button>\r"),
                        r.b("\n" + n),
                        r.b('    <button id="settbutt1" tabindex="1" type="button" class="btn icon-settings" data-toggle="modal" data-target="#settings-dialog" title="'),
                        r.b(r.v(r.d("strings.settings", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.settings", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.ShowSettingsModal", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('        <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("    </button>\r"),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b('    <button tabindex="1" id="buttFullScreenToggle" type="button" class="btn icon-full-screen" title="'),
                        r.b(r.v(r.d("strings.enter_fullscreen", e, t, 0))),
                        r.b('" aria-label="'),
                        r.b(r.v(r.d("strings.enter_fullscreen", e, t, 0))),
                        r.b('" accesskey="'),
                        r.b(r.v(r.d("keyboard.accesskeys.FullScreenToggle", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b('        <span class="glyphicon glyphicon-resize-full" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("    </button>\r"),
                        r.b("\n" + n),
                        r.b("    \r"),
                        r.b("\n" + n),
                        r.b('    <!-- <button type="button" class="btn btn-default icon icon-bookmark"></button>-->\r'),
                        r.b("\n" + n),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n"),
                        r.fl()
                    );
                },
                partials: {},
                subs: {},
            },
            "",
            e
        );
        return (t.template = n), t;
    }),
    define("hgn!readium_js_viewer_html_templates/reader-body.html", ["hogan"], function (e) {
        function t() {
            return n.render.apply(n, arguments);
        }
        var n = new e.Template(
            {
                code: function (e, t, n) {
                    var r = this;
                    return (
                        r.b((n = n || "")),
                        r.b('<div id="readium-toc-body"\r'),
                        r.b("\n" + n),
                        r.b('aria-label="'),
                        r.b(r.v(r.d("strings.toc", e, t, 0))),
                        r.b('"\r'),
                        r.b("\n" + n),
                        r.b('role="navigation"\r'),
                        r.b("\n" + n),
                        r.b(">\r"),
                        r.b("\n" + n),
                        r.b("</div>\r"),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b('<div id="reading-area" role="main">  \r'),
                        r.b("\n" + n),
                        r.b('  <div id="epub-reader-container">\r'),
                        r.b("\n" + n),
                        r.b('    <div id="epub-reader-frame">\r'),
                        r.b("\n" + n),
                        r.b("    </div>\r"),
                        r.b("\n" + n),
                        r.b("  </div>\r"),
                        r.b("\n" + n),
                        r.b("  \r"),
                        r.b("\n" + n),
                        r.b('  <div id="readium-page-btns" role="region" aria-label="'),
                        r.b(r.v(r.d("strings.i18n_page_navigation", e, t, 0))),
                        r.b('">\r'),
                        r.b("\n" + n),
                        r.b("  <!-- page left/right buttons inserted here when EPUB is loaded (page progression direction) -->\r"),
                        r.b("\n" + n),
                        r.b("  </div>\r"),
                        r.b("\n" + n),
                        r.b("  \r"),
                        r.b("\n" + n),
                        r.b("</div>"),
                        r.fl()
                    );
                },
                partials: {},
                subs: {},
            },
            "",
            e
        );
        return (t.template = n), t;
    }),
    define("hgn!readium_js_viewer_html_templates/reader-body-page-btns.html", ["hogan"], function (e) {
        function t() {
            return n.render.apply(n, arguments);
        }
        var n = new e.Template(
            {
                code: function (e, t, n) {
                    var r = this;
                    return (
                        r.b((n = n || "")),
                        r.b("<!-- Left page -->\r"),
                        r.b("\n" + n),
                        r.b('<button tabindex="0" id="left-page-btn" class="page-switch-overlay-icon" type="button"\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.s(r.f("pageProgressionDirectionIsRTL", e, t, 1), e, t, 0, 144, 280, "{{ }}") &&
                            (r.rs(e, t, function (e, t, r) {
                                r.b('title="'),
                                    r.b(r.v(r.d("strings.i18n_page_next", e, t, 0))),
                                    r.b('"\r'),
                                    r.b("\n" + n),
                                    r.b("\r"),
                                    r.b("\n" + n),
                                    r.b('aria-label="'),
                                    r.b(r.v(r.d("strings.i18n_page_next", e, t, 0))),
                                    r.b('"\r'),
                                    r.b("\n" + n),
                                    r.b("\r"),
                                    r.b("\n" + n),
                                    r.b('accesskey="'),
                                    r.b(r.v(r.d("keyboard.accesskeys.PagePreviousAlt", e, t, 0))),
                                    r.b('"\r'),
                                    r.b("\n" + n);
                            }),
                            e.pop()),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.s(r.f("pageProgressionDirectionIsRTL", e, t, 1), e, t, 1, 0, 0, "") ||
                            (r.b('title="'),
                            r.b(r.v(r.d("strings.i18n_page_previous", e, t, 0))),
                            r.b('"\r'),
                            r.b("\n" + n),
                            r.b("\r"),
                            r.b("\n" + n),
                            r.b('aria-label="'),
                            r.b(r.v(r.d("strings.i18n_page_previous", e, t, 0))),
                            r.b('"\r'),
                            r.b("\n" + n),
                            r.b("\r"),
                            r.b("\n" + n),
                            r.b('accesskey="'),
                            r.b(r.v(r.d("keyboard.accesskeys.PagePreviousAlt", e, t, 0))),
                            r.b('"\r'),
                            r.b("\n" + n)),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b(">\r"),
                        r.b("\n" + n),
                        r.b('<!-- img aria-hidden="true" src="images/pagination1.svg" -->\r'),
                        r.b("\n" + n),
                        r.b('<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("</button>\r"),
                        r.b("\n" + n),
                        r.b("  \r"),
                        r.b("\n" + n),
                        r.b("<!-- Right page -->\r"),
                        r.b("\n" + n),
                        r.b('<button tabindex="0" id="right-page-btn" class="page-switch-overlay-icon" type="button"\r'),
                        r.b("\n" + n),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.s(r.f("pageProgressionDirectionIsRTL", e, t, 1), e, t, 0, 835, 975, "{{ }}") &&
                            (r.rs(e, t, function (e, t, r) {
                                r.b('title="'),
                                    r.b(r.v(r.d("strings.i18n_page_previous", e, t, 0))),
                                    r.b('"\r'),
                                    r.b("\n" + n),
                                    r.b("\r"),
                                    r.b("\n" + n),
                                    r.b('aria-label="'),
                                    r.b(r.v(r.d("strings.i18n_page_previous", e, t, 0))),
                                    r.b('"\r'),
                                    r.b("\n" + n),
                                    r.b("\r"),
                                    r.b("\n" + n),
                                    r.b('accesskey="'),
                                    r.b(r.v(r.d("keyboard.accesskeys.PageNextAlt", e, t, 0))),
                                    r.b('"\r'),
                                    r.b("\n" + n);
                            }),
                            e.pop()),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.s(r.f("pageProgressionDirectionIsRTL", e, t, 1), e, t, 1, 0, 0, "") ||
                            (r.b('title="'),
                            r.b(r.v(r.d("strings.i18n_page_next", e, t, 0))),
                            r.b('"\r'),
                            r.b("\n" + n),
                            r.b("\r"),
                            r.b("\n" + n),
                            r.b('aria-label="'),
                            r.b(r.v(r.d("strings.i18n_page_next", e, t, 0))),
                            r.b('"\r'),
                            r.b("\n" + n),
                            r.b("\r"),
                            r.b("\n" + n),
                            r.b('accesskey="'),
                            r.b(r.v(r.d("keyboard.accesskeys.PageNextAlt", e, t, 0))),
                            r.b('"\r'),
                            r.b("\n" + n)),
                        r.b("\r"),
                        r.b("\n" + n),
                        r.b(">\r"),
                        r.b("\n" + n),
                        r.b('<!-- img aria-hidden="true" src="images/pagination1.svg" -->\r'),
                        r.b("\n" + n),
                        r.b('<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>\r'),
                        r.b("\n" + n),
                        r.b("</button>\r"),
                        r.b("\n"),
                        r.fl()
                    );
                },
                partials: {},
                subs: {},
            },
            "",
            e
        );
        return (t.template = n), t;
    }),
    define("Analytics", [], function () {
        return { trackView: function () {}, sendEvent: function () {} };
    }),
    (function () {
        "use strict";
        var e = "undefined" != typeof module && module.exports,
            t = "undefined" != typeof Element && "ALLOW_KEYBOARD_INPUT" in Element,
            n = (function () {
                for (
                    var e,
                        t,
                        n = [
                            ["requestFullscreen", "exitFullscreen", "fullscreenElement", "fullscreenEnabled", "fullscreenchange", "fullscreenerror"],
                            ["webkitRequestFullscreen", "webkitExitFullscreen", "webkitFullscreenElement", "webkitFullscreenEnabled", "webkitfullscreenchange", "webkitfullscreenerror"],
                            ["webkitRequestFullScreen", "webkitCancelFullScreen", "webkitCurrentFullScreenElement", "webkitCancelFullScreen", "webkitfullscreenchange", "webkitfullscreenerror"],
                            ["mozRequestFullScreen", "mozCancelFullScreen", "mozFullScreenElement", "mozFullScreenEnabled", "mozfullscreenchange", "mozfullscreenerror"],
                            ["msRequestFullscreen", "msExitFullscreen", "msFullscreenElement", "msFullscreenEnabled", "MSFullscreenChange", "MSFullscreenError"],
                        ],
                        r = 0,
                        i = n.length,
                        o = {};
                    r < i;
                    r++
                )
                    if (((e = n[r]), e && e[1] in document)) {
                        for (r = 0, t = e.length; r < t; r++) o[n[0][r]] = e[r];
                        return o;
                    }
                return !1;
            })(),
            r = {
                request: function (e) {
                    var r = n.requestFullscreen;
                    (e = e || document.documentElement), /5\.1[\.\d]* Safari/.test(navigator.userAgent) ? e[r]() : e[r](t && Element.ALLOW_KEYBOARD_INPUT);
                },
                exit: function () {
                    document[n.exitFullscreen]();
                },
                toggle: function (e) {
                    this.isFullscreen ? this.exit() : this.request(e);
                },
                raw: n,
            };
        return n
            ? (Object.defineProperties(r, {
                  isFullscreen: {
                      get: function () {
                          return Boolean(document[n.fullscreenElement]);
                      },
                  },
                  element: {
                      enumerable: !0,
                      get: function () {
                          return document[n.fullscreenElement];
                      },
                  },
                  enabled: {
                      enumerable: !0,
                      get: function () {
                          return Boolean(document[n.fullscreenEnabled]);
                      },
                  },
              }),
              void (e ? (module.exports = r) : (window.screenfull = r)))
            : void (e ? (module.exports = !1) : (window.screenfull = !1));
    })(),
    define("screenfull", (function (e) {
        return function () {
            var t;
            return t || e.screenfull;
        };
    })(this)),
    define("readium_js_viewer/EpubReaderMediaOverlays", ["readium_shared_js/globals", "module", "jquery", "underscore", "bootstrap", "readium_js/Readium", "./Spinner", "Settings", "i18nStrings", "./Dialogs", "./Keyboard"], function (
        e,
        t,
        n,
        r,
        i,
        o,
        a,
        s,
        l,
        c,
        u
    ) {
        var d = function (t) {
            t.reader.on(ReadiumSDK.Events.PAGINATION_CHANGED, function (r) {
                if ((e.logEvent("PAGINATION_CHANGED", "ON", "EpubReaderMediaOverlays.js"), t.reader.isMediaOverlayAvailable() && n("#audioplayer").show(), r.spineItem)) {
                    var i = t.reader.package().media_overlay.getSmilBySpineItem(r.spineItem),
                        o = !1,
                        a = n("#mo-sync-word");
                    i && i.hasSync("word") ? ((o = !0), a.removeAttr("disabled")) : a.attr("disabled", "disabled");
                    var s = n("#mo-sync-sentence");
                    i && i.hasSync("sentence") ? ((o = !0), s.removeAttr("disabled")) : s.attr("disabled", "disabled");
                    var l = n("#mo-sync-paragraph");
                    i && i.hasSync("paragraph") ? ((o = !0), l.removeAttr("disabled")) : l.attr("disabled", "disabled");
                    var c = n("#mo-sync-default");
                    o ? c.removeAttr("disabled") : c.attr("disabled", "disabled");
                }
            });
            var i = n("#audioplayer");
            s.get("reader", function (e) {
                if (!e) {
                    e = {};
                    var n = t.reader.viewerSettings();
                    (e.mediaOverlaysSkipSkippables = n.mediaOverlaysSkipSkippables),
                        (e.mediaOverlaysAutomaticPageTurn = n.mediaOverlaysAutomaticPageTurn),
                        (e.mediaOverlaysEnableClick = n.mediaOverlaysEnableClick),
                        (e.mediaOverlaysPreservePlaybackWhenScroll = n.mediaOverlaysPreservePlaybackWhenScroll),
                        s.put("reader", e);
                }
                var r = { doNotUpdateView: !0 };
                e.mediaOverlaysSkipSkippables ? (i.addClass("skip"), (r.mediaOverlaysSkipSkippables = !0)) : (i.removeClass("skip"), (r.mediaOverlaysSkipSkippables = !1)),
                    e.mediaOverlaysPreservePlaybackWhenScroll ? (i.addClass("playScroll"), (r.mediaOverlaysPreservePlaybackWhenScroll = !0)) : (i.removeClass("playScroll"), (r.mediaOverlaysPreservePlaybackWhenScroll = !1)),
                    e.mediaOverlaysAutomaticPageTurn ? (i.addClass("autoPageTurn"), (r.mediaOverlaysAutomaticPageTurn = !0)) : (i.removeClass("autoPageTurn"), (r.mediaOverlaysAutomaticPageTurn = !1)),
                    e.mediaOverlaysEnableClick ? (i.removeClass("no-touch"), (r.mediaOverlaysEnableClick = !0)) : (i.addClass("no-touch"), (r.mediaOverlaysEnableClick = !1)),
                    t.reader.updateSettings(r);
            });
            var o = n("#mo-sync-default");
            o.on("click", function () {
                var e = t.reader.isPlayingMediaOverlay();
                e && t.reader.pauseMediaOverlay(), t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysSynchronizationGranularity: "" }), e && t.reader.playMediaOverlay();
            });
            var a = n("#mo-sync-word");
            a.on("click", function () {
                var e = t.reader.isPlayingMediaOverlay();
                e && t.reader.pauseMediaOverlay(), t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysSynchronizationGranularity: "word" }), e && t.reader.playMediaOverlay();
            });
            var l = n("#mo-sync-sentence");
            l.on("click", function () {
                var e = t.reader.isPlayingMediaOverlay();
                e && t.reader.pauseMediaOverlay(), t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysSynchronizationGranularity: "sentence" }), e && t.reader.playMediaOverlay();
            });
            var c = n("#mo-sync-paragraph");
            c.on("click", function () {
                var e = t.reader.isPlayingMediaOverlay();
                e && t.reader.pauseMediaOverlay(), t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysSynchronizationGranularity: "paragraph" }), e && t.reader.playMediaOverlay();
            });
            var d = n(".btn-mo-highlighter");
            d.on("click", function () {
                d.attr("aria-selected", "false"), n(this).attr("aria-selected", "true");
                var e = n(this).attr("data-mohighlight");
                t.reader.setStyles([{ selector: ".mo-active-default", declarations: void 0 }], !0),
                    "1" === e
                        ? t.reader.setStyles(
                              [
                                  {
                                      selector: ".mo-active-default",
                                      declarations: {
                                          "background-color": "yellow !important",
                                          color: "black !important",
                                          "border-color": "transparent !important",
                                          "border-radius": "0.4em !important",
                                          "box-shadow": "0px 0px 0.4em #333333 !important",
                                      },
                                  },
                              ],
                              !0
                          )
                        : "2" === e
                        ? t.reader.setStyles(
                              [{ selector: ".mo-active-default", declarations: { "background-color": "black !important", color: "white !important", "border-color": "transparent !important", "border-radius": "0.4em !important" } }],
                              !0
                          )
                        : "3" === e
                        ? t.reader.setStyles(
                              [{ selector: ".mo-active-default", declarations: { "background-color": "orange !important", color: "black !important", "border-color": "transparent !important", "border-radius": "0.4em !important" } }],
                              !0
                          )
                        : "4" === e
                        ? t.reader.setStyles(
                              [{ selector: ".mo-active-default", declarations: { "background-color": "blue !important", color: "white !important", "border-color": "transparent !important", "border-radius": "0.4em !important" } }],
                              !0
                          )
                        : "5" === e
                        ? t.reader.setStyles(
                              [{ selector: ".mo-active-default", declarations: { "background-color": "magenta !important", color: "black !important", "border-color": "transparent !important", "border-radius": "0.4em !important" } }],
                              !0
                          )
                        : "6" === e &&
                          t.reader.setStyles(
                              [{ selector: ".mo-active-default", declarations: { "background-color": "#00FF00 !important", color: "black !important", "border-color": "transparent !important", "border-radius": "0.4em !important" } }],
                              !0
                          );
            }),
                u.on(u.MediaOverlaysEscape, "reader", t.reader.escapeMediaOverlay);
            var f = n("#btn-esc-audio");
            f.on("click", t.reader.escapeMediaOverlay);
            var h = n("#btn-previous-audio"),
                p = n("#btn-next-audio");
            u.on(u.MediaOverlaysPlayPause, "reader", t.reader.toggleMediaOverlay);
            var g = n("#btn-play-audio"),
                m = n("#btn-pause-audio");
            g.on("click", function () {
                var e = document.activeElement === g[0];
                t.reader.playMediaOverlay(),
                    g.removeAttr("accesskey"),
                    m.attr("accesskey", u.MediaOverlaysPlayPause),
                    e &&
                        setTimeout(function () {
                            m[0].focus();
                        }, 50);
            }),
                m.on("click", function () {
                    var e = document.activeElement === m[0];
                    t.reader.pauseMediaOverlay(),
                        m.removeAttr("accesskey"),
                        g.attr("accesskey", u.MediaOverlaysPlayPause),
                        e &&
                            setTimeout(function () {
                                g[0].focus();
                            }, 50);
                });
            var v = n("#btn-expand-audio"),
                b = n("#btn-collapse-audio"),
                y = function (e) {
                    e
                        ? (i.addClass("expanded-audio"), v.removeAttr("accesskey"), b.attr("accesskey", u.MediaOverlaysAdvancedPanelShowHide))
                        : (i.removeClass("expanded-audio"), b.removeAttr("accesskey"), v.attr("accesskey", u.MediaOverlaysAdvancedPanelShowHide));
                };
            u.on(u.MediaOverlaysAdvancedPanelShowHide, "reader", function () {
                var e = void 0;
                i.hasClass("expanded-audio") ? (y(!1), (e = v[0])) : (y(!0), (e = b[0])),
                    n(document.body).removeClass("hide-ui"),
                    setTimeout(function () {
                        e.focus();
                    }, 50);
            }),
                v.on("click", function () {
                    var e = document.activeElement === v[0];
                    y(!0),
                        e &&
                            setTimeout(function () {
                                b[0].focus();
                            }, 50);
                }),
                b.on("click", function () {
                    var e = document.activeElement === b[0];
                    y(!1),
                        e &&
                            setTimeout(function () {
                                v[0].focus();
                            }, 50);
                });
            var _ = n("#time-range-slider"),
                w = r.debounce(function () {
                    inDebounce = !1;
                    var e = _.val(),
                        n = t.reader.package();
                    if (n && n.media_overlay) {
                        var r = { par: void 0 },
                            i = { smilData: void 0 },
                            o = { milliseconds: void 0 };
                        if ((n.media_overlay.percentToPosition(e, i, r, o), r.par && r.par.text && i.smilData)) {
                            var a = i.smilData.href,
                                s = o.milliseconds / 1e3;
                            t.reader.mediaOverlaysOpenContentUrl(r.par.text.src, a, s);
                        }
                    }
                }, 800),
                x = function (e, t, n) {
                    e.attr("aria-valuenow", t + ""), e.attr("aria-value-now", t + ""), e.attr("aria-valuetext", n + ""), e.attr("aria-value-text", n + "");
                };
            _.on("change", function () {
                var e = _.val();
                (e = Math.round(e)), _.attr("data-value", e), x(_, e, e + "%"), t.reader.isPlayingMediaOverlay() && t.reader.pauseMediaOverlay(), w();
            }),
                t.reader.on(ReadiumSDK.Events.MEDIA_OVERLAY_STATUS_CHANGED, function (n) {
                    e.logEvent("MEDIA_OVERLAY_STATUS_CHANGED", "ON", "EpubReaderMediaOverlays.js");
                    var r = 0,
                        o = !("isPlaying" in n) || n.isPlaying,
                        a = document.activeElement === g[0] || document.activeElement === m[0];
                    if (
                        (o ? (g.removeAttr("accesskey"), m.attr("accesskey", u.MediaOverlaysPlayPause)) : (m.removeAttr("accesskey"), g.attr("accesskey", u.MediaOverlaysPlayPause)),
                        i.toggleClass("isPlaying", o),
                        a &&
                            setTimeout(function () {
                                (o ? m[0] : g[0]).focus();
                            }, 50),
                        (r = -1),
                        "undefined" != typeof n.playPosition && "undefined" != typeof n.smilIndex && "undefined" != typeof n.parIndex)
                    ) {
                        var s = t.reader.package(),
                            l = 1e3 * n.playPosition;
                        (r = s.media_overlay.positionToPercent(n.smilIndex, n.parIndex, l)), r < 0 && (r = 0);
                    }
                    r >= 0 && (_.val(r), (r = Math.round(r)), _.attr("data-value", r), x(_, r, r + "%"));
                });
            var E = n("#btn-playback-scroll-disable"),
                C = n("#btn-playback-scroll-enable");
            E.on("click", function () {
                var e = document.activeElement === E[0];
                i.removeClass("playScroll"),
                    t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysPreservePlaybackWhenScroll: !1 }),
                    s.get("reader", function (e) {
                        e || (e = {}), (e.mediaOverlaysPreservePlaybackWhenScroll = !1), s.put("reader", e);
                    }),
                    e &&
                        setTimeout(function () {
                            C[0].focus();
                        }, 50);
            }),
                C.on("click", function () {
                    var e = document.activeElement === C[0];
                    i.addClass("playScroll"),
                        t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysPreservePlaybackWhenScroll: !0 }),
                        s.get("reader", function (e) {
                            e || (e = {}), (e.mediaOverlaysPreservePlaybackWhenScroll = !0), s.put("reader", e);
                        }),
                        e &&
                            setTimeout(function () {
                                E[0].focus();
                            }, 50);
                });
            var T = n("#btn-auto-page-turn-disable"),
                S = n("#btn-auto-page-turn-enable");
            T.on("click", function () {
                var e = document.activeElement === T[0];
                i.removeClass("autoPageTurn"),
                    t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysAutomaticPageTurn: !1 }),
                    s.get("reader", function (e) {
                        e || (e = {}), (e.mediaOverlaysAutomaticPageTurn = !1), s.put("reader", e);
                    }),
                    e &&
                        setTimeout(function () {
                            S[0].focus();
                        }, 50);
            }),
                S.on("click", function () {
                    var e = document.activeElement === S[0];
                    i.addClass("autoPageTurn"),
                        t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysAutomaticPageTurn: !0 }),
                        s.get("reader", function (e) {
                            e || (e = {}), (e.mediaOverlaysAutomaticPageTurn = !0), s.put("reader", e);
                        }),
                        e &&
                            setTimeout(function () {
                                T[0].focus();
                            }, 50);
                });
            var R = n("#btn-skip-audio-disable"),
                I = n("#btn-skip-audio-enable");
            R.on("click", function () {
                var e = document.activeElement === R[0];
                i.removeClass("skip"),
                    t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysSkipSkippables: !1 }),
                    s.get("reader", function (e) {
                        e || (e = {}), (e.mediaOverlaysSkipSkippables = !1), s.put("reader", e);
                    }),
                    e &&
                        setTimeout(function () {
                            I[0].focus();
                        }, 50);
            }),
                I.on("click", function () {
                    var e = document.activeElement === I[0];
                    i.addClass("skip"),
                        t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysSkipSkippables: !0 }),
                        s.get("reader", function (e) {
                            e || (e = {}), (e.mediaOverlaysSkipSkippables = !0), s.put("reader", e);
                        }),
                        e &&
                            setTimeout(function () {
                                R[0].focus();
                            }, 50);
                });
            var k = n("#btn-touch-audio-enable"),
                P = n("#btn-touch-audio-disable");
            k.on("click", function () {
                var e = document.activeElement === k[0];
                i.removeClass("no-touch"),
                    t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysEnableClick: !0 }),
                    s.get("reader", function (e) {
                        e || (e = {}), (e.mediaOverlaysEnableClick = !0), s.put("reader", e);
                    }),
                    e &&
                        setTimeout(function () {
                            P[0].focus();
                        }, 50);
            }),
                P.on("click", function () {
                    var e = document.activeElement === P[0];
                    i.addClass("no-touch"),
                        t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysEnableClick: !1 }),
                        s.get("reader", function (e) {
                            e || (e = {}), (e.mediaOverlaysEnableClick = !1), s.put("reader", e);
                        }),
                        e &&
                            setTimeout(function () {
                                k[0].focus();
                            }, 50);
                });
            var N = n("#rate-range-slider"),
                O = n("#rate-range-slider-label"),
                A = function (e) {
                    var n = parseFloat(N.attr("min")),
                        r = parseFloat(N.attr("max")),
                        i = parseFloat(N.attr("step")),
                        o = parseFloat(N.val());
                    (o += e ? -i : i), o > r && (o = r), o < n && (o = n);
                    var a = (0 === o ? "~0" : "" + o) + "x";
                    x(N, o, a), (O[0].textContent = a), t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysRate: o }), N.val("" + o);
                };
            n("#buttRatePlus").on("click", function () {
                A(!1);
            }),
                u.on(u.MediaOverlaysRateIncrease, "reader", function () {
                    A(!1);
                }),
                n("#buttRateMinus").on("click", function () {
                    A(!0);
                }),
                u.on(u.MediaOverlaysRateDecrease, "reader", function () {
                    A(!0);
                }),
                N.on("change", function () {
                    var e = n(this).val(),
                        r = ("0" === e ? "~0" : e) + "x";
                    x(n(this), e, r), (O[0].textContent = r), t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysRate: e });
                });
            var D = function () {
                N.val(1), x(N, "1", "1x"), (O[0].textContent = "1x"), t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysRate: 1 });
            };
            u.on(u.MediaOverlaysRateReset, "reader", D);
            var M = n("#btn-audio-rate");
            M.on("click", D);
            var F = n("#volume-range-slider"),
                L = function (e) {
                    var n = parseInt(F.val());
                    (n += e ? -20 : 20),
                        n < 0 && (n = 0),
                        n > 100 && (n = 100),
                        t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysVolume: n }),
                        F.val("" + n),
                        x(F, n, n + "%"),
                        0 === n ? i.addClass("no-volume") : i.removeClass("no-volume");
                };
            n("#buttVolumePlus").on("click", function () {
                L(!1);
            }),
                u.on(u.MediaOverlaysVolumeIncrease, "reader", function () {
                    L(!1);
                }),
                n("#buttVolumeMinus").on("click", function () {
                    L(!0);
                }),
                u.on(u.MediaOverlaysVolumeDecrease, "reader", function () {
                    L(!0);
                }),
                F.on("change", function () {
                    var e = n(this).val();
                    t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysVolume: e }), x(F, e, e + "%"), "0" === e ? i.addClass("no-volume") : i.removeClass("no-volume");
                }),
                ($volumeButtonMute = n("#btn-audio-volume-mute")),
                ($volumeButtonUnMute = n("#btn-audio-volume-unmute"));
            var U = "0",
                B = function () {
                    (U = F.val()),
                        t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysVolume: 0 }),
                        F.val(0),
                        x(F, 0, "0%"),
                        $volumeButtonMute.removeAttr("accesskey"),
                        $volumeButtonUnMute.attr("accesskey", u.MediaOverlaysVolumeMuteToggle),
                        i.addClass("no-volume");
                },
                j = function () {
                    var e = "0" === U ? "100" : U;
                    t.reader.updateSettings({ doNotUpdateView: !0, mediaOverlaysVolume: e }),
                        F.val(e),
                        x(F, e, e + "%"),
                        $volumeButtonUnMute.removeAttr("accesskey"),
                        $volumeButtonMute.attr("accesskey", u.MediaOverlaysVolumeMuteToggle),
                        i.removeClass("no-volume");
                };
            u.on(u.MediaOverlaysVolumeMuteToggle, "reader", function () {
                (i.hasClass("no-volume") ? j : B)();
            }),
                $volumeButtonMute.on("click", function () {
                    var e = document.activeElement === $volumeButtonMute[0];
                    B(),
                        e &&
                            setTimeout(function () {
                                $volumeButtonUnMute[0].focus();
                            }, 50);
                }),
                $volumeButtonUnMute.on("click", function () {
                    var e = document.activeElement === $volumeButtonUnMute[0];
                    j(),
                        e &&
                            setTimeout(function () {
                                $volumeButtonMute[0].focus();
                            }, 50);
                }),
                u.on(u.MediaOverlaysPrevious, "reader", t.reader.previousMediaOverlay),
                h.on("click", t.reader.previousMediaOverlay),
                u.on(u.MediaOverlaysNext, "reader", t.reader.nextMediaOverlay),
                p.on("click", t.reader.nextMediaOverlay);
        };
        return { init: d };
    }),
    define("readium_js_viewer/EpubReaderBackgroundAudioTrack", ["module", "jquery", "bootstrap", "readium_js/Readium", "./Spinner", "Settings", "i18nStrings", "./Dialogs", "./Keyboard"], function (e, t, n, r, i, o, a, s, l) {
        var c = function (e) {
            if (e.reader.backgroundAudioTrackManager) {
                var n = t("#backgroundAudioTrack-div"),
                    r = t("#backgroundAudioTrack-button-play"),
                    i = t("#backgroundAudioTrack-button-pause");
                e.reader.backgroundAudioTrackManager.setCallback_PlayPause(function (e) {
                    e ? (n.addClass("isPlaying"), r.removeAttr("accesskey"), i.attr("accesskey", l.BackgroundAudioPlayPause)) : (n.removeClass("isPlaying"), i.removeAttr("accesskey"), r.attr("accesskey", l.BackgroundAudioPlayPause));
                }),
                    e.reader.backgroundAudioTrackManager.setCallback_IsAvailable(function (e) {
                        e ? n.removeClass("none") : n.addClass("none");
                    }),
                    l.on(l.BackgroundAudioPlayPause, "reader", function () {
                        var t = !n.hasClass("isPlaying");
                        e.reader.backgroundAudioTrackManager.setPlayState(t), e.reader.backgroundAudioTrackManager.playPause(t);
                    }),
                    r.on("click", function () {
                        var t = document.activeElement === r[0];
                        e.reader.backgroundAudioTrackManager.setPlayState(!0),
                            e.reader.backgroundAudioTrackManager.playPause(!0),
                            t &&
                                setTimeout(function () {
                                    i[0].focus();
                                }, 50);
                    }),
                    i.on("click", function () {
                        var t = document.activeElement === i[0];
                        e.reader.backgroundAudioTrackManager.setPlayState(!1),
                            e.reader.backgroundAudioTrackManager.playPause(!1),
                            t &&
                                setTimeout(function () {
                                    r[0].focus();
                                }, 50);
                    });
            }
        };
        return { init: c };
    }),
    (function (e, t, n, r) {
        "use strict";
        function i(e, t, n) {
            return setTimeout(c(e, n), t);
        }
        function o(e, t, n) {
            return !!Array.isArray(e) && (a(e, n[t], n), !0);
        }
        function a(e, t, n) {
            var i;
            if (e)
                if (e.forEach) e.forEach(t, n);
                else if (e.length !== r) for (i = 0; i < e.length; ) t.call(n, e[i], i, e), i++;
                else for (i in e) e.hasOwnProperty(i) && t.call(n, e[i], i, e);
        }
        function s(t, n, r) {
            var i = "DEPRECATED METHOD: " + n + "\n" + r + " AT \n";
            return function () {
                var n = new Error("get-stack-trace"),
                    r =
                        n && n.stack
                            ? n.stack
                                  .replace(/^[^\(]+?[\n$]/gm, "")
                                  .replace(/^\s+at\s+/gm, "")
                                  .replace(/^Object.<anonymous>\s*\(/gm, "{anonymous}()@")
                            : "Unknown Stack Trace",
                    o = e.console && (e.console.warn || e.console.log);
                return o && o.call(e.console, i, r), t.apply(this, arguments);
            };
        }
        function l(e, t, n) {
            var r,
                i = t.prototype;
            (r = e.prototype = Object.create(i)), (r.constructor = e), (r._super = i), n && de(r, n);
        }
        function c(e, t) {
            return function () {
                return e.apply(t, arguments);
            };
        }
        function u(e, t) {
            return typeof e == pe ? e.apply(t ? t[0] || r : r, t) : e;
        }
        function d(e, t) {
            return e === r ? t : e;
        }
        function f(e, t, n) {
            a(m(t), function (t) {
                e.addEventListener(t, n, !1);
            });
        }
        function h(e, t, n) {
            a(m(t), function (t) {
                e.removeEventListener(t, n, !1);
            });
        }
        function p(e, t) {
            for (; e; ) {
                if (e == t) return !0;
                e = e.parentNode;
            }
            return !1;
        }
        function g(e, t) {
            return e.indexOf(t) > -1;
        }
        function m(e) {
            return e.trim().split(/\s+/g);
        }
        function v(e, t, n) {
            if (e.indexOf && !n) return e.indexOf(t);
            for (var r = 0; r < e.length; ) {
                if ((n && e[r][n] == t) || (!n && e[r] === t)) return r;
                r++;
            }
            return -1;
        }
        function b(e) {
            return Array.prototype.slice.call(e, 0);
        }
        function y(e, t, n) {
            for (var r = [], i = [], o = 0; o < e.length; ) {
                var a = t ? e[o][t] : e[o];
                v(i, a) < 0 && r.push(e[o]), (i[o] = a), o++;
            }
            return (
                n &&
                    (r = t
                        ? r.sort(function (e, n) {
                              return e[t] > n[t];
                          })
                        : r.sort()),
                r
            );
        }
        function _(e, t) {
            for (var n, i, o = t[0].toUpperCase() + t.slice(1), a = 0; a < fe.length; ) {
                if (((n = fe[a]), (i = n ? n + o : t), i in e)) return i;
                a++;
            }
            return r;
        }
        function w() {
            return _e++;
        }
        function x(t) {
            var n = t.ownerDocument || t;
            return n.defaultView || n.parentWindow || e;
        }
        function E(e, t) {
            var n = this;
            (this.manager = e),
                (this.callback = t),
                (this.element = e.element),
                (this.target = e.options.inputTarget),
                (this.domHandler = function (t) {
                    u(e.options.enable, [e]) && n.handler(t);
                }),
                this.init();
        }
        function C(e) {
            var t,
                n = e.options.inputClass;
            return new (t = n ? n : Ee ? U : Ce ? z : xe ? H : L)(e, T);
        }
        function T(e, t, n) {
            var r = n.pointers.length,
                i = n.changedPointers.length,
                o = t & Pe && r - i === 0,
                a = t & (Oe | Ae) && r - i === 0;
            (n.isFirst = !!o), (n.isFinal = !!a), o && (e.session = {}), (n.eventType = t), S(e, n), e.emit("hammer.input", n), e.recognize(n), (e.session.prevInput = n);
        }
        function S(e, t) {
            var n = e.session,
                r = t.pointers,
                i = r.length;
            n.firstInput || (n.firstInput = k(t)), i > 1 && !n.firstMultiple ? (n.firstMultiple = k(t)) : 1 === i && (n.firstMultiple = !1);
            var o = n.firstInput,
                a = n.firstMultiple,
                s = a ? a.center : o.center,
                l = (t.center = P(r));
            (t.timeStamp = ve()), (t.deltaTime = t.timeStamp - o.timeStamp), (t.angle = D(s, l)), (t.distance = A(s, l)), R(n, t), (t.offsetDirection = O(t.deltaX, t.deltaY));
            var c = N(t.deltaTime, t.deltaX, t.deltaY);
            (t.overallVelocityX = c.x),
                (t.overallVelocityY = c.y),
                (t.overallVelocity = me(c.x) > me(c.y) ? c.x : c.y),
                (t.scale = a ? F(a.pointers, r) : 1),
                (t.rotation = a ? M(a.pointers, r) : 0),
                (t.maxPointers = n.prevInput ? (t.pointers.length > n.prevInput.maxPointers ? t.pointers.length : n.prevInput.maxPointers) : t.pointers.length),
                I(n, t);
            var u = e.element;
            p(t.srcEvent.target, u) && (u = t.srcEvent.target), (t.target = u);
        }
        function R(e, t) {
            var n = t.center,
                r = e.offsetDelta || {},
                i = e.prevDelta || {},
                o = e.prevInput || {};
            (t.eventType !== Pe && o.eventType !== Oe) || ((i = e.prevDelta = { x: o.deltaX || 0, y: o.deltaY || 0 }), (r = e.offsetDelta = { x: n.x, y: n.y })), (t.deltaX = i.x + (n.x - r.x)), (t.deltaY = i.y + (n.y - r.y));
        }
        function I(e, t) {
            var n,
                i,
                o,
                a,
                s = e.lastInterval || t,
                l = t.timeStamp - s.timeStamp;
            if (t.eventType != Ae && (l > ke || s.velocity === r)) {
                var c = t.deltaX - s.deltaX,
                    u = t.deltaY - s.deltaY,
                    d = N(l, c, u);
                (i = d.x), (o = d.y), (n = me(d.x) > me(d.y) ? d.x : d.y), (a = O(c, u)), (e.lastInterval = t);
            } else (n = s.velocity), (i = s.velocityX), (o = s.velocityY), (a = s.direction);
            (t.velocity = n), (t.velocityX = i), (t.velocityY = o), (t.direction = a);
        }
        function k(e) {
            for (var t = [], n = 0; n < e.pointers.length; ) (t[n] = { clientX: ge(e.pointers[n].clientX), clientY: ge(e.pointers[n].clientY) }), n++;
            return { timeStamp: ve(), pointers: t, center: P(t), deltaX: e.deltaX, deltaY: e.deltaY };
        }
        function P(e) {
            var t = e.length;
            if (1 === t) return { x: ge(e[0].clientX), y: ge(e[0].clientY) };
            for (var n = 0, r = 0, i = 0; i < t; ) (n += e[i].clientX), (r += e[i].clientY), i++;
            return { x: ge(n / t), y: ge(r / t) };
        }
        function N(e, t, n) {
            return { x: t / e || 0, y: n / e || 0 };
        }
        function O(e, t) {
            return e === t ? De : me(e) >= me(t) ? (e < 0 ? Me : Fe) : t < 0 ? Le : Ue;
        }
        function A(e, t, n) {
            n || (n = Ve);
            var r = t[n[0]] - e[n[0]],
                i = t[n[1]] - e[n[1]];
            return Math.sqrt(r * r + i * i);
        }
        function D(e, t, n) {
            n || (n = Ve);
            var r = t[n[0]] - e[n[0]],
                i = t[n[1]] - e[n[1]];
            return (180 * Math.atan2(i, r)) / Math.PI;
        }
        function M(e, t) {
            return D(t[1], t[0], He) + D(e[1], e[0], He);
        }
        function F(e, t) {
            return A(t[0], t[1], He) / A(e[0], e[1], He);
        }
        function L() {
            (this.evEl = We), (this.evWin = qe), (this.pressed = !1), E.apply(this, arguments);
        }
        function U() {
            (this.evEl = Ke), (this.evWin = Xe), E.apply(this, arguments), (this.store = this.manager.session.pointerEvents = []);
        }
        function B() {
            (this.evTarget = Ye), (this.evWin = Ze), (this.started = !1), E.apply(this, arguments);
        }
        function j(e, t) {
            var n = b(e.touches),
                r = b(e.changedTouches);
            return t & (Oe | Ae) && (n = y(n.concat(r), "identifier", !0)), [n, r];
        }
        function z() {
            (this.evTarget = tt), (this.targetIds = {}), E.apply(this, arguments);
        }
        function V(e, t) {
            var n = b(e.touches),
                r = this.targetIds;
            if (t & (Pe | Ne) && 1 === n.length) return (r[n[0].identifier] = !0), [n, n];
            var i,
                o,
                a = b(e.changedTouches),
                s = [],
                l = this.target;
            if (
                ((o = n.filter(function (e) {
                    return p(e.target, l);
                })),
                t === Pe)
            )
                for (i = 0; i < o.length; ) (r[o[i].identifier] = !0), i++;
            for (i = 0; i < a.length; ) r[a[i].identifier] && s.push(a[i]), t & (Oe | Ae) && delete r[a[i].identifier], i++;
            return s.length ? [y(o.concat(s), "identifier", !0), s] : void 0;
        }
        function H() {
            E.apply(this, arguments);
            var e = c(this.handler, this);
            (this.touch = new z(this.manager, e)), (this.mouse = new L(this.manager, e)), (this.primaryTouch = null), (this.lastTouches = []);
        }
        function $(e, t) {
            e & Pe ? ((this.primaryTouch = t.changedPointers[0].identifier), W.call(this, t)) : e & (Oe | Ae) && W.call(this, t);
        }
        function W(e) {
            var t = e.changedPointers[0];
            if (t.identifier === this.primaryTouch) {
                var n = { x: t.clientX, y: t.clientY };
                this.lastTouches.push(n);
                var r = this.lastTouches,
                    i = function () {
                        var e = r.indexOf(n);
                        e > -1 && r.splice(e, 1);
                    };
                setTimeout(i, nt);
            }
        }
        function q(e) {
            for (var t = e.srcEvent.clientX, n = e.srcEvent.clientY, r = 0; r < this.lastTouches.length; r++) {
                var i = this.lastTouches[r],
                    o = Math.abs(t - i.x),
                    a = Math.abs(n - i.y);
                if (o <= rt && a <= rt) return !0;
            }
            return !1;
        }
        function G(e, t) {
            (this.manager = e), this.set(t);
        }
        function J(e) {
            if (g(e, ct)) return ct;
            var t = g(e, ut),
                n = g(e, dt);
            return t && n ? ct : t || n ? (t ? ut : dt) : g(e, lt) ? lt : st;
        }
        function K() {
            if (!ot) return !1;
            var t = {},
                n = e.CSS && e.CSS.supports;
            return (
                ["auto", "manipulation", "pan-y", "pan-x", "pan-x pan-y", "none"].forEach(function (r) {
                    t[r] = !n || e.CSS.supports("touch-action", r);
                }),
                t
            );
        }
        function X(e) {
            (this.options = de({}, this.defaults, e || {})), (this.id = w()), (this.manager = null), (this.options.enable = d(this.options.enable, !0)), (this.state = ht), (this.simultaneous = {}), (this.requireFail = []);
        }
        function Q(e) {
            return e & bt ? "cancel" : e & mt ? "end" : e & gt ? "move" : e & pt ? "start" : "";
        }
        function Y(e) {
            return e == Ue ? "down" : e == Le ? "up" : e == Me ? "left" : e == Fe ? "right" : "";
        }
        function Z(e, t) {
            var n = t.manager;
            return n ? n.get(e) : e;
        }
        function ee() {
            X.apply(this, arguments);
        }
        function te() {
            ee.apply(this, arguments), (this.pX = null), (this.pY = null);
        }
        function ne() {
            ee.apply(this, arguments);
        }
        function re() {
            X.apply(this, arguments), (this._timer = null), (this._input = null);
        }
        function ie() {
            ee.apply(this, arguments);
        }
        function oe() {
            ee.apply(this, arguments);
        }
        function ae() {
            X.apply(this, arguments), (this.pTime = !1), (this.pCenter = !1), (this._timer = null), (this._input = null), (this.count = 0);
        }
        function se(e, t) {
            return (t = t || {}), (t.recognizers = d(t.recognizers, se.defaults.preset)), new le(e, t);
        }
        function le(e, t) {
            (this.options = de({}, se.defaults, t || {})),
                (this.options.inputTarget = this.options.inputTarget || e),
                (this.handlers = {}),
                (this.session = {}),
                (this.recognizers = []),
                (this.oldCssProps = {}),
                (this.element = e),
                (this.input = C(this)),
                (this.touchAction = new G(this, this.options.touchAction)),
                ce(this, !0),
                a(
                    this.options.recognizers,
                    function (e) {
                        var t = this.add(new e[0](e[1]));
                        e[2] && t.recognizeWith(e[2]), e[3] && t.requireFailure(e[3]);
                    },
                    this
                );
        }
        function ce(e, t) {
            var n = e.element;
            if (n.style) {
                var r;
                a(e.options.cssProps, function (i, o) {
                    (r = _(n.style, o)), t ? ((e.oldCssProps[r] = n.style[r]), (n.style[r] = i)) : (n.style[r] = e.oldCssProps[r] || "");
                }),
                    t || (e.oldCssProps = {});
            }
        }
        function ue(e, n) {
            var r = t.createEvent("Event");
            r.initEvent(e, !0, !0), (r.gesture = n), n.target.dispatchEvent(r);
        }
        var de,
            fe = ["", "webkit", "Moz", "MS", "ms", "o"],
            he = t.createElement("div"),
            pe = "function",
            ge = Math.round,
            me = Math.abs,
            ve = Date.now;
        de =
            "function" != typeof Object.assign
                ? function (e) {
                      if (e === r || null === e) throw new TypeError("Cannot convert undefined or null to object");
                      for (var t = Object(e), n = 1; n < arguments.length; n++) {
                          var i = arguments[n];
                          if (i !== r && null !== i) for (var o in i) i.hasOwnProperty(o) && (t[o] = i[o]);
                      }
                      return t;
                  }
                : Object.assign;
        var be = s(
                function (e, t, n) {
                    for (var i = Object.keys(t), o = 0; o < i.length; ) (!n || (n && e[i[o]] === r)) && (e[i[o]] = t[i[o]]), o++;
                    return e;
                },
                "extend",
                "Use `assign`."
            ),
            ye = s(
                function (e, t) {
                    return be(e, t, !0);
                },
                "merge",
                "Use `assign`."
            ),
            _e = 1,
            we = /mobile|tablet|ip(ad|hone|od)|android/i,
            xe = "ontouchstart" in e,
            Ee = _(e, "PointerEvent") !== r,
            Ce = xe && we.test(navigator.userAgent),
            Te = "touch",
            Se = "pen",
            Re = "mouse",
            Ie = "kinect",
            ke = 25,
            Pe = 1,
            Ne = 2,
            Oe = 4,
            Ae = 8,
            De = 1,
            Me = 2,
            Fe = 4,
            Le = 8,
            Ue = 16,
            Be = Me | Fe,
            je = Le | Ue,
            ze = Be | je,
            Ve = ["x", "y"],
            He = ["clientX", "clientY"];
        E.prototype = {
            handler: function () {},
            init: function () {
                this.evEl && f(this.element, this.evEl, this.domHandler), this.evTarget && f(this.target, this.evTarget, this.domHandler), this.evWin && f(x(this.element), this.evWin, this.domHandler);
            },
            destroy: function () {
                this.evEl && h(this.element, this.evEl, this.domHandler), this.evTarget && h(this.target, this.evTarget, this.domHandler), this.evWin && h(x(this.element), this.evWin, this.domHandler);
            },
        };
        var $e = { mousedown: Pe, mousemove: Ne, mouseup: Oe },
            We = "mousedown",
            qe = "mousemove mouseup";
        l(L, E, {
            handler: function (e) {
                var t = $e[e.type];
                t & Pe && 0 === e.button && (this.pressed = !0),
                    t & Ne && 1 !== e.which && (t = Oe),
                    this.pressed && (t & Oe && (this.pressed = !1), this.callback(this.manager, t, { pointers: [e], changedPointers: [e], pointerType: Re, srcEvent: e }));
            },
        });
        var Ge = { pointerdown: Pe, pointermove: Ne, pointerup: Oe, pointercancel: Ae, pointerout: Ae },
            Je = { 2: Te, 3: Se, 4: Re, 5: Ie },
            Ke = "pointerdown",
            Xe = "pointermove pointerup pointercancel";
        e.MSPointerEvent && !e.PointerEvent && ((Ke = "MSPointerDown"), (Xe = "MSPointerMove MSPointerUp MSPointerCancel")),
            l(U, E, {
                handler: function (e) {
                    var t = this.store,
                        n = !1,
                        r = e.type.toLowerCase().replace("ms", ""),
                        i = Ge[r],
                        o = Je[e.pointerType] || e.pointerType,
                        a = o == Te,
                        s = v(t, e.pointerId, "pointerId");
                    i & Pe && (0 === e.button || a) ? s < 0 && (t.push(e), (s = t.length - 1)) : i & (Oe | Ae) && (n = !0),
                        s < 0 || ((t[s] = e), this.callback(this.manager, i, { pointers: t, changedPointers: [e], pointerType: o, srcEvent: e }), n && t.splice(s, 1));
                },
            });
        var Qe = { touchstart: Pe, touchmove: Ne, touchend: Oe, touchcancel: Ae },
            Ye = "touchstart",
            Ze = "touchstart touchmove touchend touchcancel";
        l(B, E, {
            handler: function (e) {
                var t = Qe[e.type];
                if ((t === Pe && (this.started = !0), this.started)) {
                    var n = j.call(this, e, t);
                    t & (Oe | Ae) && n[0].length - n[1].length === 0 && (this.started = !1), this.callback(this.manager, t, { pointers: n[0], changedPointers: n[1], pointerType: Te, srcEvent: e });
                }
            },
        });
        var et = { touchstart: Pe, touchmove: Ne, touchend: Oe, touchcancel: Ae },
            tt = "touchstart touchmove touchend touchcancel";
        l(z, E, {
            handler: function (e) {
                var t = et[e.type],
                    n = V.call(this, e, t);
                n && this.callback(this.manager, t, { pointers: n[0], changedPointers: n[1], pointerType: Te, srcEvent: e });
            },
        });
        var nt = 2500,
            rt = 25;
        l(H, E, {
            handler: function (e, t, n) {
                var r = n.pointerType == Te,
                    i = n.pointerType == Re;
                if (!(i && n.sourceCapabilities && n.sourceCapabilities.firesTouchEvents)) {
                    if (r) $.call(this, t, n);
                    else if (i && q.call(this, n)) return;
                    this.callback(e, t, n);
                }
            },
            destroy: function () {
                this.touch.destroy(), this.mouse.destroy();
            },
        });
        var it = _(he.style, "touchAction"),
            ot = it !== r,
            at = "compute",
            st = "auto",
            lt = "manipulation",
            ct = "none",
            ut = "pan-x",
            dt = "pan-y",
            ft = K();
        G.prototype = {
            set: function (e) {
                e == at && (e = this.compute()), ot && this.manager.element.style && ft[e] && (this.manager.element.style[it] = e), (this.actions = e.toLowerCase().trim());
            },
            update: function () {
                this.set(this.manager.options.touchAction);
            },
            compute: function () {
                var e = [];
                return (
                    a(this.manager.recognizers, function (t) {
                        u(t.options.enable, [t]) && (e = e.concat(t.getTouchAction()));
                    }),
                    J(e.join(" "))
                );
            },
            preventDefaults: function (e) {
                var t = e.srcEvent,
                    n = e.offsetDirection;
                if (this.manager.session.prevented) return void t.preventDefault();
                var r = this.actions,
                    i = g(r, ct) && !ft[ct],
                    o = g(r, dt) && !ft[dt],
                    a = g(r, ut) && !ft[ut];
                if (i) {
                    var s = 1 === e.pointers.length,
                        l = e.distance < 2,
                        c = e.deltaTime < 250;
                    if (s && l && c) return;
                }
                return a && o ? void 0 : i || (o && n & Be) || (a && n & je) ? this.preventSrc(t) : void 0;
            },
            preventSrc: function (e) {
                (this.manager.session.prevented = !0), e.preventDefault();
            },
        };
        var ht = 1,
            pt = 2,
            gt = 4,
            mt = 8,
            vt = mt,
            bt = 16,
            yt = 32;
        (X.prototype = {
            defaults: {},
            set: function (e) {
                return de(this.options, e), this.manager && this.manager.touchAction.update(), this;
            },
            recognizeWith: function (e) {
                if (o(e, "recognizeWith", this)) return this;
                var t = this.simultaneous;
                return (e = Z(e, this)), t[e.id] || ((t[e.id] = e), e.recognizeWith(this)), this;
            },
            dropRecognizeWith: function (e) {
                return o(e, "dropRecognizeWith", this) ? this : ((e = Z(e, this)), delete this.simultaneous[e.id], this);
            },
            requireFailure: function (e) {
                if (o(e, "requireFailure", this)) return this;
                var t = this.requireFail;
                return (e = Z(e, this)), v(t, e) === -1 && (t.push(e), e.requireFailure(this)), this;
            },
            dropRequireFailure: function (e) {
                if (o(e, "dropRequireFailure", this)) return this;
                e = Z(e, this);
                var t = v(this.requireFail, e);
                return t > -1 && this.requireFail.splice(t, 1), this;
            },
            hasRequireFailures: function () {
                return this.requireFail.length > 0;
            },
            canRecognizeWith: function (e) {
                return !!this.simultaneous[e.id];
            },
            emit: function (e) {
                function t(t) {
                    n.manager.emit(t, e);
                }
                var n = this,
                    r = this.state;
                r < mt && t(n.options.event + Q(r)), t(n.options.event), e.additionalEvent && t(e.additionalEvent), r >= mt && t(n.options.event + Q(r));
            },
            tryEmit: function (e) {
                return this.canEmit() ? this.emit(e) : void (this.state = yt);
            },
            canEmit: function () {
                for (var e = 0; e < this.requireFail.length; ) {
                    if (!(this.requireFail[e].state & (yt | ht))) return !1;
                    e++;
                }
                return !0;
            },
            recognize: function (e) {
                var t = de({}, e);
                return u(this.options.enable, [this, t])
                    ? (this.state & (vt | bt | yt) && (this.state = ht), (this.state = this.process(t)), void (this.state & (pt | gt | mt | bt) && this.tryEmit(t)))
                    : (this.reset(), void (this.state = yt));
            },
            process: function (e) {},
            getTouchAction: function () {},
            reset: function () {},
        }),
            l(ee, X, {
                defaults: { pointers: 1 },
                attrTest: function (e) {
                    var t = this.options.pointers;
                    return 0 === t || e.pointers.length === t;
                },
                process: function (e) {
                    var t = this.state,
                        n = e.eventType,
                        r = t & (pt | gt),
                        i = this.attrTest(e);
                    return r && (n & Ae || !i) ? t | bt : r || i ? (n & Oe ? t | mt : t & pt ? t | gt : pt) : yt;
                },
            }),
            l(te, ee, {
                defaults: { event: "pan", threshold: 10, pointers: 1, direction: ze },
                getTouchAction: function () {
                    var e = this.options.direction,
                        t = [];
                    return e & Be && t.push(dt), e & je && t.push(ut), t;
                },
                directionTest: function (e) {
                    var t = this.options,
                        n = !0,
                        r = e.distance,
                        i = e.direction,
                        o = e.deltaX,
                        a = e.deltaY;
                    return (
                        i & t.direction || (t.direction & Be ? ((i = 0 === o ? De : o < 0 ? Me : Fe), (n = o != this.pX), (r = Math.abs(e.deltaX))) : ((i = 0 === a ? De : a < 0 ? Le : Ue), (n = a != this.pY), (r = Math.abs(e.deltaY)))),
                        (e.direction = i),
                        n && r > t.threshold && i & t.direction
                    );
                },
                attrTest: function (e) {
                    return ee.prototype.attrTest.call(this, e) && (this.state & pt || (!(this.state & pt) && this.directionTest(e)));
                },
                emit: function (e) {
                    (this.pX = e.deltaX), (this.pY = e.deltaY);
                    var t = Y(e.direction);
                    t && (e.additionalEvent = this.options.event + t), this._super.emit.call(this, e);
                },
            }),
            l(ne, ee, {
                defaults: { event: "pinch", threshold: 0, pointers: 2 },
                getTouchAction: function () {
                    return [ct];
                },
                attrTest: function (e) {
                    return this._super.attrTest.call(this, e) && (Math.abs(e.scale - 1) > this.options.threshold || this.state & pt);
                },
                emit: function (e) {
                    if (1 !== e.scale) {
                        var t = e.scale < 1 ? "in" : "out";
                        e.additionalEvent = this.options.event + t;
                    }
                    this._super.emit.call(this, e);
                },
            }),
            l(re, X, {
                defaults: { event: "press", pointers: 1, time: 251, threshold: 9 },
                getTouchAction: function () {
                    return [st];
                },
                process: function (e) {
                    var t = this.options,
                        n = e.pointers.length === t.pointers,
                        r = e.distance < t.threshold,
                        o = e.deltaTime > t.time;
                    if (((this._input = e), !r || !n || (e.eventType & (Oe | Ae) && !o))) this.reset();
                    else if (e.eventType & Pe)
                        this.reset(),
                            (this._timer = i(
                                function () {
                                    (this.state = vt), this.tryEmit();
                                },
                                t.time,
                                this
                            ));
                    else if (e.eventType & Oe) return vt;
                    return yt;
                },
                reset: function () {
                    clearTimeout(this._timer);
                },
                emit: function (e) {
                    this.state === vt && (e && e.eventType & Oe ? this.manager.emit(this.options.event + "up", e) : ((this._input.timeStamp = ve()), this.manager.emit(this.options.event, this._input)));
                },
            }),
            l(ie, ee, {
                defaults: { event: "rotate", threshold: 0, pointers: 2 },
                getTouchAction: function () {
                    return [ct];
                },
                attrTest: function (e) {
                    return this._super.attrTest.call(this, e) && (Math.abs(e.rotation) > this.options.threshold || this.state & pt);
                },
            }),
            l(oe, ee, {
                defaults: { event: "swipe", threshold: 10, velocity: 0.3, direction: Be | je, pointers: 1 },
                getTouchAction: function () {
                    return te.prototype.getTouchAction.call(this);
                },
                attrTest: function (e) {
                    var t,
                        n = this.options.direction;
                    return (
                        n & (Be | je) ? (t = e.overallVelocity) : n & Be ? (t = e.overallVelocityX) : n & je && (t = e.overallVelocityY),
                        this._super.attrTest.call(this, e) && n & e.offsetDirection && e.distance > this.options.threshold && e.maxPointers == this.options.pointers && me(t) > this.options.velocity && e.eventType & Oe
                    );
                },
                emit: function (e) {
                    var t = Y(e.offsetDirection);
                    t && this.manager.emit(this.options.event + t, e), this.manager.emit(this.options.event, e);
                },
            }),
            l(ae, X, {
                defaults: { event: "tap", pointers: 1, taps: 1, interval: 300, time: 250, threshold: 9, posThreshold: 10 },
                getTouchAction: function () {
                    return [lt];
                },
                process: function (e) {
                    var t = this.options,
                        n = e.pointers.length === t.pointers,
                        r = e.distance < t.threshold,
                        o = e.deltaTime < t.time;
                    if ((this.reset(), e.eventType & Pe && 0 === this.count)) return this.failTimeout();
                    if (r && o && n) {
                        if (e.eventType != Oe) return this.failTimeout();
                        var a = !this.pTime || e.timeStamp - this.pTime < t.interval,
                            s = !this.pCenter || A(this.pCenter, e.center) < t.posThreshold;
                        (this.pTime = e.timeStamp), (this.pCenter = e.center), s && a ? (this.count += 1) : (this.count = 1), (this._input = e);
                        var l = this.count % t.taps;
                        if (0 === l)
                            return this.hasRequireFailures()
                                ? ((this._timer = i(
                                      function () {
                                          (this.state = vt), this.tryEmit();
                                      },
                                      t.interval,
                                      this
                                  )),
                                  pt)
                                : vt;
                    }
                    return yt;
                },
                failTimeout: function () {
                    return (
                        (this._timer = i(
                            function () {
                                this.state = yt;
                            },
                            this.options.interval,
                            this
                        )),
                        yt
                    );
                },
                reset: function () {
                    clearTimeout(this._timer);
                },
                emit: function () {
                    this.state == vt && ((this._input.tapCount = this.count), this.manager.emit(this.options.event, this._input));
                },
            }),
            (se.VERSION = "2.0.7"),
            (se.defaults = {
                domEvents: !1,
                touchAction: at,
                enable: !0,
                inputTarget: null,
                inputClass: null,
                preset: [[ie, { enable: !1 }], [ne, { enable: !1 }, ["rotate"]], [oe, { direction: Be }], [te, { direction: Be }, ["swipe"]], [ae], [ae, { event: "doubletap", taps: 2 }, ["tap"]], [re]],
                cssProps: { userSelect: "none", touchSelect: "none", touchCallout: "none", contentZooming: "none", userDrag: "none", tapHighlightColor: "rgba(0,0,0,0)" },
            });
        var _t = 1,
            wt = 2;
        (le.prototype = {
            set: function (e) {
                return de(this.options, e), e.touchAction && this.touchAction.update(), e.inputTarget && (this.input.destroy(), (this.input.target = e.inputTarget), this.input.init()), this;
            },
            stop: function (e) {
                this.session.stopped = e ? wt : _t;
            },
            recognize: function (e) {
                var t = this.session;
                if (!t.stopped) {
                    this.touchAction.preventDefaults(e);
                    var n,
                        r = this.recognizers,
                        i = t.curRecognizer;
                    (!i || (i && i.state & vt)) && (i = t.curRecognizer = null);
                    for (var o = 0; o < r.length; ) (n = r[o]), t.stopped === wt || (i && n != i && !n.canRecognizeWith(i)) ? n.reset() : n.recognize(e), !i && n.state & (pt | gt | mt) && (i = t.curRecognizer = n), o++;
                }
            },
            get: function (e) {
                if (e instanceof X) return e;
                for (var t = this.recognizers, n = 0; n < t.length; n++) if (t[n].options.event == e) return t[n];
                return null;
            },
            add: function (e) {
                if (o(e, "add", this)) return this;
                var t = this.get(e.options.event);
                return t && this.remove(t), this.recognizers.push(e), (e.manager = this), this.touchAction.update(), e;
            },
            remove: function (e) {
                if (o(e, "remove", this)) return this;
                if ((e = this.get(e))) {
                    var t = this.recognizers,
                        n = v(t, e);
                    n !== -1 && (t.splice(n, 1), this.touchAction.update());
                }
                return this;
            },
            on: function (e, t) {
                if (e !== r && t !== r) {
                    var n = this.handlers;
                    return (
                        a(m(e), function (e) {
                            (n[e] = n[e] || []), n[e].push(t);
                        }),
                        this
                    );
                }
            },
            off: function (e, t) {
                if (e !== r) {
                    var n = this.handlers;
                    return (
                        a(m(e), function (e) {
                            t ? n[e] && n[e].splice(v(n[e], t), 1) : delete n[e];
                        }),
                        this
                    );
                }
            },
            emit: function (e, t) {
                this.options.domEvents && ue(e, t);
                var n = this.handlers[e] && this.handlers[e].slice();
                if (n && n.length) {
                    (t.type = e),
                        (t.preventDefault = function () {
                            t.srcEvent.preventDefault();
                        });
                    for (var r = 0; r < n.length; ) n[r](t), r++;
                }
            },
            destroy: function () {
                this.element && ce(this, !1), (this.handlers = {}), (this.session = {}), this.input.destroy(), (this.element = null);
            },
        }),
            de(se, {
                INPUT_START: Pe,
                INPUT_MOVE: Ne,
                INPUT_END: Oe,
                INPUT_CANCEL: Ae,
                STATE_POSSIBLE: ht,
                STATE_BEGAN: pt,
                STATE_CHANGED: gt,
                STATE_ENDED: mt,
                STATE_RECOGNIZED: vt,
                STATE_CANCELLED: bt,
                STATE_FAILED: yt,
                DIRECTION_NONE: De,
                DIRECTION_LEFT: Me,
                DIRECTION_RIGHT: Fe,
                DIRECTION_UP: Le,
                DIRECTION_DOWN: Ue,
                DIRECTION_HORIZONTAL: Be,
                DIRECTION_VERTICAL: je,
                DIRECTION_ALL: ze,
                Manager: le,
                Input: E,
                TouchAction: G,
                TouchInput: z,
                MouseInput: L,
                PointerEventInput: U,
                TouchMouseInput: H,
                SingleTouchInput: B,
                Recognizer: X,
                AttrRecognizer: ee,
                Tap: ae,
                Pan: te,
                Swipe: oe,
                Pinch: ne,
                Rotate: ie,
                Press: re,
                on: f,
                off: h,
                each: a,
                merge: ye,
                extend: be,
                assign: de,
                inherit: l,
                bindFn: c,
                prefixed: _,
            });
        var xt = "undefined" != typeof e ? e : "undefined" != typeof self ? self : {};
        (xt.Hammer = se),
            "function" == typeof define && define.amd
                ? define("hammerjs", [], function () {
                      return se;
                  })
                : "undefined" != typeof module && module.exports
                ? (module.exports = se)
                : (e[n] = se);
    })(window, document, "Hammer"),
    (function (e) {
        "function" == typeof define && define.amd ? define("jquery_hammer", ["jquery", "hammerjs"], e) : "object" == typeof exports ? e(require("jquery"), require("hammerjs")) : e(jQuery, Hammer);
    })(function (e, t) {
        function n(n, r) {
            var i = e(n);
            i.data("hammer") || i.data("hammer", new t(i[0], r));
        }
        (e.fn.hammer = function (e) {
            return this.each(function () {
                n(this, e);
            });
        }),
            (t.Manager.prototype.emit = (function (t) {
                return function (n, r) {
                    t.call(this, n, r), e(this.element).trigger({ type: n, gesture: r });
                };
            })(t.Manager.prototype.emit));
    }),
    define("readium_js_viewer/gestures", ["readium_shared_js/globals", "jquery", "jquery_hammer", "hammerjs"], function (e, t, n, r) {
        var i = function (n, i) {
            var o = function () {
                    n.openPageRight();
                },
                a = function () {
                    n.openPageLeft();
                },
                s = function () {
                    var e = n.getCurrentViewType();
                    return e === ReadiumSDK.Views.ReaderView.VIEW_TYPE_FIXED || e == ReadiumSDK.Views.ReaderView.VIEW_TYPE_COLUMNIZED;
                },
                l = function () {
                    return (
                        navigator.userAgent.match(/Android/i) ||
                        navigator.userAgent.match(/webOS/i) ||
                        navigator.userAgent.match(/iPhone/i) ||
                        navigator.userAgent.match(/iPod/i) ||
                        navigator.userAgent.match(/iPad/i) ||
                        navigator.userAgent.match(/Touch/i) ||
                        navigator.userAgent.match(/IEMobile/i) ||
                        navigator.userAgent.match(/Silk/i)
                    );
                };
            this.initialize = function () {
                l() &&
                    (n.on(ReadiumSDK.Events.CONTENT_DOCUMENT_LOADED, function (n, i) {
                        e.logEvent("CONTENT_DOCUMENT_LOADED", "ON", "gestures.js [ " + i.href + " ]");
                        var l = /Android/i.test(navigator.userAgent),
                            c = n.contents()[0];
                        l && (c = n.contents().find("html")[0]);
                        var u = new r(c);
                        u.on("swipe", function (e) {
                            2 === e.direction ? o() : 4 === e.direction && a();
                        }),
                            t(r.DOCUMENT).on("touchmove", function (e) {
                                s() && e.preventDefault();
                            });
                    }),
                    t(i).on("touchmove", function (e) {
                        s() && e.preventDefault();
                    }),
                    t(i)
                        .hammer()
                        .on("swipeleft", function () {
                            o();
                        }),
                    t(i)
                        .hammer()
                        .on("swiperight", function () {
                            a();
                        }));
            };
        };
        return i;
    }),
    define("readium_js_viewer/versioning/ReadiumVersioning", ["readium_js/Readium"], function (e) {
        var t = {
            getVersioningInfo: function (t) {
                e.getVersion(function (e) {
                    var n = {};
                    n = e;
                    var r = new Date(e.readiumJsViewer.timestamp);
                    (n.dateTimeString = r.toUTCString ? r.toUTCString() : r.toString()), t(n);
                });
            },
        };
        return t;
    }),
    define("readium_js_viewer/EpubReader", [
        "readium_shared_js/globalsSetup",
        "readium_shared_js/globals",
        "./ModuleConfig",
        "jquery",
        "bootstrap",
        "bootstrapA11y",
        "URIjs",
        "./Spinner",
        "Settings",
        "i18nStrings",
        "./Dialogs",
        "./ReaderSettingsDialog",
        "hgn!readium_js_viewer_html_templates/about-dialog.html",
        "hgn!readium_js_viewer_html_templates/reader-navbar.html",
        "hgn!readium_js_viewer_html_templates/reader-body.html",
        "hgn!readium_js_viewer_html_templates/reader-body-page-btns.html",
        "Analytics",
        "screenfull",
        "./Keyboard",
        "./EpubReaderMediaOverlays",
        "./EpubReaderBackgroundAudioTrack",
        "./gestures",
        "./versioning/ReadiumVersioning",
        "readium_js/Readium",
        "readium_shared_js/helpers",
        "readium_shared_js/models/bookmark_data",
    ], function (e, t, n, r, i, o, a, s, l, c, u, d, f, h, p, g, m, v, b, y, _, w, x, E, C, T) {
        function S(e) {
            var t = r(".book-title-header");
            t.length ? t.text(e) : r('<h2 class="book-title-header"></h2>').insertAfter(".navbar").text(e);
            var n = r("#navBarTitle");
            n.text(e);
        }
        var R = void 0,
            I = void 0,
            k = void 0,
            P = void 0,
            N = void 0,
            O = void 0,
            A =
                (document.documentElement,
                function () {
                    var e = "",
                        t = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
                    return t || (e = "nav *[title], #readium-page-btns *[title]"), e;
                }),
            D = function (e) {
                if (!e) return e;
                if (0 != e.indexOf("http")) return e;
                var t = 0 == e.indexOf("https"),
                    n = "/http://",
                    r = "/https://",
                    i = "%2Fhttp%3A%2F%2F",
                    o = "%2Fhttps%3A%2F%2F",
                    s = new RegExp("%2F(http[s]?)%3A%2F%2F", "gi"),
                    l = window.location ? window.location.protocol + "//" + window.location.hostname + (window.location.port ? ":" + window.location.port : "") + window.location.pathname : void 0;
                return (
                    l &&
                        (console.log("EPUB URL absolute: " + e),
                        console.log("App URL: " + l),
                        (e = e.replace(n, i)),
                        (e = e.replace(r, o)),
                        (e = new a(e).relativeTo(l).toString()),
                        0 == e.indexOf("//") && (e = (t ? "https:" : "http:") + e),
                        (e = e.replace(s, "/$1://")),
                        console.log("EPUB URL relative to app: " + e)),
                    e
                );
            },
            M = void 0,
            F = function (e) {
                var t = !0;
                if (t && R) {
                    var n = R.reader.getPaginationInfo();
                    if ((console.log(JSON.stringify(n)), !n.isFixedLayout)) {
                        try {
                            ReadiumSDK._DEBUG_CfiNavigationLogic.clearDebugOverlays();
                        } catch (e) {}
                        try {
                            console.log(e);
                            var r = R.reader.getDomRangeFromRangeCfi(e);
                            console.log(r);
                            var i = ReadiumSDK._DEBUG_CfiNavigationLogic.drawDebugOverlayFromDomRange(r);
                            console.log(i);
                            var o = ReadiumSDK.reader.getFirstVisibleCfi();
                            console.log(o);
                            var a = ReadiumSDK.reader.getLastVisibleCfi();
                            console.log(a);
                        } catch (e) {}
                        setTimeout(function () {
                            try {
                                ReadiumSDK._DEBUG_CfiNavigationLogic.clearDebugOverlays();
                            } catch (e) {}
                        }, 2e3);
                    }
                }
            },
            L = function (e, t) {
                R.openPackageDocument(
                    k,
                    function (e, t) {
                        if (!e) return console.error("ERROR OPENING EBOOK: " + P), U(!1), S(P), void u.showErrorWithDetails(c.err_epub_corrupt, P);
                        (N = e),
                            N.generateTocListDOM(function (e) {
                                H(e);
                            }),
                            (wasFixed = R.reader.isCurrentViewFixedLayout());
                        var n = t.metadata;
                        S(n.title), r("#left-page-btn").unbind("click"), r("#right-page-btn").unbind("click");
                        var i = r("#readium-page-btns");
                        i.empty();
                        var o = "rtl" === N.getPageProgressionDirection();
                        i.append(g({ strings: c, dialogs: u, keyboard: b, pageProgressionDirectionIsRTL: o })),
                            r("#left-page-btn").on("click", ee),
                            r("#right-page-btn").on("click", Z),
                            r("#left-page-btn").mouseleave(function () {
                                r(A()).tooltip("destroy");
                            }),
                            r("#right-page-btn").mouseleave(function () {
                                r(A()).tooltip("destroy");
                            });
                    },
                    t
                );
            },
            U = function (e) {
                if (e) {
                    if (s.willSpin || s.isSpinning) return;
                    (s.willSpin = !0),
                        setTimeout(function () {
                            return s.stopRequested ? ((s.willSpin = !1), void (s.stopRequested = !1)) : ((s.isSpinning = !0), s.spin(r("#reading-area")[0]), void (s.willSpin = !1));
                        }, 100);
                } else s.isSpinning ? (s.stop(), (s.isSpinning = !1)) : s.willSpin && (s.stopRequested = !0);
            },
            B = function () {
                J();
                var e,
                    t = r("#app-container"),
                    n = t.hasClass("toc-visible");
                if ((R.reader.handleViewportResize && !I && (e = JSON.parse(R.reader.bookmarkCurrentPage())), n)) {
                    t.removeClass("toc-visible");
                    var i = r('#readium-toc-body a[tabindex="60"]');
                    i.length > 0 && i[0].setAttribute("tabindex", "-1"),
                        setTimeout(function () {
                            r("#tocButt")[0].focus();
                        }, 100);
                } else
                    t.addClass("toc-visible"),
                        setTimeout(function () {
                            r("#readium-toc-body button.close")[0].focus();
                        }, 100);
                I ? X(null, !0) : R.reader.handleViewportResize && R.reader.handleViewportResize(e);
            },
            j = function () {
                r(".zoom-wrapper").show();
            },
            z = function () {
                var e = R.reader.getViewScale();
                r(".zoom-wrapper input").val(Math.round(e) + "%");
            },
            V = function () {
                r(".zoom-wrapper").hide();
            },
            H = function (e) {
                if (e) {
                    r("script", e).remove();
                    var n,
                        i = r("nav", e);
                    Array.prototype.every.call(i, function (e) {
                        return "toc" != e.getAttributeNS("http://www.idpf.org/2007/ops", "type") || ((n = e), !1);
                    });
                    for (var o = !1, a = n; a && a.getAttributeNS; ) {
                        var s = a.getAttributeNS("http://www.w3.org/1999/xhtml", "dir") || a.getAttribute("dir");
                        if (s && "rtl" === s) {
                            o = !0;
                            break;
                        }
                        a = a.parentNode;
                    }
                    var l = (n && r(n).html()) || r("body", e).html() || r(e).html(),
                        u = N.getToc();
                    if (l && l.length) {
                        var d = r(l);
                        r("iframe", d).remove(), r("#readium-toc-body").append(d), o && (d[0].setAttributeNS("http://www.w3.org/1999/xhtml", "dir", "rtl"), (d[0].style.direction = "rtl"));
                        var f = r("#readium-toc-body li >a");
                        f.each(function () {
                            r(this).attr("tabindex", "-1"),
                                r(this).on("focus", function (e) {
                                    var t = r('#readium-toc-body a[tabindex="60"]');
                                    t.length > 0 && t[0] !== e.target && t.attr("tabindex", "-1"), e.target.setAttribute("tabindex", "60");
                                });
                        });
                    }
                } else {
                    var u = N.getToc();
                    r("#readium-toc-body").append("?? " + u);
                }
                var h = !1,
                    p = void 0;
                R.reader.on(ReadiumSDK.Events.FXL_VIEW_RESIZED, function () {
                    t.logEvent("FXL_VIEW_RESIZED", "ON", "EpubReader.js"), z();
                }),
                    R.reader.on(ReadiumSDK.Events.CONTENT_DOCUMENT_LOADED, function (e, n) {
                        t.logEvent("CONTENT_DOCUMENT_LOADED", "ON", "EpubReader.js [ " + n.href + " ]");
                        var r = R.reader.isCurrentViewFixedLayout();
                        r ? j() : V(), e.attr("title", "EPUB"), e.attr("aria-label", "EPUB"), (p = e[0]);
                    }),
                    R.reader.on(ReadiumSDK.Events.PAGINATION_CHANGED, function (e) {
                        if ((t.logEvent("PAGINATION_CHANGED", "ON", "EpubReader.js"), M && (F(M), (M = void 0)), Y(), Q(e), U(!1), h)) {
                            h = !1;
                            try {
                                var n = void 0,
                                    i = void 0,
                                    o = e.elementId;
                                if (o) {
                                    n = r("#epub-reader-frame iframe")[0];
                                    var a = (n.contentWindow || n.contentDocument).document;
                                    (i = a.getElementById(o)), i || ((n = r("#epub-reader-frame iframe")[1]), n && ((a = (n.contentWindow || n.contentDocument).document), (i = a.getElementById(o)), i || (n = void 0)));
                                } else {
                                    var s = JSON.parse(R.reader.bookmarkCurrentPage());
                                    if (e.spineItem && ((i = R.reader.getElementByCfi(e.spineItem.idref, s.contentCFI, ["cfi-marker", "mo-cfi-highlight"], [], ["MathJax_Message"])), (i = i[0]))) {
                                        n = r("#epub-reader-frame iframe")[0];
                                        var a = (n.contentWindow || n.contentDocument).document;
                                        i.ownerDocument !== a && ((n = r("#epub-reader-frame iframe")[1]), n && ((a = (n.contentWindow || n.contentDocument).document), i.ownerDocument !== a && (n = void 0)));
                                    }
                                }
                                n || (n = p);
                            } catch (e) {}
                        }
                    }),
                    r("#readium-toc-body").on("click", "a", function (e) {
                        try {
                            U(!0);
                            var t = r(this).attr("href");
                            (h = !0), R.reader.openContentUrl(t, u, void 0), I && (r(".toc-visible").removeClass("toc-visible"), J());
                        } catch (e) {
                            console.error(e);
                        } finally {
                            return !1;
                        }
                    }),
                    r("#readium-toc-body").prepend(
                        '<button tabindex="50" type="button" class="close" data-dismiss="modal" aria-label="' + c.i18n_close + " " + c.toc + '" title="' + c.i18n_close + " " + c.toc + '"><span aria-hidden="true">&times;</span></button>'
                    ),
                    r("#readium-toc-body button.close").on("click", function () {
                        return B(), !1;
                    });
                var g = 35,
                    m = 36,
                    v = 38,
                    b = 40;
                r("#readium-toc-body").keydown(function (e) {
                    var t = null,
                        n = e.target;
                    switch (e.which) {
                        case m:
                            t = r("#readium-toc-body li >a")[0];
                            break;
                        case g:
                            t = r("#readium-toc-body a").last()[0];
                            break;
                        case b:
                            if ("BUTTON" == n.tagName) {
                                var i = r('#readium-toc-body a[tabindex="60"]');
                                t = i.length > 0 ? i[0] : r("#readium-toc-body li >a")[0];
                            } else {
                                var o = r("#readium-toc-body a"),
                                    a = r('a[tabindex="60"]').index("#readium-toc-body a");
                                a > -1 && a < o.length - 1 && (t = o.get(a + 1));
                            }
                            break;
                        case v:
                            var o = r("#readium-toc-body a"),
                                a = r('a[tabindex="60"]').index("#readium-toc-body a");
                            a > -1 && a > 0 && (t = o.get(a - 1));
                            break;
                        default:
                            return;
                    }
                    t && (e.preventDefault(), setTimeout(t.focus(), 5));
                });
            },
            $ = function () {
                return v.enabled && "undefined" == typeof LDEpubUtils ? void v.toggle() : (r(document).trigger("fullscreenToggleRequest"), !0);
            },
            W = "undefined" != typeof chrome && chrome.app && chrome.app.window && chrome.app.window.current;
        W &&
            (v.onchange = function (e) {
                chrome.app.window.current().isFullscreen() && chrome.app.window.current().restore();
            });
        var q = v.onchange;
        v.onchange = function (e) {
            var t;
            v.isFullscreen
                ? ((t = c.exit_fullscreen + " [" + b.FullScreenToggle + "]"),
                  r("#buttFullScreenToggle span").removeClass("glyphicon-resize-full"),
                  r("#buttFullScreenToggle span").addClass("glyphicon-resize-small"),
                  r("#buttFullScreenToggle").attr("aria-label", t),
                  r("#buttFullScreenToggle").attr("title", t))
                : ((t = c.enter_fullscreen + " [" + b.FullScreenToggle + "]"),
                  r("#buttFullScreenToggle span").removeClass("glyphicon-resize-small"),
                  r("#buttFullScreenToggle span").addClass("glyphicon-resize-full"),
                  r("#buttFullScreenToggle").attr("aria-label", t),
                  r("#buttFullScreenToggle").attr("title", t)),
                q.call(this, e);
        };
        var G,
            J = function () {
                X();
            },
            K = function () {
                G = null;
                var e = r("#app-container").is(".toc-visible, .loc-visible");
                if (!I && e) return void X();
                var t = document.getElementById("app-navbar");
                if (document.activeElement) {
                    var n = jQuery.contains(t, document.activeElement);
                    if (n) return void X();
                }
                var i = r(t),
                    o = i.find(":hover").length > 0;
                return o ? void X() : r("#audioplayer").hasClass("expanded-audio") ? void X() : (r(A()).tooltip("destroy"), void r(document.body).addClass("hide-ui"));
            },
            X = function (e, t) {
                G && (window.clearTimeout(G), (G = null));
                var n = r("#app-container").is(".toc-visible, .loc-visible");
                !n && r(document.body).hasClass("hide-ui") && r(document.body).removeClass("hide-ui"), t ? K() : (G = window.setTimeout(K, 8e3));
            },
            Q = function (e) {
                e.paginationInfo.canGoLeft() ? r("#left-page-btn").show() : r("#left-page-btn").hide(), e.paginationInfo.canGoRight() ? r("#right-page-btn").show() : r("#right-page-btn").hide();
            },
            Y = function () {
                var e = R.reader.bookmarkCurrentPage();
                l.put(P, e, r.noop), r(document).trigger("readerNeedToSave", e);
            },
            Z = function () {
                return R.reader.openPageRight(), !1;
            },
            ee = function () {
                return R.reader.openPageLeft(), !1;
            },
            te = function () {
                W
                    ? r(".icon-shareUrl").css("display", "none")
                    : r(".icon-shareUrl").on("click", function () {
                          var e = C.getURLQueryParams(),
                              t = e.epub;
                          if (t) {
                              var n = R.reader.bookmarkCurrentPage();
                              n = JSON.parse(n);
                              var i = new T(n.idref, n.contentCFI);
                              F(i), (n.elementCfi = n.contentCFI), (n.contentCFI = void 0), (n = JSON.stringify(n)), (t = D(t));
                              var o = C.buildUrlQueryParameters(void 0, { epub: t, epubs: " ", embedded: " ", goto: n });
                              u.showModalMessageEx(
                                  c.share_url,
                                  r(
                                      '<p id="share-url-dialog-input-label">' +
                                          c.share_url_label +
                                          '</p><input id="share-url-dialog-input-id" aria-labelledby="share-url-dialog-input-label" type="text" value="' +
                                          o +
                                          '" readonly="readonly" style="width:100%" />'
                                  )
                              ),
                                  setTimeout(function () {
                                      r("#share-url-dialog-input-id").focus().select();
                                  }, 500);
                          }
                      }),
                    r(".icon-annotations").on("click", function () {
                        R.reader.plugins.highlights.addSelectionHighlight(Math.floor(1e6 * Math.random()), "test-highlight");
                    });
                var e = function () {
                        return (
                            document.activeElement &&
                            (document.activeElement === document.getElementById("volume-range-slider") ||
                                document.activeElement === document.getElementById("time-range-slider") ||
                                document.activeElement === document.getElementById("rate-range-slider") ||
                                jQuery.contains(document.getElementById("mo-sync-form"), document.activeElement) ||
                                jQuery.contains(document.getElementById("mo-highlighters"), document.activeElement))
                        );
                    },
                    t = function () {
                        var e = r("#app-container").is(".toc-visible, .loc-visible");
                        (!I && e) || (K(), document.activeElement && document.activeElement.blur());
                    };
                r("#buttHideToolBar").on("click", t), b.on(b.ToolbarHide, "reader", t);
                var n = function () {
                    r("#aboutButt1")[0].focus(),
                        J(),
                        setTimeout(function () {
                            r("#aboutButt1")[0].focus();
                        }, 50);
                };
                r("#buttShowToolBar").on("click", n),
                    b.on(b.ToolbarShow, "reader", n),
                    b.on(b.PagePrevious, "reader", function () {
                        e() || ee();
                    }),
                    b.on(b.PagePreviousAlt, "reader", ee),
                    b.on(b.PageNextAlt, "reader", Z),
                    b.on(b.PageNext, "reader", function () {
                        e() || Z();
                    }),
                    b.on(b.FullScreenToggle, "reader", $),
                    r("#buttFullScreenToggle").on("click", $);
                var i = function () {
                    r("html").attr("data-theme", "library");
                    var e = C.getURLQueryParams(),
                        t = e.epubs;
                    r(window).triggerHandler("loadlibrary", t);
                };
                b.on(b.SwitchToLibrary, "reader", i),
                    r(".icon-library").on("click", function () {
                        return i(), !1;
                    }),
                    r(".zoom-wrapper input").on("click", function () {
                        if (!this.disabled) return this.focus(), !1;
                    }),
                    b.on(b.TocShowHideToggle, "reader", function () {
                        var e = r("#app-container").is(".toc-visible, .loc-visible");
                        e
                            ? setTimeout(function () {
                                  r("#readium-toc-body button.close")[0].focus();
                              }, 100)
                            : B();
                    }),
                    r(".icon-toc").on("click", B);
                var o = function () {
                    var e = r(document.body).height() - r("#app-container")[0].offsetTop;
                    r("#app-container").height(e), r("#readium-toc-body").height(e);
                };
                b.on(b.ShowSettingsModal, "reader", function () {
                    r("#settings-dialog").modal("show");
                }),
                    r("#app-navbar").on("mousemove", X),
                    r(window).on("resize", o),
                    o(),
                    X();
            },
            ne = function (e) {
                return (
                    R.reader.setZoom({ style: "fit-screen" }),
                    r(".active-zoom").removeClass("active-zoom"),
                    r("#zoom-fit-screen").addClass("active-zoom"),
                    r(".zoom-wrapper input").prop("disabled", !0),
                    r(".zoom-wrapper>a").dropdown("toggle"),
                    !1
                );
            },
            re = function (e) {
                return (
                    R.reader.setZoom({ style: "fit-width" }),
                    r(".active-zoom").removeClass("active-zoom"),
                    r("#zoom-fit-width").addClass("active-zoom"),
                    r(".zoom-wrapper input").prop("disabled", !0),
                    r(".zoom-wrapper>a").dropdown("toggle"),
                    !1
                );
            },
            ie = function (e) {
                return r(".zoom-wrapper input").prop("disabled", !1).focus(), r(".active-zoom").removeClass("active-zoom"), r("#zoom-custom").addClass("active-zoom"), r(".zoom-wrapper>a").dropdown("toggle"), !1;
            },
            oe = /^\s*(\d+)%?\s*$/,
            ae = function (e) {
                var t = r(".zoom-wrapper input").val(),
                    n = oe.exec(t);
                if (n) {
                    var i = Number(n[1]) / 100;
                    R.reader.setZoom({ style: "user", scale: i });
                } else z();
            },
            se = function () {
                r(".modal-backdrop").remove();
                var e = r("#app-container");
                e.empty(),
                    e.append(p({ strings: c, dialogs: u, keyboard: b })),
                    r("nav").empty(),
                    r("nav").attr("aria-label", c.i18n_toolbar),
                    r("nav").append(h({ strings: c, dialogs: u, keyboard: b })),
                    te(),
                    (document.title = "Readium"),
                    r("#zoom-fit-width a").on("click", re),
                    r("#zoom-fit-screen a").on("click", ne),
                    r("#zoom-custom a").on("click", ie),
                    r(".zoom-wrapper input").on("change", ae),
                    U(!0);
            },
            le = function (e) {
                b.scope("reader"),
                    (k = e.epub),
                    (P = C.getEbookUrlFilePath(k)),
                    m.trackView("/reader"),
                    (I = e.embedded),
                    se(),
                    R && R.reader && (t.logEvent("__ALL__", "OFF", "EpubReader.js"), R.reader.off()),
                    window.ReadiumSDK && (t.logEvent("PLUGINS_LOADED", "OFF", "EpubReader.js"), ReadiumSDK.off(ReadiumSDK.Events.PLUGINS_LOADED)),
                    setTimeout(function () {
                        ce();
                    }, 0);
            },
            ce = function () {
                console.log("MODULE CONFIG:"),
                    console.log(n),
                    l.getMultiple(["reader", P], function (e) {
                        var i = { el: "#epub-reader-frame", annotationCSSUrl: n.annotationCSSUrl, mathJaxUrl: n.mathJaxUrl },
                            o = { jsLibRoot: n.jsLibRoot, openBookOptions: {} };
                        n.useSimpleLoader && (o.useSimpleLoader = !0), (M = void 0);
                        var a;
                        if (e[P]) {
                            var s = JSON.parse(JSON.parse(e[P]));
                            (a = { idref: s.idref, elementCfi: s.contentCFI }), console.debug("Open request (bookmark): " + JSON.stringify(a));
                        }
                        var u = C.getURLQueryParams(),
                            h = u.goto;
                        if (h) {
                            console.log("Goto override? " + h);
                            try {
                                var p = JSON.parse(h),
                                    g = void 0;
                                p.idref
                                    ? p.spineItemPageIndex
                                        ? (g = { idref: p.idref, spineItemPageIndex: p.spineItemPageIndex })
                                        : p.elementCfi
                                        ? ((M = new T(p.idref, p.elementCfi)), (g = { idref: p.idref, elementCfi: p.elementCfi }))
                                        : (g = { idref: p.idref })
                                    : p.contentRefUrl && p.sourceFileHref && (g = { contentRefUrl: p.contentRefUrl, sourceFileHref: p.sourceFileHref }),
                                    g && ((a = g), console.debug("Open request (goto): " + JSON.stringify(a)));
                            } catch (e) {
                                console.error(e);
                            }
                        }
                        (R = new E(o, i)),
                            (window.READIUM = R),
                            ReadiumSDK.on(ReadiumSDK.Events.PLUGINS_LOADED, function () {
                                t.logEvent("PLUGINS_LOADED", "ON", "EpubReader.js"),
                                    console.log("PLUGINS INITIALIZED!"),
                                    R.reader.plugins.highlights
                                        ? (R.reader.plugins.highlights.initialize({ annotationCSSUrl: i.annotationCSSUrl }),
                                          R.reader.plugins.highlights.on("annotationClicked", function (e, t, n, r) {
                                              console.debug("ANNOTATION CLICK: " + r), R.reader.plugins.highlights.removeHighlight(r);
                                          }))
                                        : r(".icon-annotations").css("display", "none"),
                                    R.reader.plugins.example &&
                                        R.reader.plugins.example.on("exampleEvent", function (e) {
                                            alert(e);
                                        });
                            }),
                            (O = new w(R.reader, i.el)),
                            O.initialize(),
                            r(window).on("keyup", function (e) {
                                (9 !== e.keyCode && 9 !== e.which) || J();
                            }),
                            R.reader.addIFrameEventListener("keydown", function (e) {
                                b.dispatch(document.documentElement, e.originalEvent);
                            }),
                            R.reader.addIFrameEventListener("keyup", function (e) {
                                b.dispatch(document.documentElement, e.originalEvent);
                            }),
                            R.reader.addIFrameEventListener("focus", function (e) {
                                r("#reading-area").addClass("contentFocus"), r(window).trigger("focus");
                            }),
                            R.reader.addIFrameEventListener("blur", function (e) {
                                r("#reading-area").removeClass("contentFocus");
                            }),
                            d.initDialog(R.reader),
                            r("#settings-dialog").on("hidden.bs.modal", function () {
                                b.scope("reader"),
                                    J(),
                                    setTimeout(function () {
                                        r("#settbutt1").focus();
                                    }, 50),
                                    r("#buttSave").removeAttr("accesskey"),
                                    r("#buttClose").removeAttr("accesskey");
                            }),
                            r("#settings-dialog").on("shown.bs.modal", function () {
                                b.scope("settings"), r("#buttSave").attr("accesskey", b.accesskeys.SettingsModalSave), r("#buttClose").attr("accesskey", b.accesskeys.SettingsModalClose);
                            }),
                            r("#about-dialog").on("hidden.bs.modal", function () {
                                b.scope("reader"),
                                    J(),
                                    setTimeout(function () {
                                        r("#aboutButt1").focus();
                                    }, 50);
                            }),
                            r("#about-dialog").on("shown.bs.modal", function () {
                                b.scope("about");
                            });
                        var m;
                        e.reader && (m = JSON.parse(e.reader)), I ? R.reader.updateSettings({ syntheticSpread: "auto", scroll: "auto" }) : ((m = m || d.defaultSettings), d.updateReader(R.reader, m));
                        var v = function () {
                            I ||
                                l.get("reader", function (e) {
                                    e || (e = {});
                                    var t = "night-theme" === e.theme;
                                    (e.theme = t ? "author-theme" : "night-theme"), l.put("reader", e), d.updateReader(R.reader, e);
                                });
                        };
                        r("#buttNightTheme").on("click", v),
                            b.on(b.NightTheme, "reader", v),
                            R.reader.on(ReadiumSDK.Events.CONTENT_DOCUMENT_LOAD_START, function (e, n) {
                                t.logEvent("CONTENT_DOCUMENT_LOAD_START", "ON", "EpubReader.js [ " + n.href + " ]"), U(!0);
                            }),
                            y.init(R),
                            _.init(R),
                            x.getVersioningInfo(function (e) {
                                r("#app-container").append(
                                    f({ imagePathPrefix: n.imagePathPrefix, strings: c, dateTimeString: e.dateTimeString, viewerJs: e.readiumJsViewer, readiumJs: e.readiumJs, sharedJs: e.readiumSharedJs, cfiJs: e.readiumCfiJs })
                                ),
                                    (window.navigator.epubReadingSystem.name = "readium-js-viewer"),
                                    (window.navigator.epubReadingSystem.version = e.readiumJsViewer.chromeVersion),
                                    (window.navigator.epubReadingSystem.readium = {}),
                                    (window.navigator.epubReadingSystem.readium.buildInfo = {}),
                                    (window.navigator.epubReadingSystem.readium.buildInfo.dateTime = e.dateTimeString),
                                    (window.navigator.epubReadingSystem.readium.buildInfo.version = e.readiumJsViewer.version),
                                    (window.navigator.epubReadingSystem.readium.buildInfo.chromeVersion = e.readiumJsViewer.chromeVersion),
                                    (window.navigator.epubReadingSystem.readium.buildInfo.gitRepositories = []);
                                var t = {};
                                (t.name = "readium-js-viewer"),
                                    (t.sha = e.readiumJsViewer.sha),
                                    (t.tag = e.readiumJsViewer.tag),
                                    (t.version = e.readiumJsViewer.version),
                                    (t.clean = e.readiumJsViewer.clean),
                                    (t.branch = e.readiumJsViewer.branch),
                                    (t.release = e.readiumJsViewer.release),
                                    (t.timestamp = e.readiumJsViewer.timestamp),
                                    (t.url = "https://github.com/readium/" + t.name + "/tree/" + t.sha),
                                    window.navigator.epubReadingSystem.readium.buildInfo.gitRepositories.push(t);
                                var i = {};
                                (i.name = "readium-js"),
                                    (i.sha = e.readiumJs.sha),
                                    (i.tag = e.readiumJs.tag),
                                    (i.version = e.readiumJs.version),
                                    (i.clean = e.readiumJs.clean),
                                    (i.branch = e.readiumJs.branch),
                                    (i.release = e.readiumJs.release),
                                    (i.timestamp = e.readiumJs.timestamp),
                                    (i.url = "https://github.com/readium/" + i.name + "/tree/" + i.sha),
                                    window.navigator.epubReadingSystem.readium.buildInfo.gitRepositories.push(i);
                                var o = {};
                                (o.name = "readium-shared-js"),
                                    (o.sha = e.readiumSharedJs.sha),
                                    (o.tag = e.readiumSharedJs.tag),
                                    (o.version = e.readiumSharedJs.version),
                                    (o.clean = e.readiumSharedJs.clean),
                                    (o.branch = e.readiumSharedJs.branch),
                                    (o.release = e.readiumSharedJs.release),
                                    (o.timestamp = e.readiumSharedJs.timestamp),
                                    (o.url = "https://github.com/readium/" + o.name + "/tree/" + o.sha),
                                    window.navigator.epubReadingSystem.readium.buildInfo.gitRepositories.push(o);
                                var s = {};
                                (s.name = "readium-cfi-js"),
                                    (s.sha = e.readiumCfiJs.sha),
                                    (s.tag = e.readiumCfiJs.tag),
                                    (s.version = e.readiumCfiJs.version),
                                    (s.clean = e.readiumCfiJs.clean),
                                    (s.branch = e.readiumCfiJs.branch),
                                    (s.release = e.readiumCfiJs.release),
                                    (s.timestamp = e.readiumCfiJs.timestamp),
                                    (s.url = "https://github.com/readium/" + s.name + "/tree/" + s.sha),
                                    window.navigator.epubReadingSystem.readium.buildInfo.gitRepositories.push(s),
                                    L(m, a);
                            });
                    });
            },
            ue = function () {
                if (
                    (R && R.closePackageDocument(),
                    u.closeModal(),
                    u.reset(),
                    r("#settings-dialog").modal("hide"),
                    r("#about-dialog").modal("hide"),
                    r(".modal-backdrop").remove(),
                    r("#app-navbar").off("mousemove"),
                    b.off("reader"),
                    b.off("settings"),
                    r("#settings-dialog").off("hidden.bs.modal"),
                    r("#settings-dialog").off("shown.bs.modal"),
                    r("#about-dialog").off("hidden.bs.modal"),
                    r("#about-dialog").off("shown.bs.modal"),
                    R && R.reader)
                )
                    try {
                        R.reader.pauseMediaOverlay();
                    } catch (e) {}
                r(window).off("resize"),
                    r(window).off("mousemove"),
                    r(window).off("keyup"),
                    r(window).off("message"),
                    window.clearTimeout(G),
                    r(document.body).removeClass("embedded"),
                    r(".book-title-header").remove(),
                    r(document.body).removeClass("hide-ui");
            },
            de = function (e) {
                l.get("reader", function (t) {
                    b.applySettings(t), le(e);
                });
            };
        return { loadUI: de, unloadUI: ue, tooltipSelector: A, ensureUrlIsRelativeToApp: D };
    }),
    define("readium_js_viewer/ReadiumViewerLite", ["jquery", "./EpubReader", "readium_shared_js/helpers"], function (e, t, n) {
        if (
            (e(function () {
                var r = n.getURLQueryParams();
                r.epub || (r = { epub: "epub" }),
                    t.loadUI(r),
                    e(document.body).on("click", function () {
                        e(document.body).removeClass("keyboard");
                    }),
                    e(document).on("keyup", function (t) {
                        e(document.body).addClass("keyboard");
                    });
            }),
            e(document.body)
                .tooltip({
                    selector: t.tooltipSelector(),
                    placement: function (e, t) {
                        var n = "auto";
                        return "left-page-btn" == t.id ? (n = "right") : "right-page-btn" == t.id && (n = "left"), n;
                    },
                    container: "body",
                })
                .on("show.bs.tooltip", function (n) {
                    e(t.tooltipSelector()).not(n.target).tooltip("destroy");
                    var r = n.target;
                    setTimeout(function () {
                        e(r).tooltip("destroy");
                    }, 8e3);
                }),
            window.File)
        ) {
            var r = e(document.body);
            r.on("dragover", function (e) {
                e.stopPropagation(), e.preventDefault(), r.addClass("fileDragHover");
            }),
                r.on("dragleave", function (e) {
                    e.stopPropagation(), e.preventDefault(), r.removeClass("fileDragHover");
                }),
                r.on("drop", function (e) {
                    e.stopPropagation(), e.preventDefault(), r.removeClass("fileDragHover");
                    var n = e.target.files || e.originalEvent.dataTransfer.files;
                    if (n.length) {
                        var i = n[0];
                        console.log("File drag-n-drop:"), console.log(i.name), console.log(i.type), console.log(i.size), ("application/epub+zip" == i.type || /\.epub$/.test(i.name)) && t.loadUI({ epub: i });
                    }
                });
        }
    }),
    require(["readium_cfi_js/cfi_API", "readium_plugin_highlights", "readium_shared_js/globalsSetup", "readium_js_viewer/ReadiumViewerLite"]);
//# sourceMappingURL=readium-js-viewer_all_LITE.js.map
